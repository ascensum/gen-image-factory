(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();function tp(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var wx={exports:{}},Ec={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rp=Symbol.for("react.transitional.element"),ap=Symbol.for("react.fragment");function Nx(e,t,r){var a=null;if(r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),"key"in t){r={};for(var n in t)n!=="key"&&(r[n]=t[n])}else r=t;return t=r.ref,{$$typeof:rp,type:e,key:a,ref:t!==void 0?t:null,props:r}}Ec.Fragment=ap;Ec.jsx=Nx;Ec.jsxs=Nx;wx.exports=Ec;var l=wx.exports,Sx={exports:{}},Ae={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uu=Symbol.for("react.transitional.element"),np=Symbol.for("react.portal"),sp=Symbol.for("react.fragment"),lp=Symbol.for("react.strict_mode"),ip=Symbol.for("react.profiler"),cp=Symbol.for("react.consumer"),op=Symbol.for("react.context"),up=Symbol.for("react.forward_ref"),fp=Symbol.for("react.suspense"),dp=Symbol.for("react.memo"),Ex=Symbol.for("react.lazy"),ih=Symbol.iterator;function hp(e){return e===null||typeof e!="object"?null:(e=ih&&e[ih]||e["@@iterator"],typeof e=="function"?e:null)}var Tx={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_x=Object.assign,jx={};function Hs(e,t,r){this.props=e,this.context=t,this.refs=jx,this.updater=r||Tx}Hs.prototype.isReactComponent={};Hs.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Hs.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Ax(){}Ax.prototype=Hs.prototype;function zu(e,t,r){this.props=e,this.context=t,this.refs=jx,this.updater=r||Tx}var Hu=zu.prototype=new Ax;Hu.constructor=zu;_x(Hu,Hs.prototype);Hu.isPureReactComponent=!0;var ch=Array.isArray,rt={H:null,A:null,T:null,S:null,V:null},Cx=Object.prototype.hasOwnProperty;function Gu(e,t,r,a,n,s){return r=s.ref,{$$typeof:Uu,type:e,key:t,ref:r!==void 0?r:null,props:s}}function xp(e,t){return Gu(e.type,t,void 0,void 0,void 0,e.props)}function Vu(e){return typeof e=="object"&&e!==null&&e.$$typeof===Uu}function mp(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var oh=/\/+/g;function qc(e,t){return typeof e=="object"&&e!==null&&e.key!=null?mp(""+e.key):t.toString(36)}function uh(){}function gp(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch(typeof e.status=="string"?e.then(uh,uh):(e.status="pending",e.then(function(t){e.status==="pending"&&(e.status="fulfilled",e.value=t)},function(t){e.status==="pending"&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}function es(e,t,r,a,n){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(s){case"bigint":case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case Uu:case np:i=!0;break;case Ex:return i=e._init,es(i(e._payload),t,r,a,n)}}if(i)return n=n(e),i=a===""?"."+qc(e,0):a,ch(n)?(r="",i!=null&&(r=i.replace(oh,"$&/")+"/"),es(n,t,r,"",function(u){return u})):n!=null&&(Vu(n)&&(n=xp(n,r+(n.key==null||e&&e.key===n.key?"":(""+n.key).replace(oh,"$&/")+"/")+i)),t.push(n)),1;i=0;var c=a===""?".":a+":";if(ch(e))for(var o=0;o<e.length;o++)a=e[o],s=c+qc(a,o),i+=es(a,t,r,s,n);else if(o=hp(e),typeof o=="function")for(e=o.call(e),o=0;!(a=e.next()).done;)a=a.value,s=c+qc(a,o++),i+=es(a,t,r,s,n);else if(s==="object"){if(typeof e.then=="function")return es(gp(e),t,r,a,n);throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return i}function qi(e,t,r){if(e==null)return e;var a=[],n=0;return es(e,a,"","",function(s){return t.call(r,s,n++)}),a}function vp(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var fh=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function pp(){}Ae.Children={map:qi,forEach:function(e,t,r){qi(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return qi(e,function(){t++}),t},toArray:function(e){return qi(e,function(t){return t})||[]},only:function(e){if(!Vu(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ae.Component=Hs;Ae.Fragment=sp;Ae.Profiler=ip;Ae.PureComponent=zu;Ae.StrictMode=lp;Ae.Suspense=fp;Ae.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=rt;Ae.__COMPILER_RUNTIME={__proto__:null,c:function(e){return rt.H.useMemoCache(e)}};Ae.cache=function(e){return function(){return e.apply(null,arguments)}};Ae.cloneElement=function(e,t,r){if(e==null)throw Error("The argument must be a React element, but you passed "+e+".");var a=_x({},e.props),n=e.key,s=void 0;if(t!=null)for(i in t.ref!==void 0&&(s=void 0),t.key!==void 0&&(n=""+t.key),t)!Cx.call(t,i)||i==="key"||i==="__self"||i==="__source"||i==="ref"&&t.ref===void 0||(a[i]=t[i]);var i=arguments.length-2;if(i===1)a.children=r;else if(1<i){for(var c=Array(i),o=0;o<i;o++)c[o]=arguments[o+2];a.children=c}return Gu(e.type,n,void 0,void 0,s,a)};Ae.createContext=function(e){return e={$$typeof:op,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null},e.Provider=e,e.Consumer={$$typeof:cp,_context:e},e};Ae.createElement=function(e,t,r){var a,n={},s=null;if(t!=null)for(a in t.key!==void 0&&(s=""+t.key),t)Cx.call(t,a)&&a!=="key"&&a!=="__self"&&a!=="__source"&&(n[a]=t[a]);var i=arguments.length-2;if(i===1)n.children=r;else if(1<i){for(var c=Array(i),o=0;o<i;o++)c[o]=arguments[o+2];n.children=c}if(e&&e.defaultProps)for(a in i=e.defaultProps,i)n[a]===void 0&&(n[a]=i[a]);return Gu(e,s,void 0,void 0,null,n)};Ae.createRef=function(){return{current:null}};Ae.forwardRef=function(e){return{$$typeof:up,render:e}};Ae.isValidElement=Vu;Ae.lazy=function(e){return{$$typeof:Ex,_payload:{_status:-1,_result:e},_init:vp}};Ae.memo=function(e,t){return{$$typeof:dp,type:e,compare:t===void 0?null:t}};Ae.startTransition=function(e){var t=rt.T,r={};rt.T=r;try{var a=e(),n=rt.S;n!==null&&n(r,a),typeof a=="object"&&a!==null&&typeof a.then=="function"&&a.then(pp,fh)}catch(s){fh(s)}finally{rt.T=t}};Ae.unstable_useCacheRefresh=function(){return rt.H.useCacheRefresh()};Ae.use=function(e){return rt.H.use(e)};Ae.useActionState=function(e,t,r){return rt.H.useActionState(e,t,r)};Ae.useCallback=function(e,t){return rt.H.useCallback(e,t)};Ae.useContext=function(e){return rt.H.useContext(e)};Ae.useDebugValue=function(){};Ae.useDeferredValue=function(e,t){return rt.H.useDeferredValue(e,t)};Ae.useEffect=function(e,t,r){var a=rt.H;if(typeof r=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return a.useEffect(e,t)};Ae.useId=function(){return rt.H.useId()};Ae.useImperativeHandle=function(e,t,r){return rt.H.useImperativeHandle(e,t,r)};Ae.useInsertionEffect=function(e,t){return rt.H.useInsertionEffect(e,t)};Ae.useLayoutEffect=function(e,t){return rt.H.useLayoutEffect(e,t)};Ae.useMemo=function(e,t){return rt.H.useMemo(e,t)};Ae.useOptimistic=function(e,t){return rt.H.useOptimistic(e,t)};Ae.useReducer=function(e,t,r){return rt.H.useReducer(e,t,r)};Ae.useRef=function(e){return rt.H.useRef(e)};Ae.useState=function(e){return rt.H.useState(e)};Ae.useSyncExternalStore=function(e,t,r){return rt.H.useSyncExternalStore(e,t,r)};Ae.useTransition=function(){return rt.H.useTransition()};Ae.version="19.1.1";Sx.exports=Ae;var L=Sx.exports;const Vr=tp(L);var kx={exports:{}},Tc={},Mx={exports:{}},Dx={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(C,K){var O=C.length;C.push(K);e:for(;0<O;){var ne=O-1>>>1,ye=C[ne];if(0<n(ye,K))C[ne]=K,C[O]=ye,O=ne;else break e}}function r(C){return C.length===0?null:C[0]}function a(C){if(C.length===0)return null;var K=C[0],O=C.pop();if(O!==K){C[0]=O;e:for(var ne=0,ye=C.length,Te=ye>>>1;ne<Te;){var M=2*(ne+1)-1,P=C[M],F=M+1,D=C[F];if(0>n(P,O))F<ye&&0>n(D,P)?(C[ne]=D,C[F]=O,ne=F):(C[ne]=P,C[M]=O,ne=M);else if(F<ye&&0>n(D,O))C[ne]=D,C[F]=O,ne=F;else break e}}return K}function n(C,K){var O=C.sortIndex-K.sortIndex;return O!==0?O:C.id-K.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var i=Date,c=i.now();e.unstable_now=function(){return i.now()-c}}var o=[],u=[],f=1,h=null,d=3,x=!1,b=!1,m=!1,w=!1,p=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;function N(C){for(var K=r(u);K!==null;){if(K.callback===null)a(u);else if(K.startTime<=C)a(u),K.sortIndex=K.expirationTime,t(o,K);else break;K=r(u)}}function I(C){if(m=!1,N(C),!b)if(r(o)!==null)b=!0,z||(z=!0,re());else{var K=r(u);K!==null&&G(I,K.startTime-C)}}var z=!1,j=-1,B=5,R=-1;function H(){return w?!0:!(e.unstable_now()-R<B)}function q(){if(w=!1,z){var C=e.unstable_now();R=C;var K=!0;try{e:{b=!1,m&&(m=!1,v(j),j=-1),x=!0;var O=d;try{t:{for(N(C),h=r(o);h!==null&&!(h.expirationTime>C&&H());){var ne=h.callback;if(typeof ne=="function"){h.callback=null,d=h.priorityLevel;var ye=ne(h.expirationTime<=C);if(C=e.unstable_now(),typeof ye=="function"){h.callback=ye,N(C),K=!0;break t}h===r(o)&&a(o),N(C)}else a(o);h=r(o)}if(h!==null)K=!0;else{var Te=r(u);Te!==null&&G(I,Te.startTime-C),K=!1}}break e}finally{h=null,d=O,x=!1}K=void 0}}finally{K?re():z=!1}}}var re;if(typeof g=="function")re=function(){g(q)};else if(typeof MessageChannel<"u"){var se=new MessageChannel,le=se.port2;se.port1.onmessage=q,re=function(){le.postMessage(null)}}else re=function(){p(q,0)};function G(C,K){j=p(function(){C(e.unstable_now())},K)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(C){C.callback=null},e.unstable_forceFrameRate=function(C){0>C||125<C?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<C?Math.floor(1e3/C):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_next=function(C){switch(d){case 1:case 2:case 3:var K=3;break;default:K=d}var O=d;d=K;try{return C()}finally{d=O}},e.unstable_requestPaint=function(){w=!0},e.unstable_runWithPriority=function(C,K){switch(C){case 1:case 2:case 3:case 4:case 5:break;default:C=3}var O=d;d=C;try{return K()}finally{d=O}},e.unstable_scheduleCallback=function(C,K,O){var ne=e.unstable_now();switch(typeof O=="object"&&O!==null?(O=O.delay,O=typeof O=="number"&&0<O?ne+O:ne):O=ne,C){case 1:var ye=-1;break;case 2:ye=250;break;case 5:ye=1073741823;break;case 4:ye=1e4;break;default:ye=5e3}return ye=O+ye,C={id:f++,callback:K,priorityLevel:C,startTime:O,expirationTime:ye,sortIndex:-1},O>ne?(C.sortIndex=O,t(u,C),r(o)===null&&C===r(u)&&(m?(v(j),j=-1):m=!0,G(I,O-ne))):(C.sortIndex=ye,t(o,C),b||x||(b=!0,z||(z=!0,re()))),C},e.unstable_shouldYield=H,e.unstable_wrapCallback=function(C){var K=d;return function(){var O=d;d=K;try{return C.apply(this,arguments)}finally{d=O}}}})(Dx);Mx.exports=Dx;var yp=Mx.exports,Rx={exports:{}},qt={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bp=L;function Ox(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Ra(){}var Jt={d:{f:Ra,r:function(){throw Error(Ox(522))},D:Ra,C:Ra,L:Ra,m:Ra,X:Ra,S:Ra,M:Ra},p:0,findDOMNode:null},wp=Symbol.for("react.portal");function Np(e,t,r){var a=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wp,key:a==null?null:""+a,children:e,containerInfo:t,implementation:r}}var Sl=bp.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function _c(e,t){if(e==="font")return"";if(typeof t=="string")return t==="use-credentials"?t:""}qt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Jt;qt.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)throw Error(Ox(299));return Np(e,t,null,r)};qt.flushSync=function(e){var t=Sl.T,r=Jt.p;try{if(Sl.T=null,Jt.p=2,e)return e()}finally{Sl.T=t,Jt.p=r,Jt.d.f()}};qt.preconnect=function(e,t){typeof e=="string"&&(t?(t=t.crossOrigin,t=typeof t=="string"?t==="use-credentials"?t:"":void 0):t=null,Jt.d.C(e,t))};qt.prefetchDNS=function(e){typeof e=="string"&&Jt.d.D(e)};qt.preinit=function(e,t){if(typeof e=="string"&&t&&typeof t.as=="string"){var r=t.as,a=_c(r,t.crossOrigin),n=typeof t.integrity=="string"?t.integrity:void 0,s=typeof t.fetchPriority=="string"?t.fetchPriority:void 0;r==="style"?Jt.d.S(e,typeof t.precedence=="string"?t.precedence:void 0,{crossOrigin:a,integrity:n,fetchPriority:s}):r==="script"&&Jt.d.X(e,{crossOrigin:a,integrity:n,fetchPriority:s,nonce:typeof t.nonce=="string"?t.nonce:void 0})}};qt.preinitModule=function(e,t){if(typeof e=="string")if(typeof t=="object"&&t!==null){if(t.as==null||t.as==="script"){var r=_c(t.as,t.crossOrigin);Jt.d.M(e,{crossOrigin:r,integrity:typeof t.integrity=="string"?t.integrity:void 0,nonce:typeof t.nonce=="string"?t.nonce:void 0})}}else t==null&&Jt.d.M(e)};qt.preload=function(e,t){if(typeof e=="string"&&typeof t=="object"&&t!==null&&typeof t.as=="string"){var r=t.as,a=_c(r,t.crossOrigin);Jt.d.L(e,r,{crossOrigin:a,integrity:typeof t.integrity=="string"?t.integrity:void 0,nonce:typeof t.nonce=="string"?t.nonce:void 0,type:typeof t.type=="string"?t.type:void 0,fetchPriority:typeof t.fetchPriority=="string"?t.fetchPriority:void 0,referrerPolicy:typeof t.referrerPolicy=="string"?t.referrerPolicy:void 0,imageSrcSet:typeof t.imageSrcSet=="string"?t.imageSrcSet:void 0,imageSizes:typeof t.imageSizes=="string"?t.imageSizes:void 0,media:typeof t.media=="string"?t.media:void 0})}};qt.preloadModule=function(e,t){if(typeof e=="string")if(t){var r=_c(t.as,t.crossOrigin);Jt.d.m(e,{as:typeof t.as=="string"&&t.as!=="script"?t.as:void 0,crossOrigin:r,integrity:typeof t.integrity=="string"?t.integrity:void 0})}else Jt.d.m(e)};qt.requestFormReset=function(e){Jt.d.r(e)};qt.unstable_batchedUpdates=function(e,t){return e(t)};qt.useFormState=function(e,t,r){return Sl.H.useFormState(e,t,r)};qt.useFormStatus=function(){return Sl.H.useHostTransitionStatus()};qt.version="19.1.1";function Fx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Fx)}catch(e){console.error(e)}}Fx(),Rx.exports=qt;var Sp=Rx.exports;/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nt=yp,Lx=L,Ep=Sp;function ce(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Ix(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function fi(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Bx(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function dh(e){if(fi(e)!==e)throw Error(ce(188))}function Tp(e){var t=e.alternate;if(!t){if(t=fi(e),t===null)throw Error(ce(188));return t!==e?null:e}for(var r=e,a=t;;){var n=r.return;if(n===null)break;var s=n.alternate;if(s===null){if(a=n.return,a!==null){r=a;continue}break}if(n.child===s.child){for(s=n.child;s;){if(s===r)return dh(n),e;if(s===a)return dh(n),t;s=s.sibling}throw Error(ce(188))}if(r.return!==a.return)r=n,a=s;else{for(var i=!1,c=n.child;c;){if(c===r){i=!0,r=n,a=s;break}if(c===a){i=!0,a=n,r=s;break}c=c.sibling}if(!i){for(c=s.child;c;){if(c===r){i=!0,r=s,a=n;break}if(c===a){i=!0,a=s,r=n;break}c=c.sibling}if(!i)throw Error(ce(189))}}if(r.alternate!==a)throw Error(ce(190))}if(r.tag!==3)throw Error(ce(188));return r.stateNode.current===r?e:t}function Px(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=Px(e),t!==null)return t;e=e.sibling}return null}var $e=Object.assign,_p=Symbol.for("react.element"),Ki=Symbol.for("react.transitional.element"),pl=Symbol.for("react.portal"),ss=Symbol.for("react.fragment"),Ux=Symbol.for("react.strict_mode"),zo=Symbol.for("react.profiler"),jp=Symbol.for("react.provider"),zx=Symbol.for("react.consumer"),ua=Symbol.for("react.context"),Yu=Symbol.for("react.forward_ref"),Ho=Symbol.for("react.suspense"),Go=Symbol.for("react.suspense_list"),Xu=Symbol.for("react.memo"),Ia=Symbol.for("react.lazy"),Vo=Symbol.for("react.activity"),Ap=Symbol.for("react.memo_cache_sentinel"),hh=Symbol.iterator;function ol(e){return e===null||typeof e!="object"?null:(e=hh&&e[hh]||e["@@iterator"],typeof e=="function"?e:null)}var Cp=Symbol.for("react.client.reference");function Yo(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===Cp?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ss:return"Fragment";case zo:return"Profiler";case Ux:return"StrictMode";case Ho:return"Suspense";case Go:return"SuspenseList";case Vo:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case pl:return"Portal";case ua:return(e.displayName||"Context")+".Provider";case zx:return(e._context.displayName||"Context")+".Consumer";case Yu:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Xu:return t=e.displayName||null,t!==null?t:Yo(e.type)||"Memo";case Ia:t=e._payload,e=e._init;try{return Yo(e(t))}catch{}}return null}var yl=Array.isArray,Se=Lx.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ie=Ep.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Nn={pending:!1,data:null,method:null,action:null},Xo=[],ls=-1;function na(e){return{current:e}}function kt(e){0>ls||(e.current=Xo[ls],Xo[ls]=null,ls--)}function at(e,t){ls++,Xo[ls]=e.current,e.current=t}var ea=na(null),Yl=na(null),Qa=na(null),R0=na(null);function O0(e,t){switch(at(Qa,t),at(Yl,e),at(ea,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?p1(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=p1(t),e=n2(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}kt(ea),at(ea,e)}function ks(){kt(ea),kt(Yl),kt(Qa)}function Wo(e){e.memoizedState!==null&&at(R0,e);var t=ea.current,r=n2(t,e.type);t!==r&&(at(Yl,e),at(ea,r))}function F0(e){Yl.current===e&&(kt(ea),kt(Yl)),R0.current===e&&(kt(R0),ti._currentValue=Nn)}var Jo=Object.prototype.hasOwnProperty,Wu=Nt.unstable_scheduleCallback,Kc=Nt.unstable_cancelCallback,kp=Nt.unstable_shouldYield,Mp=Nt.unstable_requestPaint,ta=Nt.unstable_now,Dp=Nt.unstable_getCurrentPriorityLevel,Hx=Nt.unstable_ImmediatePriority,Gx=Nt.unstable_UserBlockingPriority,L0=Nt.unstable_NormalPriority,Rp=Nt.unstable_LowPriority,Vx=Nt.unstable_IdlePriority,Op=Nt.log,Fp=Nt.unstable_setDisableYieldValue,di=null,gr=null;function Ga(e){if(typeof Op=="function"&&Fp(e),gr&&typeof gr.setStrictMode=="function")try{gr.setStrictMode(di,e)}catch{}}var vr=Math.clz32?Math.clz32:Bp,Lp=Math.log,Ip=Math.LN2;function Bp(e){return e>>>=0,e===0?32:31-(Lp(e)/Ip|0)|0}var Zi=256,$i=4194304;function vn(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function jc(e,t,r){var a=e.pendingLanes;if(a===0)return 0;var n=0,s=e.suspendedLanes,i=e.pingedLanes;e=e.warmLanes;var c=a&134217727;return c!==0?(a=c&~s,a!==0?n=vn(a):(i&=c,i!==0?n=vn(i):r||(r=c&~e,r!==0&&(n=vn(r))))):(c=a&~s,c!==0?n=vn(c):i!==0?n=vn(i):r||(r=a&~e,r!==0&&(n=vn(r)))),n===0?0:t!==0&&t!==n&&!(t&s)&&(s=n&-n,r=t&-t,s>=r||s===32&&(r&4194048)!==0)?t:n}function hi(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function Pp(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Yx(){var e=Zi;return Zi<<=1,!(Zi&4194048)&&(Zi=256),e}function Xx(){var e=$i;return $i<<=1,!($i&62914560)&&($i=4194304),e}function Zc(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function xi(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Up(e,t,r,a,n,s){var i=e.pendingLanes;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=r,e.entangledLanes&=r,e.errorRecoveryDisabledLanes&=r,e.shellSuspendCounter=0;var c=e.entanglements,o=e.expirationTimes,u=e.hiddenUpdates;for(r=i&~r;0<r;){var f=31-vr(r),h=1<<f;c[f]=0,o[f]=-1;var d=u[f];if(d!==null)for(u[f]=null,f=0;f<d.length;f++){var x=d[f];x!==null&&(x.lane&=-536870913)}r&=~h}a!==0&&Wx(e,a,0),s!==0&&n===0&&e.tag!==0&&(e.suspendedLanes|=s&~(i&~t))}function Wx(e,t,r){e.pendingLanes|=t,e.suspendedLanes&=~t;var a=31-vr(t);e.entangledLanes|=t,e.entanglements[a]=e.entanglements[a]|1073741824|r&4194090}function Jx(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var a=31-vr(r),n=1<<a;n&t|e[a]&t&&(e[a]|=t),r&=~n}}function Ju(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Qu(e){return e&=-e,2<e?8<e?e&134217727?32:268435456:8:2}function Qx(){var e=Ie.p;return e!==0?e:(e=window.event,e===void 0?32:x2(e.type))}function zp(e,t){var r=Ie.p;try{return Ie.p=e,t()}finally{Ie.p=r}}var un=Math.random().toString(36).slice(2),zt="__reactFiber$"+un,tr="__reactProps$"+un,Gs="__reactContainer$"+un,Qo="__reactEvents$"+un,Hp="__reactListeners$"+un,Gp="__reactHandles$"+un,xh="__reactResources$"+un,mi="__reactMarker$"+un;function qu(e){delete e[zt],delete e[tr],delete e[Qo],delete e[Hp],delete e[Gp]}function is(e){var t=e[zt];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Gs]||r[zt]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=w1(e);e!==null;){if(r=e[zt])return r;e=w1(e)}return t}e=r,r=e.parentNode}return null}function Vs(e){if(e=e[zt]||e[Gs]){var t=e.tag;if(t===5||t===6||t===13||t===26||t===27||t===3)return e}return null}function bl(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(ce(33))}function ps(e){var t=e[xh];return t||(t=e[xh]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Tt(e){e[mi]=!0}var qx=new Set,Kx={};function In(e,t){Ms(e,t),Ms(e+"Capture",t)}function Ms(e,t){for(Kx[e]=t,e=0;e<t.length;e++)qx.add(t[e])}var Vp=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),mh={},gh={};function Yp(e){return Jo.call(gh,e)?!0:Jo.call(mh,e)?!1:Vp.test(e)?gh[e]=!0:(mh[e]=!0,!1)}function y0(e,t,r){if(Yp(t))if(r===null)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var a=t.toLowerCase().slice(0,5);if(a!=="data-"&&a!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+r)}}function e0(e,t,r){if(r===null)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+r)}}function la(e,t,r,a){if(a===null)e.removeAttribute(r);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(r);return}e.setAttributeNS(t,r,""+a)}}var $c,vh;function ts(e){if($c===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);$c=t&&t[1]||"",vh=-1<r.stack.indexOf(`
    at`)?" (<anonymous>)":-1<r.stack.indexOf("@")?"@unknown:0:0":""}return`
`+$c+e+vh}var eo=!1;function to(e,t){if(!e||eo)return"";eo=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var a={DetermineComponentFrameRoot:function(){try{if(t){var h=function(){throw Error()};if(Object.defineProperty(h.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(h,[])}catch(x){var d=x}Reflect.construct(e,[],h)}else{try{h.call()}catch(x){d=x}e.call(h.prototype)}}else{try{throw Error()}catch(x){d=x}(h=e())&&typeof h.catch=="function"&&h.catch(function(){})}}catch(x){if(x&&d&&typeof x.stack=="string")return[x.stack,d.stack]}return[null,null]}};a.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var n=Object.getOwnPropertyDescriptor(a.DetermineComponentFrameRoot,"name");n&&n.configurable&&Object.defineProperty(a.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var s=a.DetermineComponentFrameRoot(),i=s[0],c=s[1];if(i&&c){var o=i.split(`
`),u=c.split(`
`);for(n=a=0;a<o.length&&!o[a].includes("DetermineComponentFrameRoot");)a++;for(;n<u.length&&!u[n].includes("DetermineComponentFrameRoot");)n++;if(a===o.length||n===u.length)for(a=o.length-1,n=u.length-1;1<=a&&0<=n&&o[a]!==u[n];)n--;for(;1<=a&&0<=n;a--,n--)if(o[a]!==u[n]){if(a!==1||n!==1)do if(a--,n--,0>n||o[a]!==u[n]){var f=`
`+o[a].replace(" at new "," at ");return e.displayName&&f.includes("<anonymous>")&&(f=f.replace("<anonymous>",e.displayName)),f}while(1<=a&&0<=n);break}}}finally{eo=!1,Error.prepareStackTrace=r}return(r=e?e.displayName||e.name:"")?ts(r):""}function Xp(e){switch(e.tag){case 26:case 27:case 5:return ts(e.type);case 16:return ts("Lazy");case 13:return ts("Suspense");case 19:return ts("SuspenseList");case 0:case 15:return to(e.type,!1);case 11:return to(e.type.render,!1);case 1:return to(e.type,!0);case 31:return ts("Activity");default:return""}}function ph(e){try{var t="";do t+=Xp(e),e=e.return;while(e);return t}catch(r){return`
Error generating stack: `+r.message+`
`+r.stack}}function jr(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Zx(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Wp(e){var t=Zx(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),a=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var n=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return n.call(this)},set:function(i){a=""+i,s.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return a},setValue:function(i){a=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function I0(e){e._valueTracker||(e._valueTracker=Wp(e))}function $x(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),a="";return e&&(a=Zx(e)?e.checked?"true":"false":e.value),e=a,e!==r?(t.setValue(e),!0):!1}function B0(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var Jp=/[\n"\\]/g;function kr(e){return e.replace(Jp,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function qo(e,t,r,a,n,s,i,c){e.name="",i!=null&&typeof i!="function"&&typeof i!="symbol"&&typeof i!="boolean"?e.type=i:e.removeAttribute("type"),t!=null?i==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+jr(t)):e.value!==""+jr(t)&&(e.value=""+jr(t)):i!=="submit"&&i!=="reset"||e.removeAttribute("value"),t!=null?Ko(e,i,jr(t)):r!=null?Ko(e,i,jr(r)):a!=null&&e.removeAttribute("value"),n==null&&s!=null&&(e.defaultChecked=!!s),n!=null&&(e.checked=n&&typeof n!="function"&&typeof n!="symbol"),c!=null&&typeof c!="function"&&typeof c!="symbol"&&typeof c!="boolean"?e.name=""+jr(c):e.removeAttribute("name")}function em(e,t,r,a,n,s,i,c){if(s!=null&&typeof s!="function"&&typeof s!="symbol"&&typeof s!="boolean"&&(e.type=s),t!=null||r!=null){if(!(s!=="submit"&&s!=="reset"||t!=null))return;r=r!=null?""+jr(r):"",t=t!=null?""+jr(t):r,c||t===e.value||(e.value=t),e.defaultValue=t}a=a??n,a=typeof a!="function"&&typeof a!="symbol"&&!!a,e.checked=c?e.checked:!!a,e.defaultChecked=!!a,i!=null&&typeof i!="function"&&typeof i!="symbol"&&typeof i!="boolean"&&(e.name=i)}function Ko(e,t,r){t==="number"&&B0(e.ownerDocument)===e||e.defaultValue===""+r||(e.defaultValue=""+r)}function ys(e,t,r,a){if(e=e.options,t){t={};for(var n=0;n<r.length;n++)t["$"+r[n]]=!0;for(r=0;r<e.length;r++)n=t.hasOwnProperty("$"+e[r].value),e[r].selected!==n&&(e[r].selected=n),n&&a&&(e[r].defaultSelected=!0)}else{for(r=""+jr(r),t=null,n=0;n<e.length;n++){if(e[n].value===r){e[n].selected=!0,a&&(e[n].defaultSelected=!0);return}t!==null||e[n].disabled||(t=e[n])}t!==null&&(t.selected=!0)}}function tm(e,t,r){if(t!=null&&(t=""+jr(t),t!==e.value&&(e.value=t),r==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=r!=null?""+jr(r):""}function rm(e,t,r,a){if(t==null){if(a!=null){if(r!=null)throw Error(ce(92));if(yl(a)){if(1<a.length)throw Error(ce(93));a=a[0]}r=a}r==null&&(r=""),t=r}r=jr(t),e.defaultValue=r,a=e.textContent,a===r&&a!==""&&a!==null&&(e.value=a)}function Ds(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Qp=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function yh(e,t,r){var a=t.indexOf("--")===0;r==null||typeof r=="boolean"||r===""?a?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":a?e.setProperty(t,r):typeof r!="number"||r===0||Qp.has(t)?t==="float"?e.cssFloat=r:e[t]=(""+r).trim():e[t]=r+"px"}function am(e,t,r){if(t!=null&&typeof t!="object")throw Error(ce(62));if(e=e.style,r!=null){for(var a in r)!r.hasOwnProperty(a)||t!=null&&t.hasOwnProperty(a)||(a.indexOf("--")===0?e.setProperty(a,""):a==="float"?e.cssFloat="":e[a]="");for(var n in t)a=t[n],t.hasOwnProperty(n)&&r[n]!==a&&yh(e,n,a)}else for(var s in t)t.hasOwnProperty(s)&&yh(e,s,t[s])}function Ku(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var qp=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Kp=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function b0(e){return Kp.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var Zo=null;function Zu(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var cs=null,bs=null;function bh(e){var t=Vs(e);if(t&&(e=t.stateNode)){var r=e[tr]||null;e:switch(e=t.stateNode,t.type){case"input":if(qo(e,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll('input[name="'+kr(""+t)+'"][type="radio"]'),t=0;t<r.length;t++){var a=r[t];if(a!==e&&a.form===e.form){var n=a[tr]||null;if(!n)throw Error(ce(90));qo(a,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name)}}for(t=0;t<r.length;t++)a=r[t],a.form===e.form&&$x(a)}break e;case"textarea":tm(e,r.value,r.defaultValue);break e;case"select":t=r.value,t!=null&&ys(e,!!r.multiple,t,!1)}}}var ro=!1;function nm(e,t,r){if(ro)return e(t,r);ro=!0;try{var a=e(t);return a}finally{if(ro=!1,(cs!==null||bs!==null)&&(Ic(),cs&&(t=cs,e=bs,bs=cs=null,bh(t),e)))for(t=0;t<e.length;t++)bh(e[t])}}function Xl(e,t){var r=e.stateNode;if(r===null)return null;var a=r[tr]||null;if(a===null)return null;r=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(e=e.type,a=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!a;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(ce(231,t,typeof r));return r}var wa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),$o=!1;if(wa)try{var ul={};Object.defineProperty(ul,"passive",{get:function(){$o=!0}}),window.addEventListener("test",ul,ul),window.removeEventListener("test",ul,ul)}catch{$o=!1}var Va=null,$u=null,w0=null;function sm(){if(w0)return w0;var e,t=$u,r=t.length,a,n="value"in Va?Va.value:Va.textContent,s=n.length;for(e=0;e<r&&t[e]===n[e];e++);var i=r-e;for(a=1;a<=i&&t[r-a]===n[s-a];a++);return w0=n.slice(e,1<a?1-a:void 0)}function N0(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function t0(){return!0}function wh(){return!1}function nr(e){function t(r,a,n,s,i){this._reactName=r,this._targetInst=n,this.type=a,this.nativeEvent=s,this.target=i,this.currentTarget=null;for(var c in e)e.hasOwnProperty(c)&&(r=e[c],this[c]=r?r(s):s[c]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?t0:wh,this.isPropagationStopped=wh,this}return $e(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=t0)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=t0)},persist:function(){},isPersistent:t0}),t}var Bn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ac=nr(Bn),gi=$e({},Bn,{view:0,detail:0}),Zp=nr(gi),ao,no,fl,Cc=$e({},gi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ef,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==fl&&(fl&&e.type==="mousemove"?(ao=e.screenX-fl.screenX,no=e.screenY-fl.screenY):no=ao=0,fl=e),ao)},movementY:function(e){return"movementY"in e?e.movementY:no}}),Nh=nr(Cc),$p=$e({},Cc,{dataTransfer:0}),ey=nr($p),ty=$e({},gi,{relatedTarget:0}),so=nr(ty),ry=$e({},Bn,{animationName:0,elapsedTime:0,pseudoElement:0}),ay=nr(ry),ny=$e({},Bn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),sy=nr(ny),ly=$e({},Bn,{data:0}),Sh=nr(ly),iy={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},cy={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},oy={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function uy(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=oy[e])?!!t[e]:!1}function ef(){return uy}var fy=$e({},gi,{key:function(e){if(e.key){var t=iy[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=N0(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?cy[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ef,charCode:function(e){return e.type==="keypress"?N0(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?N0(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),dy=nr(fy),hy=$e({},Cc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Eh=nr(hy),xy=$e({},gi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ef}),my=nr(xy),gy=$e({},Bn,{propertyName:0,elapsedTime:0,pseudoElement:0}),vy=nr(gy),py=$e({},Cc,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),yy=nr(py),by=$e({},Bn,{newState:0,oldState:0}),wy=nr(by),Ny=[9,13,27,32],tf=wa&&"CompositionEvent"in window,El=null;wa&&"documentMode"in document&&(El=document.documentMode);var Sy=wa&&"TextEvent"in window&&!El,lm=wa&&(!tf||El&&8<El&&11>=El),Th=String.fromCharCode(32),_h=!1;function im(e,t){switch(e){case"keyup":return Ny.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function cm(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var os=!1;function Ey(e,t){switch(e){case"compositionend":return cm(t);case"keypress":return t.which!==32?null:(_h=!0,Th);case"textInput":return e=t.data,e===Th&&_h?null:e;default:return null}}function Ty(e,t){if(os)return e==="compositionend"||!tf&&im(e,t)?(e=sm(),w0=$u=Va=null,os=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return lm&&t.locale!=="ko"?null:t.data;default:return null}}var _y={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jh(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!_y[e.type]:t==="textarea"}function om(e,t,r,a){cs?bs?bs.push(a):bs=[a]:cs=a,t=rc(t,"onChange"),0<t.length&&(r=new Ac("onChange","change",null,r,a),e.push({event:r,listeners:t}))}var Tl=null,Wl=null;function jy(e){t2(e,0)}function kc(e){var t=bl(e);if($x(t))return e}function Ah(e,t){if(e==="change")return t}var um=!1;if(wa){var lo;if(wa){var io="oninput"in document;if(!io){var Ch=document.createElement("div");Ch.setAttribute("oninput","return;"),io=typeof Ch.oninput=="function"}lo=io}else lo=!1;um=lo&&(!document.documentMode||9<document.documentMode)}function kh(){Tl&&(Tl.detachEvent("onpropertychange",fm),Wl=Tl=null)}function fm(e){if(e.propertyName==="value"&&kc(Wl)){var t=[];om(t,Wl,e,Zu(e)),nm(jy,t)}}function Ay(e,t,r){e==="focusin"?(kh(),Tl=t,Wl=r,Tl.attachEvent("onpropertychange",fm)):e==="focusout"&&kh()}function Cy(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return kc(Wl)}function ky(e,t){if(e==="click")return kc(t)}function My(e,t){if(e==="input"||e==="change")return kc(t)}function Dy(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var br=typeof Object.is=="function"?Object.is:Dy;function Jl(e,t){if(br(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;for(a=0;a<r.length;a++){var n=r[a];if(!Jo.call(t,n)||!br(e[n],t[n]))return!1}return!0}function Mh(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Dh(e,t){var r=Mh(e);e=0;for(var a;r;){if(r.nodeType===3){if(a=e+r.textContent.length,e<=t&&a>=t)return{node:r,offset:t-e};e=a}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Mh(r)}}function dm(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?dm(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function hm(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=B0(e.document);t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=B0(e.document)}return t}function rf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var Ry=wa&&"documentMode"in document&&11>=document.documentMode,us=null,eu=null,_l=null,tu=!1;function Rh(e,t,r){var a=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;tu||us==null||us!==B0(a)||(a=us,"selectionStart"in a&&rf(a)?a={start:a.selectionStart,end:a.selectionEnd}:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection(),a={anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}),_l&&Jl(_l,a)||(_l=a,a=rc(eu,"onSelect"),0<a.length&&(t=new Ac("onSelect","select",null,t,r),e.push({event:t,listeners:a}),t.target=us)))}function gn(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var fs={animationend:gn("Animation","AnimationEnd"),animationiteration:gn("Animation","AnimationIteration"),animationstart:gn("Animation","AnimationStart"),transitionrun:gn("Transition","TransitionRun"),transitionstart:gn("Transition","TransitionStart"),transitioncancel:gn("Transition","TransitionCancel"),transitionend:gn("Transition","TransitionEnd")},co={},xm={};wa&&(xm=document.createElement("div").style,"AnimationEvent"in window||(delete fs.animationend.animation,delete fs.animationiteration.animation,delete fs.animationstart.animation),"TransitionEvent"in window||delete fs.transitionend.transition);function Pn(e){if(co[e])return co[e];if(!fs[e])return e;var t=fs[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in xm)return co[e]=t[r];return e}var mm=Pn("animationend"),gm=Pn("animationiteration"),vm=Pn("animationstart"),Oy=Pn("transitionrun"),Fy=Pn("transitionstart"),Ly=Pn("transitioncancel"),pm=Pn("transitionend"),ym=new Map,ru="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ru.push("scrollEnd");function Wr(e,t){ym.set(e,t),In(t,[e])}var Oh=new WeakMap;function Mr(e,t){if(typeof e=="object"&&e!==null){var r=Oh.get(e);return r!==void 0?r:(t={value:e,source:t,stack:ph(t)},Oh.set(e,t),t)}return{value:e,source:t,stack:ph(t)}}var Tr=[],ds=0,af=0;function Mc(){for(var e=ds,t=af=ds=0;t<e;){var r=Tr[t];Tr[t++]=null;var a=Tr[t];Tr[t++]=null;var n=Tr[t];Tr[t++]=null;var s=Tr[t];if(Tr[t++]=null,a!==null&&n!==null){var i=a.pending;i===null?n.next=n:(n.next=i.next,i.next=n),a.pending=n}s!==0&&bm(r,n,s)}}function Dc(e,t,r,a){Tr[ds++]=e,Tr[ds++]=t,Tr[ds++]=r,Tr[ds++]=a,af|=a,e.lanes|=a,e=e.alternate,e!==null&&(e.lanes|=a)}function nf(e,t,r,a){return Dc(e,t,r,a),P0(e)}function Ys(e,t){return Dc(e,null,null,t),P0(e)}function bm(e,t,r){e.lanes|=r;var a=e.alternate;a!==null&&(a.lanes|=r);for(var n=!1,s=e.return;s!==null;)s.childLanes|=r,a=s.alternate,a!==null&&(a.childLanes|=r),s.tag===22&&(e=s.stateNode,e===null||e._visibility&1||(n=!0)),e=s,s=s.return;return e.tag===3?(s=e.stateNode,n&&t!==null&&(n=31-vr(r),e=s.hiddenUpdates,a=e[n],a===null?e[n]=[t]:a.push(t),t.lane=r|536870912),s):null}function P0(e){if(50<Ll)throw Ll=0,Su=null,Error(ce(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var hs={};function Iy(e,t,r,a){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function mr(e,t,r,a){return new Iy(e,t,r,a)}function sf(e){return e=e.prototype,!(!e||!e.isReactComponent)}function ga(e,t){var r=e.alternate;return r===null?(r=mr(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&65011712,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r.refCleanup=e.refCleanup,r}function wm(e,t){e.flags&=65011714;var r=e.alternate;return r===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=r.childLanes,e.lanes=r.lanes,e.child=r.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=r.memoizedProps,e.memoizedState=r.memoizedState,e.updateQueue=r.updateQueue,e.type=r.type,t=r.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function S0(e,t,r,a,n,s){var i=0;if(a=e,typeof e=="function")sf(e)&&(i=1);else if(typeof e=="string")i=P4(e,r,ea.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case Vo:return e=mr(31,r,t,n),e.elementType=Vo,e.lanes=s,e;case ss:return Sn(r.children,n,s,t);case Ux:i=8,n|=24;break;case zo:return e=mr(12,r,t,n|2),e.elementType=zo,e.lanes=s,e;case Ho:return e=mr(13,r,t,n),e.elementType=Ho,e.lanes=s,e;case Go:return e=mr(19,r,t,n),e.elementType=Go,e.lanes=s,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case jp:case ua:i=10;break e;case zx:i=9;break e;case Yu:i=11;break e;case Xu:i=14;break e;case Ia:i=16,a=null;break e}i=29,r=Error(ce(130,e===null?"null":typeof e,"")),a=null}return t=mr(i,r,t,n),t.elementType=e,t.type=a,t.lanes=s,t}function Sn(e,t,r,a){return e=mr(7,e,a,t),e.lanes=r,e}function oo(e,t,r){return e=mr(6,e,null,t),e.lanes=r,e}function uo(e,t,r){return t=mr(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var xs=[],ms=0,U0=null,z0=0,Ar=[],Cr=0,En=null,fa=1,da="";function pn(e,t){xs[ms++]=z0,xs[ms++]=U0,U0=e,z0=t}function Nm(e,t,r){Ar[Cr++]=fa,Ar[Cr++]=da,Ar[Cr++]=En,En=e;var a=fa;e=da;var n=32-vr(a)-1;a&=~(1<<n),r+=1;var s=32-vr(t)+n;if(30<s){var i=n-n%5;s=(a&(1<<i)-1).toString(32),a>>=i,n-=i,fa=1<<32-vr(t)+n|r<<n|a,da=s+e}else fa=1<<s|r<<n|a,da=e}function lf(e){e.return!==null&&(pn(e,1),Nm(e,1,0))}function cf(e){for(;e===U0;)U0=xs[--ms],xs[ms]=null,z0=xs[--ms],xs[ms]=null;for(;e===En;)En=Ar[--Cr],Ar[Cr]=null,da=Ar[--Cr],Ar[Cr]=null,fa=Ar[--Cr],Ar[Cr]=null}var Wt=null,st=null,Le=!1,Tn=null,Zr=!1,au=Error(ce(519));function kn(e){var t=Error(ce(418,""));throw Ql(Mr(t,e)),au}function Fh(e){var t=e.stateNode,r=e.type,a=e.memoizedProps;switch(t[zt]=e,t[tr]=a,r){case"dialog":Me("cancel",t),Me("close",t);break;case"iframe":case"object":case"embed":Me("load",t);break;case"video":case"audio":for(r=0;r<Zl.length;r++)Me(Zl[r],t);break;case"source":Me("error",t);break;case"img":case"image":case"link":Me("error",t),Me("load",t);break;case"details":Me("toggle",t);break;case"input":Me("invalid",t),em(t,a.value,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name,!0),I0(t);break;case"select":Me("invalid",t);break;case"textarea":Me("invalid",t),rm(t,a.value,a.defaultValue,a.children),I0(t)}r=a.children,typeof r!="string"&&typeof r!="number"&&typeof r!="bigint"||t.textContent===""+r||a.suppressHydrationWarning===!0||a2(t.textContent,r)?(a.popover!=null&&(Me("beforetoggle",t),Me("toggle",t)),a.onScroll!=null&&Me("scroll",t),a.onScrollEnd!=null&&Me("scrollend",t),a.onClick!=null&&(t.onclick=Uc),t=!0):t=!1,t||kn(e)}function Lh(e){for(Wt=e.return;Wt;)switch(Wt.tag){case 5:case 13:Zr=!1;return;case 27:case 3:Zr=!0;return;default:Wt=Wt.return}}function dl(e){if(e!==Wt)return!1;if(!Le)return Lh(e),Le=!0,!1;var t=e.tag,r;if((r=t!==3&&t!==27)&&((r=t===5)&&(r=e.type,r=!(r!=="form"&&r!=="button")||Cu(e.type,e.memoizedProps)),r=!r),r&&st&&kn(e),Lh(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ce(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8)if(r=e.data,r==="/$"){if(t===0){st=Yr(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++;e=e.nextSibling}st=null}}else t===27?(t=st,fn(e.type)?(e=Du,Du=null,st=e):st=t):st=Wt?Yr(e.stateNode.nextSibling):null;return!0}function vi(){st=Wt=null,Le=!1}function Ih(){var e=Tn;return e!==null&&($t===null?$t=e:$t.push.apply($t,e),Tn=null),e}function Ql(e){Tn===null?Tn=[e]:Tn.push(e)}var nu=na(null),Un=null,ha=null;function Pa(e,t,r){at(nu,t._currentValue),t._currentValue=r}function va(e){e._currentValue=nu.current,kt(nu)}function su(e,t,r){for(;e!==null;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,a!==null&&(a.childLanes|=t)):a!==null&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===r)break;e=e.return}}function lu(e,t,r,a){var n=e.child;for(n!==null&&(n.return=e);n!==null;){var s=n.dependencies;if(s!==null){var i=n.child;s=s.firstContext;e:for(;s!==null;){var c=s;s=n;for(var o=0;o<t.length;o++)if(c.context===t[o]){s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),su(s.return,r,e),a||(i=null);break e}s=c.next}}else if(n.tag===18){if(i=n.return,i===null)throw Error(ce(341));i.lanes|=r,s=i.alternate,s!==null&&(s.lanes|=r),su(i,r,e),i=null}else i=n.child;if(i!==null)i.return=n;else for(i=n;i!==null;){if(i===e){i=null;break}if(n=i.sibling,n!==null){n.return=i.return,i=n;break}i=i.return}n=i}}function pi(e,t,r,a){e=null;for(var n=t,s=!1;n!==null;){if(!s){if(n.flags&524288)s=!0;else if(n.flags&262144)break}if(n.tag===10){var i=n.alternate;if(i===null)throw Error(ce(387));if(i=i.memoizedProps,i!==null){var c=n.type;br(n.pendingProps.value,i.value)||(e!==null?e.push(c):e=[c])}}else if(n===R0.current){if(i=n.alternate,i===null)throw Error(ce(387));i.memoizedState.memoizedState!==n.memoizedState.memoizedState&&(e!==null?e.push(ti):e=[ti])}n=n.return}e!==null&&lu(t,e,r,a),t.flags|=262144}function H0(e){for(e=e.firstContext;e!==null;){if(!br(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Mn(e){Un=e,ha=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Ht(e){return Sm(Un,e)}function r0(e,t){return Un===null&&Mn(e),Sm(e,t)}function Sm(e,t){var r=t._currentValue;if(t={context:t,memoizedValue:r,next:null},ha===null){if(e===null)throw Error(ce(308));ha=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else ha=ha.next=t;return r}var By=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(r,a){e.push(a)}};this.abort=function(){t.aborted=!0,e.forEach(function(r){return r()})}},Py=Nt.unstable_scheduleCallback,Uy=Nt.unstable_NormalPriority,bt={$$typeof:ua,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function of(){return{controller:new By,data:new Map,refCount:0}}function yi(e){e.refCount--,e.refCount===0&&Py(Uy,function(){e.controller.abort()})}var jl=null,iu=0,Rs=0,ws=null;function zy(e,t){if(jl===null){var r=jl=[];iu=0,Rs=Df(),ws={status:"pending",value:void 0,then:function(a){r.push(a)}}}return iu++,t.then(Bh,Bh),t}function Bh(){if(--iu===0&&jl!==null){ws!==null&&(ws.status="fulfilled");var e=jl;jl=null,Rs=0,ws=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function Hy(e,t){var r=[],a={status:"pending",value:null,reason:null,then:function(n){r.push(n)}};return e.then(function(){a.status="fulfilled",a.value=t;for(var n=0;n<r.length;n++)(0,r[n])(t)},function(n){for(a.status="rejected",a.reason=n,n=0;n<r.length;n++)(0,r[n])(void 0)}),a}var Ph=Se.S;Se.S=function(e,t){typeof t=="object"&&t!==null&&typeof t.then=="function"&&zy(e,t),Ph!==null&&Ph(e,t)};var _n=na(null);function uf(){var e=_n.current;return e!==null?e:Ke.pooledCache}function E0(e,t){t===null?at(_n,_n.current):at(_n,t.pool)}function Em(){var e=uf();return e===null?null:{parent:bt._currentValue,pool:e}}var bi=Error(ce(460)),Tm=Error(ce(474)),Rc=Error(ce(542)),cu={then:function(){}};function Uh(e){return e=e.status,e==="fulfilled"||e==="rejected"}function a0(){}function _m(e,t,r){switch(r=e[r],r===void 0?e.push(t):r!==t&&(t.then(a0,a0),t=r),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Hh(e),e;default:if(typeof t.status=="string")t.then(a0,a0);else{if(e=Ke,e!==null&&100<e.shellSuspendCounter)throw Error(ce(482));e=t,e.status="pending",e.then(function(a){if(t.status==="pending"){var n=t;n.status="fulfilled",n.value=a}},function(a){if(t.status==="pending"){var n=t;n.status="rejected",n.reason=a}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Hh(e),e}throw Al=t,bi}}var Al=null;function zh(){if(Al===null)throw Error(ce(459));var e=Al;return Al=null,e}function Hh(e){if(e===bi||e===Rc)throw Error(ce(483))}var Ba=!1;function ff(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ou(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function qa(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Ka(e,t,r){var a=e.updateQueue;if(a===null)return null;if(a=a.shared,ze&2){var n=a.pending;return n===null?t.next=t:(t.next=n.next,n.next=t),a.pending=t,t=P0(e),bm(e,null,r),t}return Dc(e,a,t,r),P0(e)}function Cl(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194048)!==0)){var a=t.lanes;a&=e.pendingLanes,r|=a,t.lanes=r,Jx(e,r)}}function fo(e,t){var r=e.updateQueue,a=e.alternate;if(a!==null&&(a=a.updateQueue,r===a)){var n=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var i={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};s===null?n=s=i:s=s.next=i,r=r.next}while(r!==null);s===null?n=s=t:s=s.next=t}else n=s=t;r={baseState:a.baseState,firstBaseUpdate:n,lastBaseUpdate:s,shared:a.shared,callbacks:a.callbacks},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}var uu=!1;function kl(){if(uu){var e=ws;if(e!==null)throw e}}function Ml(e,t,r,a){uu=!1;var n=e.updateQueue;Ba=!1;var s=n.firstBaseUpdate,i=n.lastBaseUpdate,c=n.shared.pending;if(c!==null){n.shared.pending=null;var o=c,u=o.next;o.next=null,i===null?s=u:i.next=u,i=o;var f=e.alternate;f!==null&&(f=f.updateQueue,c=f.lastBaseUpdate,c!==i&&(c===null?f.firstBaseUpdate=u:c.next=u,f.lastBaseUpdate=o))}if(s!==null){var h=n.baseState;i=0,f=u=o=null,c=s;do{var d=c.lane&-536870913,x=d!==c.lane;if(x?(Re&d)===d:(a&d)===d){d!==0&&d===Rs&&(uu=!0),f!==null&&(f=f.next={lane:0,tag:c.tag,payload:c.payload,callback:null,next:null});e:{var b=e,m=c;d=t;var w=r;switch(m.tag){case 1:if(b=m.payload,typeof b=="function"){h=b.call(w,h,d);break e}h=b;break e;case 3:b.flags=b.flags&-65537|128;case 0:if(b=m.payload,d=typeof b=="function"?b.call(w,h,d):b,d==null)break e;h=$e({},h,d);break e;case 2:Ba=!0}}d=c.callback,d!==null&&(e.flags|=64,x&&(e.flags|=8192),x=n.callbacks,x===null?n.callbacks=[d]:x.push(d))}else x={lane:d,tag:c.tag,payload:c.payload,callback:c.callback,next:null},f===null?(u=f=x,o=h):f=f.next=x,i|=d;if(c=c.next,c===null){if(c=n.shared.pending,c===null)break;x=c,c=x.next,x.next=null,n.lastBaseUpdate=x,n.shared.pending=null}}while(1);f===null&&(o=h),n.baseState=o,n.firstBaseUpdate=u,n.lastBaseUpdate=f,s===null&&(n.shared.lanes=0),sn|=i,e.lanes=i,e.memoizedState=h}}function jm(e,t){if(typeof e!="function")throw Error(ce(191,e));e.call(t)}function Am(e,t){var r=e.callbacks;if(r!==null)for(e.callbacks=null,e=0;e<r.length;e++)jm(r[e],t)}var Os=na(null),G0=na(0);function Gh(e,t){e=Ea,at(G0,e),at(Os,t),Ea=e|t.baseLanes}function fu(){at(G0,Ea),at(Os,Os.current)}function df(){Ea=G0.current,kt(Os),kt(G0)}var an=0,Ce=null,Xe=null,ht=null,V0=!1,Ns=!1,Dn=!1,Y0=0,ql=0,Ss=null,Gy=0;function ut(){throw Error(ce(321))}function hf(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!br(e[r],t[r]))return!1;return!0}function xf(e,t,r,a,n,s){return an=s,Ce=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Se.H=e===null||e.memoizedState===null?sg:lg,Dn=!1,s=r(a,n),Dn=!1,Ns&&(s=km(t,r,a,n)),Cm(e),s}function Cm(e){Se.H=X0;var t=Xe!==null&&Xe.next!==null;if(an=0,ht=Xe=Ce=null,V0=!1,ql=0,Ss=null,t)throw Error(ce(300));e===null||jt||(e=e.dependencies,e!==null&&H0(e)&&(jt=!0))}function km(e,t,r,a){Ce=e;var n=0;do{if(Ns&&(Ss=null),ql=0,Ns=!1,25<=n)throw Error(ce(301));if(n+=1,ht=Xe=null,e.updateQueue!=null){var s=e.updateQueue;s.lastEffect=null,s.events=null,s.stores=null,s.memoCache!=null&&(s.memoCache.index=0)}Se.H=qy,s=t(r,a)}while(Ns);return s}function Vy(){var e=Se.H,t=e.useState()[0];return t=typeof t.then=="function"?wi(t):t,e=e.useState()[0],(Xe!==null?Xe.memoizedState:null)!==e&&(Ce.flags|=1024),t}function mf(){var e=Y0!==0;return Y0=0,e}function gf(e,t,r){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r}function vf(e){if(V0){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}V0=!1}an=0,ht=Xe=Ce=null,Ns=!1,ql=Y0=0,Ss=null}function Kt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ht===null?Ce.memoizedState=ht=e:ht=ht.next=e,ht}function xt(){if(Xe===null){var e=Ce.alternate;e=e!==null?e.memoizedState:null}else e=Xe.next;var t=ht===null?Ce.memoizedState:ht.next;if(t!==null)ht=t,Xe=e;else{if(e===null)throw Ce.alternate===null?Error(ce(467)):Error(ce(310));Xe=e,e={memoizedState:Xe.memoizedState,baseState:Xe.baseState,baseQueue:Xe.baseQueue,queue:Xe.queue,next:null},ht===null?Ce.memoizedState=ht=e:ht=ht.next=e}return ht}function pf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function wi(e){var t=ql;return ql+=1,Ss===null&&(Ss=[]),e=_m(Ss,e,t),t=Ce,(ht===null?t.memoizedState:ht.next)===null&&(t=t.alternate,Se.H=t===null||t.memoizedState===null?sg:lg),e}function Oc(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return wi(e);if(e.$$typeof===ua)return Ht(e)}throw Error(ce(438,String(e)))}function yf(e){var t=null,r=Ce.updateQueue;if(r!==null&&(t=r.memoCache),t==null){var a=Ce.alternate;a!==null&&(a=a.updateQueue,a!==null&&(a=a.memoCache,a!=null&&(t={data:a.data.map(function(n){return n.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),r===null&&(r=pf(),Ce.updateQueue=r),r.memoCache=t,r=t.data[t.index],r===void 0)for(r=t.data[t.index]=Array(e),a=0;a<e;a++)r[a]=Ap;return t.index++,r}function Na(e,t){return typeof t=="function"?t(e):t}function T0(e){var t=xt();return bf(t,Xe,e)}function bf(e,t,r){var a=e.queue;if(a===null)throw Error(ce(311));a.lastRenderedReducer=r;var n=e.baseQueue,s=a.pending;if(s!==null){if(n!==null){var i=n.next;n.next=s.next,s.next=i}t.baseQueue=n=s,a.pending=null}if(s=e.baseState,n===null)e.memoizedState=s;else{t=n.next;var c=i=null,o=null,u=t,f=!1;do{var h=u.lane&-536870913;if(h!==u.lane?(Re&h)===h:(an&h)===h){var d=u.revertLane;if(d===0)o!==null&&(o=o.next={lane:0,revertLane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),h===Rs&&(f=!0);else if((an&d)===d){u=u.next,d===Rs&&(f=!0);continue}else h={lane:0,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},o===null?(c=o=h,i=s):o=o.next=h,Ce.lanes|=d,sn|=d;h=u.action,Dn&&r(s,h),s=u.hasEagerState?u.eagerState:r(s,h)}else d={lane:h,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},o===null?(c=o=d,i=s):o=o.next=d,Ce.lanes|=h,sn|=h;u=u.next}while(u!==null&&u!==t);if(o===null?i=s:o.next=c,!br(s,e.memoizedState)&&(jt=!0,f&&(r=ws,r!==null)))throw r;e.memoizedState=s,e.baseState=i,e.baseQueue=o,a.lastRenderedState=s}return n===null&&(a.lanes=0),[e.memoizedState,a.dispatch]}function ho(e){var t=xt(),r=t.queue;if(r===null)throw Error(ce(311));r.lastRenderedReducer=e;var a=r.dispatch,n=r.pending,s=t.memoizedState;if(n!==null){r.pending=null;var i=n=n.next;do s=e(s,i.action),i=i.next;while(i!==n);br(s,t.memoizedState)||(jt=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,a]}function Mm(e,t,r){var a=Ce,n=xt(),s=Le;if(s){if(r===void 0)throw Error(ce(407));r=r()}else r=t();var i=!br((Xe||n).memoizedState,r);i&&(n.memoizedState=r,jt=!0),n=n.queue;var c=Om.bind(null,a,n,e);if(Ni(2048,8,c,[e]),n.getSnapshot!==t||i||ht!==null&&ht.memoizedState.tag&1){if(a.flags|=2048,Fs(9,Fc(),Rm.bind(null,a,n,r,t),null),Ke===null)throw Error(ce(349));s||an&124||Dm(a,t,r)}return r}function Dm(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Ce.updateQueue,t===null?(t=pf(),Ce.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Rm(e,t,r,a){t.value=r,t.getSnapshot=a,Fm(t)&&Lm(e)}function Om(e,t,r){return r(function(){Fm(t)&&Lm(e)})}function Fm(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!br(e,r)}catch{return!0}}function Lm(e){var t=Ys(e,2);t!==null&&yr(t,e,2)}function du(e){var t=Kt();if(typeof e=="function"){var r=e;if(e=r(),Dn){Ga(!0);try{r()}finally{Ga(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Na,lastRenderedState:e},t}function Im(e,t,r,a){return e.baseState=r,bf(e,Xe,typeof a=="function"?a:Na)}function Yy(e,t,r,a,n){if(Lc(e))throw Error(ce(485));if(e=t.action,e!==null){var s={payload:n,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(i){s.listeners.push(i)}};Se.T!==null?r(!0):s.isTransition=!1,a(s),r=t.pending,r===null?(s.next=t.pending=s,Bm(t,s)):(s.next=r.next,t.pending=r.next=s)}}function Bm(e,t){var r=t.action,a=t.payload,n=e.state;if(t.isTransition){var s=Se.T,i={};Se.T=i;try{var c=r(n,a),o=Se.S;o!==null&&o(i,c),Vh(e,t,c)}catch(u){hu(e,t,u)}finally{Se.T=s}}else try{s=r(n,a),Vh(e,t,s)}catch(u){hu(e,t,u)}}function Vh(e,t,r){r!==null&&typeof r=="object"&&typeof r.then=="function"?r.then(function(a){Yh(e,t,a)},function(a){return hu(e,t,a)}):Yh(e,t,r)}function Yh(e,t,r){t.status="fulfilled",t.value=r,Pm(t),e.state=r,t=e.pending,t!==null&&(r=t.next,r===t?e.pending=null:(r=r.next,t.next=r,Bm(e,r)))}function hu(e,t,r){var a=e.pending;if(e.pending=null,a!==null){a=a.next;do t.status="rejected",t.reason=r,Pm(t),t=t.next;while(t!==a)}e.action=null}function Pm(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Um(e,t){return t}function Xh(e,t){if(Le){var r=Ke.formState;if(r!==null){e:{var a=Ce;if(Le){if(st){t:{for(var n=st,s=Zr;n.nodeType!==8;){if(!s){n=null;break t}if(n=Yr(n.nextSibling),n===null){n=null;break t}}s=n.data,n=s==="F!"||s==="F"?n:null}if(n){st=Yr(n.nextSibling),a=n.data==="F!";break e}}kn(a)}a=!1}a&&(t=r[0])}}return r=Kt(),r.memoizedState=r.baseState=t,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Um,lastRenderedState:t},r.queue=a,r=rg.bind(null,Ce,a),a.dispatch=r,a=du(!1),s=Ef.bind(null,Ce,!1,a.queue),a=Kt(),n={state:t,dispatch:null,action:e,pending:null},a.queue=n,r=Yy.bind(null,Ce,n,s,r),n.dispatch=r,a.memoizedState=e,[t,r,!1]}function Wh(e){var t=xt();return zm(t,Xe,e)}function zm(e,t,r){if(t=bf(e,t,Um)[0],e=T0(Na)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var a=wi(t)}catch(i){throw i===bi?Rc:i}else a=t;t=xt();var n=t.queue,s=n.dispatch;return r!==t.memoizedState&&(Ce.flags|=2048,Fs(9,Fc(),Xy.bind(null,n,r),null)),[a,s,e]}function Xy(e,t){e.action=t}function Jh(e){var t=xt(),r=Xe;if(r!==null)return zm(t,r,e);xt(),t=t.memoizedState,r=xt();var a=r.queue.dispatch;return r.memoizedState=e,[t,a,!1]}function Fs(e,t,r,a){return e={tag:e,create:r,deps:a,inst:t,next:null},t=Ce.updateQueue,t===null&&(t=pf(),Ce.updateQueue=t),r=t.lastEffect,r===null?t.lastEffect=e.next=e:(a=r.next,r.next=e,e.next=a,t.lastEffect=e),e}function Fc(){return{destroy:void 0,resource:void 0}}function Hm(){return xt().memoizedState}function _0(e,t,r,a){var n=Kt();a=a===void 0?null:a,Ce.flags|=e,n.memoizedState=Fs(1|t,Fc(),r,a)}function Ni(e,t,r,a){var n=xt();a=a===void 0?null:a;var s=n.memoizedState.inst;Xe!==null&&a!==null&&hf(a,Xe.memoizedState.deps)?n.memoizedState=Fs(t,s,r,a):(Ce.flags|=e,n.memoizedState=Fs(1|t,s,r,a))}function Qh(e,t){_0(8390656,8,e,t)}function Gm(e,t){Ni(2048,8,e,t)}function Vm(e,t){return Ni(4,2,e,t)}function Ym(e,t){return Ni(4,4,e,t)}function Xm(e,t){if(typeof t=="function"){e=e();var r=t(e);return function(){typeof r=="function"?r():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Wm(e,t,r){r=r!=null?r.concat([e]):null,Ni(4,4,Xm.bind(null,t,e),r)}function wf(){}function Jm(e,t){var r=xt();t=t===void 0?null:t;var a=r.memoizedState;return t!==null&&hf(t,a[1])?a[0]:(r.memoizedState=[e,t],e)}function Qm(e,t){var r=xt();t=t===void 0?null:t;var a=r.memoizedState;if(t!==null&&hf(t,a[1]))return a[0];if(a=e(),Dn){Ga(!0);try{e()}finally{Ga(!1)}}return r.memoizedState=[a,t],a}function Nf(e,t,r){return r===void 0||an&1073741824?e.memoizedState=t:(e.memoizedState=r,e=Pg(),Ce.lanes|=e,sn|=e,r)}function qm(e,t,r,a){return br(r,t)?r:Os.current!==null?(e=Nf(e,r,a),br(e,t)||(jt=!0),e):an&42?(e=Pg(),Ce.lanes|=e,sn|=e,t):(jt=!0,e.memoizedState=r)}function Km(e,t,r,a,n){var s=Ie.p;Ie.p=s!==0&&8>s?s:8;var i=Se.T,c={};Se.T=c,Ef(e,!1,t,r);try{var o=n(),u=Se.S;if(u!==null&&u(c,o),o!==null&&typeof o=="object"&&typeof o.then=="function"){var f=Hy(o,a);Dl(e,t,f,pr(e))}else Dl(e,t,a,pr(e))}catch(h){Dl(e,t,{then:function(){},status:"rejected",reason:h},pr())}finally{Ie.p=s,Se.T=i}}function Wy(){}function xu(e,t,r,a){if(e.tag!==5)throw Error(ce(476));var n=Zm(e).queue;Km(e,n,t,Nn,r===null?Wy:function(){return $m(e),r(a)})}function Zm(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:Nn,baseState:Nn,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Na,lastRenderedState:Nn},next:null};var r={};return t.next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Na,lastRenderedState:r},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function $m(e){var t=Zm(e).next.queue;Dl(e,t,{},pr())}function Sf(){return Ht(ti)}function eg(){return xt().memoizedState}function tg(){return xt().memoizedState}function Jy(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var r=pr();e=qa(r);var a=Ka(t,e,r);a!==null&&(yr(a,t,r),Cl(a,t,r)),t={cache:of()},e.payload=t;return}t=t.return}}function Qy(e,t,r){var a=pr();r={lane:a,revertLane:0,action:r,hasEagerState:!1,eagerState:null,next:null},Lc(e)?ag(t,r):(r=nf(e,t,r,a),r!==null&&(yr(r,e,a),ng(r,t,a)))}function rg(e,t,r){var a=pr();Dl(e,t,r,a)}function Dl(e,t,r,a){var n={lane:a,revertLane:0,action:r,hasEagerState:!1,eagerState:null,next:null};if(Lc(e))ag(t,n);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var i=t.lastRenderedState,c=s(i,r);if(n.hasEagerState=!0,n.eagerState=c,br(c,i))return Dc(e,t,n,0),Ke===null&&Mc(),!1}catch{}finally{}if(r=nf(e,t,n,a),r!==null)return yr(r,e,a),ng(r,t,a),!0}return!1}function Ef(e,t,r,a){if(a={lane:2,revertLane:Df(),action:a,hasEagerState:!1,eagerState:null,next:null},Lc(e)){if(t)throw Error(ce(479))}else t=nf(e,r,a,2),t!==null&&yr(t,e,2)}function Lc(e){var t=e.alternate;return e===Ce||t!==null&&t===Ce}function ag(e,t){Ns=V0=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function ng(e,t,r){if(r&4194048){var a=t.lanes;a&=e.pendingLanes,r|=a,t.lanes=r,Jx(e,r)}}var X0={readContext:Ht,use:Oc,useCallback:ut,useContext:ut,useEffect:ut,useImperativeHandle:ut,useLayoutEffect:ut,useInsertionEffect:ut,useMemo:ut,useReducer:ut,useRef:ut,useState:ut,useDebugValue:ut,useDeferredValue:ut,useTransition:ut,useSyncExternalStore:ut,useId:ut,useHostTransitionStatus:ut,useFormState:ut,useActionState:ut,useOptimistic:ut,useMemoCache:ut,useCacheRefresh:ut},sg={readContext:Ht,use:Oc,useCallback:function(e,t){return Kt().memoizedState=[e,t===void 0?null:t],e},useContext:Ht,useEffect:Qh,useImperativeHandle:function(e,t,r){r=r!=null?r.concat([e]):null,_0(4194308,4,Xm.bind(null,t,e),r)},useLayoutEffect:function(e,t){return _0(4194308,4,e,t)},useInsertionEffect:function(e,t){_0(4,2,e,t)},useMemo:function(e,t){var r=Kt();t=t===void 0?null:t;var a=e();if(Dn){Ga(!0);try{e()}finally{Ga(!1)}}return r.memoizedState=[a,t],a},useReducer:function(e,t,r){var a=Kt();if(r!==void 0){var n=r(t);if(Dn){Ga(!0);try{r(t)}finally{Ga(!1)}}}else n=t;return a.memoizedState=a.baseState=n,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:n},a.queue=e,e=e.dispatch=Qy.bind(null,Ce,e),[a.memoizedState,e]},useRef:function(e){var t=Kt();return e={current:e},t.memoizedState=e},useState:function(e){e=du(e);var t=e.queue,r=rg.bind(null,Ce,t);return t.dispatch=r,[e.memoizedState,r]},useDebugValue:wf,useDeferredValue:function(e,t){var r=Kt();return Nf(r,e,t)},useTransition:function(){var e=du(!1);return e=Km.bind(null,Ce,e.queue,!0,!1),Kt().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,r){var a=Ce,n=Kt();if(Le){if(r===void 0)throw Error(ce(407));r=r()}else{if(r=t(),Ke===null)throw Error(ce(349));Re&124||Dm(a,t,r)}n.memoizedState=r;var s={value:r,getSnapshot:t};return n.queue=s,Qh(Om.bind(null,a,s,e),[e]),a.flags|=2048,Fs(9,Fc(),Rm.bind(null,a,s,r,t),null),r},useId:function(){var e=Kt(),t=Ke.identifierPrefix;if(Le){var r=da,a=fa;r=(a&~(1<<32-vr(a)-1)).toString(32)+r,t="«"+t+"R"+r,r=Y0++,0<r&&(t+="H"+r.toString(32)),t+="»"}else r=Gy++,t="«"+t+"r"+r.toString(32)+"»";return e.memoizedState=t},useHostTransitionStatus:Sf,useFormState:Xh,useActionState:Xh,useOptimistic:function(e){var t=Kt();t.memoizedState=t.baseState=e;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=r,t=Ef.bind(null,Ce,!0,r),r.dispatch=t,[e,t]},useMemoCache:yf,useCacheRefresh:function(){return Kt().memoizedState=Jy.bind(null,Ce)}},lg={readContext:Ht,use:Oc,useCallback:Jm,useContext:Ht,useEffect:Gm,useImperativeHandle:Wm,useInsertionEffect:Vm,useLayoutEffect:Ym,useMemo:Qm,useReducer:T0,useRef:Hm,useState:function(){return T0(Na)},useDebugValue:wf,useDeferredValue:function(e,t){var r=xt();return qm(r,Xe.memoizedState,e,t)},useTransition:function(){var e=T0(Na)[0],t=xt().memoizedState;return[typeof e=="boolean"?e:wi(e),t]},useSyncExternalStore:Mm,useId:eg,useHostTransitionStatus:Sf,useFormState:Wh,useActionState:Wh,useOptimistic:function(e,t){var r=xt();return Im(r,Xe,e,t)},useMemoCache:yf,useCacheRefresh:tg},qy={readContext:Ht,use:Oc,useCallback:Jm,useContext:Ht,useEffect:Gm,useImperativeHandle:Wm,useInsertionEffect:Vm,useLayoutEffect:Ym,useMemo:Qm,useReducer:ho,useRef:Hm,useState:function(){return ho(Na)},useDebugValue:wf,useDeferredValue:function(e,t){var r=xt();return Xe===null?Nf(r,e,t):qm(r,Xe.memoizedState,e,t)},useTransition:function(){var e=ho(Na)[0],t=xt().memoizedState;return[typeof e=="boolean"?e:wi(e),t]},useSyncExternalStore:Mm,useId:eg,useHostTransitionStatus:Sf,useFormState:Jh,useActionState:Jh,useOptimistic:function(e,t){var r=xt();return Xe!==null?Im(r,Xe,e,t):(r.baseState=e,[e,r.queue.dispatch])},useMemoCache:yf,useCacheRefresh:tg},Es=null,Kl=0;function n0(e){var t=Kl;return Kl+=1,Es===null&&(Es=[]),_m(Es,e,t)}function hl(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function s0(e,t){throw t.$$typeof===_p?Error(ce(525)):(e=Object.prototype.toString.call(t),Error(ce(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function qh(e){var t=e._init;return t(e._payload)}function ig(e){function t(p,v){if(e){var g=p.deletions;g===null?(p.deletions=[v],p.flags|=16):g.push(v)}}function r(p,v){if(!e)return null;for(;v!==null;)t(p,v),v=v.sibling;return null}function a(p){for(var v=new Map;p!==null;)p.key!==null?v.set(p.key,p):v.set(p.index,p),p=p.sibling;return v}function n(p,v){return p=ga(p,v),p.index=0,p.sibling=null,p}function s(p,v,g){return p.index=g,e?(g=p.alternate,g!==null?(g=g.index,g<v?(p.flags|=67108866,v):g):(p.flags|=67108866,v)):(p.flags|=1048576,v)}function i(p){return e&&p.alternate===null&&(p.flags|=67108866),p}function c(p,v,g,N){return v===null||v.tag!==6?(v=oo(g,p.mode,N),v.return=p,v):(v=n(v,g),v.return=p,v)}function o(p,v,g,N){var I=g.type;return I===ss?f(p,v,g.props.children,N,g.key):v!==null&&(v.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===Ia&&qh(I)===v.type)?(v=n(v,g.props),hl(v,g),v.return=p,v):(v=S0(g.type,g.key,g.props,null,p.mode,N),hl(v,g),v.return=p,v)}function u(p,v,g,N){return v===null||v.tag!==4||v.stateNode.containerInfo!==g.containerInfo||v.stateNode.implementation!==g.implementation?(v=uo(g,p.mode,N),v.return=p,v):(v=n(v,g.children||[]),v.return=p,v)}function f(p,v,g,N,I){return v===null||v.tag!==7?(v=Sn(g,p.mode,N,I),v.return=p,v):(v=n(v,g),v.return=p,v)}function h(p,v,g){if(typeof v=="string"&&v!==""||typeof v=="number"||typeof v=="bigint")return v=oo(""+v,p.mode,g),v.return=p,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Ki:return g=S0(v.type,v.key,v.props,null,p.mode,g),hl(g,v),g.return=p,g;case pl:return v=uo(v,p.mode,g),v.return=p,v;case Ia:var N=v._init;return v=N(v._payload),h(p,v,g)}if(yl(v)||ol(v))return v=Sn(v,p.mode,g,null),v.return=p,v;if(typeof v.then=="function")return h(p,n0(v),g);if(v.$$typeof===ua)return h(p,r0(p,v),g);s0(p,v)}return null}function d(p,v,g,N){var I=v!==null?v.key:null;if(typeof g=="string"&&g!==""||typeof g=="number"||typeof g=="bigint")return I!==null?null:c(p,v,""+g,N);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Ki:return g.key===I?o(p,v,g,N):null;case pl:return g.key===I?u(p,v,g,N):null;case Ia:return I=g._init,g=I(g._payload),d(p,v,g,N)}if(yl(g)||ol(g))return I!==null?null:f(p,v,g,N,null);if(typeof g.then=="function")return d(p,v,n0(g),N);if(g.$$typeof===ua)return d(p,v,r0(p,g),N);s0(p,g)}return null}function x(p,v,g,N,I){if(typeof N=="string"&&N!==""||typeof N=="number"||typeof N=="bigint")return p=p.get(g)||null,c(v,p,""+N,I);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case Ki:return p=p.get(N.key===null?g:N.key)||null,o(v,p,N,I);case pl:return p=p.get(N.key===null?g:N.key)||null,u(v,p,N,I);case Ia:var z=N._init;return N=z(N._payload),x(p,v,g,N,I)}if(yl(N)||ol(N))return p=p.get(g)||null,f(v,p,N,I,null);if(typeof N.then=="function")return x(p,v,g,n0(N),I);if(N.$$typeof===ua)return x(p,v,g,r0(v,N),I);s0(v,N)}return null}function b(p,v,g,N){for(var I=null,z=null,j=v,B=v=0,R=null;j!==null&&B<g.length;B++){j.index>B?(R=j,j=null):R=j.sibling;var H=d(p,j,g[B],N);if(H===null){j===null&&(j=R);break}e&&j&&H.alternate===null&&t(p,j),v=s(H,v,B),z===null?I=H:z.sibling=H,z=H,j=R}if(B===g.length)return r(p,j),Le&&pn(p,B),I;if(j===null){for(;B<g.length;B++)j=h(p,g[B],N),j!==null&&(v=s(j,v,B),z===null?I=j:z.sibling=j,z=j);return Le&&pn(p,B),I}for(j=a(j);B<g.length;B++)R=x(j,p,B,g[B],N),R!==null&&(e&&R.alternate!==null&&j.delete(R.key===null?B:R.key),v=s(R,v,B),z===null?I=R:z.sibling=R,z=R);return e&&j.forEach(function(q){return t(p,q)}),Le&&pn(p,B),I}function m(p,v,g,N){if(g==null)throw Error(ce(151));for(var I=null,z=null,j=v,B=v=0,R=null,H=g.next();j!==null&&!H.done;B++,H=g.next()){j.index>B?(R=j,j=null):R=j.sibling;var q=d(p,j,H.value,N);if(q===null){j===null&&(j=R);break}e&&j&&q.alternate===null&&t(p,j),v=s(q,v,B),z===null?I=q:z.sibling=q,z=q,j=R}if(H.done)return r(p,j),Le&&pn(p,B),I;if(j===null){for(;!H.done;B++,H=g.next())H=h(p,H.value,N),H!==null&&(v=s(H,v,B),z===null?I=H:z.sibling=H,z=H);return Le&&pn(p,B),I}for(j=a(j);!H.done;B++,H=g.next())H=x(j,p,B,H.value,N),H!==null&&(e&&H.alternate!==null&&j.delete(H.key===null?B:H.key),v=s(H,v,B),z===null?I=H:z.sibling=H,z=H);return e&&j.forEach(function(re){return t(p,re)}),Le&&pn(p,B),I}function w(p,v,g,N){if(typeof g=="object"&&g!==null&&g.type===ss&&g.key===null&&(g=g.props.children),typeof g=="object"&&g!==null){switch(g.$$typeof){case Ki:e:{for(var I=g.key;v!==null;){if(v.key===I){if(I=g.type,I===ss){if(v.tag===7){r(p,v.sibling),N=n(v,g.props.children),N.return=p,p=N;break e}}else if(v.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===Ia&&qh(I)===v.type){r(p,v.sibling),N=n(v,g.props),hl(N,g),N.return=p,p=N;break e}r(p,v);break}else t(p,v);v=v.sibling}g.type===ss?(N=Sn(g.props.children,p.mode,N,g.key),N.return=p,p=N):(N=S0(g.type,g.key,g.props,null,p.mode,N),hl(N,g),N.return=p,p=N)}return i(p);case pl:e:{for(I=g.key;v!==null;){if(v.key===I)if(v.tag===4&&v.stateNode.containerInfo===g.containerInfo&&v.stateNode.implementation===g.implementation){r(p,v.sibling),N=n(v,g.children||[]),N.return=p,p=N;break e}else{r(p,v);break}else t(p,v);v=v.sibling}N=uo(g,p.mode,N),N.return=p,p=N}return i(p);case Ia:return I=g._init,g=I(g._payload),w(p,v,g,N)}if(yl(g))return b(p,v,g,N);if(ol(g)){if(I=ol(g),typeof I!="function")throw Error(ce(150));return g=I.call(g),m(p,v,g,N)}if(typeof g.then=="function")return w(p,v,n0(g),N);if(g.$$typeof===ua)return w(p,v,r0(p,g),N);s0(p,g)}return typeof g=="string"&&g!==""||typeof g=="number"||typeof g=="bigint"?(g=""+g,v!==null&&v.tag===6?(r(p,v.sibling),N=n(v,g),N.return=p,p=N):(r(p,v),N=oo(g,p.mode,N),N.return=p,p=N),i(p)):r(p,v)}return function(p,v,g,N){try{Kl=0;var I=w(p,v,g,N);return Es=null,I}catch(j){if(j===bi||j===Rc)throw j;var z=mr(29,j,null,p.mode);return z.lanes=N,z.return=p,z}finally{}}}var Ls=ig(!0),cg=ig(!1),Rr=na(null),ra=null;function Ua(e){var t=e.alternate;at(wt,wt.current&1),at(Rr,e),ra===null&&(t===null||Os.current!==null||t.memoizedState!==null)&&(ra=e)}function og(e){if(e.tag===22){if(at(wt,wt.current),at(Rr,e),ra===null){var t=e.alternate;t!==null&&t.memoizedState!==null&&(ra=e)}}else za()}function za(){at(wt,wt.current),at(Rr,Rr.current)}function xa(e){kt(Rr),ra===e&&(ra=null),kt(wt)}var wt=na(0);function W0(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||Mu(r)))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function xo(e,t,r,a){t=e.memoizedState,r=r(a,t),r=r==null?t:$e({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var mu={enqueueSetState:function(e,t,r){e=e._reactInternals;var a=pr(),n=qa(a);n.payload=t,r!=null&&(n.callback=r),t=Ka(e,n,a),t!==null&&(yr(t,e,a),Cl(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var a=pr(),n=qa(a);n.tag=1,n.payload=t,r!=null&&(n.callback=r),t=Ka(e,n,a),t!==null&&(yr(t,e,a),Cl(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=pr(),a=qa(r);a.tag=2,t!=null&&(a.callback=t),t=Ka(e,a,r),t!==null&&(yr(t,e,r),Cl(t,e,r))}};function Kh(e,t,r,a,n,s,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(a,s,i):t.prototype&&t.prototype.isPureReactComponent?!Jl(r,a)||!Jl(n,s):!0}function Zh(e,t,r,a){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,a),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,a),t.state!==e&&mu.enqueueReplaceState(t,t.state,null)}function Rn(e,t){var r=t;if("ref"in t){r={};for(var a in t)a!=="ref"&&(r[a]=t[a])}if(e=e.defaultProps){r===t&&(r=$e({},r));for(var n in e)r[n]===void 0&&(r[n]=e[n])}return r}var J0=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function ug(e){J0(e)}function fg(e){console.error(e)}function dg(e){J0(e)}function Q0(e,t){try{var r=e.onUncaughtError;r(t.value,{componentStack:t.stack})}catch(a){setTimeout(function(){throw a})}}function $h(e,t,r){try{var a=e.onCaughtError;a(r.value,{componentStack:r.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(n){setTimeout(function(){throw n})}}function gu(e,t,r){return r=qa(r),r.tag=3,r.payload={element:null},r.callback=function(){Q0(e,t)},r}function hg(e){return e=qa(e),e.tag=3,e}function xg(e,t,r,a){var n=r.type.getDerivedStateFromError;if(typeof n=="function"){var s=a.value;e.payload=function(){return n(s)},e.callback=function(){$h(t,r,a)}}var i=r.stateNode;i!==null&&typeof i.componentDidCatch=="function"&&(e.callback=function(){$h(t,r,a),typeof n!="function"&&(Za===null?Za=new Set([this]):Za.add(this));var c=a.stack;this.componentDidCatch(a.value,{componentStack:c!==null?c:""})})}function Ky(e,t,r,a,n){if(r.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){if(t=r.alternate,t!==null&&pi(t,r,n,!0),r=Rr.current,r!==null){switch(r.tag){case 13:return ra===null?Eu():r.alternate===null&&it===0&&(it=3),r.flags&=-257,r.flags|=65536,r.lanes=n,a===cu?r.flags|=16384:(t=r.updateQueue,t===null?r.updateQueue=new Set([a]):t.add(a),To(e,a,n)),!1;case 22:return r.flags|=65536,a===cu?r.flags|=16384:(t=r.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([a])},r.updateQueue=t):(r=t.retryQueue,r===null?t.retryQueue=new Set([a]):r.add(a)),To(e,a,n)),!1}throw Error(ce(435,r.tag))}return To(e,a,n),Eu(),!1}if(Le)return t=Rr.current,t!==null?(!(t.flags&65536)&&(t.flags|=256),t.flags|=65536,t.lanes=n,a!==au&&(e=Error(ce(422),{cause:a}),Ql(Mr(e,r)))):(a!==au&&(t=Error(ce(423),{cause:a}),Ql(Mr(t,r))),e=e.current.alternate,e.flags|=65536,n&=-n,e.lanes|=n,a=Mr(a,r),n=gu(e.stateNode,a,n),fo(e,n),it!==4&&(it=2)),!1;var s=Error(ce(520),{cause:a});if(s=Mr(s,r),Fl===null?Fl=[s]:Fl.push(s),it!==4&&(it=2),t===null)return!0;a=Mr(a,r),r=t;do{switch(r.tag){case 3:return r.flags|=65536,e=n&-n,r.lanes|=e,e=gu(r.stateNode,a,e),fo(r,e),!1;case 1:if(t=r.type,s=r.stateNode,(r.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||s!==null&&typeof s.componentDidCatch=="function"&&(Za===null||!Za.has(s))))return r.flags|=65536,n&=-n,r.lanes|=n,n=hg(n),xg(n,e,r,a),fo(r,n),!1}r=r.return}while(r!==null);return!1}var mg=Error(ce(461)),jt=!1;function Dt(e,t,r,a){t.child=e===null?cg(t,null,r,a):Ls(t,e.child,r,a)}function e1(e,t,r,a,n){r=r.render;var s=t.ref;if("ref"in a){var i={};for(var c in a)c!=="ref"&&(i[c]=a[c])}else i=a;return Mn(t),a=xf(e,t,r,i,s,n),c=mf(),e!==null&&!jt?(gf(e,t,n),Sa(e,t,n)):(Le&&c&&lf(t),t.flags|=1,Dt(e,t,a,n),t.child)}function t1(e,t,r,a,n){if(e===null){var s=r.type;return typeof s=="function"&&!sf(s)&&s.defaultProps===void 0&&r.compare===null?(t.tag=15,t.type=s,gg(e,t,s,a,n)):(e=S0(r.type,null,a,t,t.mode,n),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!Tf(e,n)){var i=s.memoizedProps;if(r=r.compare,r=r!==null?r:Jl,r(i,a)&&e.ref===t.ref)return Sa(e,t,n)}return t.flags|=1,e=ga(s,a),e.ref=t.ref,e.return=t,t.child=e}function gg(e,t,r,a,n){if(e!==null){var s=e.memoizedProps;if(Jl(s,a)&&e.ref===t.ref)if(jt=!1,t.pendingProps=a=s,Tf(e,n))e.flags&131072&&(jt=!0);else return t.lanes=e.lanes,Sa(e,t,n)}return vu(e,t,r,a,n)}function vg(e,t,r){var a=t.pendingProps,n=a.children,s=e!==null?e.memoizedState:null;if(a.mode==="hidden"){if(t.flags&128){if(a=s!==null?s.baseLanes|r:r,e!==null){for(n=t.child=e.child,s=0;n!==null;)s=s|n.lanes|n.childLanes,n=n.sibling;t.childLanes=s&~a}else t.childLanes=0,t.child=null;return r1(e,t,a,r)}if(r&536870912)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&E0(t,s!==null?s.cachePool:null),s!==null?Gh(t,s):fu(),og(t);else return t.lanes=t.childLanes=536870912,r1(e,t,s!==null?s.baseLanes|r:r,r)}else s!==null?(E0(t,s.cachePool),Gh(t,s),za(),t.memoizedState=null):(e!==null&&E0(t,null),fu(),za());return Dt(e,t,n,r),t.child}function r1(e,t,r,a){var n=uf();return n=n===null?null:{parent:bt._currentValue,pool:n},t.memoizedState={baseLanes:r,cachePool:n},e!==null&&E0(t,null),fu(),og(t),e!==null&&pi(e,t,a,!0),null}function j0(e,t){var r=t.ref;if(r===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof r!="function"&&typeof r!="object")throw Error(ce(284));(e===null||e.ref!==r)&&(t.flags|=4194816)}}function vu(e,t,r,a,n){return Mn(t),r=xf(e,t,r,a,void 0,n),a=mf(),e!==null&&!jt?(gf(e,t,n),Sa(e,t,n)):(Le&&a&&lf(t),t.flags|=1,Dt(e,t,r,n),t.child)}function a1(e,t,r,a,n,s){return Mn(t),t.updateQueue=null,r=km(t,a,r,n),Cm(e),a=mf(),e!==null&&!jt?(gf(e,t,s),Sa(e,t,s)):(Le&&a&&lf(t),t.flags|=1,Dt(e,t,r,s),t.child)}function n1(e,t,r,a,n){if(Mn(t),t.stateNode===null){var s=hs,i=r.contextType;typeof i=="object"&&i!==null&&(s=Ht(i)),s=new r(a,s),t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=mu,t.stateNode=s,s._reactInternals=t,s=t.stateNode,s.props=a,s.state=t.memoizedState,s.refs={},ff(t),i=r.contextType,s.context=typeof i=="object"&&i!==null?Ht(i):hs,s.state=t.memoizedState,i=r.getDerivedStateFromProps,typeof i=="function"&&(xo(t,r,i,a),s.state=t.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(i=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),i!==s.state&&mu.enqueueReplaceState(s,s.state,null),Ml(t,a,s,n),kl(),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308),a=!0}else if(e===null){s=t.stateNode;var c=t.memoizedProps,o=Rn(r,c);s.props=o;var u=s.context,f=r.contextType;i=hs,typeof f=="object"&&f!==null&&(i=Ht(f));var h=r.getDerivedStateFromProps;f=typeof h=="function"||typeof s.getSnapshotBeforeUpdate=="function",c=t.pendingProps!==c,f||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(c||u!==i)&&Zh(t,s,a,i),Ba=!1;var d=t.memoizedState;s.state=d,Ml(t,a,s,n),kl(),u=t.memoizedState,c||d!==u||Ba?(typeof h=="function"&&(xo(t,r,h,a),u=t.memoizedState),(o=Ba||Kh(t,r,o,a,d,u,i))?(f||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=u),s.props=a,s.state=u,s.context=i,a=o):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),a=!1)}else{s=t.stateNode,ou(e,t),i=t.memoizedProps,f=Rn(r,i),s.props=f,h=t.pendingProps,d=s.context,u=r.contextType,o=hs,typeof u=="object"&&u!==null&&(o=Ht(u)),c=r.getDerivedStateFromProps,(u=typeof c=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(i!==h||d!==o)&&Zh(t,s,a,o),Ba=!1,d=t.memoizedState,s.state=d,Ml(t,a,s,n),kl();var x=t.memoizedState;i!==h||d!==x||Ba||e!==null&&e.dependencies!==null&&H0(e.dependencies)?(typeof c=="function"&&(xo(t,r,c,a),x=t.memoizedState),(f=Ba||Kh(t,r,f,a,d,x,o)||e!==null&&e.dependencies!==null&&H0(e.dependencies))?(u||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(a,x,o),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(a,x,o)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||i===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||i===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=x),s.props=a,s.state=x,s.context=o,a=f):(typeof s.componentDidUpdate!="function"||i===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||i===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),a=!1)}return s=a,j0(e,t),a=(t.flags&128)!==0,s||a?(s=t.stateNode,r=a&&typeof r.getDerivedStateFromError!="function"?null:s.render(),t.flags|=1,e!==null&&a?(t.child=Ls(t,e.child,null,n),t.child=Ls(t,null,r,n)):Dt(e,t,r,n),t.memoizedState=s.state,e=t.child):e=Sa(e,t,n),e}function s1(e,t,r,a){return vi(),t.flags|=256,Dt(e,t,r,a),t.child}var mo={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function go(e){return{baseLanes:e,cachePool:Em()}}function vo(e,t,r){return e=e!==null?e.childLanes&~r:0,t&&(e|=Dr),e}function pg(e,t,r){var a=t.pendingProps,n=!1,s=(t.flags&128)!==0,i;if((i=s)||(i=e!==null&&e.memoizedState===null?!1:(wt.current&2)!==0),i&&(n=!0,t.flags&=-129),i=(t.flags&32)!==0,t.flags&=-33,e===null){if(Le){if(n?Ua(t):za(),Le){var c=st,o;if(o=c){e:{for(o=c,c=Zr;o.nodeType!==8;){if(!c){c=null;break e}if(o=Yr(o.nextSibling),o===null){c=null;break e}}c=o}c!==null?(t.memoizedState={dehydrated:c,treeContext:En!==null?{id:fa,overflow:da}:null,retryLane:536870912,hydrationErrors:null},o=mr(18,null,null,0),o.stateNode=c,o.return=t,t.child=o,Wt=t,st=null,o=!0):o=!1}o||kn(t)}if(c=t.memoizedState,c!==null&&(c=c.dehydrated,c!==null))return Mu(c)?t.lanes=32:t.lanes=536870912,null;xa(t)}return c=a.children,a=a.fallback,n?(za(),n=t.mode,c=q0({mode:"hidden",children:c},n),a=Sn(a,n,r,null),c.return=t,a.return=t,c.sibling=a,t.child=c,n=t.child,n.memoizedState=go(r),n.childLanes=vo(e,i,r),t.memoizedState=mo,a):(Ua(t),pu(t,c))}if(o=e.memoizedState,o!==null&&(c=o.dehydrated,c!==null)){if(s)t.flags&256?(Ua(t),t.flags&=-257,t=po(e,t,r)):t.memoizedState!==null?(za(),t.child=e.child,t.flags|=128,t=null):(za(),n=a.fallback,c=t.mode,a=q0({mode:"visible",children:a.children},c),n=Sn(n,c,r,null),n.flags|=2,a.return=t,n.return=t,a.sibling=n,t.child=a,Ls(t,e.child,null,r),a=t.child,a.memoizedState=go(r),a.childLanes=vo(e,i,r),t.memoizedState=mo,t=n);else if(Ua(t),Mu(c)){if(i=c.nextSibling&&c.nextSibling.dataset,i)var u=i.dgst;i=u,a=Error(ce(419)),a.stack="",a.digest=i,Ql({value:a,source:null,stack:null}),t=po(e,t,r)}else if(jt||pi(e,t,r,!1),i=(r&e.childLanes)!==0,jt||i){if(i=Ke,i!==null&&(a=r&-r,a=a&42?1:Ju(a),a=a&(i.suspendedLanes|r)?0:a,a!==0&&a!==o.retryLane))throw o.retryLane=a,Ys(e,a),yr(i,e,a),mg;c.data==="$?"||Eu(),t=po(e,t,r)}else c.data==="$?"?(t.flags|=192,t.child=e.child,t=null):(e=o.treeContext,st=Yr(c.nextSibling),Wt=t,Le=!0,Tn=null,Zr=!1,e!==null&&(Ar[Cr++]=fa,Ar[Cr++]=da,Ar[Cr++]=En,fa=e.id,da=e.overflow,En=t),t=pu(t,a.children),t.flags|=4096);return t}return n?(za(),n=a.fallback,c=t.mode,o=e.child,u=o.sibling,a=ga(o,{mode:"hidden",children:a.children}),a.subtreeFlags=o.subtreeFlags&65011712,u!==null?n=ga(u,n):(n=Sn(n,c,r,null),n.flags|=2),n.return=t,a.return=t,a.sibling=n,t.child=a,a=n,n=t.child,c=e.child.memoizedState,c===null?c=go(r):(o=c.cachePool,o!==null?(u=bt._currentValue,o=o.parent!==u?{parent:u,pool:u}:o):o=Em(),c={baseLanes:c.baseLanes|r,cachePool:o}),n.memoizedState=c,n.childLanes=vo(e,i,r),t.memoizedState=mo,a):(Ua(t),r=e.child,e=r.sibling,r=ga(r,{mode:"visible",children:a.children}),r.return=t,r.sibling=null,e!==null&&(i=t.deletions,i===null?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=r,t.memoizedState=null,r)}function pu(e,t){return t=q0({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function q0(e,t){return e=mr(22,e,null,t),e.lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function po(e,t,r){return Ls(t,e.child,null,r),e=pu(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function l1(e,t,r){e.lanes|=t;var a=e.alternate;a!==null&&(a.lanes|=t),su(e.return,t,r)}function yo(e,t,r,a,n){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:r,tailMode:n}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=a,s.tail=r,s.tailMode=n)}function yg(e,t,r){var a=t.pendingProps,n=a.revealOrder,s=a.tail;if(Dt(e,t,a.children,r),a=wt.current,a&2)a=a&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&l1(e,r,t);else if(e.tag===19)l1(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}switch(at(wt,a),n){case"forwards":for(r=t.child,n=null;r!==null;)e=r.alternate,e!==null&&W0(e)===null&&(n=r),r=r.sibling;r=n,r===null?(n=t.child,t.child=null):(n=r.sibling,r.sibling=null),yo(t,!1,n,r,s);break;case"backwards":for(r=null,n=t.child,t.child=null;n!==null;){if(e=n.alternate,e!==null&&W0(e)===null){t.child=n;break}e=n.sibling,n.sibling=r,r=n,n=e}yo(t,!0,r,null,s);break;case"together":yo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Sa(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),sn|=t.lanes,!(r&t.childLanes))if(e!==null){if(pi(e,t,r,!1),(r&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(ce(153));if(t.child!==null){for(e=t.child,r=ga(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=ga(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Tf(e,t){return e.lanes&t?!0:(e=e.dependencies,!!(e!==null&&H0(e)))}function Zy(e,t,r){switch(t.tag){case 3:O0(t,t.stateNode.containerInfo),Pa(t,bt,e.memoizedState.cache),vi();break;case 27:case 5:Wo(t);break;case 4:O0(t,t.stateNode.containerInfo);break;case 10:Pa(t,t.type,t.memoizedProps.value);break;case 13:var a=t.memoizedState;if(a!==null)return a.dehydrated!==null?(Ua(t),t.flags|=128,null):r&t.child.childLanes?pg(e,t,r):(Ua(t),e=Sa(e,t,r),e!==null?e.sibling:null);Ua(t);break;case 19:var n=(e.flags&128)!==0;if(a=(r&t.childLanes)!==0,a||(pi(e,t,r,!1),a=(r&t.childLanes)!==0),n){if(a)return yg(e,t,r);t.flags|=128}if(n=t.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),at(wt,wt.current),a)break;return null;case 22:case 23:return t.lanes=0,vg(e,t,r);case 24:Pa(t,bt,e.memoizedState.cache)}return Sa(e,t,r)}function bg(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps)jt=!0;else{if(!Tf(e,r)&&!(t.flags&128))return jt=!1,Zy(e,t,r);jt=!!(e.flags&131072)}else jt=!1,Le&&t.flags&1048576&&Nm(t,z0,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var a=t.elementType,n=a._init;if(a=n(a._payload),t.type=a,typeof a=="function")sf(a)?(e=Rn(a,e),t.tag=1,t=n1(null,t,a,e,r)):(t.tag=0,t=vu(null,t,a,e,r));else{if(a!=null){if(n=a.$$typeof,n===Yu){t.tag=11,t=e1(null,t,a,e,r);break e}else if(n===Xu){t.tag=14,t=t1(null,t,a,e,r);break e}}throw t=Yo(a)||a,Error(ce(306,t,""))}}return t;case 0:return vu(e,t,t.type,t.pendingProps,r);case 1:return a=t.type,n=Rn(a,t.pendingProps),n1(e,t,a,n,r);case 3:e:{if(O0(t,t.stateNode.containerInfo),e===null)throw Error(ce(387));a=t.pendingProps;var s=t.memoizedState;n=s.element,ou(e,t),Ml(t,a,null,r);var i=t.memoizedState;if(a=i.cache,Pa(t,bt,a),a!==s.cache&&lu(t,[bt],r,!0),kl(),a=i.element,s.isDehydrated)if(s={element:a,isDehydrated:!1,cache:i.cache},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){t=s1(e,t,a,r);break e}else if(a!==n){n=Mr(Error(ce(424)),t),Ql(n),t=s1(e,t,a,r);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(st=Yr(e.firstChild),Wt=t,Le=!0,Tn=null,Zr=!0,r=cg(t,null,a,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling}else{if(vi(),a===n){t=Sa(e,t,r);break e}Dt(e,t,a,r)}t=t.child}return t;case 26:return j0(e,t),e===null?(r=S1(t.type,null,t.pendingProps,null))?t.memoizedState=r:Le||(r=t.type,e=t.pendingProps,a=ac(Qa.current).createElement(r),a[zt]=t,a[tr]=e,It(a,r,e),Tt(a),t.stateNode=a):t.memoizedState=S1(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Wo(t),e===null&&Le&&(a=t.stateNode=l2(t.type,t.pendingProps,Qa.current),Wt=t,Zr=!0,n=st,fn(t.type)?(Du=n,st=Yr(a.firstChild)):st=n),Dt(e,t,t.pendingProps.children,r),j0(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&Le&&((n=a=st)&&(a=_4(a,t.type,t.pendingProps,Zr),a!==null?(t.stateNode=a,Wt=t,st=Yr(a.firstChild),Zr=!1,n=!0):n=!1),n||kn(t)),Wo(t),n=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,a=s.children,Cu(n,s)?a=null:i!==null&&Cu(n,i)&&(t.flags|=32),t.memoizedState!==null&&(n=xf(e,t,Vy,null,null,r),ti._currentValue=n),j0(e,t),Dt(e,t,a,r),t.child;case 6:return e===null&&Le&&((e=r=st)&&(r=j4(r,t.pendingProps,Zr),r!==null?(t.stateNode=r,Wt=t,st=null,e=!0):e=!1),e||kn(t)),null;case 13:return pg(e,t,r);case 4:return O0(t,t.stateNode.containerInfo),a=t.pendingProps,e===null?t.child=Ls(t,null,a,r):Dt(e,t,a,r),t.child;case 11:return e1(e,t,t.type,t.pendingProps,r);case 7:return Dt(e,t,t.pendingProps,r),t.child;case 8:return Dt(e,t,t.pendingProps.children,r),t.child;case 12:return Dt(e,t,t.pendingProps.children,r),t.child;case 10:return a=t.pendingProps,Pa(t,t.type,a.value),Dt(e,t,a.children,r),t.child;case 9:return n=t.type._context,a=t.pendingProps.children,Mn(t),n=Ht(n),a=a(n),t.flags|=1,Dt(e,t,a,r),t.child;case 14:return t1(e,t,t.type,t.pendingProps,r);case 15:return gg(e,t,t.type,t.pendingProps,r);case 19:return yg(e,t,r);case 31:return a=t.pendingProps,r=t.mode,a={mode:a.mode,children:a.children},e===null?(r=q0(a,r),r.ref=t.ref,t.child=r,r.return=t,t=r):(r=ga(e.child,a),r.ref=t.ref,t.child=r,r.return=t,t=r),t;case 22:return vg(e,t,r);case 24:return Mn(t),a=Ht(bt),e===null?(n=uf(),n===null&&(n=Ke,s=of(),n.pooledCache=s,s.refCount++,s!==null&&(n.pooledCacheLanes|=r),n=s),t.memoizedState={parent:a,cache:n},ff(t),Pa(t,bt,n)):(e.lanes&r&&(ou(e,t),Ml(t,null,null,r),kl()),n=e.memoizedState,s=t.memoizedState,n.parent!==a?(n={parent:a,cache:a},t.memoizedState=n,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=n),Pa(t,bt,a)):(a=s.cache,Pa(t,bt,a),a!==n.cache&&lu(t,[bt],r,!0))),Dt(e,t,t.pendingProps.children,r),t.child;case 29:throw t.pendingProps}throw Error(ce(156,t.tag))}function ia(e){e.flags|=4}function i1(e,t){if(t.type!=="stylesheet"||t.state.loading&4)e.flags&=-16777217;else if(e.flags|=16777216,!o2(t)){if(t=Rr.current,t!==null&&((Re&4194048)===Re?ra!==null:(Re&62914560)!==Re&&!(Re&536870912)||t!==ra))throw Al=cu,Tm;e.flags|=8192}}function l0(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?Xx():536870912,e.lanes|=t,Is|=t)}function xl(e,t){if(!Le)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var a=null;r!==null;)r.alternate!==null&&(a=r),r=r.sibling;a===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:a.sibling=null}}function nt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,a=0;if(t)for(var n=e.child;n!==null;)r|=n.lanes|n.childLanes,a|=n.subtreeFlags&65011712,a|=n.flags&65011712,n.return=e,n=n.sibling;else for(n=e.child;n!==null;)r|=n.lanes|n.childLanes,a|=n.subtreeFlags,a|=n.flags,n.return=e,n=n.sibling;return e.subtreeFlags|=a,e.childLanes=r,t}function $y(e,t,r){var a=t.pendingProps;switch(cf(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nt(t),null;case 1:return nt(t),null;case 3:return r=t.stateNode,a=null,e!==null&&(a=e.memoizedState.cache),t.memoizedState.cache!==a&&(t.flags|=2048),va(bt),ks(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(dl(t)?ia(t):e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ih())),nt(t),null;case 26:return r=t.memoizedState,e===null?(ia(t),r!==null?(nt(t),i1(t,r)):(nt(t),t.flags&=-16777217)):r?r!==e.memoizedState?(ia(t),nt(t),i1(t,r)):(nt(t),t.flags&=-16777217):(e.memoizedProps!==a&&ia(t),nt(t),t.flags&=-16777217),null;case 27:F0(t),r=Qa.current;var n=t.type;if(e!==null&&t.stateNode!=null)e.memoizedProps!==a&&ia(t);else{if(!a){if(t.stateNode===null)throw Error(ce(166));return nt(t),null}e=ea.current,dl(t)?Fh(t):(e=l2(n,a,r),t.stateNode=e,ia(t))}return nt(t),null;case 5:if(F0(t),r=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==a&&ia(t);else{if(!a){if(t.stateNode===null)throw Error(ce(166));return nt(t),null}if(e=ea.current,dl(t))Fh(t);else{switch(n=ac(Qa.current),e){case 1:e=n.createElementNS("http://www.w3.org/2000/svg",r);break;case 2:e=n.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;default:switch(r){case"svg":e=n.createElementNS("http://www.w3.org/2000/svg",r);break;case"math":e=n.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;case"script":e=n.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e=typeof a.is=="string"?n.createElement("select",{is:a.is}):n.createElement("select"),a.multiple?e.multiple=!0:a.size&&(e.size=a.size);break;default:e=typeof a.is=="string"?n.createElement(r,{is:a.is}):n.createElement(r)}}e[zt]=t,e[tr]=a;e:for(n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.tag!==27&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break e;for(;n.sibling===null;){if(n.return===null||n.return===t)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}t.stateNode=e;e:switch(It(e,r,a),r){case"button":case"input":case"select":case"textarea":e=!!a.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&ia(t)}}return nt(t),t.flags&=-16777217,null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==a&&ia(t);else{if(typeof a!="string"&&t.stateNode===null)throw Error(ce(166));if(e=Qa.current,dl(t)){if(e=t.stateNode,r=t.memoizedProps,a=null,n=Wt,n!==null)switch(n.tag){case 27:case 5:a=n.memoizedProps}e[zt]=t,e=!!(e.nodeValue===r||a!==null&&a.suppressHydrationWarning===!0||a2(e.nodeValue,r)),e||kn(t)}else e=ac(e).createTextNode(a),e[zt]=t,t.stateNode=e}return nt(t),null;case 13:if(a=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(n=dl(t),a!==null&&a.dehydrated!==null){if(e===null){if(!n)throw Error(ce(318));if(n=t.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(ce(317));n[zt]=t}else vi(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;nt(t),n=!1}else n=Ih(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=n),n=!0;if(!n)return t.flags&256?(xa(t),t):(xa(t),null)}if(xa(t),t.flags&128)return t.lanes=r,t;if(r=a!==null,e=e!==null&&e.memoizedState!==null,r){a=t.child,n=null,a.alternate!==null&&a.alternate.memoizedState!==null&&a.alternate.memoizedState.cachePool!==null&&(n=a.alternate.memoizedState.cachePool.pool);var s=null;a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(s=a.memoizedState.cachePool.pool),s!==n&&(a.flags|=2048)}return r!==e&&r&&(t.child.flags|=8192),l0(t,t.updateQueue),nt(t),null;case 4:return ks(),e===null&&Rf(t.stateNode.containerInfo),nt(t),null;case 10:return va(t.type),nt(t),null;case 19:if(kt(wt),n=t.memoizedState,n===null)return nt(t),null;if(a=(t.flags&128)!==0,s=n.rendering,s===null)if(a)xl(n,!1);else{if(it!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=W0(e),s!==null){for(t.flags|=128,xl(n,!1),e=s.updateQueue,t.updateQueue=e,l0(t,e),t.subtreeFlags=0,e=r,r=t.child;r!==null;)wm(r,e),r=r.sibling;return at(wt,wt.current&1|2),t.child}e=e.sibling}n.tail!==null&&ta()>Z0&&(t.flags|=128,a=!0,xl(n,!1),t.lanes=4194304)}else{if(!a)if(e=W0(s),e!==null){if(t.flags|=128,a=!0,e=e.updateQueue,t.updateQueue=e,l0(t,e),xl(n,!0),n.tail===null&&n.tailMode==="hidden"&&!s.alternate&&!Le)return nt(t),null}else 2*ta()-n.renderingStartTime>Z0&&r!==536870912&&(t.flags|=128,a=!0,xl(n,!1),t.lanes=4194304);n.isBackwards?(s.sibling=t.child,t.child=s):(e=n.last,e!==null?e.sibling=s:t.child=s,n.last=s)}return n.tail!==null?(t=n.tail,n.rendering=t,n.tail=t.sibling,n.renderingStartTime=ta(),t.sibling=null,e=wt.current,at(wt,a?e&1|2:e&1),t):(nt(t),null);case 22:case 23:return xa(t),df(),a=t.memoizedState!==null,e!==null?e.memoizedState!==null!==a&&(t.flags|=8192):a&&(t.flags|=8192),a?r&536870912&&!(t.flags&128)&&(nt(t),t.subtreeFlags&6&&(t.flags|=8192)):nt(t),r=t.updateQueue,r!==null&&l0(t,r.retryQueue),r=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(r=e.memoizedState.cachePool.pool),a=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(a=t.memoizedState.cachePool.pool),a!==r&&(t.flags|=2048),e!==null&&kt(_n),null;case 24:return r=null,e!==null&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),va(bt),nt(t),null;case 25:return null;case 30:return null}throw Error(ce(156,t.tag))}function e4(e,t){switch(cf(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return va(bt),ks(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return F0(t),null;case 13:if(xa(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ce(340));vi()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return kt(wt),null;case 4:return ks(),null;case 10:return va(t.type),null;case 22:case 23:return xa(t),df(),e!==null&&kt(_n),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return va(bt),null;case 25:return null;default:return null}}function wg(e,t){switch(cf(t),t.tag){case 3:va(bt),ks();break;case 26:case 27:case 5:F0(t);break;case 4:ks();break;case 13:xa(t);break;case 19:kt(wt);break;case 10:va(t.type);break;case 22:case 23:xa(t),df(),e!==null&&kt(_n);break;case 24:va(bt)}}function Si(e,t){try{var r=t.updateQueue,a=r!==null?r.lastEffect:null;if(a!==null){var n=a.next;r=n;do{if((r.tag&e)===e){a=void 0;var s=r.create,i=r.inst;a=s(),i.destroy=a}r=r.next}while(r!==n)}}catch(c){Je(t,t.return,c)}}function nn(e,t,r){try{var a=t.updateQueue,n=a!==null?a.lastEffect:null;if(n!==null){var s=n.next;a=s;do{if((a.tag&e)===e){var i=a.inst,c=i.destroy;if(c!==void 0){i.destroy=void 0,n=t;var o=r,u=c;try{u()}catch(f){Je(n,o,f)}}}a=a.next}while(a!==s)}}catch(f){Je(t,t.return,f)}}function Ng(e){var t=e.updateQueue;if(t!==null){var r=e.stateNode;try{Am(t,r)}catch(a){Je(e,e.return,a)}}}function Sg(e,t,r){r.props=Rn(e.type,e.memoizedProps),r.state=e.memoizedState;try{r.componentWillUnmount()}catch(a){Je(e,t,a)}}function Rl(e,t){try{var r=e.ref;if(r!==null){switch(e.tag){case 26:case 27:case 5:var a=e.stateNode;break;case 30:a=e.stateNode;break;default:a=e.stateNode}typeof r=="function"?e.refCleanup=r(a):r.current=a}}catch(n){Je(e,t,n)}}function $r(e,t){var r=e.ref,a=e.refCleanup;if(r!==null)if(typeof a=="function")try{a()}catch(n){Je(e,t,n)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof r=="function")try{r(null)}catch(n){Je(e,t,n)}else r.current=null}function Eg(e){var t=e.type,r=e.memoizedProps,a=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":r.autoFocus&&a.focus();break e;case"img":r.src?a.src=r.src:r.srcSet&&(a.srcset=r.srcSet)}}catch(n){Je(e,e.return,n)}}function bo(e,t,r){try{var a=e.stateNode;w4(a,e.type,r,t),a[tr]=t}catch(n){Je(e,e.return,n)}}function Tg(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&fn(e.type)||e.tag===4}function wo(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Tg(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&fn(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function yu(e,t,r){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r).insertBefore(e,t):(t=r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,t.appendChild(e),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Uc));else if(a!==4&&(a===27&&fn(e.type)&&(r=e.stateNode,t=null),e=e.child,e!==null))for(yu(e,t,r),e=e.sibling;e!==null;)yu(e,t,r),e=e.sibling}function K0(e,t,r){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(a!==4&&(a===27&&fn(e.type)&&(r=e.stateNode),e=e.child,e!==null))for(K0(e,t,r),e=e.sibling;e!==null;)K0(e,t,r),e=e.sibling}function _g(e){var t=e.stateNode,r=e.memoizedProps;try{for(var a=e.type,n=t.attributes;n.length;)t.removeAttributeNode(n[0]);It(t,a,r),t[zt]=e,t[tr]=r}catch(s){Je(e,e.return,s)}}var oa=!1,ft=!1,No=!1,c1=typeof WeakSet=="function"?WeakSet:Set,Et=null;function t4(e,t){if(e=e.containerInfo,ju=ic,e=hm(e),rf(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var a=r.getSelection&&r.getSelection();if(a&&a.rangeCount!==0){r=a.anchorNode;var n=a.anchorOffset,s=a.focusNode;a=a.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var i=0,c=-1,o=-1,u=0,f=0,h=e,d=null;t:for(;;){for(var x;h!==r||n!==0&&h.nodeType!==3||(c=i+n),h!==s||a!==0&&h.nodeType!==3||(o=i+a),h.nodeType===3&&(i+=h.nodeValue.length),(x=h.firstChild)!==null;)d=h,h=x;for(;;){if(h===e)break t;if(d===r&&++u===n&&(c=i),d===s&&++f===a&&(o=i),(x=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=x}r=c===-1||o===-1?null:{start:c,end:o}}else r=null}r=r||{start:0,end:0}}else r=null;for(Au={focusedElem:e,selectionRange:r},ic=!1,Et=t;Et!==null;)if(t=Et,e=t.child,(t.subtreeFlags&1024)!==0&&e!==null)e.return=t,Et=e;else for(;Et!==null;){switch(t=Et,s=t.alternate,e=t.flags,t.tag){case 0:break;case 11:case 15:break;case 1:if(e&1024&&s!==null){e=void 0,r=t,n=s.memoizedProps,s=s.memoizedState,a=r.stateNode;try{var b=Rn(r.type,n,r.elementType===r.type);e=a.getSnapshotBeforeUpdate(b,s),a.__reactInternalSnapshotBeforeUpdate=e}catch(m){Je(r,r.return,m)}}break;case 3:if(e&1024){if(e=t.stateNode.containerInfo,r=e.nodeType,r===9)ku(e);else if(r===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":ku(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(e&1024)throw Error(ce(163))}if(e=t.sibling,e!==null){e.return=t.return,Et=e;break}Et=t.return}}function jg(e,t,r){var a=r.flags;switch(r.tag){case 0:case 11:case 15:Oa(e,r),a&4&&Si(5,r);break;case 1:if(Oa(e,r),a&4)if(e=r.stateNode,t===null)try{e.componentDidMount()}catch(i){Je(r,r.return,i)}else{var n=Rn(r.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(n,t,e.__reactInternalSnapshotBeforeUpdate)}catch(i){Je(r,r.return,i)}}a&64&&Ng(r),a&512&&Rl(r,r.return);break;case 3:if(Oa(e,r),a&64&&(e=r.updateQueue,e!==null)){if(t=null,r.child!==null)switch(r.child.tag){case 27:case 5:t=r.child.stateNode;break;case 1:t=r.child.stateNode}try{Am(e,t)}catch(i){Je(r,r.return,i)}}break;case 27:t===null&&a&4&&_g(r);case 26:case 5:Oa(e,r),t===null&&a&4&&Eg(r),a&512&&Rl(r,r.return);break;case 12:Oa(e,r);break;case 13:Oa(e,r),a&4&&kg(e,r),a&64&&(e=r.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(r=u4.bind(null,r),A4(e,r))));break;case 22:if(a=r.memoizedState!==null||oa,!a){t=t!==null&&t.memoizedState!==null||ft,n=oa;var s=ft;oa=a,(ft=t)&&!s?La(e,r,(r.subtreeFlags&8772)!==0):Oa(e,r),oa=n,ft=s}break;case 30:break;default:Oa(e,r)}}function Ag(e){var t=e.alternate;t!==null&&(e.alternate=null,Ag(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&qu(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var tt=null,Zt=!1;function ca(e,t,r){for(r=r.child;r!==null;)Cg(e,t,r),r=r.sibling}function Cg(e,t,r){if(gr&&typeof gr.onCommitFiberUnmount=="function")try{gr.onCommitFiberUnmount(di,r)}catch{}switch(r.tag){case 26:ft||$r(r,t),ca(e,t,r),r.memoizedState?r.memoizedState.count--:r.stateNode&&(r=r.stateNode,r.parentNode.removeChild(r));break;case 27:ft||$r(r,t);var a=tt,n=Zt;fn(r.type)&&(tt=r.stateNode,Zt=!1),ca(e,t,r),Il(r.stateNode),tt=a,Zt=n;break;case 5:ft||$r(r,t);case 6:if(a=tt,n=Zt,tt=null,ca(e,t,r),tt=a,Zt=n,tt!==null)if(Zt)try{(tt.nodeType===9?tt.body:tt.nodeName==="HTML"?tt.ownerDocument.body:tt).removeChild(r.stateNode)}catch(s){Je(r,t,s)}else try{tt.removeChild(r.stateNode)}catch(s){Je(r,t,s)}break;case 18:tt!==null&&(Zt?(e=tt,b1(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,r.stateNode),ni(e)):b1(tt,r.stateNode));break;case 4:a=tt,n=Zt,tt=r.stateNode.containerInfo,Zt=!0,ca(e,t,r),tt=a,Zt=n;break;case 0:case 11:case 14:case 15:ft||nn(2,r,t),ft||nn(4,r,t),ca(e,t,r);break;case 1:ft||($r(r,t),a=r.stateNode,typeof a.componentWillUnmount=="function"&&Sg(r,t,a)),ca(e,t,r);break;case 21:ca(e,t,r);break;case 22:ft=(a=ft)||r.memoizedState!==null,ca(e,t,r),ft=a;break;default:ca(e,t,r)}}function kg(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{ni(e)}catch(r){Je(t,t.return,r)}}function r4(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new c1),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new c1),t;default:throw Error(ce(435,e.tag))}}function So(e,t){var r=r4(e);t.forEach(function(a){var n=f4.bind(null,e,a);r.has(a)||(r.add(a),a.then(n,n))})}function ir(e,t){var r=t.deletions;if(r!==null)for(var a=0;a<r.length;a++){var n=r[a],s=e,i=t,c=i;e:for(;c!==null;){switch(c.tag){case 27:if(fn(c.type)){tt=c.stateNode,Zt=!1;break e}break;case 5:tt=c.stateNode,Zt=!1;break e;case 3:case 4:tt=c.stateNode.containerInfo,Zt=!0;break e}c=c.return}if(tt===null)throw Error(ce(160));Cg(s,i,n),tt=null,Zt=!1,s=n.alternate,s!==null&&(s.return=null),n.return=null}if(t.subtreeFlags&13878)for(t=t.child;t!==null;)Mg(t,e),t=t.sibling}var zr=null;function Mg(e,t){var r=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:ir(t,e),cr(e),a&4&&(nn(3,e,e.return),Si(3,e),nn(5,e,e.return));break;case 1:ir(t,e),cr(e),a&512&&(ft||r===null||$r(r,r.return)),a&64&&oa&&(e=e.updateQueue,e!==null&&(a=e.callbacks,a!==null&&(r=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=r===null?a:r.concat(a))));break;case 26:var n=zr;if(ir(t,e),cr(e),a&512&&(ft||r===null||$r(r,r.return)),a&4){var s=r!==null?r.memoizedState:null;if(a=e.memoizedState,r===null)if(a===null)if(e.stateNode===null){e:{a=e.type,r=e.memoizedProps,n=n.ownerDocument||n;t:switch(a){case"title":s=n.getElementsByTagName("title")[0],(!s||s[mi]||s[zt]||s.namespaceURI==="http://www.w3.org/2000/svg"||s.hasAttribute("itemprop"))&&(s=n.createElement(a),n.head.insertBefore(s,n.querySelector("head > title"))),It(s,a,r),s[zt]=e,Tt(s),a=s;break e;case"link":var i=T1("link","href",n).get(a+(r.href||""));if(i){for(var c=0;c<i.length;c++)if(s=i[c],s.getAttribute("href")===(r.href==null||r.href===""?null:r.href)&&s.getAttribute("rel")===(r.rel==null?null:r.rel)&&s.getAttribute("title")===(r.title==null?null:r.title)&&s.getAttribute("crossorigin")===(r.crossOrigin==null?null:r.crossOrigin)){i.splice(c,1);break t}}s=n.createElement(a),It(s,a,r),n.head.appendChild(s);break;case"meta":if(i=T1("meta","content",n).get(a+(r.content||""))){for(c=0;c<i.length;c++)if(s=i[c],s.getAttribute("content")===(r.content==null?null:""+r.content)&&s.getAttribute("name")===(r.name==null?null:r.name)&&s.getAttribute("property")===(r.property==null?null:r.property)&&s.getAttribute("http-equiv")===(r.httpEquiv==null?null:r.httpEquiv)&&s.getAttribute("charset")===(r.charSet==null?null:r.charSet)){i.splice(c,1);break t}}s=n.createElement(a),It(s,a,r),n.head.appendChild(s);break;default:throw Error(ce(468,a))}s[zt]=e,Tt(s),a=s}e.stateNode=a}else _1(n,e.type,e.stateNode);else e.stateNode=E1(n,a,e.memoizedProps);else s!==a?(s===null?r.stateNode!==null&&(r=r.stateNode,r.parentNode.removeChild(r)):s.count--,a===null?_1(n,e.type,e.stateNode):E1(n,a,e.memoizedProps)):a===null&&e.stateNode!==null&&bo(e,e.memoizedProps,r.memoizedProps)}break;case 27:ir(t,e),cr(e),a&512&&(ft||r===null||$r(r,r.return)),r!==null&&a&4&&bo(e,e.memoizedProps,r.memoizedProps);break;case 5:if(ir(t,e),cr(e),a&512&&(ft||r===null||$r(r,r.return)),e.flags&32){n=e.stateNode;try{Ds(n,"")}catch(x){Je(e,e.return,x)}}a&4&&e.stateNode!=null&&(n=e.memoizedProps,bo(e,n,r!==null?r.memoizedProps:n)),a&1024&&(No=!0);break;case 6:if(ir(t,e),cr(e),a&4){if(e.stateNode===null)throw Error(ce(162));a=e.memoizedProps,r=e.stateNode;try{r.nodeValue=a}catch(x){Je(e,e.return,x)}}break;case 3:if(k0=null,n=zr,zr=nc(t.containerInfo),ir(t,e),zr=n,cr(e),a&4&&r!==null&&r.memoizedState.isDehydrated)try{ni(t.containerInfo)}catch(x){Je(e,e.return,x)}No&&(No=!1,Dg(e));break;case 4:a=zr,zr=nc(e.stateNode.containerInfo),ir(t,e),cr(e),zr=a;break;case 12:ir(t,e),cr(e);break;case 13:ir(t,e),cr(e),e.child.flags&8192&&e.memoizedState!==null!=(r!==null&&r.memoizedState!==null)&&(kf=ta()),a&4&&(a=e.updateQueue,a!==null&&(e.updateQueue=null,So(e,a)));break;case 22:n=e.memoizedState!==null;var o=r!==null&&r.memoizedState!==null,u=oa,f=ft;if(oa=u||n,ft=f||o,ir(t,e),ft=f,oa=u,cr(e),a&8192)e:for(t=e.stateNode,t._visibility=n?t._visibility&-2:t._visibility|1,n&&(r===null||o||oa||ft||yn(e)),r=null,t=e;;){if(t.tag===5||t.tag===26){if(r===null){o=r=t;try{if(s=o.stateNode,n)i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none";else{c=o.stateNode;var h=o.memoizedProps.style,d=h!=null&&h.hasOwnProperty("display")?h.display:null;c.style.display=d==null||typeof d=="boolean"?"":(""+d).trim()}}catch(x){Je(o,o.return,x)}}}else if(t.tag===6){if(r===null){o=t;try{o.stateNode.nodeValue=n?"":o.memoizedProps}catch(x){Je(o,o.return,x)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;r===t&&(r=null),t=t.return}r===t&&(r=null),t.sibling.return=t.return,t=t.sibling}a&4&&(a=e.updateQueue,a!==null&&(r=a.retryQueue,r!==null&&(a.retryQueue=null,So(e,r))));break;case 19:ir(t,e),cr(e),a&4&&(a=e.updateQueue,a!==null&&(e.updateQueue=null,So(e,a)));break;case 30:break;case 21:break;default:ir(t,e),cr(e)}}function cr(e){var t=e.flags;if(t&2){try{for(var r,a=e.return;a!==null;){if(Tg(a)){r=a;break}a=a.return}if(r==null)throw Error(ce(160));switch(r.tag){case 27:var n=r.stateNode,s=wo(e);K0(e,s,n);break;case 5:var i=r.stateNode;r.flags&32&&(Ds(i,""),r.flags&=-33);var c=wo(e);K0(e,c,i);break;case 3:case 4:var o=r.stateNode.containerInfo,u=wo(e);yu(e,u,o);break;default:throw Error(ce(161))}}catch(f){Je(e,e.return,f)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Dg(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;Dg(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function Oa(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)jg(e,t.alternate,t),t=t.sibling}function yn(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:nn(4,t,t.return),yn(t);break;case 1:$r(t,t.return);var r=t.stateNode;typeof r.componentWillUnmount=="function"&&Sg(t,t.return,r),yn(t);break;case 27:Il(t.stateNode);case 26:case 5:$r(t,t.return),yn(t);break;case 22:t.memoizedState===null&&yn(t);break;case 30:yn(t);break;default:yn(t)}e=e.sibling}}function La(e,t,r){for(r=r&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var a=t.alternate,n=e,s=t,i=s.flags;switch(s.tag){case 0:case 11:case 15:La(n,s,r),Si(4,s);break;case 1:if(La(n,s,r),a=s,n=a.stateNode,typeof n.componentDidMount=="function")try{n.componentDidMount()}catch(u){Je(a,a.return,u)}if(a=s,n=a.updateQueue,n!==null){var c=a.stateNode;try{var o=n.shared.hiddenCallbacks;if(o!==null)for(n.shared.hiddenCallbacks=null,n=0;n<o.length;n++)jm(o[n],c)}catch(u){Je(a,a.return,u)}}r&&i&64&&Ng(s),Rl(s,s.return);break;case 27:_g(s);case 26:case 5:La(n,s,r),r&&a===null&&i&4&&Eg(s),Rl(s,s.return);break;case 12:La(n,s,r);break;case 13:La(n,s,r),r&&i&4&&kg(n,s);break;case 22:s.memoizedState===null&&La(n,s,r),Rl(s,s.return);break;case 30:break;default:La(n,s,r)}t=t.sibling}}function _f(e,t){var r=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(r=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==r&&(e!=null&&e.refCount++,r!=null&&yi(r))}function jf(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&yi(e))}function Qr(e,t,r,a){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Rg(e,t,r,a),t=t.sibling}function Rg(e,t,r,a){var n=t.flags;switch(t.tag){case 0:case 11:case 15:Qr(e,t,r,a),n&2048&&Si(9,t);break;case 1:Qr(e,t,r,a);break;case 3:Qr(e,t,r,a),n&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&yi(e)));break;case 12:if(n&2048){Qr(e,t,r,a),e=t.stateNode;try{var s=t.memoizedProps,i=s.id,c=s.onPostCommit;typeof c=="function"&&c(i,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(o){Je(t,t.return,o)}}else Qr(e,t,r,a);break;case 13:Qr(e,t,r,a);break;case 23:break;case 22:s=t.stateNode,i=t.alternate,t.memoizedState!==null?s._visibility&2?Qr(e,t,r,a):Ol(e,t):s._visibility&2?Qr(e,t,r,a):(s._visibility|=2,rs(e,t,r,a,(t.subtreeFlags&10256)!==0)),n&2048&&_f(i,t);break;case 24:Qr(e,t,r,a),n&2048&&jf(t.alternate,t);break;default:Qr(e,t,r,a)}}function rs(e,t,r,a,n){for(n=n&&(t.subtreeFlags&10256)!==0,t=t.child;t!==null;){var s=e,i=t,c=r,o=a,u=i.flags;switch(i.tag){case 0:case 11:case 15:rs(s,i,c,o,n),Si(8,i);break;case 23:break;case 22:var f=i.stateNode;i.memoizedState!==null?f._visibility&2?rs(s,i,c,o,n):Ol(s,i):(f._visibility|=2,rs(s,i,c,o,n)),n&&u&2048&&_f(i.alternate,i);break;case 24:rs(s,i,c,o,n),n&&u&2048&&jf(i.alternate,i);break;default:rs(s,i,c,o,n)}t=t.sibling}}function Ol(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var r=e,a=t,n=a.flags;switch(a.tag){case 22:Ol(r,a),n&2048&&_f(a.alternate,a);break;case 24:Ol(r,a),n&2048&&jf(a.alternate,a);break;default:Ol(r,a)}t=t.sibling}}var wl=8192;function Jn(e){if(e.subtreeFlags&wl)for(e=e.child;e!==null;)Og(e),e=e.sibling}function Og(e){switch(e.tag){case 26:Jn(e),e.flags&wl&&e.memoizedState!==null&&z4(zr,e.memoizedState,e.memoizedProps);break;case 5:Jn(e);break;case 3:case 4:var t=zr;zr=nc(e.stateNode.containerInfo),Jn(e),zr=t;break;case 22:e.memoizedState===null&&(t=e.alternate,t!==null&&t.memoizedState!==null?(t=wl,wl=16777216,Jn(e),wl=t):Jn(e));break;default:Jn(e)}}function Fg(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function ml(e){var t=e.deletions;if(e.flags&16){if(t!==null)for(var r=0;r<t.length;r++){var a=t[r];Et=a,Ig(a,e)}Fg(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)Lg(e),e=e.sibling}function Lg(e){switch(e.tag){case 0:case 11:case 15:ml(e),e.flags&2048&&nn(9,e,e.return);break;case 3:ml(e);break;case 12:ml(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,A0(e)):ml(e);break;default:ml(e)}}function A0(e){var t=e.deletions;if(e.flags&16){if(t!==null)for(var r=0;r<t.length;r++){var a=t[r];Et=a,Ig(a,e)}Fg(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:nn(8,t,t.return),A0(t);break;case 22:r=t.stateNode,r._visibility&2&&(r._visibility&=-3,A0(t));break;default:A0(t)}e=e.sibling}}function Ig(e,t){for(;Et!==null;){var r=Et;switch(r.tag){case 0:case 11:case 15:nn(8,r,t);break;case 23:case 22:if(r.memoizedState!==null&&r.memoizedState.cachePool!==null){var a=r.memoizedState.cachePool.pool;a!=null&&a.refCount++}break;case 24:yi(r.memoizedState.cache)}if(a=r.child,a!==null)a.return=r,Et=a;else e:for(r=e;Et!==null;){a=Et;var n=a.sibling,s=a.return;if(Ag(a),a===r){Et=null;break e}if(n!==null){n.return=s,Et=n;break e}Et=s}}}var a4={getCacheForType:function(e){var t=Ht(bt),r=t.data.get(e);return r===void 0&&(r=e(),t.data.set(e,r)),r}},n4=typeof WeakMap=="function"?WeakMap:Map,ze=0,Ke=null,De=null,Re=0,Pe=0,fr=null,Ya=!1,Xs=!1,Af=!1,Ea=0,it=0,sn=0,jn=0,Cf=0,Dr=0,Is=0,Fl=null,$t=null,bu=!1,kf=0,Z0=1/0,$0=null,Za=null,Ot=0,$a=null,Bs=null,Ts=0,wu=0,Nu=null,Bg=null,Ll=0,Su=null;function pr(){if(ze&2&&Re!==0)return Re&-Re;if(Se.T!==null){var e=Rs;return e!==0?e:Df()}return Qx()}function Pg(){Dr===0&&(Dr=!(Re&536870912)||Le?Yx():536870912);var e=Rr.current;return e!==null&&(e.flags|=32),Dr}function yr(e,t,r){(e===Ke&&(Pe===2||Pe===9)||e.cancelPendingCommit!==null)&&(Ps(e,0),Xa(e,Re,Dr,!1)),xi(e,r),(!(ze&2)||e!==Ke)&&(e===Ke&&(!(ze&2)&&(jn|=r),it===4&&Xa(e,Re,Dr,!1)),sa(e))}function Ug(e,t,r){if(ze&6)throw Error(ce(327));var a=!r&&(t&124)===0&&(t&e.expiredLanes)===0||hi(e,t),n=a?i4(e,t):Eo(e,t,!0),s=a;do{if(n===0){Xs&&!a&&Xa(e,t,0,!1);break}else{if(r=e.current.alternate,s&&!s4(r)){n=Eo(e,t,!1),s=!1;continue}if(n===2){if(s=t,e.errorRecoveryDisabledLanes&s)var i=0;else i=e.pendingLanes&-536870913,i=i!==0?i:i&536870912?536870912:0;if(i!==0){t=i;e:{var c=e;n=Fl;var o=c.current.memoizedState.isDehydrated;if(o&&(Ps(c,i).flags|=256),i=Eo(c,i,!1),i!==2){if(Af&&!o){c.errorRecoveryDisabledLanes|=s,jn|=s,n=4;break e}s=$t,$t=n,s!==null&&($t===null?$t=s:$t.push.apply($t,s))}n=i}if(s=!1,n!==2)continue}}if(n===1){Ps(e,0),Xa(e,t,0,!0);break}e:{switch(a=e,s=n,s){case 0:case 1:throw Error(ce(345));case 4:if((t&4194048)!==t)break;case 6:Xa(a,t,Dr,!Ya);break e;case 2:$t=null;break;case 3:case 5:break;default:throw Error(ce(329))}if((t&62914560)===t&&(n=kf+300-ta(),10<n)){if(Xa(a,t,Dr,!Ya),jc(a,0,!0)!==0)break e;a.timeoutHandle=s2(o1.bind(null,a,r,$t,$0,bu,t,Dr,jn,Is,Ya,s,2,-0,0),n);break e}o1(a,r,$t,$0,bu,t,Dr,jn,Is,Ya,s,0,-0,0)}}break}while(1);sa(e)}function o1(e,t,r,a,n,s,i,c,o,u,f,h,d,x){if(e.timeoutHandle=-1,h=t.subtreeFlags,(h&8192||(h&16785408)===16785408)&&(ei={stylesheets:null,count:0,unsuspend:U4},Og(t),h=H4(),h!==null)){e.cancelPendingCommit=h(f1.bind(null,e,t,s,r,a,n,i,c,o,f,1,d,x)),Xa(e,s,i,!u);return}f1(e,t,s,r,a,n,i,c,o)}function s4(e){for(var t=e;;){var r=t.tag;if((r===0||r===11||r===15)&&t.flags&16384&&(r=t.updateQueue,r!==null&&(r=r.stores,r!==null)))for(var a=0;a<r.length;a++){var n=r[a],s=n.getSnapshot;n=n.value;try{if(!br(s(),n))return!1}catch{return!1}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Xa(e,t,r,a){t&=~Cf,t&=~jn,e.suspendedLanes|=t,e.pingedLanes&=~t,a&&(e.warmLanes|=t),a=e.expirationTimes;for(var n=t;0<n;){var s=31-vr(n),i=1<<s;a[s]=-1,n&=~i}r!==0&&Wx(e,r,t)}function Ic(){return ze&6?!0:(Ei(0,!1),!1)}function Mf(){if(De!==null){if(Pe===0)var e=De.return;else e=De,ha=Un=null,vf(e),Es=null,Kl=0,e=De;for(;e!==null;)wg(e.alternate,e),e=e.return;De=null}}function Ps(e,t){var r=e.timeoutHandle;r!==-1&&(e.timeoutHandle=-1,S4(r)),r=e.cancelPendingCommit,r!==null&&(e.cancelPendingCommit=null,r()),Mf(),Ke=e,De=r=ga(e.current,null),Re=t,Pe=0,fr=null,Ya=!1,Xs=hi(e,t),Af=!1,Is=Dr=Cf=jn=sn=it=0,$t=Fl=null,bu=!1,t&8&&(t|=t&32);var a=e.entangledLanes;if(a!==0)for(e=e.entanglements,a&=t;0<a;){var n=31-vr(a),s=1<<n;t|=e[n],a&=~s}return Ea=t,Mc(),r}function zg(e,t){Ce=null,Se.H=X0,t===bi||t===Rc?(t=zh(),Pe=3):t===Tm?(t=zh(),Pe=4):Pe=t===mg?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,fr=t,De===null&&(it=1,Q0(e,Mr(t,e.current)))}function Hg(){var e=Se.H;return Se.H=X0,e===null?X0:e}function Gg(){var e=Se.A;return Se.A=a4,e}function Eu(){it=4,Ya||(Re&4194048)!==Re&&Rr.current!==null||(Xs=!0),!(sn&134217727)&&!(jn&134217727)||Ke===null||Xa(Ke,Re,Dr,!1)}function Eo(e,t,r){var a=ze;ze|=2;var n=Hg(),s=Gg();(Ke!==e||Re!==t)&&($0=null,Ps(e,t)),t=!1;var i=it;e:do try{if(Pe!==0&&De!==null){var c=De,o=fr;switch(Pe){case 8:Mf(),i=6;break e;case 3:case 2:case 9:case 6:Rr.current===null&&(t=!0);var u=Pe;if(Pe=0,fr=null,gs(e,c,o,u),r&&Xs){i=0;break e}break;default:u=Pe,Pe=0,fr=null,gs(e,c,o,u)}}l4(),i=it;break}catch(f){zg(e,f)}while(1);return t&&e.shellSuspendCounter++,ha=Un=null,ze=a,Se.H=n,Se.A=s,De===null&&(Ke=null,Re=0,Mc()),i}function l4(){for(;De!==null;)Vg(De)}function i4(e,t){var r=ze;ze|=2;var a=Hg(),n=Gg();Ke!==e||Re!==t?($0=null,Z0=ta()+500,Ps(e,t)):Xs=hi(e,t);e:do try{if(Pe!==0&&De!==null){t=De;var s=fr;t:switch(Pe){case 1:Pe=0,fr=null,gs(e,t,s,1);break;case 2:case 9:if(Uh(s)){Pe=0,fr=null,u1(t);break}t=function(){Pe!==2&&Pe!==9||Ke!==e||(Pe=7),sa(e)},s.then(t,t);break e;case 3:Pe=7;break e;case 4:Pe=5;break e;case 7:Uh(s)?(Pe=0,fr=null,u1(t)):(Pe=0,fr=null,gs(e,t,s,7));break;case 5:var i=null;switch(De.tag){case 26:i=De.memoizedState;case 5:case 27:var c=De;if(!i||o2(i)){Pe=0,fr=null;var o=c.sibling;if(o!==null)De=o;else{var u=c.return;u!==null?(De=u,Bc(u)):De=null}break t}}Pe=0,fr=null,gs(e,t,s,5);break;case 6:Pe=0,fr=null,gs(e,t,s,6);break;case 8:Mf(),it=6;break e;default:throw Error(ce(462))}}c4();break}catch(f){zg(e,f)}while(1);return ha=Un=null,Se.H=a,Se.A=n,ze=r,De!==null?0:(Ke=null,Re=0,Mc(),it)}function c4(){for(;De!==null&&!kp();)Vg(De)}function Vg(e){var t=bg(e.alternate,e,Ea);e.memoizedProps=e.pendingProps,t===null?Bc(e):De=t}function u1(e){var t=e,r=t.alternate;switch(t.tag){case 15:case 0:t=a1(r,t,t.pendingProps,t.type,void 0,Re);break;case 11:t=a1(r,t,t.pendingProps,t.type.render,t.ref,Re);break;case 5:vf(t);default:wg(r,t),t=De=wm(t,Ea),t=bg(r,t,Ea)}e.memoizedProps=e.pendingProps,t===null?Bc(e):De=t}function gs(e,t,r,a){ha=Un=null,vf(t),Es=null,Kl=0;var n=t.return;try{if(Ky(e,n,t,r,Re)){it=1,Q0(e,Mr(r,e.current)),De=null;return}}catch(s){if(n!==null)throw De=n,s;it=1,Q0(e,Mr(r,e.current)),De=null;return}t.flags&32768?(Le||a===1?e=!0:Xs||Re&536870912?e=!1:(Ya=e=!0,(a===2||a===9||a===3||a===6)&&(a=Rr.current,a!==null&&a.tag===13&&(a.flags|=16384))),Yg(t,e)):Bc(t)}function Bc(e){var t=e;do{if(t.flags&32768){Yg(t,Ya);return}e=t.return;var r=$y(t.alternate,t,Ea);if(r!==null){De=r;return}if(t=t.sibling,t!==null){De=t;return}De=t=e}while(t!==null);it===0&&(it=5)}function Yg(e,t){do{var r=e4(e.alternate,e);if(r!==null){r.flags&=32767,De=r;return}if(r=e.return,r!==null&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!t&&(e=e.sibling,e!==null)){De=e;return}De=e=r}while(e!==null);it=6,De=null}function f1(e,t,r,a,n,s,i,c,o){e.cancelPendingCommit=null;do Pc();while(Ot!==0);if(ze&6)throw Error(ce(327));if(t!==null){if(t===e.current)throw Error(ce(177));if(s=t.lanes|t.childLanes,s|=af,Up(e,r,s,i,c,o),e===Ke&&(De=Ke=null,Re=0),Bs=t,$a=e,Ts=r,wu=s,Nu=n,Bg=a,t.subtreeFlags&10256||t.flags&10256?(e.callbackNode=null,e.callbackPriority=0,d4(L0,function(){return qg(),null})):(e.callbackNode=null,e.callbackPriority=0),a=(t.flags&13878)!==0,t.subtreeFlags&13878||a){a=Se.T,Se.T=null,n=Ie.p,Ie.p=2,i=ze,ze|=4;try{t4(e,t,r)}finally{ze=i,Ie.p=n,Se.T=a}}Ot=1,Xg(),Wg(),Jg()}}function Xg(){if(Ot===1){Ot=0;var e=$a,t=Bs,r=(t.flags&13878)!==0;if(t.subtreeFlags&13878||r){r=Se.T,Se.T=null;var a=Ie.p;Ie.p=2;var n=ze;ze|=4;try{Mg(t,e);var s=Au,i=hm(e.containerInfo),c=s.focusedElem,o=s.selectionRange;if(i!==c&&c&&c.ownerDocument&&dm(c.ownerDocument.documentElement,c)){if(o!==null&&rf(c)){var u=o.start,f=o.end;if(f===void 0&&(f=u),"selectionStart"in c)c.selectionStart=u,c.selectionEnd=Math.min(f,c.value.length);else{var h=c.ownerDocument||document,d=h&&h.defaultView||window;if(d.getSelection){var x=d.getSelection(),b=c.textContent.length,m=Math.min(o.start,b),w=o.end===void 0?m:Math.min(o.end,b);!x.extend&&m>w&&(i=w,w=m,m=i);var p=Dh(c,m),v=Dh(c,w);if(p&&v&&(x.rangeCount!==1||x.anchorNode!==p.node||x.anchorOffset!==p.offset||x.focusNode!==v.node||x.focusOffset!==v.offset)){var g=h.createRange();g.setStart(p.node,p.offset),x.removeAllRanges(),m>w?(x.addRange(g),x.extend(v.node,v.offset)):(g.setEnd(v.node,v.offset),x.addRange(g))}}}}for(h=[],x=c;x=x.parentNode;)x.nodeType===1&&h.push({element:x,left:x.scrollLeft,top:x.scrollTop});for(typeof c.focus=="function"&&c.focus(),c=0;c<h.length;c++){var N=h[c];N.element.scrollLeft=N.left,N.element.scrollTop=N.top}}ic=!!ju,Au=ju=null}finally{ze=n,Ie.p=a,Se.T=r}}e.current=t,Ot=2}}function Wg(){if(Ot===2){Ot=0;var e=$a,t=Bs,r=(t.flags&8772)!==0;if(t.subtreeFlags&8772||r){r=Se.T,Se.T=null;var a=Ie.p;Ie.p=2;var n=ze;ze|=4;try{jg(e,t.alternate,t)}finally{ze=n,Ie.p=a,Se.T=r}}Ot=3}}function Jg(){if(Ot===4||Ot===3){Ot=0,Mp();var e=$a,t=Bs,r=Ts,a=Bg;t.subtreeFlags&10256||t.flags&10256?Ot=5:(Ot=0,Bs=$a=null,Qg(e,e.pendingLanes));var n=e.pendingLanes;if(n===0&&(Za=null),Qu(r),t=t.stateNode,gr&&typeof gr.onCommitFiberRoot=="function")try{gr.onCommitFiberRoot(di,t,void 0,(t.current.flags&128)===128)}catch{}if(a!==null){t=Se.T,n=Ie.p,Ie.p=2,Se.T=null;try{for(var s=e.onRecoverableError,i=0;i<a.length;i++){var c=a[i];s(c.value,{componentStack:c.stack})}}finally{Se.T=t,Ie.p=n}}Ts&3&&Pc(),sa(e),n=e.pendingLanes,r&4194090&&n&42?e===Su?Ll++:(Ll=0,Su=e):Ll=0,Ei(0,!1)}}function Qg(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,yi(t)))}function Pc(e){return Xg(),Wg(),Jg(),qg()}function qg(){if(Ot!==5)return!1;var e=$a,t=wu;wu=0;var r=Qu(Ts),a=Se.T,n=Ie.p;try{Ie.p=32>r?32:r,Se.T=null,r=Nu,Nu=null;var s=$a,i=Ts;if(Ot=0,Bs=$a=null,Ts=0,ze&6)throw Error(ce(331));var c=ze;if(ze|=4,Lg(s.current),Rg(s,s.current,i,r),ze=c,Ei(0,!1),gr&&typeof gr.onPostCommitFiberRoot=="function")try{gr.onPostCommitFiberRoot(di,s)}catch{}return!0}finally{Ie.p=n,Se.T=a,Qg(e,t)}}function d1(e,t,r){t=Mr(r,t),t=gu(e.stateNode,t,2),e=Ka(e,t,2),e!==null&&(xi(e,2),sa(e))}function Je(e,t,r){if(e.tag===3)d1(e,e,r);else for(;t!==null;){if(t.tag===3){d1(t,e,r);break}else if(t.tag===1){var a=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof a.componentDidCatch=="function"&&(Za===null||!Za.has(a))){e=Mr(r,e),r=hg(2),a=Ka(t,r,2),a!==null&&(xg(r,a,t,e),xi(a,2),sa(a));break}}t=t.return}}function To(e,t,r){var a=e.pingCache;if(a===null){a=e.pingCache=new n4;var n=new Set;a.set(t,n)}else n=a.get(t),n===void 0&&(n=new Set,a.set(t,n));n.has(r)||(Af=!0,n.add(r),e=o4.bind(null,e,t,r),t.then(e,e))}function o4(e,t,r){var a=e.pingCache;a!==null&&a.delete(t),e.pingedLanes|=e.suspendedLanes&r,e.warmLanes&=~r,Ke===e&&(Re&r)===r&&(it===4||it===3&&(Re&62914560)===Re&&300>ta()-kf?!(ze&2)&&Ps(e,0):Cf|=r,Is===Re&&(Is=0)),sa(e)}function Kg(e,t){t===0&&(t=Xx()),e=Ys(e,t),e!==null&&(xi(e,t),sa(e))}function u4(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Kg(e,r)}function f4(e,t){var r=0;switch(e.tag){case 13:var a=e.stateNode,n=e.memoizedState;n!==null&&(r=n.retryLane);break;case 19:a=e.stateNode;break;case 22:a=e.stateNode._retryCache;break;default:throw Error(ce(314))}a!==null&&a.delete(t),Kg(e,r)}function d4(e,t){return Wu(e,t)}var ec=null,as=null,Tu=!1,tc=!1,_o=!1,An=0;function sa(e){e!==as&&e.next===null&&(as===null?ec=as=e:as=as.next=e),tc=!0,Tu||(Tu=!0,x4())}function Ei(e,t){if(!_o&&tc){_o=!0;do for(var r=!1,a=ec;a!==null;){if(!t)if(e!==0){var n=a.pendingLanes;if(n===0)var s=0;else{var i=a.suspendedLanes,c=a.pingedLanes;s=(1<<31-vr(42|e)+1)-1,s&=n&~(i&~c),s=s&201326741?s&201326741|1:s?s|2:0}s!==0&&(r=!0,h1(a,s))}else s=Re,s=jc(a,a===Ke?s:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),!(s&3)||hi(a,s)||(r=!0,h1(a,s));a=a.next}while(r);_o=!1}}function h4(){Zg()}function Zg(){tc=Tu=!1;var e=0;An!==0&&(N4()&&(e=An),An=0);for(var t=ta(),r=null,a=ec;a!==null;){var n=a.next,s=$g(a,t);s===0?(a.next=null,r===null?ec=n:r.next=n,n===null&&(as=r)):(r=a,(e!==0||s&3)&&(tc=!0)),a=n}Ei(e,!1)}function $g(e,t){for(var r=e.suspendedLanes,a=e.pingedLanes,n=e.expirationTimes,s=e.pendingLanes&-62914561;0<s;){var i=31-vr(s),c=1<<i,o=n[i];o===-1?(!(c&r)||c&a)&&(n[i]=Pp(c,t)):o<=t&&(e.expiredLanes|=c),s&=~c}if(t=Ke,r=Re,r=jc(e,e===t?r:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),a=e.callbackNode,r===0||e===t&&(Pe===2||Pe===9)||e.cancelPendingCommit!==null)return a!==null&&a!==null&&Kc(a),e.callbackNode=null,e.callbackPriority=0;if(!(r&3)||hi(e,r)){if(t=r&-r,t===e.callbackPriority)return t;switch(a!==null&&Kc(a),Qu(r)){case 2:case 8:r=Gx;break;case 32:r=L0;break;case 268435456:r=Vx;break;default:r=L0}return a=e2.bind(null,e),r=Wu(r,a),e.callbackPriority=t,e.callbackNode=r,t}return a!==null&&a!==null&&Kc(a),e.callbackPriority=2,e.callbackNode=null,2}function e2(e,t){if(Ot!==0&&Ot!==5)return e.callbackNode=null,e.callbackPriority=0,null;var r=e.callbackNode;if(Pc()&&e.callbackNode!==r)return null;var a=Re;return a=jc(e,e===Ke?a:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),a===0?null:(Ug(e,a,t),$g(e,ta()),e.callbackNode!=null&&e.callbackNode===r?e2.bind(null,e):null)}function h1(e,t){if(Pc())return null;Ug(e,t,!0)}function x4(){E4(function(){ze&6?Wu(Hx,h4):Zg()})}function Df(){return An===0&&(An=Yx()),An}function x1(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:b0(""+e)}function m1(e,t){var r=t.ownerDocument.createElement("input");return r.name=t.name,r.value=t.value,e.id&&r.setAttribute("form",e.id),t.parentNode.insertBefore(r,t),e=new FormData(e),r.parentNode.removeChild(r),e}function m4(e,t,r,a,n){if(t==="submit"&&r&&r.stateNode===n){var s=x1((n[tr]||null).action),i=a.submitter;i&&(t=(t=i[tr]||null)?x1(t.formAction):i.getAttribute("formAction"),t!==null&&(s=t,i=null));var c=new Ac("action","action",null,a,n);e.push({event:c,listeners:[{instance:null,listener:function(){if(a.defaultPrevented){if(An!==0){var o=i?m1(n,i):new FormData(n);xu(r,{pending:!0,data:o,method:n.method,action:s},null,o)}}else typeof s=="function"&&(c.preventDefault(),o=i?m1(n,i):new FormData(n),xu(r,{pending:!0,data:o,method:n.method,action:s},s,o))},currentTarget:n}]})}}for(var jo=0;jo<ru.length;jo++){var Ao=ru[jo],g4=Ao.toLowerCase(),v4=Ao[0].toUpperCase()+Ao.slice(1);Wr(g4,"on"+v4)}Wr(mm,"onAnimationEnd");Wr(gm,"onAnimationIteration");Wr(vm,"onAnimationStart");Wr("dblclick","onDoubleClick");Wr("focusin","onFocus");Wr("focusout","onBlur");Wr(Oy,"onTransitionRun");Wr(Fy,"onTransitionStart");Wr(Ly,"onTransitionCancel");Wr(pm,"onTransitionEnd");Ms("onMouseEnter",["mouseout","mouseover"]);Ms("onMouseLeave",["mouseout","mouseover"]);Ms("onPointerEnter",["pointerout","pointerover"]);Ms("onPointerLeave",["pointerout","pointerover"]);In("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));In("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));In("onBeforeInput",["compositionend","keypress","textInput","paste"]);In("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));In("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));In("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Zl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),p4=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Zl));function t2(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var a=e[r],n=a.event;a=a.listeners;e:{var s=void 0;if(t)for(var i=a.length-1;0<=i;i--){var c=a[i],o=c.instance,u=c.currentTarget;if(c=c.listener,o!==s&&n.isPropagationStopped())break e;s=c,n.currentTarget=u;try{s(n)}catch(f){J0(f)}n.currentTarget=null,s=o}else for(i=0;i<a.length;i++){if(c=a[i],o=c.instance,u=c.currentTarget,c=c.listener,o!==s&&n.isPropagationStopped())break e;s=c,n.currentTarget=u;try{s(n)}catch(f){J0(f)}n.currentTarget=null,s=o}}}}function Me(e,t){var r=t[Qo];r===void 0&&(r=t[Qo]=new Set);var a=e+"__bubble";r.has(a)||(r2(t,e,2,!1),r.add(a))}function Co(e,t,r){var a=0;t&&(a|=4),r2(r,e,a,t)}var i0="_reactListening"+Math.random().toString(36).slice(2);function Rf(e){if(!e[i0]){e[i0]=!0,qx.forEach(function(r){r!=="selectionchange"&&(p4.has(r)||Co(r,!1,e),Co(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[i0]||(t[i0]=!0,Co("selectionchange",!1,t))}}function r2(e,t,r,a){switch(x2(t)){case 2:var n=Y4;break;case 8:n=X4;break;default:n=If}r=n.bind(null,t,r,e),n=void 0,!$o||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(n=!0),a?n!==void 0?e.addEventListener(t,r,{capture:!0,passive:n}):e.addEventListener(t,r,!0):n!==void 0?e.addEventListener(t,r,{passive:n}):e.addEventListener(t,r,!1)}function ko(e,t,r,a,n){var s=a;if(!(t&1)&&!(t&2)&&a!==null)e:for(;;){if(a===null)return;var i=a.tag;if(i===3||i===4){var c=a.stateNode.containerInfo;if(c===n)break;if(i===4)for(i=a.return;i!==null;){var o=i.tag;if((o===3||o===4)&&i.stateNode.containerInfo===n)return;i=i.return}for(;c!==null;){if(i=is(c),i===null)return;if(o=i.tag,o===5||o===6||o===26||o===27){a=s=i;continue e}c=c.parentNode}}a=a.return}nm(function(){var u=s,f=Zu(r),h=[];e:{var d=ym.get(e);if(d!==void 0){var x=Ac,b=e;switch(e){case"keypress":if(N0(r)===0)break e;case"keydown":case"keyup":x=dy;break;case"focusin":b="focus",x=so;break;case"focusout":b="blur",x=so;break;case"beforeblur":case"afterblur":x=so;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=Nh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=ey;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=my;break;case mm:case gm:case vm:x=ay;break;case pm:x=vy;break;case"scroll":case"scrollend":x=Zp;break;case"wheel":x=yy;break;case"copy":case"cut":case"paste":x=sy;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=Eh;break;case"toggle":case"beforetoggle":x=wy}var m=(t&4)!==0,w=!m&&(e==="scroll"||e==="scrollend"),p=m?d!==null?d+"Capture":null:d;m=[];for(var v=u,g;v!==null;){var N=v;if(g=N.stateNode,N=N.tag,N!==5&&N!==26&&N!==27||g===null||p===null||(N=Xl(v,p),N!=null&&m.push($l(v,N,g))),w)break;v=v.return}0<m.length&&(d=new x(d,b,null,r,f),h.push({event:d,listeners:m}))}}if(!(t&7)){e:{if(d=e==="mouseover"||e==="pointerover",x=e==="mouseout"||e==="pointerout",d&&r!==Zo&&(b=r.relatedTarget||r.fromElement)&&(is(b)||b[Gs]))break e;if((x||d)&&(d=f.window===f?f:(d=f.ownerDocument)?d.defaultView||d.parentWindow:window,x?(b=r.relatedTarget||r.toElement,x=u,b=b?is(b):null,b!==null&&(w=fi(b),m=b.tag,b!==w||m!==5&&m!==27&&m!==6)&&(b=null)):(x=null,b=u),x!==b)){if(m=Nh,N="onMouseLeave",p="onMouseEnter",v="mouse",(e==="pointerout"||e==="pointerover")&&(m=Eh,N="onPointerLeave",p="onPointerEnter",v="pointer"),w=x==null?d:bl(x),g=b==null?d:bl(b),d=new m(N,v+"leave",x,r,f),d.target=w,d.relatedTarget=g,N=null,is(f)===u&&(m=new m(p,v+"enter",b,r,f),m.target=g,m.relatedTarget=w,N=m),w=N,x&&b)t:{for(m=x,p=b,v=0,g=m;g;g=Qn(g))v++;for(g=0,N=p;N;N=Qn(N))g++;for(;0<v-g;)m=Qn(m),v--;for(;0<g-v;)p=Qn(p),g--;for(;v--;){if(m===p||p!==null&&m===p.alternate)break t;m=Qn(m),p=Qn(p)}m=null}else m=null;x!==null&&g1(h,d,x,m,!1),b!==null&&w!==null&&g1(h,w,b,m,!0)}}e:{if(d=u?bl(u):window,x=d.nodeName&&d.nodeName.toLowerCase(),x==="select"||x==="input"&&d.type==="file")var I=Ah;else if(jh(d))if(um)I=My;else{I=Cy;var z=Ay}else x=d.nodeName,!x||x.toLowerCase()!=="input"||d.type!=="checkbox"&&d.type!=="radio"?u&&Ku(u.elementType)&&(I=Ah):I=ky;if(I&&(I=I(e,u))){om(h,I,r,f);break e}z&&z(e,d,u),e==="focusout"&&u&&d.type==="number"&&u.memoizedProps.value!=null&&Ko(d,"number",d.value)}switch(z=u?bl(u):window,e){case"focusin":(jh(z)||z.contentEditable==="true")&&(us=z,eu=u,_l=null);break;case"focusout":_l=eu=us=null;break;case"mousedown":tu=!0;break;case"contextmenu":case"mouseup":case"dragend":tu=!1,Rh(h,r,f);break;case"selectionchange":if(Ry)break;case"keydown":case"keyup":Rh(h,r,f)}var j;if(tf)e:{switch(e){case"compositionstart":var B="onCompositionStart";break e;case"compositionend":B="onCompositionEnd";break e;case"compositionupdate":B="onCompositionUpdate";break e}B=void 0}else os?im(e,r)&&(B="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(B="onCompositionStart");B&&(lm&&r.locale!=="ko"&&(os||B!=="onCompositionStart"?B==="onCompositionEnd"&&os&&(j=sm()):(Va=f,$u="value"in Va?Va.value:Va.textContent,os=!0)),z=rc(u,B),0<z.length&&(B=new Sh(B,e,null,r,f),h.push({event:B,listeners:z}),j?B.data=j:(j=cm(r),j!==null&&(B.data=j)))),(j=Sy?Ey(e,r):Ty(e,r))&&(B=rc(u,"onBeforeInput"),0<B.length&&(z=new Sh("onBeforeInput","beforeinput",null,r,f),h.push({event:z,listeners:B}),z.data=j)),m4(h,e,u,r,f)}t2(h,t)})}function $l(e,t,r){return{instance:e,listener:t,currentTarget:r}}function rc(e,t){for(var r=t+"Capture",a=[];e!==null;){var n=e,s=n.stateNode;if(n=n.tag,n!==5&&n!==26&&n!==27||s===null||(n=Xl(e,r),n!=null&&a.unshift($l(e,n,s)),n=Xl(e,t),n!=null&&a.push($l(e,n,s))),e.tag===3)return a;e=e.return}return[]}function Qn(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function g1(e,t,r,a,n){for(var s=t._reactName,i=[];r!==null&&r!==a;){var c=r,o=c.alternate,u=c.stateNode;if(c=c.tag,o!==null&&o===a)break;c!==5&&c!==26&&c!==27||u===null||(o=u,n?(u=Xl(r,s),u!=null&&i.unshift($l(r,u,o))):n||(u=Xl(r,s),u!=null&&i.push($l(r,u,o)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var y4=/\r\n?/g,b4=/\u0000|\uFFFD/g;function v1(e){return(typeof e=="string"?e:""+e).replace(y4,`
`).replace(b4,"")}function a2(e,t){return t=v1(t),v1(e)===t}function Uc(){}function Ve(e,t,r,a,n,s){switch(r){case"children":typeof a=="string"?t==="body"||t==="textarea"&&a===""||Ds(e,a):(typeof a=="number"||typeof a=="bigint")&&t!=="body"&&Ds(e,""+a);break;case"className":e0(e,"class",a);break;case"tabIndex":e0(e,"tabindex",a);break;case"dir":case"role":case"viewBox":case"width":case"height":e0(e,r,a);break;case"style":am(e,a,s);break;case"data":if(t!=="object"){e0(e,"data",a);break}case"src":case"href":if(a===""&&(t!=="a"||r!=="href")){e.removeAttribute(r);break}if(a==null||typeof a=="function"||typeof a=="symbol"||typeof a=="boolean"){e.removeAttribute(r);break}a=b0(""+a),e.setAttribute(r,a);break;case"action":case"formAction":if(typeof a=="function"){e.setAttribute(r,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof s=="function"&&(r==="formAction"?(t!=="input"&&Ve(e,t,"name",n.name,n,null),Ve(e,t,"formEncType",n.formEncType,n,null),Ve(e,t,"formMethod",n.formMethod,n,null),Ve(e,t,"formTarget",n.formTarget,n,null)):(Ve(e,t,"encType",n.encType,n,null),Ve(e,t,"method",n.method,n,null),Ve(e,t,"target",n.target,n,null)));if(a==null||typeof a=="symbol"||typeof a=="boolean"){e.removeAttribute(r);break}a=b0(""+a),e.setAttribute(r,a);break;case"onClick":a!=null&&(e.onclick=Uc);break;case"onScroll":a!=null&&Me("scroll",e);break;case"onScrollEnd":a!=null&&Me("scrollend",e);break;case"dangerouslySetInnerHTML":if(a!=null){if(typeof a!="object"||!("__html"in a))throw Error(ce(61));if(r=a.__html,r!=null){if(n.children!=null)throw Error(ce(60));e.innerHTML=r}}break;case"multiple":e.multiple=a&&typeof a!="function"&&typeof a!="symbol";break;case"muted":e.muted=a&&typeof a!="function"&&typeof a!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(a==null||typeof a=="function"||typeof a=="boolean"||typeof a=="symbol"){e.removeAttribute("xlink:href");break}r=b0(""+a),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":a!=null&&typeof a!="function"&&typeof a!="symbol"?e.setAttribute(r,""+a):e.removeAttribute(r);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":a&&typeof a!="function"&&typeof a!="symbol"?e.setAttribute(r,""):e.removeAttribute(r);break;case"capture":case"download":a===!0?e.setAttribute(r,""):a!==!1&&a!=null&&typeof a!="function"&&typeof a!="symbol"?e.setAttribute(r,a):e.removeAttribute(r);break;case"cols":case"rows":case"size":case"span":a!=null&&typeof a!="function"&&typeof a!="symbol"&&!isNaN(a)&&1<=a?e.setAttribute(r,a):e.removeAttribute(r);break;case"rowSpan":case"start":a==null||typeof a=="function"||typeof a=="symbol"||isNaN(a)?e.removeAttribute(r):e.setAttribute(r,a);break;case"popover":Me("beforetoggle",e),Me("toggle",e),y0(e,"popover",a);break;case"xlinkActuate":la(e,"http://www.w3.org/1999/xlink","xlink:actuate",a);break;case"xlinkArcrole":la(e,"http://www.w3.org/1999/xlink","xlink:arcrole",a);break;case"xlinkRole":la(e,"http://www.w3.org/1999/xlink","xlink:role",a);break;case"xlinkShow":la(e,"http://www.w3.org/1999/xlink","xlink:show",a);break;case"xlinkTitle":la(e,"http://www.w3.org/1999/xlink","xlink:title",a);break;case"xlinkType":la(e,"http://www.w3.org/1999/xlink","xlink:type",a);break;case"xmlBase":la(e,"http://www.w3.org/XML/1998/namespace","xml:base",a);break;case"xmlLang":la(e,"http://www.w3.org/XML/1998/namespace","xml:lang",a);break;case"xmlSpace":la(e,"http://www.w3.org/XML/1998/namespace","xml:space",a);break;case"is":y0(e,"is",a);break;case"innerText":case"textContent":break;default:(!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(r=qp.get(r)||r,y0(e,r,a))}}function _u(e,t,r,a,n,s){switch(r){case"style":am(e,a,s);break;case"dangerouslySetInnerHTML":if(a!=null){if(typeof a!="object"||!("__html"in a))throw Error(ce(61));if(r=a.__html,r!=null){if(n.children!=null)throw Error(ce(60));e.innerHTML=r}}break;case"children":typeof a=="string"?Ds(e,a):(typeof a=="number"||typeof a=="bigint")&&Ds(e,""+a);break;case"onScroll":a!=null&&Me("scroll",e);break;case"onScrollEnd":a!=null&&Me("scrollend",e);break;case"onClick":a!=null&&(e.onclick=Uc);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Kx.hasOwnProperty(r))e:{if(r[0]==="o"&&r[1]==="n"&&(n=r.endsWith("Capture"),t=r.slice(2,n?r.length-7:void 0),s=e[tr]||null,s=s!=null?s[r]:null,typeof s=="function"&&e.removeEventListener(t,s,n),typeof a=="function")){typeof s!="function"&&s!==null&&(r in e?e[r]=null:e.hasAttribute(r)&&e.removeAttribute(r)),e.addEventListener(t,a,n);break e}r in e?e[r]=a:a===!0?e.setAttribute(r,""):y0(e,r,a)}}}function It(e,t,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Me("error",e),Me("load",e);var a=!1,n=!1,s;for(s in r)if(r.hasOwnProperty(s)){var i=r[s];if(i!=null)switch(s){case"src":a=!0;break;case"srcSet":n=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(ce(137,t));default:Ve(e,t,s,i,r,null)}}n&&Ve(e,t,"srcSet",r.srcSet,r,null),a&&Ve(e,t,"src",r.src,r,null);return;case"input":Me("invalid",e);var c=s=i=n=null,o=null,u=null;for(a in r)if(r.hasOwnProperty(a)){var f=r[a];if(f!=null)switch(a){case"name":n=f;break;case"type":i=f;break;case"checked":o=f;break;case"defaultChecked":u=f;break;case"value":s=f;break;case"defaultValue":c=f;break;case"children":case"dangerouslySetInnerHTML":if(f!=null)throw Error(ce(137,t));break;default:Ve(e,t,a,f,r,null)}}em(e,s,c,o,u,i,n,!1),I0(e);return;case"select":Me("invalid",e),a=i=s=null;for(n in r)if(r.hasOwnProperty(n)&&(c=r[n],c!=null))switch(n){case"value":s=c;break;case"defaultValue":i=c;break;case"multiple":a=c;default:Ve(e,t,n,c,r,null)}t=s,r=i,e.multiple=!!a,t!=null?ys(e,!!a,t,!1):r!=null&&ys(e,!!a,r,!0);return;case"textarea":Me("invalid",e),s=n=a=null;for(i in r)if(r.hasOwnProperty(i)&&(c=r[i],c!=null))switch(i){case"value":a=c;break;case"defaultValue":n=c;break;case"children":s=c;break;case"dangerouslySetInnerHTML":if(c!=null)throw Error(ce(91));break;default:Ve(e,t,i,c,r,null)}rm(e,a,n,s),I0(e);return;case"option":for(o in r)if(r.hasOwnProperty(o)&&(a=r[o],a!=null))switch(o){case"selected":e.selected=a&&typeof a!="function"&&typeof a!="symbol";break;default:Ve(e,t,o,a,r,null)}return;case"dialog":Me("beforetoggle",e),Me("toggle",e),Me("cancel",e),Me("close",e);break;case"iframe":case"object":Me("load",e);break;case"video":case"audio":for(a=0;a<Zl.length;a++)Me(Zl[a],e);break;case"image":Me("error",e),Me("load",e);break;case"details":Me("toggle",e);break;case"embed":case"source":case"link":Me("error",e),Me("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in r)if(r.hasOwnProperty(u)&&(a=r[u],a!=null))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(ce(137,t));default:Ve(e,t,u,a,r,null)}return;default:if(Ku(t)){for(f in r)r.hasOwnProperty(f)&&(a=r[f],a!==void 0&&_u(e,t,f,a,r,void 0));return}}for(c in r)r.hasOwnProperty(c)&&(a=r[c],a!=null&&Ve(e,t,c,a,r,null))}function w4(e,t,r,a){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var n=null,s=null,i=null,c=null,o=null,u=null,f=null;for(x in r){var h=r[x];if(r.hasOwnProperty(x)&&h!=null)switch(x){case"checked":break;case"value":break;case"defaultValue":o=h;default:a.hasOwnProperty(x)||Ve(e,t,x,null,a,h)}}for(var d in a){var x=a[d];if(h=r[d],a.hasOwnProperty(d)&&(x!=null||h!=null))switch(d){case"type":s=x;break;case"name":n=x;break;case"checked":u=x;break;case"defaultChecked":f=x;break;case"value":i=x;break;case"defaultValue":c=x;break;case"children":case"dangerouslySetInnerHTML":if(x!=null)throw Error(ce(137,t));break;default:x!==h&&Ve(e,t,d,x,a,h)}}qo(e,i,c,o,u,f,s,n);return;case"select":x=i=c=d=null;for(s in r)if(o=r[s],r.hasOwnProperty(s)&&o!=null)switch(s){case"value":break;case"multiple":x=o;default:a.hasOwnProperty(s)||Ve(e,t,s,null,a,o)}for(n in a)if(s=a[n],o=r[n],a.hasOwnProperty(n)&&(s!=null||o!=null))switch(n){case"value":d=s;break;case"defaultValue":c=s;break;case"multiple":i=s;default:s!==o&&Ve(e,t,n,s,a,o)}t=c,r=i,a=x,d!=null?ys(e,!!r,d,!1):!!a!=!!r&&(t!=null?ys(e,!!r,t,!0):ys(e,!!r,r?[]:"",!1));return;case"textarea":x=d=null;for(c in r)if(n=r[c],r.hasOwnProperty(c)&&n!=null&&!a.hasOwnProperty(c))switch(c){case"value":break;case"children":break;default:Ve(e,t,c,null,a,n)}for(i in a)if(n=a[i],s=r[i],a.hasOwnProperty(i)&&(n!=null||s!=null))switch(i){case"value":d=n;break;case"defaultValue":x=n;break;case"children":break;case"dangerouslySetInnerHTML":if(n!=null)throw Error(ce(91));break;default:n!==s&&Ve(e,t,i,n,a,s)}tm(e,d,x);return;case"option":for(var b in r)if(d=r[b],r.hasOwnProperty(b)&&d!=null&&!a.hasOwnProperty(b))switch(b){case"selected":e.selected=!1;break;default:Ve(e,t,b,null,a,d)}for(o in a)if(d=a[o],x=r[o],a.hasOwnProperty(o)&&d!==x&&(d!=null||x!=null))switch(o){case"selected":e.selected=d&&typeof d!="function"&&typeof d!="symbol";break;default:Ve(e,t,o,d,a,x)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var m in r)d=r[m],r.hasOwnProperty(m)&&d!=null&&!a.hasOwnProperty(m)&&Ve(e,t,m,null,a,d);for(u in a)if(d=a[u],x=r[u],a.hasOwnProperty(u)&&d!==x&&(d!=null||x!=null))switch(u){case"children":case"dangerouslySetInnerHTML":if(d!=null)throw Error(ce(137,t));break;default:Ve(e,t,u,d,a,x)}return;default:if(Ku(t)){for(var w in r)d=r[w],r.hasOwnProperty(w)&&d!==void 0&&!a.hasOwnProperty(w)&&_u(e,t,w,void 0,a,d);for(f in a)d=a[f],x=r[f],!a.hasOwnProperty(f)||d===x||d===void 0&&x===void 0||_u(e,t,f,d,a,x);return}}for(var p in r)d=r[p],r.hasOwnProperty(p)&&d!=null&&!a.hasOwnProperty(p)&&Ve(e,t,p,null,a,d);for(h in a)d=a[h],x=r[h],!a.hasOwnProperty(h)||d===x||d==null&&x==null||Ve(e,t,h,d,a,x)}var ju=null,Au=null;function ac(e){return e.nodeType===9?e:e.ownerDocument}function p1(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function n2(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function Cu(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Mo=null;function N4(){var e=window.event;return e&&e.type==="popstate"?e===Mo?!1:(Mo=e,!0):(Mo=null,!1)}var s2=typeof setTimeout=="function"?setTimeout:void 0,S4=typeof clearTimeout=="function"?clearTimeout:void 0,y1=typeof Promise=="function"?Promise:void 0,E4=typeof queueMicrotask=="function"?queueMicrotask:typeof y1<"u"?function(e){return y1.resolve(null).then(e).catch(T4)}:s2;function T4(e){setTimeout(function(){throw e})}function fn(e){return e==="head"}function b1(e,t){var r=t,a=0,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(0<a&&8>a){r=a;var i=e.ownerDocument;if(r&1&&Il(i.documentElement),r&2&&Il(i.body),r&4)for(r=i.head,Il(r),i=r.firstChild;i;){var c=i.nextSibling,o=i.nodeName;i[mi]||o==="SCRIPT"||o==="STYLE"||o==="LINK"&&i.rel.toLowerCase()==="stylesheet"||r.removeChild(i),i=c}}if(n===0){e.removeChild(s),ni(t);return}n--}else r==="$"||r==="$?"||r==="$!"?n++:a=r.charCodeAt(0)-48;else a=0;r=s}while(r);ni(t)}function ku(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var r=t;switch(t=t.nextSibling,r.nodeName){case"HTML":case"HEAD":case"BODY":ku(r),qu(r);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(r.rel.toLowerCase()==="stylesheet")continue}e.removeChild(r)}}function _4(e,t,r,a){for(;e.nodeType===1;){var n=r;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!a&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(a){if(!e[mi])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(s=e.getAttribute("rel"),s==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(s!==n.rel||e.getAttribute("href")!==(n.href==null||n.href===""?null:n.href)||e.getAttribute("crossorigin")!==(n.crossOrigin==null?null:n.crossOrigin)||e.getAttribute("title")!==(n.title==null?null:n.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(s=e.getAttribute("src"),(s!==(n.src==null?null:n.src)||e.getAttribute("type")!==(n.type==null?null:n.type)||e.getAttribute("crossorigin")!==(n.crossOrigin==null?null:n.crossOrigin))&&s&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var s=n.name==null?null:""+n.name;if(n.type==="hidden"&&e.getAttribute("name")===s)return e}else return e;if(e=Yr(e.nextSibling),e===null)break}return null}function j4(e,t,r){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!r||(e=Yr(e.nextSibling),e===null))return null;return e}function Mu(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState==="complete"}function A4(e,t){var r=e.ownerDocument;if(e.data!=="$?"||r.readyState==="complete")t();else{var a=function(){t(),r.removeEventListener("DOMContentLoaded",a)};r.addEventListener("DOMContentLoaded",a),e._reactRetry=a}}function Yr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="F!"||t==="F")break;if(t==="/$")return null}}return e}var Du=null;function w1(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}function l2(e,t,r){switch(t=ac(r),e){case"html":if(e=t.documentElement,!e)throw Error(ce(452));return e;case"head":if(e=t.head,!e)throw Error(ce(453));return e;case"body":if(e=t.body,!e)throw Error(ce(454));return e;default:throw Error(ce(451))}}function Il(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);qu(e)}var Or=new Map,N1=new Set;function nc(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var ja=Ie.d;Ie.d={f:C4,r:k4,D:M4,C:D4,L:R4,m:O4,X:L4,S:F4,M:I4};function C4(){var e=ja.f(),t=Ic();return e||t}function k4(e){var t=Vs(e);t!==null&&t.tag===5&&t.type==="form"?$m(t):ja.r(e)}var Ws=typeof document>"u"?null:document;function i2(e,t,r){var a=Ws;if(a&&typeof t=="string"&&t){var n=kr(t);n='link[rel="'+e+'"][href="'+n+'"]',typeof r=="string"&&(n+='[crossorigin="'+r+'"]'),N1.has(n)||(N1.add(n),e={rel:e,crossOrigin:r,href:t},a.querySelector(n)===null&&(t=a.createElement("link"),It(t,"link",e),Tt(t),a.head.appendChild(t)))}}function M4(e){ja.D(e),i2("dns-prefetch",e,null)}function D4(e,t){ja.C(e,t),i2("preconnect",e,t)}function R4(e,t,r){ja.L(e,t,r);var a=Ws;if(a&&e&&t){var n='link[rel="preload"][as="'+kr(t)+'"]';t==="image"&&r&&r.imageSrcSet?(n+='[imagesrcset="'+kr(r.imageSrcSet)+'"]',typeof r.imageSizes=="string"&&(n+='[imagesizes="'+kr(r.imageSizes)+'"]')):n+='[href="'+kr(e)+'"]';var s=n;switch(t){case"style":s=Us(e);break;case"script":s=Js(e)}Or.has(s)||(e=$e({rel:"preload",href:t==="image"&&r&&r.imageSrcSet?void 0:e,as:t},r),Or.set(s,e),a.querySelector(n)!==null||t==="style"&&a.querySelector(Ti(s))||t==="script"&&a.querySelector(_i(s))||(t=a.createElement("link"),It(t,"link",e),Tt(t),a.head.appendChild(t)))}}function O4(e,t){ja.m(e,t);var r=Ws;if(r&&e){var a=t&&typeof t.as=="string"?t.as:"script",n='link[rel="modulepreload"][as="'+kr(a)+'"][href="'+kr(e)+'"]',s=n;switch(a){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":s=Js(e)}if(!Or.has(s)&&(e=$e({rel:"modulepreload",href:e},t),Or.set(s,e),r.querySelector(n)===null)){switch(a){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(r.querySelector(_i(s)))return}a=r.createElement("link"),It(a,"link",e),Tt(a),r.head.appendChild(a)}}}function F4(e,t,r){ja.S(e,t,r);var a=Ws;if(a&&e){var n=ps(a).hoistableStyles,s=Us(e);t=t||"default";var i=n.get(s);if(!i){var c={loading:0,preload:null};if(i=a.querySelector(Ti(s)))c.loading=5;else{e=$e({rel:"stylesheet",href:e,"data-precedence":t},r),(r=Or.get(s))&&Of(e,r);var o=i=a.createElement("link");Tt(o),It(o,"link",e),o._p=new Promise(function(u,f){o.onload=u,o.onerror=f}),o.addEventListener("load",function(){c.loading|=1}),o.addEventListener("error",function(){c.loading|=2}),c.loading|=4,C0(i,t,a)}i={type:"stylesheet",instance:i,count:1,state:c},n.set(s,i)}}}function L4(e,t){ja.X(e,t);var r=Ws;if(r&&e){var a=ps(r).hoistableScripts,n=Js(e),s=a.get(n);s||(s=r.querySelector(_i(n)),s||(e=$e({src:e,async:!0},t),(t=Or.get(n))&&Ff(e,t),s=r.createElement("script"),Tt(s),It(s,"link",e),r.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},a.set(n,s))}}function I4(e,t){ja.M(e,t);var r=Ws;if(r&&e){var a=ps(r).hoistableScripts,n=Js(e),s=a.get(n);s||(s=r.querySelector(_i(n)),s||(e=$e({src:e,async:!0,type:"module"},t),(t=Or.get(n))&&Ff(e,t),s=r.createElement("script"),Tt(s),It(s,"link",e),r.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},a.set(n,s))}}function S1(e,t,r,a){var n=(n=Qa.current)?nc(n):null;if(!n)throw Error(ce(446));switch(e){case"meta":case"title":return null;case"style":return typeof r.precedence=="string"&&typeof r.href=="string"?(t=Us(r.href),r=ps(n).hoistableStyles,a=r.get(t),a||(a={type:"style",instance:null,count:0,state:null},r.set(t,a)),a):{type:"void",instance:null,count:0,state:null};case"link":if(r.rel==="stylesheet"&&typeof r.href=="string"&&typeof r.precedence=="string"){e=Us(r.href);var s=ps(n).hoistableStyles,i=s.get(e);if(i||(n=n.ownerDocument||n,i={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},s.set(e,i),(s=n.querySelector(Ti(e)))&&!s._p&&(i.instance=s,i.state.loading=5),Or.has(e)||(r={rel:"preload",as:"style",href:r.href,crossOrigin:r.crossOrigin,integrity:r.integrity,media:r.media,hrefLang:r.hrefLang,referrerPolicy:r.referrerPolicy},Or.set(e,r),s||B4(n,e,r,i.state))),t&&a===null)throw Error(ce(528,""));return i}if(t&&a!==null)throw Error(ce(529,""));return null;case"script":return t=r.async,r=r.src,typeof r=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Js(r),r=ps(n).hoistableScripts,a=r.get(t),a||(a={type:"script",instance:null,count:0,state:null},r.set(t,a)),a):{type:"void",instance:null,count:0,state:null};default:throw Error(ce(444,e))}}function Us(e){return'href="'+kr(e)+'"'}function Ti(e){return'link[rel="stylesheet"]['+e+"]"}function c2(e){return $e({},e,{"data-precedence":e.precedence,precedence:null})}function B4(e,t,r,a){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?a.loading=1:(t=e.createElement("link"),a.preload=t,t.addEventListener("load",function(){return a.loading|=1}),t.addEventListener("error",function(){return a.loading|=2}),It(t,"link",r),Tt(t),e.head.appendChild(t))}function Js(e){return'[src="'+kr(e)+'"]'}function _i(e){return"script[async]"+e}function E1(e,t,r){if(t.count++,t.instance===null)switch(t.type){case"style":var a=e.querySelector('style[data-href~="'+kr(r.href)+'"]');if(a)return t.instance=a,Tt(a),a;var n=$e({},r,{"data-href":r.href,"data-precedence":r.precedence,href:null,precedence:null});return a=(e.ownerDocument||e).createElement("style"),Tt(a),It(a,"style",n),C0(a,r.precedence,e),t.instance=a;case"stylesheet":n=Us(r.href);var s=e.querySelector(Ti(n));if(s)return t.state.loading|=4,t.instance=s,Tt(s),s;a=c2(r),(n=Or.get(n))&&Of(a,n),s=(e.ownerDocument||e).createElement("link"),Tt(s);var i=s;return i._p=new Promise(function(c,o){i.onload=c,i.onerror=o}),It(s,"link",a),t.state.loading|=4,C0(s,r.precedence,e),t.instance=s;case"script":return s=Js(r.src),(n=e.querySelector(_i(s)))?(t.instance=n,Tt(n),n):(a=r,(n=Or.get(s))&&(a=$e({},r),Ff(a,n)),e=e.ownerDocument||e,n=e.createElement("script"),Tt(n),It(n,"link",a),e.head.appendChild(n),t.instance=n);case"void":return null;default:throw Error(ce(443,t.type))}else t.type==="stylesheet"&&!(t.state.loading&4)&&(a=t.instance,t.state.loading|=4,C0(a,r.precedence,e));return t.instance}function C0(e,t,r){for(var a=r.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),n=a.length?a[a.length-1]:null,s=n,i=0;i<a.length;i++){var c=a[i];if(c.dataset.precedence===t)s=c;else if(s!==n)break}s?s.parentNode.insertBefore(e,s.nextSibling):(t=r.nodeType===9?r.head:r,t.insertBefore(e,t.firstChild))}function Of(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Ff(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var k0=null;function T1(e,t,r){if(k0===null){var a=new Map,n=k0=new Map;n.set(r,a)}else n=k0,a=n.get(r),a||(a=new Map,n.set(r,a));if(a.has(e))return a;for(a.set(e,null),r=r.getElementsByTagName(e),n=0;n<r.length;n++){var s=r[n];if(!(s[mi]||s[zt]||e==="link"&&s.getAttribute("rel")==="stylesheet")&&s.namespaceURI!=="http://www.w3.org/2000/svg"){var i=s.getAttribute(t)||"";i=e+i;var c=a.get(i);c?c.push(s):a.set(i,[s])}}return a}function _1(e,t,r){e=e.ownerDocument||e,e.head.insertBefore(r,t==="title"?e.querySelector("head > title"):null)}function P4(e,t,r){if(r===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function o2(e){return!(e.type==="stylesheet"&&!(e.state.loading&3))}var ei=null;function U4(){}function z4(e,t,r){if(ei===null)throw Error(ce(475));var a=ei;if(t.type==="stylesheet"&&(typeof r.media!="string"||matchMedia(r.media).matches!==!1)&&!(t.state.loading&4)){if(t.instance===null){var n=Us(r.href),s=e.querySelector(Ti(n));if(s){e=s._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(a.count++,a=sc.bind(a),e.then(a,a)),t.state.loading|=4,t.instance=s,Tt(s);return}s=e.ownerDocument||e,r=c2(r),(n=Or.get(n))&&Of(r,n),s=s.createElement("link"),Tt(s);var i=s;i._p=new Promise(function(c,o){i.onload=c,i.onerror=o}),It(s,"link",r),t.instance=s}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(t,e),(e=t.state.preload)&&!(t.state.loading&3)&&(a.count++,t=sc.bind(a),e.addEventListener("load",t),e.addEventListener("error",t))}}function H4(){if(ei===null)throw Error(ce(475));var e=ei;return e.stylesheets&&e.count===0&&Ru(e,e.stylesheets),0<e.count?function(t){var r=setTimeout(function(){if(e.stylesheets&&Ru(e,e.stylesheets),e.unsuspend){var a=e.unsuspend;e.unsuspend=null,a()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(r)}}:null}function sc(){if(this.count--,this.count===0){if(this.stylesheets)Ru(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var lc=null;function Ru(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,lc=new Map,t.forEach(G4,e),lc=null,sc.call(e))}function G4(e,t){if(!(t.state.loading&4)){var r=lc.get(e);if(r)var a=r.get(null);else{r=new Map,lc.set(e,r);for(var n=e.querySelectorAll("link[data-precedence],style[data-precedence]"),s=0;s<n.length;s++){var i=n[s];(i.nodeName==="LINK"||i.getAttribute("media")!=="not all")&&(r.set(i.dataset.precedence,i),a=i)}a&&r.set(null,a)}n=t.instance,i=n.getAttribute("data-precedence"),s=r.get(i)||a,s===a&&r.set(null,n),r.set(i,n),this.count++,a=sc.bind(this),n.addEventListener("load",a),n.addEventListener("error",a),s?s.parentNode.insertBefore(n,s.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(n,e.firstChild)),t.state.loading|=4}}var ti={$$typeof:ua,Provider:null,Consumer:null,_currentValue:Nn,_currentValue2:Nn,_threadCount:0};function V4(e,t,r,a,n,s,i,c){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Zc(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Zc(0),this.hiddenUpdates=Zc(null),this.identifierPrefix=a,this.onUncaughtError=n,this.onCaughtError=s,this.onRecoverableError=i,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=c,this.incompleteTransitions=new Map}function u2(e,t,r,a,n,s,i,c,o,u,f,h){return e=new V4(e,t,r,i,c,o,u,h),t=1,s===!0&&(t|=24),s=mr(3,null,null,t),e.current=s,s.stateNode=e,t=of(),t.refCount++,e.pooledCache=t,t.refCount++,s.memoizedState={element:a,isDehydrated:r,cache:t},ff(s),e}function f2(e){return e?(e=hs,e):hs}function d2(e,t,r,a,n,s){n=f2(n),a.context===null?a.context=n:a.pendingContext=n,a=qa(t),a.payload={element:r},s=s===void 0?null:s,s!==null&&(a.callback=s),r=Ka(e,a,t),r!==null&&(yr(r,e,t),Cl(r,e,t))}function j1(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Lf(e,t){j1(e,t),(e=e.alternate)&&j1(e,t)}function h2(e){if(e.tag===13){var t=Ys(e,67108864);t!==null&&yr(t,e,67108864),Lf(e,67108864)}}var ic=!0;function Y4(e,t,r,a){var n=Se.T;Se.T=null;var s=Ie.p;try{Ie.p=2,If(e,t,r,a)}finally{Ie.p=s,Se.T=n}}function X4(e,t,r,a){var n=Se.T;Se.T=null;var s=Ie.p;try{Ie.p=8,If(e,t,r,a)}finally{Ie.p=s,Se.T=n}}function If(e,t,r,a){if(ic){var n=Ou(a);if(n===null)ko(e,t,a,cc,r),A1(e,a);else if(J4(n,e,t,r,a))a.stopPropagation();else if(A1(e,a),t&4&&-1<W4.indexOf(e)){for(;n!==null;){var s=Vs(n);if(s!==null)switch(s.tag){case 3:if(s=s.stateNode,s.current.memoizedState.isDehydrated){var i=vn(s.pendingLanes);if(i!==0){var c=s;for(c.pendingLanes|=2,c.entangledLanes|=2;i;){var o=1<<31-vr(i);c.entanglements[1]|=o,i&=~o}sa(s),!(ze&6)&&(Z0=ta()+500,Ei(0,!1))}}break;case 13:c=Ys(s,2),c!==null&&yr(c,s,2),Ic(),Lf(s,2)}if(s=Ou(a),s===null&&ko(e,t,a,cc,r),s===n)break;n=s}n!==null&&a.stopPropagation()}else ko(e,t,a,null,r)}}function Ou(e){return e=Zu(e),Bf(e)}var cc=null;function Bf(e){if(cc=null,e=is(e),e!==null){var t=fi(e);if(t===null)e=null;else{var r=t.tag;if(r===13){if(e=Bx(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return cc=e,null}function x2(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Dp()){case Hx:return 2;case Gx:return 8;case L0:case Rp:return 32;case Vx:return 268435456;default:return 32}default:return 32}}var Fu=!1,en=null,tn=null,rn=null,ri=new Map,ai=new Map,Ha=[],W4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function A1(e,t){switch(e){case"focusin":case"focusout":en=null;break;case"dragenter":case"dragleave":tn=null;break;case"mouseover":case"mouseout":rn=null;break;case"pointerover":case"pointerout":ri.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ai.delete(t.pointerId)}}function gl(e,t,r,a,n,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:a,nativeEvent:s,targetContainers:[n]},t!==null&&(t=Vs(t),t!==null&&h2(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,n!==null&&t.indexOf(n)===-1&&t.push(n),e)}function J4(e,t,r,a,n){switch(t){case"focusin":return en=gl(en,e,t,r,a,n),!0;case"dragenter":return tn=gl(tn,e,t,r,a,n),!0;case"mouseover":return rn=gl(rn,e,t,r,a,n),!0;case"pointerover":var s=n.pointerId;return ri.set(s,gl(ri.get(s)||null,e,t,r,a,n)),!0;case"gotpointercapture":return s=n.pointerId,ai.set(s,gl(ai.get(s)||null,e,t,r,a,n)),!0}return!1}function m2(e){var t=is(e.target);if(t!==null){var r=fi(t);if(r!==null){if(t=r.tag,t===13){if(t=Bx(r),t!==null){e.blockedOn=t,zp(e.priority,function(){if(r.tag===13){var a=pr();a=Ju(a);var n=Ys(r,a);n!==null&&yr(n,r,a),Lf(r,a)}});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function M0(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Ou(e.nativeEvent);if(r===null){r=e.nativeEvent;var a=new r.constructor(r.type,r);Zo=a,r.target.dispatchEvent(a),Zo=null}else return t=Vs(r),t!==null&&h2(t),e.blockedOn=r,!1;t.shift()}return!0}function C1(e,t,r){M0(e)&&r.delete(t)}function Q4(){Fu=!1,en!==null&&M0(en)&&(en=null),tn!==null&&M0(tn)&&(tn=null),rn!==null&&M0(rn)&&(rn=null),ri.forEach(C1),ai.forEach(C1)}function c0(e,t){e.blockedOn===t&&(e.blockedOn=null,Fu||(Fu=!0,Nt.unstable_scheduleCallback(Nt.unstable_NormalPriority,Q4)))}var o0=null;function k1(e){o0!==e&&(o0=e,Nt.unstable_scheduleCallback(Nt.unstable_NormalPriority,function(){o0===e&&(o0=null);for(var t=0;t<e.length;t+=3){var r=e[t],a=e[t+1],n=e[t+2];if(typeof a!="function"){if(Bf(a||r)===null)continue;break}var s=Vs(r);s!==null&&(e.splice(t,3),t-=3,xu(s,{pending:!0,data:n,method:r.method,action:a},a,n))}}))}function ni(e){function t(o){return c0(o,e)}en!==null&&c0(en,e),tn!==null&&c0(tn,e),rn!==null&&c0(rn,e),ri.forEach(t),ai.forEach(t);for(var r=0;r<Ha.length;r++){var a=Ha[r];a.blockedOn===e&&(a.blockedOn=null)}for(;0<Ha.length&&(r=Ha[0],r.blockedOn===null);)m2(r),r.blockedOn===null&&Ha.shift();if(r=(e.ownerDocument||e).$$reactFormReplay,r!=null)for(a=0;a<r.length;a+=3){var n=r[a],s=r[a+1],i=n[tr]||null;if(typeof s=="function")i||k1(r);else if(i){var c=null;if(s&&s.hasAttribute("formAction")){if(n=s,i=s[tr]||null)c=i.formAction;else if(Bf(n)!==null)continue}else c=i.action;typeof c=="function"?r[a+1]=c:(r.splice(a,3),a-=3),k1(r)}}}function Pf(e){this._internalRoot=e}zc.prototype.render=Pf.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ce(409));var r=t.current,a=pr();d2(r,a,e,t,null,null)};zc.prototype.unmount=Pf.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;d2(e.current,2,null,e,null,null),Ic(),t[Gs]=null}};function zc(e){this._internalRoot=e}zc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Qx();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Ha.length&&t!==0&&t<Ha[r].priority;r++);Ha.splice(r,0,e),r===0&&m2(e)}};var M1=Lx.version;if(M1!=="19.1.1")throw Error(ce(527,M1,"19.1.1"));Ie.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ce(188)):(e=Object.keys(e).join(","),Error(ce(268,e)));return e=Tp(t),e=e!==null?Px(e):null,e=e===null?null:e.stateNode,e};var q4={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:Se,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var u0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!u0.isDisabled&&u0.supportsFiber)try{di=u0.inject(q4),gr=u0}catch{}}Tc.createRoot=function(e,t){if(!Ix(e))throw Error(ce(299));var r=!1,a="",n=ug,s=fg,i=dg,c=null;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(a=t.identifierPrefix),t.onUncaughtError!==void 0&&(n=t.onUncaughtError),t.onCaughtError!==void 0&&(s=t.onCaughtError),t.onRecoverableError!==void 0&&(i=t.onRecoverableError),t.unstable_transitionCallbacks!==void 0&&(c=t.unstable_transitionCallbacks)),t=u2(e,1,!1,null,null,r,a,n,s,i,c,null),e[Gs]=t.current,Rf(e),new Pf(t)};Tc.hydrateRoot=function(e,t,r){if(!Ix(e))throw Error(ce(299));var a=!1,n="",s=ug,i=fg,c=dg,o=null,u=null;return r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(n=r.identifierPrefix),r.onUncaughtError!==void 0&&(s=r.onUncaughtError),r.onCaughtError!==void 0&&(i=r.onCaughtError),r.onRecoverableError!==void 0&&(c=r.onRecoverableError),r.unstable_transitionCallbacks!==void 0&&(o=r.unstable_transitionCallbacks),r.formState!==void 0&&(u=r.formState)),t=u2(e,1,!0,t,r??null,a,n,s,i,c,o,u),t.context=f2(null),r=t.current,a=pr(),a=Ju(a),n=qa(a),n.callback=null,Ka(r,n,a),r=a,t.current.lanes=r,xi(t,r),sa(t),e[Gs]=t.current,Rf(e),new zc(t)};Tc.version="19.1.1";function g2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(g2)}catch(e){console.error(e)}}g2(),kx.exports=Tc;var K4=kx.exports;/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z4=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),$4=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,a)=>a?a.toUpperCase():r.toLowerCase()),D1=e=>{const t=$4(e);return t.charAt(0).toUpperCase()+t.slice(1)},v2=(...e)=>e.filter((t,r,a)=>!!t&&t.trim()!==""&&a.indexOf(t)===r).join(" ").trim(),eb=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var tb={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rb=L.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:a,className:n="",children:s,iconNode:i,...c},o)=>L.createElement("svg",{ref:o,...tb,width:t,height:t,stroke:e,strokeWidth:a?Number(r)*24/Number(t):r,className:v2("lucide",n),...!s&&!eb(c)&&{"aria-hidden":"true"},...c},[...i.map(([u,f])=>L.createElement(u,f)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sr=(e,t)=>{const r=L.forwardRef(({className:a,...n},s)=>L.createElement(rb,{ref:s,iconNode:t,className:v2(`lucide-${Z4(D1(e))}`,`lucide-${e}`,a),...n}));return r.displayName=D1(e),r};/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ab=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],oc=sr("circle-alert",ab);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nb=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],p2=sr("circle-check-big",nb);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sb=[["path",{d:"M12 20a8 8 0 1 0 0-16 8 8 0 0 0 0 16Z",key:"sobvz5"}],["path",{d:"M12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z",key:"11i496"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 22v-2",key:"1osdcq"}],["path",{d:"m17 20.66-1-1.73",key:"eq3orb"}],["path",{d:"M11 10.27 7 3.34",key:"16pf9h"}],["path",{d:"m20.66 17-1.73-1",key:"sg0v6f"}],["path",{d:"m3.34 7 1.73 1",key:"1ulond"}],["path",{d:"M14 12h8",key:"4f43i9"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"m20.66 7-1.73 1",key:"1ow05n"}],["path",{d:"m3.34 17 1.73-1",key:"nuk764"}],["path",{d:"m17 3.34-1 1.73",key:"2wel8s"}],["path",{d:"m11 13.73-4 6.93",key:"794ttg"}]],y2=sr("cog",sb);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lb=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],ib=sr("eye-off",lb);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cb=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],ob=sr("eye",cb);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ub=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],fb=sr("file",ub);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const db=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],Uf=sr("folder-open",db);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hb=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],b2=sr("key",hb);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xb=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],R1=sr("loader-circle",xb);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mb=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],gb=sr("rotate-ccw",mb);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vb=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],pb=sr("save",vb);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yb=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Bl=sr("settings",yb);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bb=[["line",{x1:"4",x2:"4",y1:"21",y2:"14",key:"1p332r"}],["line",{x1:"4",x2:"4",y1:"10",y2:"3",key:"gb41h5"}],["line",{x1:"12",x2:"12",y1:"21",y2:"12",key:"hf2csr"}],["line",{x1:"12",x2:"12",y1:"8",y2:"3",key:"1kfi7u"}],["line",{x1:"20",x2:"20",y1:"21",y2:"16",key:"1lhrwl"}],["line",{x1:"20",x2:"20",y1:"12",y2:"3",key:"16vvfq"}],["line",{x1:"2",x2:"6",y1:"14",y2:"14",key:"1uebub"}],["line",{x1:"10",x2:"14",y1:"8",y2:"8",key:"1yglbp"}],["line",{x1:"18",x2:"22",y1:"16",y2:"16",key:"1jxqpz"}]],wb=sr("sliders-vertical",bb);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nb=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],D0=sr("x",Nb),or=({checked:e,onChange:t,disabled:r=!1,className:a=""})=>l.jsx("button",{type:"button",role:"switch","aria-checked":e,disabled:r,onClick:()=>!r&&t(!e),style:{position:"relative",display:"inline-flex",alignItems:"center",width:"44px",height:"24px",borderRadius:"12px",border:"none",cursor:r?"not-allowed":"pointer",backgroundColor:e?"#2563eb":"#e5e7eb",transition:"background-color 0.2s ease-in-out",opacity:r?.5:1,outline:"none"},className:a,children:l.jsx("span",{style:{position:"absolute",left:e?"22px":"2px",width:"20px",height:"20px",borderRadius:"50%",backgroundColor:"white",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)",transition:"transform 0.2s ease-in-out",transform:"translateX(0)"}})}),qn=({label:e,value:t,onChange:r,onValidation:a,type:n,fileTypes:s=[],accept:i,placeholder:c="Select file or directory",disabled:o=!1,required:u=!1,className:f,error:h})=>{const[d,x]=L.useState("idle"),[b,m]=L.useState(""),[w,p]=L.useState("idle");L.useState([]);const[v,g]=L.useState(!1),[N,I]=L.useState(!1),z=L.useRef(null),j=L.useRef(null),B=L.useRef(null),R=L.useMemo(()=>i?i.split(",").map(O=>O.trim().startsWith(".")?O.trim():`.${O.trim()}`):s,[i,s]);L.useEffect(()=>{},[]),L.useEffect(()=>{var O;t&&((O=window.electronAPI)!=null&&O.validatePath)?q(t):(x("idle"),m(""),a==null||a(!1))},[t,a]),L.useEffect(()=>{const O=ne=>{B.current&&!B.current.contains(ne.target)&&g(!1)};return document.addEventListener("mousedown",O),()=>document.removeEventListener("mousedown",O)},[]);const H=async O=>{},q=L.useCallback(async O=>{var ne;if(!O||O.trim()==="")return{isValid:!1,message:u?"Path is required":""};x("validating");try{if((ne=window.electronAPI)!=null&&ne.validatePath){const ye=await window.electronAPI.validatePath(O,n,R);return ye.isValid?(x("valid"),m(""),a==null||a(!0),{isValid:!0}):(x("invalid"),m(ye.message||"Invalid path"),a==null||a(!1),{isValid:!1,message:ye.message})}else{const ye=O.length>0;return x(ye?"valid":"invalid"),m(ye?"":"Invalid path"),a==null||a(ye),{isValid:ye}}}catch{return x("invalid"),m("Error validating path"),a==null||a(!1),{isValid:!1,message:"Error validating path"}}},[n,R,u,a]),re=L.useCallback(async()=>{var O;if(!(o||N))try{if(I(!0),(O=window.electronAPI)!=null&&O.selectFile){const ne=await window.electronAPI.selectFile({type:n,fileTypes:R.length>0?R:void 0,title:`Select ${n==="directory"?"Directory":"File"}`});ne.success&&ne.filePath&&(r(ne.filePath),await H(ne.filePath))}else console.warn("Electron API not available - file dialog not supported in test environment")}catch(ne){console.error("Error opening file dialog:",ne),m("Error opening file dialog")}finally{I(!1)}},[o,N,n,R,t,r]),se=L.useCallback(O=>{const ne=O.target.value;r(ne)},[r]);L.useCallback(O=>{O.preventDefault(),O.stopPropagation(),o||p("dragover")},[o]),L.useCallback(O=>{var ne;O.preventDefault(),O.stopPropagation(),(ne=z.current)!=null&&ne.contains(O.relatedTarget)||p("idle")},[]),L.useCallback(async O=>{var ne;if(O.preventDefault(),O.stopPropagation(),p("idle"),!o)try{const ye=Array.from(O.dataTransfer.files);if(ye.length===0)return;if(R.length>0){const P=ye[0].name.toLowerCase();if(!R.some(D=>P.endsWith(D.toLowerCase()))){m("Unsupported file type"),a==null||a(!1);return}}const Te=ye[0];if((ne=window.electronAPI)!=null&&ne.selectFile){console.log("Drag-and-drop detected, but using file dialog for path selection"),m("Please use the Browse button to select files"),a==null||a(!1);return}else{console.log("Drag-and-drop not supported in web environment"),m("Drag-and-drop not supported in this environment"),a==null||a(!1);return}}catch(ye){console.error("Error handling dropped files:",ye),m("Error processing dropped files")}},[o,n,r,R,a]),L.useCallback(async O=>{r(O),g(!1),await H()},[r]);const le=L.useCallback(()=>{r(""),g(!1)},[r]),G=()=>{const O="flex-1 px-3 py-2 border rounded-l-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-0 transition-colors",ne=f||"";return o?`${O} bg-gray-100 border-gray-300 text-gray-500 cursor-not-allowed ${ne}`:h||d==="invalid"&&b?`${O} border-red-300 text-red-900 focus:ring-red-500 focus:border-red-500 ${ne}`:d==="valid"?`${O} border-green-300 text-green-900 focus:ring-green-500 focus:border-green-500 ${ne}`:`${O} border-gray-300 focus:ring-blue-500 focus:border-blue-500 ${ne}`},C=()=>null,K=()=>d==="validating"?l.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-600",children:[l.jsx(R1,{className:"w-4 h-4 animate-spin"}),l.jsx("span",{children:"Validating path..."})]}):d==="valid"?l.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600",children:[l.jsx(p2,{className:"w-4 h-4"}),l.jsx("span",{children:"Valid path"})]}):d==="invalid"&&b?l.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-600",role:"alert",children:[l.jsx(oc,{className:"w-4 h-4"}),l.jsx("span",{children:b})]}):null;return l.jsxs("div",{className:"space-y-3",children:[l.jsxs("label",{htmlFor:`file-selector-${e.replace(/\s+/g,"-").toLowerCase()}`,className:"block text-sm font-medium text-gray-700",children:[e,u&&l.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),l.jsxs("div",{className:"flex",children:[l.jsx("input",{ref:j,id:`file-selector-${e.replace(/\s+/g,"-").toLowerCase()}`,type:"text",value:t,onChange:se,className:G(),placeholder:c,disabled:o,readOnly:n!=="file"&&n!=="directory","aria-describedby":`${e}-help ${e}-error`,"aria-invalid":d==="invalid"}),t&&l.jsx("button",{type:"button",onClick:le,disabled:o,className:"px-3 py-2 border-t border-b border-gray-300 text-gray-400 hover:text-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-0 disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Clear path",children:l.jsx(D0,{className:"w-4 h-4"})}),l.jsxs("button",{type:"button",onClick:re,disabled:o||N,className:"px-4 py-2 bg-blue-600 text-white border border-blue-600 rounded-r-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-0 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2",children:[N?l.jsx(R1,{className:"w-4 h-4 animate-spin"}):n==="directory"?l.jsx(Uf,{className:"w-4 h-4"}):l.jsx(fb,{className:"w-4 h-4"}),"Browse"]})]}),l.jsx(C,{}),l.jsx(K,{}),h&&l.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-600",role:"alert",children:[l.jsx(oc,{className:"w-4 h-4"}),l.jsx("span",{children:h})]}),l.jsx("div",{id:`${e}-help`,className:"text-xs text-gray-500",children:n==="directory"?"Select a directory":"Select a file"})]})},O1={apiKeys:{openai:"",piapi:"",removeBg:""},filePaths:{outputDirectory:"./pictures/toupload",tempDirectory:"./pictures/generated",systemPromptFile:"",keywordsFile:"",qualityCheckPromptFile:"",metadataPromptFile:""},parameters:{processMode:"relax",aspectRatios:["1:1","16:9","9:16"],mjVersion:"6.1",openaiModel:"gpt-4o",pollingTimeout:15,pollingInterval:1,enablePollingTimeout:!0,keywordRandom:!1,count:1},processing:{removeBg:!1,imageConvert:!1,imageEnhancement:!1,sharpening:5,saturation:1.4,convertToJpg:!1,trimTransparentBackground:!1,jpgBackground:"white",jpgQuality:100,pngQuality:100,removeBgSize:"auto"},ai:{runQualityCheck:!0,runMetadataGen:!0},advanced:{debugMode:!1}},Sb=[{id:"api-keys",label:"API Keys",icon:b2},{id:"files",label:"File Paths",icon:Uf},{id:"parameters",label:"Parameters",icon:wb},{id:"processing",label:"Processing",icon:y2},{id:"ai",label:"AI Features",icon:Bl},{id:"advanced",label:"Advanced",icon:Bl}],Eb=({onSave:e,onReset:t,onBack:r,isLoading:a=!1,error:n=null,success:s=null})=>{const[i,c]=L.useState(O1),[o,u]=L.useState("api-keys"),[f,h]=L.useState(!1),[d,x]=L.useState({openai:!1,piapi:!1,removeBg:!1}),[b,m]=L.useState(!1),[w,p]=L.useState(!1),v=L.useRef({});L.useEffect(()=>{(async()=>{try{if(window.electronAPI&&window.electronAPI.getSettings){const C=await window.electronAPI.getSettings();C&&C.success&&C.settings&&c(C.settings)}else console.log("Electron API not available, using default settings")}catch(C){console.error("Error loading settings:",C)}})()},[]);const g=(G,C)=>K=>{const O=K.target.type==="number"?parseInt(K.target.value):K.target.value,ne=`${G}-${C}`,Te=K.target.selectionStart;c(M=>({...M,[G]:{...M[G],[C]:O}})),h(!0),requestAnimationFrame(()=>{const M=v.current[ne];M&&document.activeElement!==M&&(M.focus(),M.setSelectionRange&&M.setSelectionRange(Te,Te))})},N=(G,C)=>K=>{c(O=>({...O,[G]:{...O[G],[C]:K}})),h(!0)},I=G=>{x(C=>({...C,[G]:!C[G]}))};L.useEffect(()=>{const G=C=>{C.key==="Escape"&&(m(!1),p(!1))};return document.addEventListener("keydown",G),()=>document.removeEventListener("keydown",G)},[]);const z=async()=>{try{window.electronAPI&&window.electronAPI.saveSettings&&await window.electronAPI.saveSettings(i),h(!1),p(!0),setTimeout(()=>p(!1),3e3),e&&e(i)}catch(G){console.error("Error saving settings:",G),m(!0),setTimeout(()=>m(!1),3e3)}},j=()=>{c(O1),h(!0),t&&t()};L.useEffect(()=>{n&&m(!0)},[n]),L.useEffect(()=>{s&&(p(!0),setTimeout(()=>p(!1),3e3))},[s]);const B=()=>l.jsxs("div",{className:"space-y-6","data-testid":"api-keys-section",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"API Keys"}),l.jsx(b2,{className:"h-5 w-5 text-gray-400"})]}),l.jsx("div",{className:"space-y-4",children:Object.entries({openai:"OpenAI API Key",piapi:"PiAPI (Midjourney) API Key",removeBg:"Remove.bg API Key"}).map(([G,C])=>{const K=`apiKeys-${G}`;return l.jsxs("div",{children:[l.jsx("label",{htmlFor:`${G}-key`,className:"block text-sm font-medium text-gray-700 mb-2",children:C}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{id:`${G}-key`,"data-testid":`${G}-api-key-input`,ref:O=>{v.current[K]=O},type:d[G]?"text":"password",defaultValue:i.apiKeys[G],onChange:g("apiKeys",G),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:`Enter ${G} API key...`}),l.jsx("button",{type:"button",onClick:()=>I(G),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:d[G]?l.jsx(ib,{className:"h-4 w-4 text-gray-400"}):l.jsx(ob,{className:"h-4 w-4 text-gray-400"})})]})]},G)})})]}),R=()=>l.jsxs("div",{className:"space-y-6","data-testid":"file-paths-section",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"File Paths"}),l.jsx(Uf,{className:"h-5 w-5 text-gray-400"})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsx(qn,{label:"Output Directory",value:i.filePaths.outputDirectory,onChange:G=>g("filePaths","outputDirectory")({target:{value:G}}),type:"directory",placeholder:"Select directory for processed images",required:!1}),l.jsx(qn,{label:"Temp Directory",value:i.filePaths.tempDirectory,onChange:G=>g("filePaths","tempDirectory")({target:{value:G}}),type:"directory",placeholder:"Select directory for temporary files",required:!1}),l.jsx(qn,{label:"System Prompt File",value:i.filePaths.systemPromptFile,onChange:G=>g("filePaths","systemPromptFile")({target:{value:G}}),type:"file",fileTypes:[".txt"],placeholder:"Select system prompt file (.txt only)",required:!1}),l.jsx(qn,{label:"Keywords File",value:i.filePaths.keywordsFile,onChange:G=>g("filePaths","keywordsFile")({target:{value:G}}),type:"file",fileTypes:[".txt",".csv"],placeholder:"Select keywords file (.txt or .csv)",required:!1}),l.jsx(qn,{label:"Quality Check Prompt File",value:i.filePaths.qualityCheckPromptFile,onChange:G=>g("filePaths","qualityCheckPromptFile")({target:{value:G}}),type:"file",fileTypes:[".txt"],placeholder:"Select quality check prompt file (.txt only)",required:!1}),l.jsx(qn,{label:"Metadata Prompt File",value:i.filePaths.metadataPromptFile,onChange:G=>g("filePaths","metadataPromptFile")({target:{value:G}}),type:"file",fileTypes:[".txt"],placeholder:"Select metadata prompt file (.txt only)",required:!1})]})]}),H=()=>l.jsxs("div",{className:"space-y-6","data-testid":"parameters-section",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"AI Model Parameters"}),l.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Configure parameters for PiAPI (Midjourney) and OpenAI models."})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsx("h4",{className:"text-md font-medium text-gray-800",children:"Midjourney Settings"}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"process-mode",className:"block text-sm font-medium text-gray-700 mb-2",children:"Process Mode"}),l.jsxs("select",{id:"process-mode",value:i.parameters.processMode,onChange:g("parameters","processMode"),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"relax",children:"Relax"}),l.jsx("option",{value:"fast",children:"Fast"}),l.jsx("option",{value:"turbo",children:"Turbo"})]}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Midjourney generation speed mode"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"aspect-ratios",className:"block text-sm font-medium text-gray-700 mb-2",children:"Aspect Ratios"}),l.jsx("input",{id:"aspect-ratios",type:"text",value:i.parameters.aspectRatios,onChange:g("parameters","aspectRatios"),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"1:1,16:9,9:16"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Comma-separated list of aspect ratios"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"mj-version",className:"block text-sm font-medium text-gray-700 mb-2",children:"Midjourney Version"}),l.jsx("input",{id:"mj-version",type:"text",value:i.parameters.mjVersion,onChange:g("parameters","mjVersion"),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"6.1"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Midjourney model version"})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("h4",{className:"text-md font-medium text-gray-800",children:"OpenAI Settings"}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"openai-model",className:"block text-sm font-medium text-gray-700 mb-2",children:"OpenAI Model"}),l.jsxs("select",{id:"openai-model",value:i.parameters.openaiModel,onChange:g("parameters","openaiModel"),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"gpt-4o",children:"GPT-4o"}),l.jsx("option",{value:"gpt-4o-mini",children:"GPT-4o Mini"}),l.jsx("option",{value:"gpt-3.5-turbo",children:"GPT-3.5 Turbo"})]}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"OpenAI model for text generation"})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Enable Polling Timeout"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Use custom polling timeout instead of default"})]}),l.jsx(or,{checked:i.parameters.enablePollingTimeout,onChange:N("parameters","enablePollingTimeout")})]}),i.parameters.enablePollingTimeout&&l.jsxs("div",{children:[l.jsx("label",{htmlFor:"polling-timeout",className:"block text-sm font-medium text-gray-700 mb-2",children:"Polling Timeout (seconds)"}),l.jsx("input",{id:"polling-timeout",ref:G=>{v.current["parameters-pollingTimeout"]=G},type:"number",value:i.parameters.pollingTimeout,onChange:g("parameters","pollingTimeout"),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"1",max:"300"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Maximum time to wait for API response"})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("h4",{className:"text-md font-medium text-gray-800",children:"Generation Settings"}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"count",className:"block text-sm font-medium text-gray-700 mb-2",children:"Image Count"}),l.jsx("input",{id:"count",type:"number",value:i.parameters.count,onChange:g("parameters","count"),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"1",max:"10"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Number of images to generate"})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Random Keywords"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Use random keywords from the keywords file"})]}),l.jsx(or,{checked:i.parameters.keywordRandom,onChange:N("parameters","keywordRandom")})]})]})]})]}),q=()=>{const G=i.processing.removeBg;i.processing.imageConvert;const C=i.processing.imageConvert,K=i.processing.removeBg,O=i.processing.removeBg&&i.processing.imageConvert&&i.processing.convertToJpg,ne=i.processing.imageConvert;return l.jsxs("div",{className:"space-y-6","data-testid":"processing-section",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Image Processing"}),l.jsx(y2,{className:"h-5 w-5 text-gray-400"})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Remove Background"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Remove background from generated images"})]}),l.jsx(or,{checked:i.processing.removeBg,onChange:N("processing","removeBg")})]}),G&&l.jsxs("div",{children:[l.jsx("label",{htmlFor:"remove-bg-size",className:"block text-sm font-medium text-gray-700 mb-2",children:"Remove.bg Size"}),l.jsxs("select",{id:"remove-bg-size",value:i.processing.removeBgSize,onChange:g("processing","removeBgSize"),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"auto",children:"Auto"}),l.jsx("option",{value:"preview",children:"Preview"}),l.jsx("option",{value:"full",children:"Full"}),l.jsx("option",{value:"50MP",children:"50MP"})]}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Size setting for Remove.bg API"})]}),K&&l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Trim Transparent Background"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Remove transparent areas from images (PNG only)"})]}),l.jsx(or,{checked:i.processing.trimTransparentBackground,onChange:N("processing","trimTransparentBackground")})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Image Convert"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Enable image conversion and processing"})]}),l.jsx(or,{checked:i.processing.imageConvert,onChange:N("processing","imageConvert")})]}),C&&l.jsxs("div",{children:[l.jsx("label",{htmlFor:"convert-format",className:"block text-sm font-medium text-gray-700 mb-2",children:"Convert Format"}),l.jsxs("select",{id:"convert-format",value:i.processing.convertToJpg?"jpg":"png",onChange:ye=>{const Te=ye.target.value==="jpg";c(M=>({...M,processing:{...M.processing,convertToJpg:Te}})),h(!0)},className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"png",children:"PNG"}),l.jsx("option",{value:"jpg",children:"JPG"})]}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Convert images to this format"})]}),ne&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"jpg-quality",className:"block text-sm font-medium text-gray-700 mb-2",children:"JPG Quality (1-100)"}),l.jsx("input",{id:"jpg-quality",type:"number",value:i.processing.jpgQuality,onChange:g("processing","jpgQuality"),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"1",max:"100"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Quality setting for JPG conversion"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"png-quality",className:"block text-sm font-medium text-gray-700 mb-2",children:"PNG Quality (1-100)"}),l.jsx("input",{id:"png-quality",type:"number",value:i.processing.pngQuality,onChange:g("processing","pngQuality"),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"1",max:"100"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Quality setting for PNG conversion"})]}),O&&l.jsxs("div",{children:[l.jsx("label",{htmlFor:"jpg-background",className:"block text-sm font-medium text-gray-700 mb-2",children:"JPG Background Colour"}),l.jsxs("select",{id:"jpg-background",value:i.processing.jpgBackground,onChange:g("processing","jpgBackground"),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"white",children:"White"}),l.jsx("option",{value:"black",children:"Black"})]}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Background color for JPG conversion (JPG cannot be transparent)"})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Image Enhancement"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Apply sharpening and saturation effects"})]}),l.jsx(or,{checked:i.processing.imageEnhancement,onChange:N("processing","imageEnhancement")})]}),i.processing.imageEnhancement&&l.jsxs("div",{children:[l.jsx("label",{htmlFor:"sharpening",className:"block text-sm font-medium text-gray-700 mb-2",children:"Sharpening Intensity (0-10)"}),l.jsx("input",{id:"sharpening",type:"range",min:"0",max:"10",step:"0.5",value:i.processing.sharpening,onChange:g("processing","sharpening"),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),l.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[l.jsx("span",{children:"0 (None)"}),l.jsx("span",{children:i.processing.sharpening}),l.jsx("span",{children:"10 (Maximum)"})]})]}),i.processing.imageEnhancement&&l.jsxs("div",{children:[l.jsx("label",{htmlFor:"saturation",className:"block text-sm font-medium text-gray-700 mb-2",children:"Saturation Level (0-2)"}),l.jsx("input",{id:"saturation",type:"range",min:"0",max:"2",step:"0.1",value:i.processing.saturation,onChange:g("processing","saturation"),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),l.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[l.jsx("span",{children:"0 (Grayscale)"}),l.jsx("span",{children:i.processing.saturation}),l.jsx("span",{children:"2 (Vibrant)"})]})]})]})]})]})]})},re=()=>l.jsxs("div",{className:"space-y-6","data-testid":"ai-section",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"AI Features"}),l.jsx(Bl,{className:"h-5 w-5 text-gray-400"})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"AI Quality Check"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Use AI to check image quality"})]}),l.jsx(or,{checked:i.ai.runQualityCheck,onChange:N("ai","runQualityCheck")})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"AI Metadata Generation"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Generate metadata using AI"})]}),l.jsx(or,{checked:i.ai.runMetadataGen,onChange:N("ai","runMetadataGen")})]})]})]}),se=()=>l.jsxs("div",{className:"space-y-6","data-testid":"advanced-section",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Advanced Settings"}),l.jsx(Bl,{className:"h-5 w-5 text-gray-400"})]}),l.jsx("div",{className:"space-y-4",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Debug Mode"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Enable detailed logging and debugging"})]}),l.jsx(or,{checked:i.advanced.debugMode,onChange:N("advanced","debugMode")})]})})]}),le=()=>{switch(o){case"api-keys":return l.jsx(B,{});case"files":return l.jsx(R,{});case"parameters":return l.jsx(H,{});case"processing":return l.jsx(q,{});case"ai":return l.jsx(re,{});case"advanced":return l.jsx(se,{});default:return null}};return l.jsxs("div",{className:"flex h-screen bg-gray-50","data-testid":"settings-panel",children:[l.jsxs("aside",{className:"w-64 bg-white border-r border-gray-200 flex flex-col",children:[l.jsxs("div",{className:"p-6 border-b border-gray-200",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(Bl,{className:"w-6 h-6 text-blue-600"}),l.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Settings"})]}),r&&l.jsx("button",{onClick:r,className:"text-gray-500 hover:text-gray-700 transition-colors","aria-label":"Back to main view",children:l.jsx(D0,{className:"w-5 h-5"})})]}),l.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Configure your application settings and API keys"})]}),l.jsx("nav",{className:"flex-1 p-4 pr-8",children:l.jsx("ul",{className:"space-y-1",role:"tablist",children:Sb.map(G=>{const C=G.icon,K=o===G.id;return l.jsx("li",{className:"flex justify-center",children:l.jsxs("button",{role:"tab","aria-selected":K,"aria-controls":`${G.id}-panel`,"data-testid":`${G.id}-tab`,onClick:()=>u(G.id),onKeyDown:O=>{(O.key==="Enter"||O.key===" ")&&(O.preventDefault(),u(G.id))},className:`flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-md transition-colors ${K?"bg-blue-100 text-blue-700 border-blue-200":"text-gray-600 hover:bg-gray-100 hover:text-gray-900"}`,children:[l.jsx(C,{className:"w-4 h-4"}),G.label]})},G.id)})})})]}),l.jsxs("main",{className:"flex-1 flex flex-col",children:[b&&n&&l.jsx("div",{className:"bg-red-50 border-l-4 border-red-400 p-4 m-4 rounded-md",role:"alert","data-testid":"error-message",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx(oc,{className:"w-5 h-5 text-red-400 mr-2"}),l.jsx("p",{className:"text-sm text-red-700",children:n})]}),l.jsx("button",{onClick:()=>m(!1),className:"text-red-400 hover:text-red-600 transition-colors","aria-label":"Dismiss error",children:l.jsx(D0,{className:"w-4 h-4"})})]})}),w&&s&&l.jsx("div",{className:"bg-green-50 border-l-4 border-green-400 p-4 m-4 rounded-md",role:"alert","data-testid":"success-message",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx(p2,{className:"w-5 h-5 text-green-400 mr-2"}),l.jsx("p",{className:"text-sm text-green-700",children:s})]}),l.jsx("button",{onClick:()=>p(!1),className:"text-green-400 hover:text-green-600 transition-colors","aria-label":"Dismiss success",children:l.jsx(D0,{className:"w-4 h-4"})})]})}),l.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:l.jsx("div",{className:"max-w-4xl mx-auto",children:le()})}),l.jsx("div",{className:"border-t border-gray-200 bg-white p-4",children:l.jsxs("div",{className:"flex items-center justify-center max-w-4xl mx-auto",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("button",{onClick:z,disabled:a||!f,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed","data-testid":"save-button",children:[l.jsx(pb,{className:"w-4 h-4"}),a?"Saving...":"Save Settings"]}),l.jsxs("button",{onClick:j,disabled:a,className:"flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed","data-testid":"reset-button",children:[l.jsx(gb,{className:"w-4 h-4"}),"Reset to Defaults"]})]}),f&&l.jsxs("div",{className:"text-sm text-amber-600 flex items-center gap-2",children:[l.jsx(oc,{className:"w-4 h-4"}),"You have unsaved changes"]})]})})]})]})},Tb=({jobStatus:e,onStartJob:t,onStopJob:r,onRefresh:a,isLoading:n})=>{const s=e==="running"||e==="starting",i=e==="idle"||e==="completed"||e==="failed"||e==="stopped",c=s;return l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("button",{onClick:t,onKeyDown:o=>{o.key==="Enter"&&i&&!n&&t()},disabled:!i||n,className:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors ${i&&!n?"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,"aria-label":"Start job",children:n&&e==="starting"?l.jsxs(l.Fragment,{children:[l.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Starting..."]}):l.jsxs(l.Fragment,{children:[l.jsx("svg",{className:"-ml-1 mr-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.828 14.828a4 4 0 01-5.656 0M9 10h1m4 0h1m-6 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Start Job"]})}),l.jsx("button",{onClick:r,onKeyDown:o=>{o.key==="Enter"&&c&&!n&&r()},disabled:!c||n,className:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors ${c&&!n?"bg-red-600 hover:bg-red-700 focus:ring-red-500 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,"aria-label":"Stop job",children:n&&(e==="running"||e==="stopping")?l.jsxs(l.Fragment,{children:[l.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Stopping..."]}):l.jsxs(l.Fragment,{children:[l.jsx("svg",{className:"-ml-1 mr-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z M9 10a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1v-4z"})}),"Stop Job"]})}),l.jsxs("button",{onClick:a,onKeyDown:o=>{o.key==="Enter"&&!n&&a()},disabled:n,className:`inline-flex items-center px-3 py-2 border border-gray-300 text-sm font-medium rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors ${n?"bg-gray-100 text-gray-400 cursor-not-allowed border-gray-200":"bg-white hover:bg-gray-50 focus:ring-blue-500 text-gray-700 border-gray-300"}`,"aria-label":"Refresh data",title:"Refresh job history and statistics",children:[l.jsx("svg",{className:"-ml-1 mr-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:`w-2 h-2 rounded-full ${e==="idle"?"bg-gray-400":e==="starting"?"bg-yellow-400":e==="running"?"bg-green-400":e==="completed"?"bg-blue-400":e==="failed"?"bg-red-400":"bg-gray-400"}`}),l.jsxs("span",{className:`text-sm ${e==="idle"?"bg-green-100 text-green-800 px-2 py-1 rounded-full":e==="starting"?"bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full":e==="running"?"bg-blue-100 text-blue-800 px-2 py-1 rounded-full":e==="completed"?"bg-green-100 text-green-800 px-2 py-1 rounded-full":e==="failed"?"bg-red-100 text-red-800 px-2 py-1 rounded-full":"bg-gray-100 text-gray-800 px-2 py-1 rounded-full"}`,children:[e==="idle"&&"Ready",e==="starting"&&"Starting...",e==="running"&&"Running",e==="completed"&&"Completed",e==="failed"&&"Failed",e==="stopped"&&"Stopped"]})]})]})},_b=({logs:e,jobStatus:t,isLoading:r=!1,onRefresh:a})=>{const[n,s]=L.useState("debug"),[i,c]=L.useState(!0),[o,u]=L.useState(""),[f,h]=L.useState("all");L.useState(0);const d=L.useRef(null),x=g=>{s(g)};L.useEffect(()=>{i&&d.current&&(d.current.scrollTop=d.current.scrollHeight)},[e,i]);const b=e.filter(g=>!(n==="standard"&&g.level==="debug"||f!=="all"&&g.level!==f||o&&!g.message.includes(o))),m=g=>{switch(g){case"error":return l.jsx("svg",{className:"w-4 h-4 text-red-600",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{clipRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",fillRule:"evenodd"})});case"warn":return l.jsx("svg",{className:"w-4 h-4 text-yellow-600",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{clipRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",fillRule:"evenodd"})});case"info":return l.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{clipRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",fillRule:"evenodd"})});default:return l.jsx("svg",{className:"w-4 h-4 text-gray-600",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{clipRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",fillRule:"evenodd"})})}},w=g=>new Date(g).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit",timeZone:"UTC"}),p=()=>{const N=(b&&b.length>0?b:e).map(I=>`[${w(I.timestamp)}] [${I.level.toUpperCase()}] ${I.message}`).join(`
`);if(typeof window>"u"||!window.URL||!window.URL.createObjectURL){console.log("Export logs:",N),typeof window<"u"&&window.open&&window.open("data:text/plain;charset=utf-8,"+encodeURIComponent(N),"_blank");return}try{const I=new Blob([N],{type:"text/plain;charset=utf-8"}),z=URL.createObjectURL(I),j=document.createElement("a");j.href=z,j.download="logs.txt",document.body.appendChild(j),j.click(),document.body.removeChild(j),setTimeout(()=>URL.revokeObjectURL(z),200)}catch(I){console.error("Failed to export logs:",I)}},v=()=>{a?a():window.location.reload()};return l.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 flex flex-col h-full",children:[l.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex-shrink-0",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Logs"}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Mode:"}),l.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",role:"tablist","aria-label":"Log viewing mode",children:[l.jsx("button",{onClick:()=>x("standard"),role:"tab","aria-selected":n==="standard","aria-label":"Standard log mode",className:`px-3 py-1 text-xs font-medium rounded-md transition-colors ${n==="standard"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Standard"}),l.jsx("button",{onClick:()=>x("debug"),role:"tab","aria-selected":n==="debug","aria-label":"Debug log mode",className:`px-3 py-1 text-xs font-medium rounded-md transition-colors ${n==="debug"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Debug"})]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Level:"}),l.jsxs("select",{value:f,onChange:g=>h(g.target.value),"aria-label":"Filter logs by level",className:"text-xs border border-gray-300 rounded-md px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:"all",children:"All Levels"}),l.jsx("option",{value:"info",children:"Info"}),l.jsx("option",{value:"warn",children:"Warning"}),l.jsx("option",{value:"error",children:"Error"}),l.jsx("option",{value:"debug",children:"Debug Level"})]})]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("label",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[l.jsx("input",{type:"checkbox",checked:i,onChange:g=>c(g.target.checked),"aria-label":"Auto-scroll to bottom",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),l.jsx("span",{children:"Auto-scroll"})]}),l.jsxs("button",{onClick:v,"aria-label":"Refresh logs",className:"inline-flex items-center px-3 py-1 border border-gray-300 rounded-md text-xs font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[l.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]}),l.jsxs("button",{onClick:p,"aria-label":"Export logs",className:"inline-flex items-center px-3 py-1 border border-gray-300 rounded-md text-xs font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[l.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export"]})]})]}),l.jsx("div",{className:"flex items-center space-x-4",children:l.jsx("div",{className:"flex-1 max-w-md",children:l.jsxs("div",{className:"relative",children:[l.jsx("input",{id:"log-search",type:"text",placeholder:"Search logs...",value:o,onChange:g=>u(g.target.value),"aria-label":"Search logs",className:"w-full px-3 py-2 pl-8 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),l.jsx("svg",{className:"absolute left-2.5 top-2.5 w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})})})]}),l.jsxs("div",{className:"px-6 py-4 flex-1 flex flex-col min-h-0",children:[l.jsxs("div",{ref:d,role:"list","aria-label":"Log entries",className:"flex-1 font-mono text-sm bg-gray-50 rounded-lg p-4 min-h-0 logs-scroll border border-gray-200",style:{minHeight:"144px",maxHeight:"320px",overflowY:"auto"},children:[l.jsx("div",{className:"text-xs text-gray-500 text-center py-2 border-b border-gray-200 mb-2",children:"📜 Logs area - scroll when content overflows"}),r?l.jsxs("div",{className:"text-center text-gray-500 py-8",children:[l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),l.jsx("span",{className:"ml-2 text-gray-600",children:"Loading logs..."})]}):e.length===0?l.jsxs("div",{className:"text-center text-gray-500 py-8",children:[l.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),l.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No logs available"}),l.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Logs will appear here when a job is running or has completed."})]}):b.length===0?l.jsx("div",{className:"text-center text-gray-500 py-8",children:"No logs match the current filters."}):l.jsx("div",{className:"space-y-1",children:b.map((g,N)=>l.jsxs("div",{"aria-label":`Log entry ${N+1}: ${g.level} level message`,className:`flex items-start space-x-3 p-2 rounded-md border ${g.level==="error"?"bg-red-50 border-red-200":g.level==="warn"?"bg-yellow-50 border-yellow-200":g.level==="info"?"bg-blue-50 border-blue-200":"bg-white border-gray-200"}`,children:[l.jsx("div",{className:"flex-shrink-0 text-xs text-gray-500 w-20",children:w(g.timestamp)}),l.jsxs("div",{className:`flex-shrink-0 inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border ${g.level==="error"?"text-red-600 bg-red-100 border-red-300":g.level==="warn"?"text-yellow-600 bg-yellow-100 border-yellow-300":g.level==="info"?"text-blue-600 bg-blue-100 border-blue-300":"text-gray-600 bg-gray-100 border-gray-300"}`,children:[m(g.level),l.jsx("span",{className:"ml-1",children:g.level.toUpperCase()})]}),l.jsxs("div",{className:"flex-1 text-gray-900 break-words whitespace-pre",children:[g.message,l.jsxs("div",{className:"mt-1 text-xs text-gray-600 space-y-1",children:[(g.stepName||g.subStep)&&l.jsxs("div",{className:"flex items-center space-x-2",children:[g.stepName&&l.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",children:g.stepName}),g.subStep&&l.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800",children:g.subStep})]}),g.imageIndex!==null&&g.imageIndex!==void 0&&l.jsxs("div",{className:"text-purple-600",children:["📷 Image ",g.imageIndex+1]}),g.durationMs!==null&&g.durationMs!==void 0&&l.jsxs("div",{className:"text-orange-600",children:["⏱️ ",g.durationMs,"ms"]}),(g.progress!==void 0||g.totalImages!==void 0)&&l.jsxs("div",{className:"text-gray-600",children:[g.progress!==void 0&&`Progress: ${g.progress}%`,g.totalImages!==void 0&&` | Images: ${g.successfulImages||0}/${g.totalImages}`]}),g.metadata&&Object.keys(g.metadata).length>0&&l.jsxs("details",{className:"mt-1",children:[l.jsxs("summary",{className:"cursor-pointer text-gray-500 hover:text-gray-700",children:["📋 Metadata (",Object.keys(g.metadata).length," fields)"]}),l.jsx("div",{className:"mt-1 pl-2 text-gray-600",children:Object.entries(g.metadata).map(([I,z])=>l.jsxs("div",{className:"flex justify-between",children:[l.jsxs("span",{className:"font-medium",children:[I,":"]}),l.jsx("span",{className:"ml-2",children:typeof z=="object"?JSON.stringify(z):String(z)})]},I))})]})]})]}),g.source&&l.jsx("div",{className:"flex-shrink-0 text-xs text-gray-500",children:g.source})]},`${g.id}-${N}`))})]}),l.jsxs("div",{className:"mt-3 flex items-center justify-between text-xs text-gray-500 flex-shrink-0",children:[l.jsxs("div",{children:[e.length===0?"15 sample logs":`${e.length} logs`,o&&` matching "${o}"`]}),l.jsx("div",{children:t==="running"&&l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),l.jsx("span",{children:"Live updates"})]})})]})]})]})},jb=({jobs:e,onJobAction:t,onDeleteJob:r,isLoading:a})=>{var se;const[n,s]=L.useState(null),[i,c]=L.useState(null),[o,u]=L.useState({x:0,y:0}),[f,h]=L.useState(0),[d,x]=L.useState(null),[b,m]=L.useState("all"),[w,p]=L.useState("newest"),v=L.useRef(null),g=Vr.useMemo(()=>{if(!e||!Array.isArray(e))return[];let le=e;return b!=="all"&&(le=le.filter(C=>C.status===b)),[...le].sort((C,K)=>{switch(w){case"oldest":return!C.startedAt&&!K.startedAt?0:C.startedAt?K.startedAt?C.startedAt.getTime()-K.startedAt.getTime():-1:1;case"newest":return!C.startedAt&&!K.startedAt?0:C.startedAt?K.startedAt?K.startedAt.getTime()-C.startedAt.getTime():-1:1;case"name":const O=C.configurationName||"Unknown",ne=K.configurationName||"Unknown";return O.localeCompare(ne);default:return 0}})},[e,b,w]),N=le=>{s(le),t("view",le)},I=(le,G)=>{le.preventDefault(),c(G),u({x:le.clientX,y:le.clientY})},z=(le,G)=>{switch(c(null),le){case"view":t("view",G);break;case"export":t("export",G);break;case"rerun":console.log("🚨 DEBUG RERUN: JobHistory rerun case triggered for jobId:",G),console.log("🚨 DEBUG RERUN: Timestamp:",new Date().toISOString()),console.log("🚨 DEBUG RERUN: Stack trace:",new Error().stack),t("rerun",G);break;case"delete":x(G);break}},j=le=>{r&&r(le),x(null)},B=()=>{x(null)},R=(le,G)=>{if(!le)return"Unknown";if(!G)return"In Progress";const C=G.getTime()-le.getTime(),K=Math.floor(C/(1e3*60)),O=Math.floor(K/60);return O>0?`${O}h ${K%60}m`:`${K}m`},H=le=>le?le.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"Unknown",q=le=>{switch(le){case"completed":return l.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})});case"failed":return l.jsx("svg",{className:"w-5 h-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})});case"running":return l.jsx("svg",{className:"w-5 h-5 text-blue-600 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})});default:return l.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}},re=le=>{switch(le){case"completed":return"bg-green-100 text-green-800";case"failed":return"bg-red-100 text-red-800";case"running":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}};return L.useEffect(()=>{v.current&&f>0&&requestAnimationFrame(()=>{v.current&&(v.current.scrollTop=f)})},[g,f]),L.useEffect(()=>{if(v.current){const le=()=>{v.current&&h(v.current.scrollTop)},G=v.current;return G.addEventListener("scroll",le),()=>{G.removeEventListener("scroll",le)}}},[]),L.useEffect(()=>{const le=G=>{if(i){const C=G.target,K=document.querySelector(".context-menu");K&&!K.contains(C)&&c(null)}};return document.addEventListener("mousedown",le),()=>{document.removeEventListener("mousedown",le)}},[i]),a?l.jsxs("div",{className:"flex flex-col h-full min-h-0",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex-shrink-0",children:"Job History"}),l.jsxs("div",{className:"flex-1 flex items-center justify-center py-8 min-h-0",children:[l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),l.jsx("span",{className:"ml-2 text-gray-600",children:"Loading job history..."})]})]}):g.length===0?l.jsxs("div",{className:"flex flex-col h-full min-h-0",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex-shrink-0",children:"Job History"}),l.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center py-8 min-h-0",children:[l.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),l.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No job history available"}),l.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Start your first job to see it here."})]})]}):l.jsxs("div",{className:"flex flex-col h-full min-h-0",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex-shrink-0",children:"Job History"}),l.jsxs("div",{className:"flex items-center space-x-4 mb-4 flex-shrink-0",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("label",{htmlFor:"status-filter",className:"text-sm font-medium text-gray-700",children:"Status:"}),l.jsxs("select",{id:"status-filter",className:"border border-gray-300 rounded-md px-3 py-1 text-sm",value:b,onChange:le=>m(le.target.value),children:[l.jsx("option",{value:"all",children:"All Statuses"}),l.jsx("option",{value:"completed",children:"Completed"}),l.jsx("option",{value:"failed",children:"Failed"}),l.jsx("option",{value:"running",children:"Running"}),l.jsx("option",{value:"pending",children:"Pending"})]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("label",{htmlFor:"sort-select",className:"text-sm font-medium text-gray-700",children:"Sort:"}),l.jsxs("select",{id:"sort-select",className:"border border-gray-300 rounded-md px-3 py-1 text-sm",value:w,onChange:le=>p(le.target.value),children:[l.jsx("option",{value:"newest",children:"Newest First"}),l.jsx("option",{value:"oldest",children:"Oldest First"}),l.jsx("option",{value:"name",children:"By Name"})]})]})]}),l.jsxs("div",{className:"flex-1 overflow-y-auto space-y-3 min-h-0 job-history-scroll border border-gray-200 rounded-lg p-2",role:"list",ref:v,children:[g.length>5&&l.jsxs("div",{className:"text-xs text-gray-500 text-center py-2 border-b border-gray-200",children:["📜 Job History area - scroll when content overflows (",g.length," total)"]}),g.length===0&&l.jsxs("div",{className:"text-center py-12",children:[l.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),l.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No jobs found"}),l.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Jobs will appear here once you start processing images."})]}),g.map(le=>l.jsx("div",{role:"listitem",tabIndex:0,"aria-label":`${le.configurationName||"Unknown"} - ${le.status}`,className:`bg-white border rounded-lg p-4 cursor-pointer transition-colors ${n===le.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,onClick:()=>N(le.id),onContextMenu:G=>I(G,le.id),onKeyDown:G=>{G.key==="Enter"&&t("view",le.id)},children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[q(le.status),l.jsxs("div",{children:[l.jsx("h3",{className:"font-medium text-gray-900",children:le.configurationName||"Unknown"}),l.jsxs("div",{className:"text-xs text-gray-500 mb-1",children:["Job ID: ",le.id]}),l.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[l.jsx("span",{children:H(le.startedAt)}),l.jsx("span",{children:R(le.startedAt,le.completedAt)}),l.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${re(le.status)}`,children:le.status})]})]})]}),l.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[le.status==="running"&&l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"font-medium",children:"Running"}),l.jsx("div",{className:"text-xs",children:"Processing images"})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Images:"}),l.jsxs("div",{children:[le.totalImages," total (",le.successfulImages," successful, ",le.failedImages," failed)"]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("button",{onClick:G=>{G.stopPropagation(),t("view",le.id)},className:"p-1 text-gray-400 hover:text-blue-600 transition-colors",title:"View job details",children:l.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),l.jsx("button",{onClick:G=>{G.stopPropagation(),t("export",le.id)},className:"p-1 text-gray-400 hover:text-green-600 transition-colors",title:"Export to Excel",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),l.jsx("button",{onClick:G=>{G.stopPropagation(),t("rerun",le.id)},className:"p-1 text-gray-400 hover:text-blue-600 transition-colors",title:"Rerun job",disabled:le.status==="running",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),l.jsx("button",{onClick:G=>{G.stopPropagation(),r&&r(le.id)},className:"p-1 text-gray-400 hover:text-red-600 transition-colors",title:"Delete job",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})]})},le.id))]}),i&&l.jsxs("div",{className:"fixed z-50 bg-white border border-gray-200 rounded-lg shadow-lg py-1 context-menu min-w-48",style:{left:o.x,top:o.y},children:[l.jsxs("button",{onClick:()=>z("view",i),className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center",children:[l.jsxs("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"View Details"]}),l.jsxs("button",{onClick:()=>z("export",i),className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center",children:[l.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export to Excel"]}),l.jsxs("button",{onClick:()=>z("rerun",i),className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center",disabled:((se=e.find(le=>le.id===i))==null?void 0:se.status)==="running",children:[l.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Rerun Job"]}),l.jsxs("button",{onClick:()=>z("delete",i),className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center",children:[l.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete Job"]})]}),d&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Delete Job"}),l.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Are you sure you want to delete this job? This action cannot be undone."}),l.jsxs("div",{className:"flex justify-end space-x-3",children:[l.jsx("button",{onClick:B,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200",children:"Cancel"}),l.jsx("button",{onClick:()=>j(d),className:"px-4 py-2 text-sm font-medium text-white bg-red-600 border border-transparent rounded-md hover:bg-red-700",children:"Delete"})]})]})})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var uc={};uc.version="0.18.5";var w2=1252,Ab=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],N2=function(e){Ab.indexOf(e)!=-1&&(w2=e)};function Cb(){N2(1252)}var si=function(e){N2(e)};function kb(){si(1200),Cb()}function Mb(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var f0=function(t){return String.fromCharCode(t)},F1=function(t){return String.fromCharCode(t)},bn,Wa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function li(e){for(var t="",r=0,a=0,n=0,s=0,i=0,c=0,o=0,u=0;u<e.length;)r=e.charCodeAt(u++),s=r>>2,a=e.charCodeAt(u++),i=(r&3)<<4|a>>4,n=e.charCodeAt(u++),c=(a&15)<<2|n>>6,o=n&63,isNaN(a)?c=o=64:isNaN(n)&&(o=64),t+=Wa.charAt(s)+Wa.charAt(i)+Wa.charAt(c)+Wa.charAt(o);return t}function Ta(e){var t="",r=0,a=0,n=0,s=0,i=0,c=0,o=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)s=Wa.indexOf(e.charAt(u++)),i=Wa.indexOf(e.charAt(u++)),r=s<<2|i>>4,t+=String.fromCharCode(r),c=Wa.indexOf(e.charAt(u++)),a=(i&15)<<4|c>>2,c!==64&&(t+=String.fromCharCode(a)),o=Wa.indexOf(e.charAt(u++)),n=(c&3)<<6|o,o!==64&&(t+=String.fromCharCode(n));return t}var Fe=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Aa=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function On(e){return Fe?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function L1(e){return Fe?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Hr=function(t){return Fe?Aa(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Hc(e){if(typeof ArrayBuffer>"u")return Hr(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=e.charCodeAt(a)&255;return t}function ji(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Db(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var Ft=Fe?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Aa(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function Rb(e){for(var t=[],r=0,a=e.length+250,n=On(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)n[r++]=i;else if(i<2048)n[r++]=192|i>>6&31,n[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var c=e.charCodeAt(++s)&1023;n[r++]=240|i>>8&7,n[r++]=128|i>>2&63,n[r++]=128|c>>6&15|(i&3)<<4,n[r++]=128|c&63}else n[r++]=224|i>>12&15,n[r++]=128|i>>6&63,n[r++]=128|i&63;r>a&&(t.push(n.slice(0,r)),r=0,n=On(65535),a=65530)}return t.push(n.slice(0,r)),Ft(t)}var Pl=/\u0000/g,d0=/[\u0001-\u0006]/g;function _s(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Gr(e,t){var r=""+e;return r.length>=t?r:lt("0",t-r.length)+r}function zf(e,t){var r=""+e;return r.length>=t?r:lt(" ",t-r.length)+r}function fc(e,t){var r=""+e;return r.length>=t?r:r+lt(" ",t-r.length)}function Ob(e,t){var r=""+Math.round(e);return r.length>=t?r:lt("0",t-r.length)+r}function Fb(e,t){var r=""+e;return r.length>=t?r:lt("0",t-r.length)+r}var I1=Math.pow(2,32);function Kn(e,t){if(e>I1||e<-I1)return Ob(e,t);var r=Math.round(e);return Fb(r,t)}function dc(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var B1=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Do=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Lb(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var ct={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},P1={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Ib={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function hc(e,t,r){for(var a=e<0?-1:1,n=e*a,s=0,i=1,c=0,o=1,u=0,f=0,h=Math.floor(n);u<t&&(h=Math.floor(n),c=h*i+s,f=h*u+o,!(n-h<5e-8));)n=1/(n-h),s=i,i=c,o=u,u=f;if(f>t&&(u>t?(f=o,c=s):(f=u,c=i)),!r)return[0,a*c,f];var d=Math.floor(a*c/f);return[d,a*c-d*f,f]}function h0(e,t,r){if(e>2958465||e<0)return null;var a=e|0,n=Math.floor(86400*(e-a)),s=0,i=[],c={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),t&&t.date1904&&(a+=1462),c.u>.9999&&(c.u=0,++n==86400&&(c.T=n=0,++a,++c.D)),a===60)i=r?[1317,10,29]:[1900,2,29],s=3;else if(a===0)i=r?[1317,8,29]:[1900,1,0],s=6;else{a>60&&--a;var o=new Date(1900,0,1);o.setDate(o.getDate()+a-1),i=[o.getFullYear(),o.getMonth()+1,o.getDate()],s=o.getDay(),a<60&&(s=(s+6)%7),r&&(s=Vb(o,i))}return c.y=i[0],c.m=i[1],c.d=i[2],c.S=n%60,n=Math.floor(n/60),c.M=n%60,n=Math.floor(n/60),c.H=n,c.q=s,c}var S2=new Date(1899,11,31,0,0,0),Bb=S2.getTime(),Pb=new Date(1900,2,1,0,0,0);function E2(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Pb&&(r+=24*60*60*1e3),(r-(Bb+(e.getTimezoneOffset()-S2.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Hf(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Ub(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function zb(e){var t=e<0?12:11,r=Hf(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Hb(e){var t=Hf(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Gb(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=zb(e):t===10?r=e.toFixed(10).substr(0,12):r=Hb(e),Hf(Ub(r.toUpperCase()))}function Lu(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Gb(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ln(14,E2(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Vb(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Yb(e,t,r,a){var n="",s=0,i=0,c=r.y,o,u=0;switch(e){case 98:c=r.y+543;case 121:switch(t.length){case 1:case 2:o=c%100,u=2;break;default:o=c%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:o=r.m,u=t.length;break;case 3:return Do[r.m-1][1];case 5:return Do[r.m-1][0];default:return Do[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:o=r.d,u=t.length;break;case 3:return B1[r.q][0];default:return B1[r.q][1]}break;case 104:switch(t.length){case 1:case 2:o=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:o=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:o=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Gr(r.S,t.length):(a>=2?i=a===3?1e3:100:i=a===1?10:1,s=Math.round(i*(r.S+r.u)),s>=60*i&&(s=0),t==="s"?s===0?"0":""+s/i:(n=Gr(s,2+a),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":o=r.D*24+r.H;break;case"[m]":case"[mm]":o=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":o=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:o=c,u=1;break}var f=u>0?Gr(o,u):"";return f}function Ja(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var T2=/%/g;function Xb(e,t,r){var a=t.replace(T2,""),n=t.length-a.length;return pa(e,a,r*Math.pow(10,2*n))+lt("%",n)}function Wb(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return pa(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function _2(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+_2(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%n;if(s<0&&(s+=n),r=(t/Math.pow(10,s)).toPrecision(a+1+(n+s)%n),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,o,u,f){return o+u+f.substr(0,(n+s)%n)+"."+f.substr(s)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var j2=/# (\?+)( ?)\/( ?)(\d+)/;function Jb(e,t,r){var a=parseInt(e[4],10),n=Math.round(t*a),s=Math.floor(n/a),i=n-s*a,c=a;return r+(s===0?"":""+s)+" "+(i===0?lt(" ",e[1].length+1+e[4].length):zf(i,e[1].length)+e[2]+"/"+e[3]+Gr(c,e[4].length))}function Qb(e,t,r){return r+(t===0?"":""+t)+lt(" ",e[1].length+2+e[4].length)}var A2=/^#*0*\.([0#]+)/,C2=/\).*[0#]/,k2=/\(###\) ###\\?-####/;function Yt(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function U1(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function z1(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function qb(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Kb(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Er(e,t,r){if(e.charCodeAt(0)===40&&!t.match(C2)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Er("n",a,r):"("+Er("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Wb(e,t,r);if(t.indexOf("%")!==-1)return Xb(e,t,r);if(t.indexOf("E")!==-1)return _2(t,r);if(t.charCodeAt(0)===36)return"$"+Er(e,t.substr(t.charAt(1)==" "?2:1),r);var n,s,i,c,o=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Kn(o,t.length);if(t.match(/^[#?]+$/))return n=Kn(r,0),n==="0"&&(n=""),n.length>t.length?n:Yt(t.substr(0,t.length-n.length))+n;if(s=t.match(j2))return Jb(s,o,u);if(t.match(/^#+0+$/))return u+Kn(o,t.length-t.indexOf("0"));if(s=t.match(A2))return n=U1(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Yt(s[1])).replace(/\.$/,"."+Yt(s[1])).replace(/\.(\d*)$/,function(b,m){return"."+m+lt("0",Yt(s[1]).length-m.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+U1(o,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+Ja(Kn(o,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Er(e,t,-r):Ja(""+(Math.floor(r)+qb(r,s[1].length)))+"."+Gr(z1(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Er(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=_s(Er(e,t.replace(/[\\-]/g,""),r)),i=0,_s(_s(t.replace(/\\/g,"")).replace(/[0#]/g,function(b){return i<n.length?n.charAt(i++):b==="0"?"0":""}));if(t.match(k2))return n=Er(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),c=hc(o,Math.pow(10,i)-1,!1),n=""+u,f=pa("n",s[1],c[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),n+=f+s[2]+"/"+s[3],f=fc(c[2],i),f.length<s[4].length&&(f=Yt(s[4].substr(s[4].length-f.length))+f),n+=f,n;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),c=hc(o,Math.pow(10,i)-1,!0),u+(c[0]||(c[1]?"":"0"))+" "+(c[1]?zf(c[1],i)+s[2]+"/"+s[3]+fc(c[2],i):lt(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return n=Kn(r,0),t.length<=n.length?n:Yt(t.substr(0,t.length-n.length))+n;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=n.indexOf(".");var h=t.indexOf(".")-i,d=t.length-n.length-h;return Yt(t.substr(0,h)+n+t.substr(t.length-d))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=z1(r,s[1].length),r<0?"-"+Er(e,t,-r):Ja(Kb(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?Gr(0,3-b.length):"")+b})+"."+Gr(i,s[1].length);switch(t){case"###,##0.00":return Er(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var x=Ja(Kn(o,0));return x!=="0"?u+x:"";case"###,###.00":return Er(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Er(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Zb(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return pa(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function $b(e,t,r){var a=t.replace(T2,""),n=t.length-a.length;return pa(e,a,r*Math.pow(10,2*n))+lt("%",n)}function M2(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+M2(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%n;if(s<0&&(s+=n),r=(t/Math.pow(10,s)).toPrecision(a+1+(n+s)%n),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,o,u,f){return o+u+f.substr(0,(n+s)%n)+"."+f.substr(s)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function qr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(C2)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?qr("n",a,r):"("+qr("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Zb(e,t,r);if(t.indexOf("%")!==-1)return $b(e,t,r);if(t.indexOf("E")!==-1)return M2(t,r);if(t.charCodeAt(0)===36)return"$"+qr(e,t.substr(t.charAt(1)==" "?2:1),r);var n,s,i,c,o=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Gr(o,t.length);if(t.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>t.length?n:Yt(t.substr(0,t.length-n.length))+n;if(s=t.match(j2))return Qb(s,o,u);if(t.match(/^#+0+$/))return u+Gr(o,t.length-t.indexOf("0"));if(s=t.match(A2))return n=(""+r).replace(/^([^\.]+)$/,"$1."+Yt(s[1])).replace(/\.$/,"."+Yt(s[1])),n=n.replace(/\.(\d*)$/,function(b,m){return"."+m+lt("0",Yt(s[1]).length-m.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+(""+o).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+Ja(""+o);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+qr(e,t,-r):Ja(""+r)+"."+lt("0",s[1].length);if(s=t.match(/^#,#*,#0/))return qr(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=_s(qr(e,t.replace(/[\\-]/g,""),r)),i=0,_s(_s(t.replace(/\\/g,"")).replace(/[0#]/g,function(b){return i<n.length?n.charAt(i++):b==="0"?"0":""}));if(t.match(k2))return n=qr(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),c=hc(o,Math.pow(10,i)-1,!1),n=""+u,f=pa("n",s[1],c[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),n+=f+s[2]+"/"+s[3],f=fc(c[2],i),f.length<s[4].length&&(f=Yt(s[4].substr(s[4].length-f.length))+f),n+=f,n;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),c=hc(o,Math.pow(10,i)-1,!0),u+(c[0]||(c[1]?"":"0"))+" "+(c[1]?zf(c[1],i)+s[2]+"/"+s[3]+fc(c[2],i):lt(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:Yt(t.substr(0,t.length-n.length))+n;if(s=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=n.indexOf(".");var h=t.indexOf(".")-i,d=t.length-n.length-h;return Yt(t.substr(0,h)+n+t.substr(t.length-d))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+qr(e,t,-r):Ja(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?Gr(0,3-b.length):"")+b})+"."+Gr(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var x=Ja(""+o);return x!=="0"?u+x:"";default:if(t.match(/\.[0#?]*$/))return qr(e,t.slice(0,t.lastIndexOf(".")),r)+Yt(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function pa(e,t,r){return(r|0)===r?qr(e,t,r):Er(e,t,r)}function ew(e){for(var t=[],r=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(n,a-n),n=a+1}if(t[t.length]=e.substr(n),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var D2=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function R2(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":dc(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(D2))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function tw(e,t,r,a){for(var n=[],s="",i=0,c="",o="t",u,f,h,d="H";i<e.length;)switch(c=e.charAt(i)){case"G":if(!dc(e,i))throw new Error("unrecognized character "+c+" in "+e);n[n.length]={t:"G",v:"General"},i+=7;break;case'"':for(s="";(h=e.charCodeAt(++i))!==34&&i<e.length;)s+=String.fromCharCode(h);n[n.length]={t:"t",v:s},++i;break;case"\\":var x=e.charAt(++i),b=x==="("||x===")"?x:"t";n[n.length]={t:b,v:x},++i;break;case"_":n[n.length]={t:"t",v:" "},i+=2;break;case"@":n[n.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(u==null&&(u=h0(t,r,e.charAt(i+1)==="2"),u==null))return"";n[n.length]={t:"X",v:e.substr(i,2)},o=c,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=h0(t,r),u==null))return"";for(s=c;++i<e.length&&e.charAt(i).toLowerCase()===c;)s+=c;c==="m"&&o.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=d),n[n.length]={t:c,v:s},o=c;break;case"A":case"a":case"上":var m={t:c,v:c};if(u==null&&(u=h0(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(u!=null&&(m.v=u.H>=12?"P":"A"),m.t="T",d="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(u!=null&&(m.v=u.H>=12?"PM":"AM"),m.t="T",i+=5,d="h"):e.substr(i,5).toUpperCase()==="上午/下午"?(u!=null&&(m.v=u.H>=12?"下午":"上午"),m.t="T",i+=5,d="h"):(m.t="t",++i),u==null&&m.t==="T")return"";n[n.length]=m,o=c;break;case"[":for(s=c;e.charAt(i++)!=="]"&&i<e.length;)s+=e.charAt(i);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(D2)){if(u==null&&(u=h0(t,r),u==null))return"";n[n.length]={t:"Z",v:s.toLowerCase()},o=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",R2(e)||(n[n.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=c;++i<e.length&&(c=e.charAt(i))==="0";)s+=c;n[n.length]={t:"s",v:s};break}case"0":case"#":for(s=c;++i<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(i))>-1;)s+=c;n[n.length]={t:"n",v:s};break;case"?":for(s=c;e.charAt(++i)===c;)s+=c;n[n.length]={t:c,v:s},o=c;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":n[n.length]={t:a===1?"t":c,v:c},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=c;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)s+=e.charAt(i);n[n.length]={t:"D",v:s};break;case" ":n[n.length]={t:c,v:c},++i;break;case"$":n[n.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);n[n.length]={t:"t",v:c},++i;break}var w=0,p=0,v;for(i=n.length-1,o="t";i>=0;--i)switch(n[i].t){case"h":case"H":n[i].t=d,o="h",w<1&&(w=1);break;case"s":(v=n[i].v.match(/\.0+$/))&&(p=Math.max(p,v[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":o=n[i].t;break;case"m":o==="s"&&(n[i].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&n[i].v.match(/[Hh]/)&&(w=1),w<2&&n[i].v.match(/[Mm]/)&&(w=2),w<3&&n[i].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var g="",N;for(i=0;i<n.length;++i)switch(n[i].t){case"t":case"T":case" ":case"D":break;case"X":n[i].v="",n[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[i].v=Yb(n[i].t.charCodeAt(0),n[i].v,u,p),n[i].t="t";break;case"n":case"?":for(N=i+1;n[N]!=null&&((c=n[N].t)==="?"||c==="D"||(c===" "||c==="t")&&n[N+1]!=null&&(n[N+1].t==="?"||n[N+1].t==="t"&&n[N+1].v==="/")||n[i].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(n[N].v==="/"||n[N].v===" "&&n[N+1]!=null&&n[N+1].t=="?"));)n[i].v+=n[N].v,n[N]={v:"",t:";"},++N;g+=n[i].v,i=N-1;break;case"G":n[i].t="t",n[i].v=Lu(t,r);break}var I="",z,j;if(g.length>0){g.charCodeAt(0)==40?(z=t<0&&g.charCodeAt(0)===45?-t:t,j=pa("n",g,z)):(z=t<0&&a>1?-t:t,j=pa("n",g,z),z<0&&n[0]&&n[0].t=="t"&&(j=j.substr(1),n[0].v="-"+n[0].v)),N=j.length-1;var B=n.length;for(i=0;i<n.length;++i)if(n[i]!=null&&n[i].t!="t"&&n[i].v.indexOf(".")>-1){B=i;break}var R=n.length;if(B===n.length&&j.indexOf("E")===-1){for(i=n.length-1;i>=0;--i)n[i]==null||"n?".indexOf(n[i].t)===-1||(N>=n[i].v.length-1?(N-=n[i].v.length,n[i].v=j.substr(N+1,n[i].v.length)):N<0?n[i].v="":(n[i].v=j.substr(0,N+1),N=-1),n[i].t="t",R=i);N>=0&&R<n.length&&(n[R].v=j.substr(0,N+1)+n[R].v)}else if(B!==n.length&&j.indexOf("E")===-1){for(N=j.indexOf(".")-1,i=B;i>=0;--i)if(!(n[i]==null||"n?".indexOf(n[i].t)===-1)){for(f=n[i].v.indexOf(".")>-1&&i===B?n[i].v.indexOf(".")-1:n[i].v.length-1,I=n[i].v.substr(f+1);f>=0;--f)N>=0&&(n[i].v.charAt(f)==="0"||n[i].v.charAt(f)==="#")&&(I=j.charAt(N--)+I);n[i].v=I,n[i].t="t",R=i}for(N>=0&&R<n.length&&(n[R].v=j.substr(0,N+1)+n[R].v),N=j.indexOf(".")+1,i=B;i<n.length;++i)if(!(n[i]==null||"n?(".indexOf(n[i].t)===-1&&i!==B)){for(f=n[i].v.indexOf(".")>-1&&i===B?n[i].v.indexOf(".")+1:0,I=n[i].v.substr(0,f);f<n[i].v.length;++f)N<j.length&&(I+=j.charAt(N++));n[i].v=I,n[i].t="t",R=i}}}for(i=0;i<n.length;++i)n[i]!=null&&"n?".indexOf(n[i].t)>-1&&(z=a>1&&t<0&&i>0&&n[i-1].v==="-"?-t:t,n[i].v=pa(n[i].t,n[i].v,z),n[i].t="t");var H="";for(i=0;i!==n.length;++i)n[i]!=null&&(H+=n[i].v);return H}var H1=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function G1(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function rw(e,t){var r=ew(e),a=r.length,n=r[a-1].indexOf("@");if(a<4&&n>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(H1),c=r[1].match(H1);return G1(t,i)?[a,r[0]]:G1(t,c)?[a,r[1]]:[a,r[i!=null&&c!=null?2:1]]}return[a,s]}function ln(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:ct)[e],a==null&&(a=r.table&&r.table[P1[e]]||ct[P1[e]]),a==null&&(a=Ib[e]||"General");break}if(dc(a,0))return Lu(t,r);t instanceof Date&&(t=E2(t,r.date1904));var n=rw(a,t);if(dc(n[1]))return Lu(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return tw(n[1],t,r,n[0])}function O2(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(ct[r]==null){t<0&&(t=r);continue}if(ct[r]==e){t=r;break}}t<0&&(t=391)}return ct[t]=e,t}function Gc(e){for(var t=0;t!=392;++t)e[t]!==void 0&&O2(e[t],t)}function Vc(){ct=Lb()}var F2=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function aw(e){var t=typeof e=="number"?ct[e]:e;return t=t.replace(F2,"(\\d+)"),new RegExp("^"+t+"$")}function nw(e,t,r){var a=-1,n=-1,s=-1,i=-1,c=-1,o=-1;(t.match(F2)||[]).forEach(function(h,d){var x=parseInt(r[d+1],10);switch(h.toLowerCase().charAt(0)){case"y":a=x;break;case"d":s=x;break;case"h":i=x;break;case"s":o=x;break;case"m":i>=0?c=x:n=x;break}}),o>=0&&c==-1&&n>=0&&(c=n,n=-1);var u=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var f=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2);return i==-1&&c==-1&&o==-1?u:a==-1&&n==-1&&s==-1?f:u+"T"+f}var sw=function(){var e={};e.version="1.2.0";function t(){for(var j=0,B=new Array(256),R=0;R!=256;++R)j=R,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,B[R]=j;return typeof Int32Array<"u"?new Int32Array(B):B}var r=t();function a(j){var B=0,R=0,H=0,q=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(H=0;H!=256;++H)q[H]=j[H];for(H=0;H!=256;++H)for(R=j[H],B=256+H;B<4096;B+=256)R=q[B]=R>>>8^j[R&255];var re=[];for(H=1;H!=16;++H)re[H-1]=typeof Int32Array<"u"?q.subarray(H*256,H*256+256):q.slice(H*256,H*256+256);return re}var n=a(r),s=n[0],i=n[1],c=n[2],o=n[3],u=n[4],f=n[5],h=n[6],d=n[7],x=n[8],b=n[9],m=n[10],w=n[11],p=n[12],v=n[13],g=n[14];function N(j,B){for(var R=B^-1,H=0,q=j.length;H<q;)R=R>>>8^r[(R^j.charCodeAt(H++))&255];return~R}function I(j,B){for(var R=B^-1,H=j.length-15,q=0;q<H;)R=g[j[q++]^R&255]^v[j[q++]^R>>8&255]^p[j[q++]^R>>16&255]^w[j[q++]^R>>>24]^m[j[q++]]^b[j[q++]]^x[j[q++]]^d[j[q++]]^h[j[q++]]^f[j[q++]]^u[j[q++]]^o[j[q++]]^c[j[q++]]^i[j[q++]]^s[j[q++]]^r[j[q++]];for(H+=15;q<H;)R=R>>>8^r[(R^j[q++])&255];return~R}function z(j,B){for(var R=B^-1,H=0,q=j.length,re=0,se=0;H<q;)re=j.charCodeAt(H++),re<128?R=R>>>8^r[(R^re)&255]:re<2048?(R=R>>>8^r[(R^(192|re>>6&31))&255],R=R>>>8^r[(R^(128|re&63))&255]):re>=55296&&re<57344?(re=(re&1023)+64,se=j.charCodeAt(H++)&1023,R=R>>>8^r[(R^(240|re>>8&7))&255],R=R>>>8^r[(R^(128|re>>2&63))&255],R=R>>>8^r[(R^(128|se>>6&15|(re&3)<<4))&255],R=R>>>8^r[(R^(128|se&63))&255]):(R=R>>>8^r[(R^(224|re>>12&15))&255],R=R>>>8^r[(R^(128|re>>6&63))&255],R=R>>>8^r[(R^(128|re&63))&255]);return~R}return e.table=r,e.bstr=N,e.buf=I,e.str=z,e}(),Ye=function(){var t={};t.version="1.2.1";function r(y,T){for(var S=y.split("/"),E=T.split("/"),_=0,A=0,Y=Math.min(S.length,E.length);_<Y;++_){if(A=S[_].length-E[_].length)return A;if(S[_]!=E[_])return S[_]<E[_]?-1:1}return S.length-E.length}function a(y){if(y.charAt(y.length-1)=="/")return y.slice(0,-1).indexOf("/")===-1?y:a(y.slice(0,-1));var T=y.lastIndexOf("/");return T===-1?y:y.slice(0,T+1)}function n(y){if(y.charAt(y.length-1)=="/")return n(y.slice(0,-1));var T=y.lastIndexOf("/");return T===-1?y:y.slice(T+1)}function s(y,T){typeof T=="string"&&(T=new Date(T));var S=T.getHours();S=S<<6|T.getMinutes(),S=S<<5|T.getSeconds()>>>1,y.write_shift(2,S);var E=T.getFullYear()-1980;E=E<<4|T.getMonth()+1,E=E<<5|T.getDate(),y.write_shift(2,E)}function i(y){var T=y.read_shift(2)&65535,S=y.read_shift(2)&65535,E=new Date,_=S&31;S>>>=5;var A=S&15;S>>>=4,E.setMilliseconds(0),E.setFullYear(S+1980),E.setMonth(A-1),E.setDate(_);var Y=T&31;T>>>=5;var ae=T&63;return T>>>=6,E.setHours(T),E.setMinutes(ae),E.setSeconds(Y<<1),E}function c(y){dr(y,0);for(var T={},S=0;y.l<=y.length-4;){var E=y.read_shift(2),_=y.read_shift(2),A=y.l+_,Y={};switch(E){case 21589:S=y.read_shift(1),S&1&&(Y.mtime=y.read_shift(4)),_>5&&(S&2&&(Y.atime=y.read_shift(4)),S&4&&(Y.ctime=y.read_shift(4))),Y.mtime&&(Y.mt=new Date(Y.mtime*1e3));break}y.l=A,T[E]=Y}return T}var o;function u(){return o||(o={})}function f(y,T){if(y[0]==80&&y[1]==75)return il(y,T);if((y[0]|32)==109&&(y[1]|32)==105)return Vi(y,T);if(y.length<512)throw new Error("CFB file size "+y.length+" < 512");var S=3,E=512,_=0,A=0,Y=0,ae=0,V=0,X=[],J=y.slice(0,512);dr(J,0);var fe=h(J);switch(S=fe[0],S){case 3:E=512;break;case 4:E=4096;break;case 0:if(fe[1]==0)return il(y,T);default:throw new Error("Major Version: Expected 3 or 4 saw "+S)}E!==512&&(J=y.slice(0,E),dr(J,28));var ge=y.slice(0,E);d(J,S);var pe=J.read_shift(4,"i");if(S===3&&pe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+pe);J.l+=4,Y=J.read_shift(4,"i"),J.l+=4,J.chk("00100000","Mini Stream Cutoff Size: "),ae=J.read_shift(4,"i"),_=J.read_shift(4,"i"),V=J.read_shift(4,"i"),A=J.read_shift(4,"i");for(var de=-1,ve=0;ve<109&&(de=J.read_shift(4,"i"),!(de<0));++ve)X[ve]=de;var Ee=x(y,E);w(V,A,Ee,E,X);var Qe=v(Ee,Y,X,E);Qe[Y].name="!Directory",_>0&&ae!==se&&(Qe[ae].name="!MiniFAT"),Qe[X[0]].name="!FAT",Qe.fat_addrs=X,Qe.ssz=E;var qe={},pt=[],ka=[],Ma=[];g(Y,Qe,Ee,pt,_,qe,ka,ae),b(ka,Ma,pt),pt.shift();var Da={FileIndex:ka,FullPaths:Ma};return T&&T.raw&&(Da.raw={header:ge,sectors:Ee}),Da}function h(y){if(y[y.l]==80&&y[y.l+1]==75)return[0,0];y.chk(le,"Header Signature: "),y.l+=16;var T=y.read_shift(2,"u");return[y.read_shift(2,"u"),T]}function d(y,T){var S=9;switch(y.l+=2,S=y.read_shift(2)){case 9:if(T!=3)throw new Error("Sector Shift: Expected 9 saw "+S);break;case 12:if(T!=4)throw new Error("Sector Shift: Expected 12 saw "+S);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+S)}y.chk("0600","Mini Sector Shift: "),y.chk("000000000000","Reserved: ")}function x(y,T){for(var S=Math.ceil(y.length/T)-1,E=[],_=1;_<S;++_)E[_-1]=y.slice(_*T,(_+1)*T);return E[S-1]=y.slice(S*T),E}function b(y,T,S){for(var E=0,_=0,A=0,Y=0,ae=0,V=S.length,X=[],J=[];E<V;++E)X[E]=J[E]=E,T[E]=S[E];for(;ae<J.length;++ae)E=J[ae],_=y[E].L,A=y[E].R,Y=y[E].C,X[E]===E&&(_!==-1&&X[_]!==_&&(X[E]=X[_]),A!==-1&&X[A]!==A&&(X[E]=X[A])),Y!==-1&&(X[Y]=E),_!==-1&&E!=X[E]&&(X[_]=X[E],J.lastIndexOf(_)<ae&&J.push(_)),A!==-1&&E!=X[E]&&(X[A]=X[E],J.lastIndexOf(A)<ae&&J.push(A));for(E=1;E<V;++E)X[E]===E&&(A!==-1&&X[A]!==A?X[E]=X[A]:_!==-1&&X[_]!==_&&(X[E]=X[_]));for(E=1;E<V;++E)if(y[E].type!==0){if(ae=E,ae!=X[ae])do ae=X[ae],T[E]=T[ae]+"/"+T[E];while(ae!==0&&X[ae]!==-1&&ae!=X[ae]);X[E]=-1}for(T[0]+="/",E=1;E<V;++E)y[E].type!==2&&(T[E]+="/")}function m(y,T,S){for(var E=y.start,_=y.size,A=[],Y=E;S&&_>0&&Y>=0;)A.push(T.slice(Y*re,Y*re+re)),_-=re,Y=wn(S,Y*4);return A.length===0?te(0):Ft(A).slice(0,y.size)}function w(y,T,S,E,_){var A=se;if(y===se){if(T!==0)throw new Error("DIFAT chain shorter than expected")}else if(y!==-1){var Y=S[y],ae=(E>>>2)-1;if(!Y)return;for(var V=0;V<ae&&(A=wn(Y,V*4))!==se;++V)_.push(A);w(wn(Y,E-4),T-1,S,E,_)}}function p(y,T,S,E,_){var A=[],Y=[];_||(_=[]);var ae=E-1,V=0,X=0;for(V=T;V>=0;){_[V]=!0,A[A.length]=V,Y.push(y[V]);var J=S[Math.floor(V*4/E)];if(X=V*4&ae,E<4+X)throw new Error("FAT boundary crossed: "+V+" 4 "+E);if(!y[J])break;V=wn(y[J],X)}return{nodes:A,data:K1([Y])}}function v(y,T,S,E){var _=y.length,A=[],Y=[],ae=[],V=[],X=E-1,J=0,fe=0,ge=0,pe=0;for(J=0;J<_;++J)if(ae=[],ge=J+T,ge>=_&&(ge-=_),!Y[ge]){V=[];var de=[];for(fe=ge;fe>=0;){de[fe]=!0,Y[fe]=!0,ae[ae.length]=fe,V.push(y[fe]);var ve=S[Math.floor(fe*4/E)];if(pe=fe*4&X,E<4+pe)throw new Error("FAT boundary crossed: "+fe+" 4 "+E);if(!y[ve]||(fe=wn(y[ve],pe),de[fe]))break}A[ge]={nodes:ae,data:K1([V])}}return A}function g(y,T,S,E,_,A,Y,ae){for(var V=0,X=E.length?2:0,J=T[y].data,fe=0,ge=0,pe;fe<J.length;fe+=128){var de=J.slice(fe,fe+128);dr(de,64),ge=de.read_shift(2),pe=Wf(de,0,ge-X),E.push(pe);var ve={name:pe,type:de.read_shift(1),color:de.read_shift(1),L:de.read_shift(4,"i"),R:de.read_shift(4,"i"),C:de.read_shift(4,"i"),clsid:de.read_shift(16),state:de.read_shift(4,"i"),start:0,size:0},Ee=de.read_shift(2)+de.read_shift(2)+de.read_shift(2)+de.read_shift(2);Ee!==0&&(ve.ct=N(de,de.l-8));var Qe=de.read_shift(2)+de.read_shift(2)+de.read_shift(2)+de.read_shift(2);Qe!==0&&(ve.mt=N(de,de.l-8)),ve.start=de.read_shift(4,"i"),ve.size=de.read_shift(4,"i"),ve.size<0&&ve.start<0&&(ve.size=ve.type=0,ve.start=se,ve.name=""),ve.type===5?(V=ve.start,_>0&&V!==se&&(T[V].name="!StreamData")):ve.size>=4096?(ve.storage="fat",T[ve.start]===void 0&&(T[ve.start]=p(S,ve.start,T.fat_addrs,T.ssz)),T[ve.start].name=ve.name,ve.content=T[ve.start].data.slice(0,ve.size)):(ve.storage="minifat",ve.size<0?ve.size=0:V!==se&&ve.start!==se&&T[V]&&(ve.content=m(ve,T[V].data,(T[ae]||{}).data))),ve.content&&dr(ve.content,0),A[pe]=ve,Y.push(ve)}}function N(y,T){return new Date((xr(y,T+4)/1e7*Math.pow(2,32)+xr(y,T)/1e7-11644473600)*1e3)}function I(y,T){return u(),f(o.readFileSync(y),T)}function z(y,T){var S=T&&T.type;switch(S||Fe&&Buffer.isBuffer(y)&&(S="buffer"),S||"base64"){case"file":return I(y,T);case"base64":return f(Hr(Ta(y)),T);case"binary":return f(Hr(y),T)}return f(y,T)}function j(y,T){var S=T||{},E=S.root||"Root Entry";if(y.FullPaths||(y.FullPaths=[]),y.FileIndex||(y.FileIndex=[]),y.FullPaths.length!==y.FileIndex.length)throw new Error("inconsistent CFB structure");y.FullPaths.length===0&&(y.FullPaths[0]=E+"/",y.FileIndex[0]={name:E,type:5}),S.CLSID&&(y.FileIndex[0].clsid=S.CLSID),B(y)}function B(y){var T="Sh33tJ5";if(!Ye.find(y,"/"+T)){var S=te(4);S[0]=55,S[1]=S[3]=50,S[2]=54,y.FileIndex.push({name:T,type:2,content:S,size:4,L:69,R:69,C:69}),y.FullPaths.push(y.FullPaths[0]+T),R(y)}}function R(y,T){j(y);for(var S=!1,E=!1,_=y.FullPaths.length-1;_>=0;--_){var A=y.FileIndex[_];switch(A.type){case 0:E?S=!0:(y.FileIndex.pop(),y.FullPaths.pop());break;case 1:case 2:case 5:E=!0,isNaN(A.R*A.L*A.C)&&(S=!0),A.R>-1&&A.L>-1&&A.R==A.L&&(S=!0);break;default:S=!0;break}}if(!(!S&&!T)){var Y=new Date(1987,1,19),ae=0,V=Object.create?Object.create(null):{},X=[];for(_=0;_<y.FullPaths.length;++_)V[y.FullPaths[_]]=!0,y.FileIndex[_].type!==0&&X.push([y.FullPaths[_],y.FileIndex[_]]);for(_=0;_<X.length;++_){var J=a(X[_][0]);E=V[J],E||(X.push([J,{name:n(J).replace("/",""),type:1,clsid:C,ct:Y,mt:Y,content:null}]),V[J]=!0)}for(X.sort(function(pe,de){return r(pe[0],de[0])}),y.FullPaths=[],y.FileIndex=[],_=0;_<X.length;++_)y.FullPaths[_]=X[_][0],y.FileIndex[_]=X[_][1];for(_=0;_<X.length;++_){var fe=y.FileIndex[_],ge=y.FullPaths[_];if(fe.name=n(ge).replace("/",""),fe.L=fe.R=fe.C=-(fe.color=1),fe.size=fe.content?fe.content.length:0,fe.start=0,fe.clsid=fe.clsid||C,_===0)fe.C=X.length>1?1:-1,fe.size=0,fe.type=5;else if(ge.slice(-1)=="/"){for(ae=_+1;ae<X.length&&a(y.FullPaths[ae])!=ge;++ae);for(fe.C=ae>=X.length?-1:ae,ae=_+1;ae<X.length&&a(y.FullPaths[ae])!=a(ge);++ae);fe.R=ae>=X.length?-1:ae,fe.type=1}else a(y.FullPaths[_+1]||"")==a(ge)&&(fe.R=_+1),fe.type=2}}}function H(y,T){var S=T||{};if(S.fileType=="mad")return Yi(y,S);switch(R(y),S.fileType){case"zip":return Bi(y,S)}var E=function(pe){for(var de=0,ve=0,Ee=0;Ee<pe.FileIndex.length;++Ee){var Qe=pe.FileIndex[Ee];if(Qe.content){var qe=Qe.content.length;qe>0&&(qe<4096?de+=qe+63>>6:ve+=qe+511>>9)}}for(var pt=pe.FullPaths.length+3>>2,ka=de+7>>3,Ma=de+127>>7,Da=ka+ve+pt+Ma,Jr=Da+127>>7,Wn=Jr<=109?0:Math.ceil((Jr-109)/127);Da+Jr+Wn+127>>7>Jr;)Wn=++Jr<=109?0:Math.ceil((Jr-109)/127);var Sr=[1,Wn,Jr,Ma,pt,ve,de,0];return pe.FileIndex[0].size=de<<6,Sr[7]=(pe.FileIndex[0].start=Sr[0]+Sr[1]+Sr[2]+Sr[3]+Sr[4]+Sr[5])+(Sr[6]+7>>3),Sr}(y),_=te(E[7]<<9),A=0,Y=0;{for(A=0;A<8;++A)_.write_shift(1,G[A]);for(A=0;A<8;++A)_.write_shift(2,0);for(_.write_shift(2,62),_.write_shift(2,3),_.write_shift(2,65534),_.write_shift(2,9),_.write_shift(2,6),A=0;A<3;++A)_.write_shift(2,0);for(_.write_shift(4,0),_.write_shift(4,E[2]),_.write_shift(4,E[0]+E[1]+E[2]+E[3]-1),_.write_shift(4,0),_.write_shift(4,4096),_.write_shift(4,E[3]?E[0]+E[1]+E[2]-1:se),_.write_shift(4,E[3]),_.write_shift(-4,E[1]?E[0]-1:se),_.write_shift(4,E[1]),A=0;A<109;++A)_.write_shift(-4,A<E[2]?E[1]+A:-1)}if(E[1])for(Y=0;Y<E[1];++Y){for(;A<236+Y*127;++A)_.write_shift(-4,A<E[2]?E[1]+A:-1);_.write_shift(-4,Y===E[1]-1?se:Y+1)}var ae=function(pe){for(Y+=pe;A<Y-1;++A)_.write_shift(-4,A+1);pe&&(++A,_.write_shift(-4,se))};for(Y=A=0,Y+=E[1];A<Y;++A)_.write_shift(-4,K.DIFSECT);for(Y+=E[2];A<Y;++A)_.write_shift(-4,K.FATSECT);ae(E[3]),ae(E[4]);for(var V=0,X=0,J=y.FileIndex[0];V<y.FileIndex.length;++V)J=y.FileIndex[V],J.content&&(X=J.content.length,!(X<4096)&&(J.start=Y,ae(X+511>>9)));for(ae(E[6]+7>>3);_.l&511;)_.write_shift(-4,K.ENDOFCHAIN);for(Y=A=0,V=0;V<y.FileIndex.length;++V)J=y.FileIndex[V],J.content&&(X=J.content.length,!(!X||X>=4096)&&(J.start=Y,ae(X+63>>6)));for(;_.l&511;)_.write_shift(-4,K.ENDOFCHAIN);for(A=0;A<E[4]<<2;++A){var fe=y.FullPaths[A];if(!fe||fe.length===0){for(V=0;V<17;++V)_.write_shift(4,0);for(V=0;V<3;++V)_.write_shift(4,-1);for(V=0;V<12;++V)_.write_shift(4,0);continue}J=y.FileIndex[A],A===0&&(J.start=J.size?J.start-1:se);var ge=A===0&&S.root||J.name;if(X=2*(ge.length+1),_.write_shift(64,ge,"utf16le"),_.write_shift(2,X),_.write_shift(1,J.type),_.write_shift(1,J.color),_.write_shift(-4,J.L),_.write_shift(-4,J.R),_.write_shift(-4,J.C),J.clsid)_.write_shift(16,J.clsid,"hex");else for(V=0;V<4;++V)_.write_shift(4,0);_.write_shift(4,J.state||0),_.write_shift(4,0),_.write_shift(4,0),_.write_shift(4,0),_.write_shift(4,0),_.write_shift(4,J.start),_.write_shift(4,J.size),_.write_shift(4,0)}for(A=1;A<y.FileIndex.length;++A)if(J=y.FileIndex[A],J.size>=4096)if(_.l=J.start+1<<9,Fe&&Buffer.isBuffer(J.content))J.content.copy(_,_.l,0,J.size),_.l+=J.size+511&-512;else{for(V=0;V<J.size;++V)_.write_shift(1,J.content[V]);for(;V&511;++V)_.write_shift(1,0)}for(A=1;A<y.FileIndex.length;++A)if(J=y.FileIndex[A],J.size>0&&J.size<4096)if(Fe&&Buffer.isBuffer(J.content))J.content.copy(_,_.l,0,J.size),_.l+=J.size+63&-64;else{for(V=0;V<J.size;++V)_.write_shift(1,J.content[V]);for(;V&63;++V)_.write_shift(1,0)}if(Fe)_.l=_.length;else for(;_.l<_.length;)_.write_shift(1,0);return _}function q(y,T){var S=y.FullPaths.map(function(V){return V.toUpperCase()}),E=S.map(function(V){var X=V.split("/");return X[X.length-(V.slice(-1)=="/"?2:1)]}),_=!1;T.charCodeAt(0)===47?(_=!0,T=S[0].slice(0,-1)+T):_=T.indexOf("/")!==-1;var A=T.toUpperCase(),Y=_===!0?S.indexOf(A):E.indexOf(A);if(Y!==-1)return y.FileIndex[Y];var ae=!A.match(d0);for(A=A.replace(Pl,""),ae&&(A=A.replace(d0,"!")),Y=0;Y<S.length;++Y)if((ae?S[Y].replace(d0,"!"):S[Y]).replace(Pl,"")==A||(ae?E[Y].replace(d0,"!"):E[Y]).replace(Pl,"")==A)return y.FileIndex[Y];return null}var re=64,se=-2,le="d0cf11e0a1b11ae1",G=[208,207,17,224,161,177,26,225],C="00000000000000000000000000000000",K={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:se,FREESECT:-1,HEADER_SIGNATURE:le,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:C,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function O(y,T,S){u();var E=H(y,S);o.writeFileSync(T,E)}function ne(y){for(var T=new Array(y.length),S=0;S<y.length;++S)T[S]=String.fromCharCode(y[S]);return T.join("")}function ye(y,T){var S=H(y,T);switch(T&&T.type||"buffer"){case"file":return u(),o.writeFileSync(T.filename,S),S;case"binary":return typeof S=="string"?S:ne(S);case"base64":return li(typeof S=="string"?S:ne(S));case"buffer":if(Fe)return Buffer.isBuffer(S)?S:Aa(S);case"array":return typeof S=="string"?Hr(S):S}return S}var Te;function M(y){try{var T=y.InflateRaw,S=new T;if(S._processChunk(new Uint8Array([3,0]),S._finishFlushFlag),S.bytesRead)Te=y;else throw new Error("zlib does not expose bytesRead")}catch(E){console.error("cannot use native zlib: "+(E.message||E))}}function P(y,T){if(!Te)return sl(y,T);var S=Te.InflateRaw,E=new S,_=E._processChunk(y.slice(y.l),E._finishFlushFlag);return y.l+=E.bytesRead,_}function F(y){return Te?Te.deflateRawSync(y):xn(y)}var D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],k=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],U=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ee(y){var T=(y<<1|y<<11)&139536|(y<<5|y<<15)&558144;return(T>>16|T>>8|T)&255}for(var ue=typeof Uint8Array<"u",ie=ue?new Uint8Array(256):[],be=0;be<256;++be)ie[be]=ee(be);function we(y,T){var S=ie[y&255];return T<=8?S>>>8-T:(S=S<<8|ie[y>>8&255],T<=16?S>>>16-T:(S=S<<8|ie[y>>16&255],S>>>24-T))}function W(y,T){var S=T&7,E=T>>>3;return(y[E]|(S<=6?0:y[E+1]<<8))>>>S&3}function Q(y,T){var S=T&7,E=T>>>3;return(y[E]|(S<=5?0:y[E+1]<<8))>>>S&7}function _e(y,T){var S=T&7,E=T>>>3;return(y[E]|(S<=4?0:y[E+1]<<8))>>>S&15}function Ne(y,T){var S=T&7,E=T>>>3;return(y[E]|(S<=3?0:y[E+1]<<8))>>>S&31}function me(y,T){var S=T&7,E=T>>>3;return(y[E]|(S<=1?0:y[E+1]<<8))>>>S&127}function vt(y,T,S){var E=T&7,_=T>>>3,A=(1<<S)-1,Y=y[_]>>>E;return S<8-E||(Y|=y[_+1]<<8-E,S<16-E)||(Y|=y[_+2]<<16-E,S<24-E)||(Y|=y[_+3]<<24-E),Y&A}function Ze(y,T,S){var E=T&7,_=T>>>3;return E<=5?y[_]|=(S&7)<<E:(y[_]|=S<<E&255,y[_+1]=(S&7)>>8-E),T+3}function lr(y,T,S){var E=T&7,_=T>>>3;return S=(S&1)<<E,y[_]|=S,T+1}function Ca(y,T,S){var E=T&7,_=T>>>3;return S<<=E,y[_]|=S&255,S>>>=8,y[_+1]=S,T+8}function Ri(y,T,S){var E=T&7,_=T>>>3;return S<<=E,y[_]|=S&255,S>>>=8,y[_+1]=S&255,y[_+2]=S>>>8,T+16}function $s(y,T){var S=y.length,E=2*S>T?2*S:T+5,_=0;if(S>=T)return y;if(Fe){var A=L1(E);if(y.copy)y.copy(A);else for(;_<y.length;++_)A[_]=y[_];return A}else if(ue){var Y=new Uint8Array(E);if(Y.set)Y.set(y);else for(;_<S;++_)Y[_]=y[_];return Y}return y.length=E,y}function Nr(y){for(var T=new Array(y),S=0;S<y;++S)T[S]=0;return T}function hn(y,T,S){var E=1,_=0,A=0,Y=0,ae=0,V=y.length,X=ue?new Uint16Array(32):Nr(32);for(A=0;A<32;++A)X[A]=0;for(A=V;A<S;++A)y[A]=0;V=y.length;var J=ue?new Uint16Array(V):Nr(V);for(A=0;A<V;++A)X[_=y[A]]++,E<_&&(E=_),J[A]=0;for(X[0]=0,A=1;A<=E;++A)X[A+16]=ae=ae+X[A-1]<<1;for(A=0;A<V;++A)ae=y[A],ae!=0&&(J[A]=X[ae+16]++);var fe=0;for(A=0;A<V;++A)if(fe=y[A],fe!=0)for(ae=we(J[A],E)>>E-fe,Y=(1<<E+4-fe)-1;Y>=0;--Y)T[ae|Y<<fe]=fe&15|A<<4;return E}var ot=ue?new Uint16Array(512):Nr(512),Lr=ue?new Uint16Array(32):Nr(32);if(!ue){for(var Ir=0;Ir<512;++Ir)ot[Ir]=0;for(Ir=0;Ir<32;++Ir)Lr[Ir]=0}(function(){for(var y=[],T=0;T<32;T++)y.push(5);hn(y,Lr,32);var S=[];for(T=0;T<=143;T++)S.push(8);for(;T<=255;T++)S.push(9);for(;T<=279;T++)S.push(7);for(;T<=287;T++)S.push(8);hn(S,ot,288)})();var el=function(){for(var T=ue?new Uint8Array(32768):[],S=0,E=0;S<U.length-1;++S)for(;E<U[S+1];++E)T[E]=S;for(;E<32768;++E)T[E]=29;var _=ue?new Uint8Array(259):[];for(S=0,E=0;S<k.length-1;++S)for(;E<k[S+1];++E)_[E]=S;function A(ae,V){for(var X=0;X<ae.length;){var J=Math.min(65535,ae.length-X),fe=X+J==ae.length;for(V.write_shift(1,+fe),V.write_shift(2,J),V.write_shift(2,~J&65535);J-- >0;)V[V.l++]=ae[X++]}return V.l}function Y(ae,V){for(var X=0,J=0,fe=ue?new Uint16Array(32768):[];J<ae.length;){var ge=Math.min(65535,ae.length-J);if(ge<10){for(X=Ze(V,X,+(J+ge==ae.length)),X&7&&(X+=8-(X&7)),V.l=X/8|0,V.write_shift(2,ge),V.write_shift(2,~ge&65535);ge-- >0;)V[V.l++]=ae[J++];X=V.l*8;continue}X=Ze(V,X,+(J+ge==ae.length)+2);for(var pe=0;ge-- >0;){var de=ae[J];pe=(pe<<5^de)&32767;var ve=-1,Ee=0;if((ve=fe[pe])&&(ve|=J&-32768,ve>J&&(ve-=32768),ve<J))for(;ae[ve+Ee]==ae[J+Ee]&&Ee<250;)++Ee;if(Ee>2){de=_[Ee],de<=22?X=Ca(V,X,ie[de+1]>>1)-1:(Ca(V,X,3),X+=5,Ca(V,X,ie[de-23]>>5),X+=3);var Qe=de<8?0:de-4>>2;Qe>0&&(Ri(V,X,Ee-k[de]),X+=Qe),de=T[J-ve],X=Ca(V,X,ie[de]>>3),X-=3;var qe=de<4?0:de-2>>1;qe>0&&(Ri(V,X,J-ve-U[de]),X+=qe);for(var pt=0;pt<Ee;++pt)fe[pe]=J&32767,pe=(pe<<5^ae[J])&32767,++J;ge-=Ee-1}else de<=143?de=de+48:X=lr(V,X,1),X=Ca(V,X,ie[de]),fe[pe]=J&32767,++J}X=Ca(V,X,0)-1}return V.l=(X+7)/8|0,V.l}return function(V,X){return V.length<8?A(V,X):Y(V,X)}}();function xn(y){var T=te(50+Math.floor(y.length*1.1)),S=el(y,T);return T.slice(0,S)}var Oi=ue?new Uint16Array(32768):Nr(32768),tl=ue?new Uint16Array(32768):Nr(32768),rl=ue?new Uint16Array(128):Nr(128),al=1,nl=1;function Fi(y,T){var S=Ne(y,T)+257;T+=5;var E=Ne(y,T)+1;T+=5;var _=_e(y,T)+4;T+=4;for(var A=0,Y=ue?new Uint8Array(19):Nr(19),ae=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],V=1,X=ue?new Uint8Array(8):Nr(8),J=ue?new Uint8Array(8):Nr(8),fe=Y.length,ge=0;ge<_;++ge)Y[D[ge]]=A=Q(y,T),V<A&&(V=A),X[A]++,T+=3;var pe=0;for(X[0]=0,ge=1;ge<=V;++ge)J[ge]=pe=pe+X[ge-1]<<1;for(ge=0;ge<fe;++ge)(pe=Y[ge])!=0&&(ae[ge]=J[pe]++);var de=0;for(ge=0;ge<fe;++ge)if(de=Y[ge],de!=0){pe=ie[ae[ge]]>>8-de;for(var ve=(1<<7-de)-1;ve>=0;--ve)rl[pe|ve<<de]=de&7|ge<<3}var Ee=[];for(V=1;Ee.length<S+E;)switch(pe=rl[me(y,T)],T+=pe&7,pe>>>=3){case 16:for(A=3+W(y,T),T+=2,pe=Ee[Ee.length-1];A-- >0;)Ee.push(pe);break;case 17:for(A=3+Q(y,T),T+=3;A-- >0;)Ee.push(0);break;case 18:for(A=11+me(y,T),T+=7;A-- >0;)Ee.push(0);break;default:Ee.push(pe),V<pe&&(V=pe);break}var Qe=Ee.slice(0,S),qe=Ee.slice(S);for(ge=S;ge<286;++ge)Qe[ge]=0;for(ge=E;ge<30;++ge)qe[ge]=0;return al=hn(Qe,Oi,286),nl=hn(qe,tl,30),T}function Li(y,T){if(y[0]==3&&!(y[1]&3))return[On(T),2];for(var S=0,E=0,_=L1(T||1<<18),A=0,Y=_.length>>>0,ae=0,V=0;!(E&1);){if(E=Q(y,S),S+=3,E>>>1)E>>1==1?(ae=9,V=5):(S=Fi(y,S),ae=al,V=nl);else{S&7&&(S+=8-(S&7));var X=y[S>>>3]|y[(S>>>3)+1]<<8;if(S+=32,X>0)for(!T&&Y<A+X&&(_=$s(_,A+X),Y=_.length);X-- >0;)_[A++]=y[S>>>3],S+=8;continue}for(;;){!T&&Y<A+32767&&(_=$s(_,A+32767),Y=_.length);var J=vt(y,S,ae),fe=E>>>1==1?ot[J]:Oi[J];if(S+=fe&15,fe>>>=4,!(fe>>>8&255))_[A++]=fe;else{if(fe==256)break;fe-=257;var ge=fe<8?0:fe-4>>2;ge>5&&(ge=0);var pe=A+k[fe];ge>0&&(pe+=vt(y,S,ge),S+=ge),J=vt(y,S,V),fe=E>>>1==1?Lr[J]:tl[J],S+=fe&15,fe>>>=4;var de=fe<4?0:fe-2>>1,ve=U[fe];for(de>0&&(ve+=vt(y,S,de),S+=de),!T&&Y<pe&&(_=$s(_,pe+100),Y=_.length);A<pe;)_[A]=_[A-ve],++A}}}return T?[_,S+7>>>3]:[_.slice(0,A),S+7>>>3]}function sl(y,T){var S=y.slice(y.l||0),E=Li(S,T);return y.l+=E[1],E[0]}function ll(y,T){if(y)typeof console<"u"&&console.error(T);else throw new Error(T)}function il(y,T){var S=y;dr(S,0);var E=[],_=[],A={FileIndex:E,FullPaths:_};j(A,{root:T.root});for(var Y=S.length-4;(S[Y]!=80||S[Y+1]!=75||S[Y+2]!=5||S[Y+3]!=6)&&Y>=0;)--Y;S.l=Y+4,S.l+=4;var ae=S.read_shift(2);S.l+=6;var V=S.read_shift(4);for(S.l=V,Y=0;Y<ae;++Y){S.l+=20;var X=S.read_shift(4),J=S.read_shift(4),fe=S.read_shift(2),ge=S.read_shift(2),pe=S.read_shift(2);S.l+=8;var de=S.read_shift(4),ve=c(S.slice(S.l+fe,S.l+fe+ge));S.l+=fe+ge+pe;var Ee=S.l;S.l=de+4,Ii(S,X,J,A,ve),S.l=Ee}return A}function Ii(y,T,S,E,_){y.l+=2;var A=y.read_shift(2),Y=y.read_shift(2),ae=i(y);if(A&8257)throw new Error("Unsupported ZIP encryption");for(var V=y.read_shift(4),X=y.read_shift(4),J=y.read_shift(4),fe=y.read_shift(2),ge=y.read_shift(2),pe="",de=0;de<fe;++de)pe+=String.fromCharCode(y[y.l++]);if(ge){var ve=c(y.slice(y.l,y.l+ge));(ve[21589]||{}).mt&&(ae=ve[21589].mt),((_||{})[21589]||{}).mt&&(ae=_[21589].mt)}y.l+=ge;var Ee=y.slice(y.l,y.l+X);switch(Y){case 8:Ee=P(y,J);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Y)}var Qe=!1;A&8&&(V=y.read_shift(4),V==134695760&&(V=y.read_shift(4),Qe=!0),X=y.read_shift(4),J=y.read_shift(4)),X!=T&&ll(Qe,"Bad compressed size: "+T+" != "+X),J!=S&&ll(Qe,"Bad uncompressed size: "+S+" != "+J),Xn(E,pe,Ee,{unsafe:!0,mt:ae})}function Bi(y,T){var S=T||{},E=[],_=[],A=te(1),Y=S.compression?8:0,ae=0,V=0,X=0,J=0,fe=0,ge=y.FullPaths[0],pe=ge,de=y.FileIndex[0],ve=[],Ee=0;for(V=1;V<y.FullPaths.length;++V)if(pe=y.FullPaths[V].slice(ge.length),de=y.FileIndex[V],!(!de.size||!de.content||pe=="Sh33tJ5")){var Qe=J,qe=te(pe.length);for(X=0;X<pe.length;++X)qe.write_shift(1,pe.charCodeAt(X)&127);qe=qe.slice(0,qe.l),ve[fe]=sw.buf(de.content,0);var pt=de.content;Y==8&&(pt=F(pt)),A=te(30),A.write_shift(4,67324752),A.write_shift(2,20),A.write_shift(2,ae),A.write_shift(2,Y),de.mt?s(A,de.mt):A.write_shift(4,0),A.write_shift(-4,ve[fe]),A.write_shift(4,pt.length),A.write_shift(4,de.content.length),A.write_shift(2,qe.length),A.write_shift(2,0),J+=A.length,E.push(A),J+=qe.length,E.push(qe),J+=pt.length,E.push(pt),A=te(46),A.write_shift(4,33639248),A.write_shift(2,0),A.write_shift(2,20),A.write_shift(2,ae),A.write_shift(2,Y),A.write_shift(4,0),A.write_shift(-4,ve[fe]),A.write_shift(4,pt.length),A.write_shift(4,de.content.length),A.write_shift(2,qe.length),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(4,0),A.write_shift(4,Qe),Ee+=A.l,_.push(A),Ee+=qe.length,_.push(qe),++fe}return A=te(22),A.write_shift(4,101010256),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(2,fe),A.write_shift(2,fe),A.write_shift(4,Ee),A.write_shift(4,J),A.write_shift(2,0),Ft([Ft(E),Ft(_),A])}var mn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Pi(y,T){if(y.ctype)return y.ctype;var S=y.name||"",E=S.match(/\.([^\.]+)$/);return E&&mn[E[1]]||T&&(E=(S=T).match(/[\.\\]([^\.\\])+$/),E&&mn[E[1]])?mn[E[1]]:"application/octet-stream"}function Ui(y){for(var T=li(y),S=[],E=0;E<T.length;E+=76)S.push(T.slice(E,E+76));return S.join(`\r
`)+`\r
`}function zi(y){var T=y.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(X){var J=X.charCodeAt(0).toString(16).toUpperCase();return"="+(J.length==1?"0"+J:J)});T=T.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),T.charAt(0)==`
`&&(T="=0D"+T.slice(1)),T=T.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var S=[],E=T.split(`\r
`),_=0;_<E.length;++_){var A=E[_];if(A.length==0){S.push("");continue}for(var Y=0;Y<A.length;){var ae=76,V=A.slice(Y,Y+ae);V.charAt(ae-1)=="="?ae--:V.charAt(ae-2)=="="?ae-=2:V.charAt(ae-3)=="="&&(ae-=3),V=A.slice(Y,Y+ae),Y+=ae,Y<A.length&&(V+="="),S.push(V)}}return S.join(`\r
`)}function Hi(y){for(var T=[],S=0;S<y.length;++S){for(var E=y[S];S<=y.length&&E.charAt(E.length-1)=="=";)E=E.slice(0,E.length-1)+y[++S];T.push(E)}for(var _=0;_<T.length;++_)T[_]=T[_].replace(/[=][0-9A-Fa-f]{2}/g,function(A){return String.fromCharCode(parseInt(A.slice(1),16))});return Hr(T.join(`\r
`))}function Gi(y,T,S){for(var E="",_="",A="",Y,ae=0;ae<10;++ae){var V=T[ae];if(!V||V.match(/^\s*$/))break;var X=V.match(/^(.*?):\s*([^\s].*)$/);if(X)switch(X[1].toLowerCase()){case"content-location":E=X[2].trim();break;case"content-type":A=X[2].trim();break;case"content-transfer-encoding":_=X[2].trim();break}}switch(++ae,_.toLowerCase()){case"base64":Y=Hr(Ta(T.slice(ae).join("")));break;case"quoted-printable":Y=Hi(T.slice(ae));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+_)}var J=Xn(y,E.slice(S.length),Y,{unsafe:!0});A&&(J.ctype=A)}function Vi(y,T){if(ne(y.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var S=T&&T.root||"",E=(Fe&&Buffer.isBuffer(y)?y.toString("binary"):ne(y)).split(`\r
`),_=0,A="";for(_=0;_<E.length;++_)if(A=E[_],!!/^Content-Location:/i.test(A)&&(A=A.slice(A.indexOf("file")),S||(S=A.slice(0,A.lastIndexOf("/")+1)),A.slice(0,S.length)!=S))for(;S.length>0&&(S=S.slice(0,S.length-1),S=S.slice(0,S.lastIndexOf("/")+1),A.slice(0,S.length)!=S););var Y=(E[1]||"").match(/boundary="(.*?)"/);if(!Y)throw new Error("MAD cannot find boundary");var ae="--"+(Y[1]||""),V=[],X=[],J={FileIndex:V,FullPaths:X};j(J);var fe,ge=0;for(_=0;_<E.length;++_){var pe=E[_];pe!==ae&&pe!==ae+"--"||(ge++&&Gi(J,E.slice(fe,_),S),fe=_)}return J}function Yi(y,T){var S=T||{},E=S.boundary||"SheetJS";E="------="+E;for(var _=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+E.slice(2)+'"',"","",""],A=y.FullPaths[0],Y=A,ae=y.FileIndex[0],V=1;V<y.FullPaths.length;++V)if(Y=y.FullPaths[V].slice(A.length),ae=y.FileIndex[V],!(!ae.size||!ae.content||Y=="Sh33tJ5")){Y=Y.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ee){return"_x"+Ee.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ee){return"_u"+Ee.charCodeAt(0).toString(16)+"_"});for(var X=ae.content,J=Fe&&Buffer.isBuffer(X)?X.toString("binary"):ne(X),fe=0,ge=Math.min(1024,J.length),pe=0,de=0;de<=ge;++de)(pe=J.charCodeAt(de))>=32&&pe<128&&++fe;var ve=fe>=ge*4/5;_.push(E),_.push("Content-Location: "+(S.root||"file:///C:/SheetJS/")+Y),_.push("Content-Transfer-Encoding: "+(ve?"quoted-printable":"base64")),_.push("Content-Type: "+Pi(ae,Y)),_.push(""),_.push(ve?zi(J):Ui(J))}return _.push(E+`--\r
`),_.join(`\r
`)}function Xi(y){var T={};return j(T,y),T}function Xn(y,T,S,E){var _=E&&E.unsafe;_||j(y);var A=!_&&Ye.find(y,T);if(!A){var Y=y.FullPaths[0];T.slice(0,Y.length)==Y?Y=T:(Y.slice(-1)!="/"&&(Y+="/"),Y=(Y+T).replace("//","/")),A={name:n(T),type:2},y.FileIndex.push(A),y.FullPaths.push(Y),_||Ye.utils.cfb_gc(y)}return A.content=S,A.size=S?S.length:0,E&&(E.CLSID&&(A.clsid=E.CLSID),E.mt&&(A.mt=E.mt),E.ct&&(A.ct=E.ct)),A}function Wi(y,T){j(y);var S=Ye.find(y,T);if(S){for(var E=0;E<y.FileIndex.length;++E)if(y.FileIndex[E]==S)return y.FileIndex.splice(E,1),y.FullPaths.splice(E,1),!0}return!1}function Ji(y,T,S){j(y);var E=Ye.find(y,T);if(E){for(var _=0;_<y.FileIndex.length;++_)if(y.FileIndex[_]==E)return y.FileIndex[_].name=n(S),y.FullPaths[_]=S,!0}return!1}function Qi(y){R(y,!0)}return t.find=q,t.read=z,t.parse=f,t.write=ye,t.writeFile=O,t.utils={cfb_new:Xi,cfb_add:Xn,cfb_del:Wi,cfb_mov:Ji,cfb_gc:Qi,ReadShift:zl,CheckField:$2,prep_blob:dr,bconcat:Ft,use_zlib:M,_deflateRaw:xn,_inflateRaw:sl,consts:K},t}();function lw(e){return typeof e=="string"?Hc(e):Array.isArray(e)?Db(e):e}function Ai(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Hc(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a=r=="utf8"?ma(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var n=new Blob([lw(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if(typeof saveAs<"u")return saveAs(n,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=s,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(e);return c.open("w"),c.encoding="binary",Array.isArray(t)&&(t=ji(t)),c.write(t),c.close(),t}catch(o){if(!o.message||!o.message.match(/onstruct/))throw o}throw new Error("cannot save file "+e)}function Pt(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function V1(e,t){for(var r=[],a=Pt(e),n=0;n!==a.length;++n)r[e[a[n]][t]]==null&&(r[e[a[n]][t]]=a[n]);return r}function Gf(e){for(var t=[],r=Pt(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function Yc(e){for(var t=[],r=Pt(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}function iw(e){for(var t=[],r=Pt(e),a=0;a!==r.length;++a)t[e[r[a]]]==null&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}var xc=new Date(1899,11,30,0,0,0);function rr(e,t){var r=e.getTime();t&&(r-=1462*24*60*60*1e3);var a=xc.getTime()+(e.getTimezoneOffset()-xc.getTimezoneOffset())*6e4;return(r-a)/(24*60*60*1e3)}var L2=new Date,cw=xc.getTime()+(L2.getTimezoneOffset()-xc.getTimezoneOffset())*6e4,Y1=L2.getTimezoneOffset();function I2(e){var t=new Date;return t.setTime(e*24*60*60*1e3+cw),t.getTimezoneOffset()!==Y1&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Y1)*6e4),t}var X1=new Date("2017-02-19T19:06:09.000Z"),B2=isNaN(X1.getFullYear())?new Date("2/19/17"):X1,ow=B2.getFullYear()==2017;function Qt(e,t){var r=new Date(e);if(ow)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(B2.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Xc(e,t){if(Fe&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return ma(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return ma(Mb(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return ma(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return ma(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return r[s]||s})}catch{}for(var a=[],n=0;n!=e.length;++n)a.push(String.fromCharCode(e[n]));return a.join("")}function ar(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=ar(e[r]));return t}function lt(e,t){for(var r="";r.length<t;)r+=e;return r}function ya(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,s){return r=-r,s}),!isNaN(t=Number(a)))?t/r:t}var uw=["january","february","march","april","may","june","july","august","september","october","november","december"];function ii(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),n=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&uw.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return a<0||a>8099?r:(n>0||s>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function je(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return Fe?a=Aa(r):a=Rb(r),Ye.utils.cfb_add(e,t,a)}Ye.utils.cfb_add(e,t,r)}else e.file(t,r)}function Vf(){return Ye.utils.cfb_new()}var gt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,fw={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Yf=Gf(fw),Xf=/[&<>'"]/g,dw=/[\u0000-\u0008\u000b-\u001f]/g;function He(e){var t=e+"";return t.replace(Xf,function(r){return Yf[r]}).replace(dw,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function W1(e){return He(e).replace(/ /g,"_x0020_")}var P2=/[\u0000-\u001f]/g;function hw(e){var t=e+"";return t.replace(Xf,function(r){return Yf[r]}).replace(/\n/g,"<br/>").replace(P2,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function xw(e){var t=e+"";return t.replace(Xf,function(r){return Yf[r]}).replace(P2,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function mw(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function gw(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Ro(e){for(var t="",r=0,a=0,n=0,s=0,i=0,c=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(n=e.charCodeAt(r++),a>191&&a<224){i=(a&31)<<6,i|=n&63,t+=String.fromCharCode(i);continue}if(s=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(n&63)<<6|s&63);continue}i=e.charCodeAt(r++),c=((a&7)<<18|(n&63)<<12|(s&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(c>>>10&1023)),t+=String.fromCharCode(56320+(c&1023))}return t}function J1(e){var t=On(2*e.length),r,a,n=1,s=0,i=0,c;for(a=0;a<e.length;a+=n)n=1,(c=e.charCodeAt(a))<128?r=c:c<224?(r=(c&31)*64+(e.charCodeAt(a+1)&63),n=2):c<240?(r=(c&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),n=3):(n=4,r=(c&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[s++]=i&255,t[s++]=i>>>8,i=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function Q1(e){return Aa(e,"binary").toString("utf8")}var x0="foo bar bazâð£",Ul=Fe&&(Q1(x0)==Ro(x0)&&Q1||J1(x0)==Ro(x0)&&J1)||Ro,ma=Fe?function(e){return Aa(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,n=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},vw=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)a=a.replace(e[n][0],e[n][1]);return a}}(),U2=/(^\s|\s$|\n)/;function Lt(e,t){return"<"+e+(t.match(U2)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function ci(e){return Pt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function he(e,t,r){return"<"+e+(r!=null?ci(r):"")+(t!=null?(t.match(U2)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Iu(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function pw(e,t){switch(typeof e){case"string":var r=he("vt:lpwstr",He(e));return t&&(r=r.replace(/&quot;/g,"_x0022_")),r;case"number":return he((e|0)==e?"vt:i4":"vt:r8",He(String(e)));case"boolean":return he("vt:bool",e?"true":"false")}if(e instanceof Date)return he("vt:filetime",Iu(e));throw new Error("Unable to serialize "+e)}var _t={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Qs=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],hr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function yw(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),n=e[t+6]&15,s=5;s>=0;--s)n=n*256+e[t+s];return a==2047?n==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),r*Math.pow(2,a-52)*n)}function bw(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,n=0,s=0,i=a?-t:t;isFinite(i)?i==0?n=s=0:(n=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-n),n<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?n=-1022:(s-=Math.pow(2,52),n+=1023)):(n=2047,s=isNaN(t)?26985:0);for(var c=0;c<=5;++c,s/=256)e[r+c]=s&255;e[r+6]=(n&15)<<4|s&15,e[r+7]=n>>4|a}var q1=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var n=0,s=e[0][a].length;n<s;n+=r)t.push.apply(t,e[0][a].slice(n,n+r));return t},K1=Fe?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Aa(t)})):q1(e)}:q1,Z1=function(e,t,r){for(var a=[],n=t;n<r;n+=2)a.push(String.fromCharCode(Nl(e,n)));return a.join("").replace(Pl,"")},Wf=Fe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Pl,""):Z1(e,t,r)}:Z1,$1=function(e,t,r){for(var a=[],n=t;n<t+r;++n)a.push(("0"+e[n].toString(16)).slice(-2));return a.join("")},z2=Fe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):$1(e,t,r)}:$1,ex=function(e,t,r){for(var a=[],n=t;n<r;n++)a.push(String.fromCharCode(ns(e,n)));return a.join("")},Ci=Fe?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):ex(t,r,a)}:ex,H2=function(e,t){var r=xr(e,t);return r>0?Ci(e,t+4,t+4+r-1):""},G2=H2,V2=function(e,t){var r=xr(e,t);return r>0?Ci(e,t+4,t+4+r-1):""},Y2=V2,X2=function(e,t){var r=2*xr(e,t);return r>0?Ci(e,t+4,t+4+r-1):""},W2=X2,J2=function(t,r){var a=xr(t,r);return a>0?Wf(t,r+4,r+4+a):""},Q2=J2,q2=function(e,t){var r=xr(e,t);return r>0?Ci(e,t+4,t+4+r):""},K2=q2,Z2=function(e,t){return yw(e,t)},mc=Z2,Jf=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Fe&&(G2=function(t,r){if(!Buffer.isBuffer(t))return H2(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},Y2=function(t,r){if(!Buffer.isBuffer(t))return V2(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},W2=function(t,r){if(!Buffer.isBuffer(t))return X2(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},Q2=function(t,r){if(!Buffer.isBuffer(t))return J2(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},K2=function(t,r){if(!Buffer.isBuffer(t))return q2(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},mc=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Z2(t,r)},Jf=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var ns=function(e,t){return e[t]},Nl=function(e,t){return e[t+1]*256+e[t]},ww=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},xr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},wn=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Nw=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function zl(e,t){var r="",a,n,s=[],i,c,o,u;switch(t){case"dbcs":if(u=this.l,Fe&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(o=0;o<e;++o)r+=String.fromCharCode(Nl(this,u)),u+=2;e*=2;break;case"utf8":r=Ci(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Wf(this,this.l,this.l+e);break;case"wstr":return zl.call(this,e,"dbcs");case"lpstr-ansi":r=G2(this,this.l),e=4+xr(this,this.l);break;case"lpstr-cp":r=Y2(this,this.l),e=4+xr(this,this.l);break;case"lpwstr":r=W2(this,this.l),e=4+2*xr(this,this.l);break;case"lpp4":e=4+xr(this,this.l),r=Q2(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+xr(this,this.l),r=K2(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=ns(this,this.l+e++))!==0;)s.push(f0(i));r=s.join("");break;case"_wstr":for(e=0,r="";(i=Nl(this,this.l+e))!==0;)s.push(f0(i)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,o=0;o<e;++o){if(this.lens&&this.lens.indexOf(u)!==-1)return i=ns(this,u),this.l=u+1,c=zl.call(this,e-o,i?"dbcs-cont":"sbcs-cont"),s.join("")+c;s.push(f0(Nl(this,u))),u+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,o=0;o!=e;++o){if(this.lens&&this.lens.indexOf(u)!==-1)return i=ns(this,u),this.l=u+1,c=zl.call(this,e-o,i?"dbcs-cont":"sbcs-cont"),s.join("")+c;s.push(f0(ns(this,u))),u+=1}r=s.join("");break;default:switch(e){case 1:return a=ns(this,this.l),this.l++,a;case 2:return a=(t==="i"?ww:Nl)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(a=(e>0?wn:Nw)(this,this.l),this.l+=4,a):(n=xr(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return e==8?n=mc(this,this.l):n=mc([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:r=z2(this,this.l,e);break}}return this.l+=e,r}var Sw=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},Ew=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Tw=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function _w(e,t,r){var a=0,n=0;if(r==="dbcs"){for(n=0;n!=t.length;++n)Tw(this,t.charCodeAt(n),this.l+2*n);a=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;a=t.length}else if(r==="hex"){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var i=t.charCodeAt(n);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,Sw(this,t,this.l);break;case 8:if(a=8,r==="f"){bw(this,t,this.l);break}case 16:break;case-4:a=4,Ew(this,t,this.l);break}return this.l+=a,this}function $2(e,t){var r=z2(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function dr(e,t){e.l=t,e.read_shift=zl,e.chk=$2,e.write_shift=_w}function aa(e,t){e.l+=t}function te(e){var t=On(e);return dr(t,0),t}function er(){var e=[],t=Fe?256:2048,r=function(u){var f=te(u);return dr(f,0),f},a=r(t),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},s=function(u){return a&&u<a.length-a.l?a:(n(),a=r(Math.max(u+1,t)))},i=function(){return n(),Ft(e)},c=function(u){n(),a=u,a.l==null&&(a.l=a.length),s(t)};return{next:s,push:c,end:i,_bufs:e}}function oe(e,t,r,a){var n=+t,s;if(!isNaN(n)){a||(a=y_[n].p||(r||[]).length||0),s=1+(n>=128?1:0)+1,a>=128&&++s,a>=16384&&++s,a>=2097152&&++s;var i=e.next(s);n<=127?i.write_shift(1,n):(i.write_shift(1,(n&127)+128),i.write_shift(1,n>>7));for(var c=0;c!=4;++c)if(a>=128)i.write_shift(1,(a&127)+128),a>>=7;else{i.write_shift(1,a);break}a>0&&Jf(r)&&e.push(r)}}function Hl(e,t,r){var a=ar(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function tx(e,t,r){var a=ar(e);return a.s=Hl(a.s,t.s,r),a.e=Hl(a.e,t.s,r),a}function Gl(e,t){if(e.cRel&&e.c<0)for(e=ar(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=ar(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ge(e);return!e.cRel&&e.cRel!=null&&(r=Cw(r)),!e.rRel&&e.rRel!=null&&(r=jw(r)),r}function Oo(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Gt(e.s.c)+":"+(e.e.cRel?"":"$")+Gt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Bt(e.s.r)+":"+(e.e.rRel?"":"$")+Bt(e.e.r):Gl(e.s,t.biff)+":"+Gl(e.e,t.biff)}function Qf(e){return parseInt(Aw(e),10)-1}function Bt(e){return""+(e+1)}function jw(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Aw(e){return e.replace(/\$(\d+)$/,"$1")}function qf(e){for(var t=kw(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function Gt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Cw(e){return e.replace(/^([A-Z])/,"$$$1")}function kw(e){return e.replace(/^\$([A-Z])/,"$1")}function Mw(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function At(e){for(var t=0,r=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function Ge(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function wr(e){var t=e.indexOf(":");return t==-1?{s:At(e),e:At(e)}:{s:At(e.slice(0,t)),e:At(e.slice(t+1))}}function mt(e,t){return typeof t>"u"||typeof t=="number"?mt(e.s,e.e):(typeof e!="string"&&(e=Ge(e)),typeof t!="string"&&(t=Ge(t)),e==t?e:e+":"+t)}function et(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,n=0,s=e.length;for(r=0;a<s&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.s.c=--r,r=0;a<s&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;if(t.s.r=--r,a===s||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=s&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.e.c=--r,r=0;a!=s&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;return t.e.r=--r,t}function rx(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=ln(e.z,r?rr(t):t)}catch{}try{return e.w=ln((e.XF||{}).numFmtId||(r?14:0),r?rr(t):t)}catch{return""+t}}function _a(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?ki[e.v]||e.v:t==null?rx(e,e.v):rx(e,t))}function zn(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function ev(e,t,r){var a=r||{},n=e?Array.isArray(e):a.dense,s=e||(n?[]:{}),i=0,c=0;if(s&&a.origin!=null){if(typeof a.origin=="number")i=a.origin;else{var o=typeof a.origin=="string"?At(a.origin):a.origin;i=o.r,c=o.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=et(s["!ref"]);u.s.c=f.s.c,u.s.r=f.s.r,u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),i==-1&&(u.e.r=i=f.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=t[h].length;++d)if(!(typeof t[h][d]>"u")){var x={v:t[h][d]},b=i+h,m=c+d;if(u.s.r>b&&(u.s.r=b),u.s.c>m&&(u.s.c=m),u.e.r<b&&(u.e.r=b),u.e.c<m&&(u.e.c=m),t[h][d]&&typeof t[h][d]=="object"&&!Array.isArray(t[h][d])&&!(t[h][d]instanceof Date))x=t[h][d];else if(Array.isArray(x.v)&&(x.f=t[h][d][1],x.v=x.v[0]),x.v===null)if(x.f)x.t="n";else if(a.nullError)x.t="e",x.v=0;else if(a.sheetStubs)x.t="z";else continue;else typeof x.v=="number"?x.t="n":typeof x.v=="boolean"?x.t="b":x.v instanceof Date?(x.z=a.dateNF||ct[14],a.cellDates?(x.t="d",x.w=ln(x.z,rr(x.v))):(x.t="n",x.v=rr(x.v),x.w=ln(x.z,x.v))):x.t="s";if(n)s[b]||(s[b]=[]),s[b][m]&&s[b][m].z&&(x.z=s[b][m].z),s[b][m]=x;else{var w=Ge({c:m,r:b});s[w]&&s[w].z&&(x.z=s[w].z),s[w]=x}}}return u.s.c<1e7&&(s["!ref"]=mt(u)),s}function qs(e,t){return ev(null,e,t)}function Dw(e){return e.read_shift(4,"i")}function Xr(e,t){return t||(t=te(4)),t.write_shift(4,e),t}function Vt(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Ct(e,t){var r=!1;return t==null&&(r=!0,t=te(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function Rw(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Ow(e,t){return t||(t=te(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0),t}function Kf(e,t){var r=e.l,a=e.read_shift(1),n=Vt(e),s=[],i={t:n,h:n};if(a&1){for(var c=e.read_shift(4),o=0;o!=c;++o)s.push(Rw(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function Fw(e,t){var r=!1;return t==null&&(r=!0,t=te(15+4*e.t.length)),t.write_shift(1,0),Ct(e.t,t),r?t.slice(0,t.l):t}var Lw=Kf;function Iw(e,t){var r=!1;return t==null&&(r=!0,t=te(23+4*e.t.length)),t.write_shift(1,1),Ct(e.t,t),t.write_shift(4,1),Ow({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function Fr(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Hn(e,t){return t==null&&(t=te(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Gn(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Vn(e,t){return t==null&&(t=te(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Bw=Vt,tv=Ct;function Zf(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function gc(e,t){var r=!1;return t==null&&(r=!0,t=te(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var Pw=Vt,Bu=Zf,$f=gc;function rv(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var n=a===0?mc([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):wn(t,0)>>2;return r?n/100:n}function av(e,t){t==null&&(t=te(4));var r=0,a=0,n=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?a=1:n==(n|0)&&n>=-(1<<29)&&n<1<<29&&(a=1,r=1),a)t.write_shift(-4,((r?n:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function nv(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function Uw(e,t){return t||(t=te(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Yn=nv,Ks=Uw;function Zs(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Fn(e,t){return(t||te(8)).write_shift(8,e,"f")}function zw(e){var t={},r=e.read_shift(1),a=r>>>1,n=e.read_shift(1),s=e.read_shift(2,"i"),i=e.read_shift(1),c=e.read_shift(1),o=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=n;var u=qw[n];u&&(t.rgb=hx(u));break;case 2:t.rgb=hx([i,c,o]);break;case 3:t.theme=n;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function vc(e,t){if(t||(t=te(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function Hw(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Gw(e,t){t||(t=te(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var sv=2,ur=3,m0=11,pc=19,g0=64,Vw=65,Yw=71,Xw=4108,Ww=4126,Rt=80,ax={1:{n:"CodePage",t:sv},2:{n:"Category",t:Rt},3:{n:"PresentationFormat",t:Rt},4:{n:"ByteCount",t:ur},5:{n:"LineCount",t:ur},6:{n:"ParagraphCount",t:ur},7:{n:"SlideCount",t:ur},8:{n:"NoteCount",t:ur},9:{n:"HiddenCount",t:ur},10:{n:"MultimediaClipCount",t:ur},11:{n:"ScaleCrop",t:m0},12:{n:"HeadingPairs",t:Xw},13:{n:"TitlesOfParts",t:Ww},14:{n:"Manager",t:Rt},15:{n:"Company",t:Rt},16:{n:"LinksUpToDate",t:m0},17:{n:"CharacterCount",t:ur},19:{n:"SharedDoc",t:m0},22:{n:"HyperlinksChanged",t:m0},23:{n:"AppVersion",t:ur,p:"version"},24:{n:"DigSig",t:Vw},26:{n:"ContentType",t:Rt},27:{n:"ContentStatus",t:Rt},28:{n:"Language",t:Rt},29:{n:"Version",t:Rt},255:{},2147483648:{n:"Locale",t:pc},2147483651:{n:"Behavior",t:pc},1919054434:{}},nx={1:{n:"CodePage",t:sv},2:{n:"Title",t:Rt},3:{n:"Subject",t:Rt},4:{n:"Author",t:Rt},5:{n:"Keywords",t:Rt},6:{n:"Comments",t:Rt},7:{n:"Template",t:Rt},8:{n:"LastAuthor",t:Rt},9:{n:"RevNumber",t:Rt},10:{n:"EditTime",t:g0},11:{n:"LastPrinted",t:g0},12:{n:"CreatedDate",t:g0},13:{n:"ModifiedDate",t:g0},14:{n:"PageCount",t:ur},15:{n:"WordCount",t:ur},16:{n:"CharCount",t:ur},17:{n:"Thumbnail",t:Yw},18:{n:"Application",t:Rt},19:{n:"DocSecurity",t:ur},255:{},2147483648:{n:"Locale",t:pc},2147483651:{n:"Behavior",t:pc},1919054434:{}};function Jw(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Qw=Jw([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),qw=ar(Qw),ki={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Kw={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},v0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function lv(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function iv(e,t){var r=iw(Kw),a=[],n;a[a.length]=gt,a[a.length]=he("Types",null,{xmlns:_t.CT,"xmlns:xsd":_t.xsd,"xmlns:xsi":_t.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(o){return he("Default",null,{Extension:o[0],ContentType:o[1]})}));var s=function(o){e[o]&&e[o].length>0&&(n=e[o][0],a[a.length]=he("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:v0[o][t.bookType]||v0[o].xlsx}))},i=function(o){(e[o]||[]).forEach(function(u){a[a.length]=he("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:v0[o][t.bookType]||v0[o].xlsx})})},c=function(o){(e[o]||[]).forEach(function(u){a[a.length]=he("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[o][0]})})};return s("workbooks"),i("sheets"),i("charts"),c("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),i("metadata"),c("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var Oe={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function cv(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function js(e){var t=[gt,he("Relationships",null,{xmlns:_t.RELS})];return Pt(e["!id"]).forEach(function(r){t[t.length]=he("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Ue(e,t,r,a,n,s){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,n.Id="rId"+t,n.Type=a,n.Target=r,s?n.TargetMode=s:[Oe.HLINK,Oe.XPATH,Oe.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,t}function Zw(e){var t=[gt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function sx(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function $w(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function e3(e){var t=[gt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(sx(e[r][0],e[r][1])),t.push($w("",e[r][0]));return t.push(sx("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function ov(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+uc.version+"</meta:generator></office:meta></office:document-meta>"}var Cn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Fo(e,t,r,a,n){n[e]!=null||t==null||t===""||(n[e]=t,t=He(t),a[a.length]=r?he(e,t,r):Lt(e,t))}function uv(e,t){var r=t||{},a=[gt,he("cp:coreProperties",null,{"xmlns:cp":_t.CORE_PROPS,"xmlns:dc":_t.dc,"xmlns:dcterms":_t.dcterms,"xmlns:dcmitype":_t.dcmitype,"xmlns:xsi":_t.xsi})],n={};if(!e&&!r.Props)return a.join("");e&&(e.CreatedDate!=null&&Fo("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Iu(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n),e.ModifiedDate!=null&&Fo("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Iu(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n));for(var s=0;s!=Cn.length;++s){var i=Cn[s],c=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&Fo(i[0],c,null,a,n)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var As=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],fv=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function dv(e){var t=[],r=he;return e||(e={}),e.Application="SheetJS",t[t.length]=gt,t[t.length]=he("Properties",null,{xmlns:_t.EXT_PROPS,"xmlns:vt":_t.vt}),As.forEach(function(a){if(e[a[1]]!==void 0){var n;switch(a[2]){case"string":n=He(String(e[a[1]]));break;case"bool":n=e[a[1]]?"true":"false";break}n!==void 0&&(t[t.length]=r(a[0],n))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+He(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function hv(e){var t=[gt,he("Properties",null,{xmlns:_t.CUST_PROPS,"xmlns:vt":_t.vt})];if(!e)return t.join("");var r=1;return Pt(e).forEach(function(n){++r,t[t.length]=he("property",pw(e[n],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:He(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var lx={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function t3(e,t){var r=[];return Pt(lx).map(function(a){for(var n=0;n<Cn.length;++n)if(Cn[n][1]==a)return Cn[n];for(n=0;n<As.length;++n)if(As[n][1]==a)return As[n];throw a}).forEach(function(a){if(e[a[1]]!=null){var n=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];switch(a[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(Lt(lx[a[1]]||a[1],n))}}),he("DocumentProperties",r.join(""),{xmlns:hr.o})}function r3(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",n=[];return e&&Pt(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var i=0;i<Cn.length;++i)if(s==Cn[i][1])return;for(i=0;i<As.length;++i)if(s==As[i][1])return;for(i=0;i<r.length;++i)if(s==r[i])return;var c=e[s],o="string";typeof c=="number"?(o="float",c=String(c)):c===!0||c===!1?(o="boolean",c=c?"1":"0"):c=String(c),n.push(he(W1(s),c,{"dt:dt":o}))}}),t&&Pt(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var i=t[s],c="string";typeof i=="number"?(c="float",i=String(i)):i===!0||i===!1?(c="boolean",i=i?"1":"0"):i instanceof Date?(c="dateTime.tz",i=i.toISOString()):i=String(i),n.push(he(W1(s),i,{"dt:dt":c}))}}),"<"+a+' xmlns="'+hr.o+'">'+n.join("")+"</"+a+">"}function a3(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,a=r%Math.pow(2,32),n=(r-a)/Math.pow(2,32);a*=1e7,n*=1e7;var s=a/Math.pow(2,32)|0;s>0&&(a=a%Math.pow(2,32),n+=s);var i=te(8);return i.write_shift(4,a),i.write_shift(4,n),i}function ix(e,t){var r=te(4),a=te(4);switch(r.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=te(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=a3(t);break;case 31:case 80:for(a=te(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Ft([r,a])}var xv=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function n3(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function cx(e,t,r){var a=te(8),n=[],s=[],i=8,c=0,o=te(8),u=te(8);if(o.write_shift(4,2),o.write_shift(4,1200),u.write_shift(4,1),s.push(o),n.push(u),i+=8+o.length,!t){u=te(8),u.write_shift(4,0),n.unshift(u);var f=[te(4)];for(f[0].write_shift(4,e.length),c=0;c<e.length;++c){var h=e[c][0];for(o=te(4+4+2*(h.length+1)+(h.length%2?0:2)),o.write_shift(4,c+2),o.write_shift(4,h.length+1),o.write_shift(0,h,"dbcs");o.l!=o.length;)o.write_shift(1,0);f.push(o)}o=Ft(f),s.unshift(o),i+=8+o.length}for(c=0;c<e.length;++c)if(!(t&&!t[e[c][0]])&&!(xv.indexOf(e[c][0])>-1||fv.indexOf(e[c][0])>-1)&&e[c][1]!=null){var d=e[c][1],x=0;if(t){x=+t[e[c][0]];var b=r[x];if(b.p=="version"&&typeof d=="string"){var m=d.split(".");d=(+m[0]<<16)+(+m[1]||0)}o=ix(b.t,d)}else{var w=n3(d);w==-1&&(w=31,d=String(d)),o=ix(w,d)}s.push(o),u=te(8),u.write_shift(4,t?x:2+c),n.push(u),i+=8+o.length}var p=8*(s.length+1);for(c=0;c<s.length;++c)n[c].write_shift(4,p),p+=s[c].length;return a.write_shift(4,i),a.write_shift(4,s.length),Ft([a].concat(n).concat(s))}function ox(e,t,r,a,n,s){var i=te(n?68:48),c=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,Ye.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,n?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,n?68:48);var o=cx(e,r,a);if(c.push(o),n){var u=cx(n,null,null);i.write_shift(16,s,"hex"),i.write_shift(4,68+o.length),c.push(u)}return Ft(c)}function s3(e,t){t||(t=te(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function l3(e,t){return e.read_shift(t)===1}function Xt(e,t){return t||(t=te(2)),t.write_shift(2,+!!e),t}function mv(e){return e.read_shift(2,"u")}function _r(e,t){return t||(t=te(2)),t.write_shift(2,e),t}function gv(e,t,r){return r||(r=te(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function vv(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var i=a?e.read_shift(a,n):"";return i}function i3(e){var t=e.t||"",r=te(3+0);r.write_shift(2,t.length),r.write_shift(1,1);var a=te(2*t.length);a.write_shift(2*t.length,t,"utf16le");var n=[r,a];return Ft(n)}function c3(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var n=e.read_shift(1);return n===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function o3(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):c3(e,a,r)}function u3(e,t,r){if(r.biff>5)return o3(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function pv(e,t,r){return r||(r=te(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function ux(e,t){t||(t=te(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function f3(e){var t=te(512),r=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var n=a.indexOf("#"),s=n>-1?31:23;switch(a.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(s==28)a=a.slice(1),ux(a,t);else if(s&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var c=n>-1?a.slice(0,n):a;for(t.write_shift(4,2*(c.length+1)),r=0;r<c.length;++r)t.write_shift(2,c.charCodeAt(r));t.write_shift(2,0),s&8&&ux(n>-1?a.slice(n+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var o=0;a.slice(o*3,o*3+3)=="../"||a.slice(o*3,o*3+3)=="..\\";)++o;for(t.write_shift(2,o),t.write_shift(4,a.length-3*o+1),r=0;r<a.length-3*o;++r)t.write_shift(1,a.charCodeAt(r+3*o)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Ln(e,t,r,a){return a||(a=te(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function d3(e,t,r){var a=r.biff>8?4:2,n=e.read_shift(a),s=e.read_shift(a,"i"),i=e.read_shift(a,"i");return[n,s,i]}function h3(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2);return{s:{c:a,r:t},e:{c:n,r}}}function yv(e,t){return t||(t=te(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function ed(e,t,r){var a=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,n=8;break;case"biff4":a=4,n=6;break;case"biff3":a=3,n=6;break;case"biff2":a=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=te(n);return s.write_shift(2,a),s.write_shift(2,t),n>4&&s.write_shift(2,29282),n>6&&s.write_shift(2,1997),n>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function x3(e,t){var r=!t||t.biff==8,a=te(r?112:54);for(a.write_shift(t.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function m3(e,t){var r=!t||t.biff>=8?2:1,a=te(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var n=a.slice(0,a.l);return n.l=a.l,n}function g3(e,t){var r=te(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],n=0;n<e.length;++n)a[n]=i3(e[n]);var s=Ft([r].concat(a));return s.parts=[r.length].concat(a.map(function(i){return i.length})),s}function v3(){var e=te(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function p3(e){var t=te(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function y3(e,t){var r=e.name||"Arial",a=t&&t.biff==5,n=a?15+r.length:16+2*r.length,s=te(n);return s.write_shift(2,(e.sz||12)*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),a||s.write_shift(1,1),s.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),s}function b3(e,t,r,a){var n=te(10);return Ln(e,t,a,n),n.write_shift(4,r),n}function w3(e,t,r,a,n){var s=!n||n.biff==8,i=te(6+2+ +s+(1+s)*r.length);return Ln(e,t,a,i),i.write_shift(2,r.length),s&&i.write_shift(1,1),i.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),i}function N3(e,t,r,a){var n=r&&r.biff==5;a||(a=te(n?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(n?1:2,t.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var s=a.length>a.l?a.slice(0,a.l):a;return s.l==null&&(s.l=s.length),s}function S3(e,t){var r=t.biff==8||!t.biff?4:2,a=te(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function fx(e,t,r,a){var n=r&&r.biff==5;a||(a=te(n?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&n&&(s|=1024),a.write_shift(4,s),a.write_shift(4,0),n||a.write_shift(4,0),a.write_shift(2,0),a}function E3(e){var t=te(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}function T3(e,t,r,a,n,s){var i=te(8);return Ln(e,t,a,i),gv(r,s,i),i}function _3(e,t,r,a){var n=te(14);return Ln(e,t,a,n),Fn(r,n),n}function j3(e,t,r){if(r.biff<8)return A3(e,t,r);for(var a=[],n=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)a.push(d3(e,r.biff>8?12:6,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return a}function A3(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=vv(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function C3(e){var t=te(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)yv(e[r],t);return t}function k3(e){var t=te(24),r=At(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(a[n],16));return Ft([t,f3(e[1])])}function M3(e){var t=e[1].Tooltip,r=te(10+2*(t.length+1));r.write_shift(2,2048);var a=At(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var n=0;n<t.length;++n)r.write_shift(2,t.charCodeAt(n));return r.write_shift(2,0),r}function D3(e){return e||(e=te(4)),e.write_shift(2,1),e.write_shift(2,1),e}function R3(e,t,r){if(!r.cellStyles)return aa(e,t);var a=r&&r.biff>=12?4:2,n=e.read_shift(a),s=e.read_shift(a),i=e.read_shift(a),c=e.read_shift(a),o=e.read_shift(2);a==2&&(e.l+=2);var u={s:n,e:s,w:i,ixfe:c,flags:o};return(r.biff>=5||!r.biff)&&(u.level=o>>8&7),u}function O3(e,t){var r=te(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function F3(e){for(var t=te(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function L3(e,t,r){var a=te(15);return Di(a,e,t),a.write_shift(8,r,"f"),a}function I3(e,t,r){var a=te(9);return Di(a,e,t),a.write_shift(2,r),a}var B3=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Gf({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(c,o){var u=[],f=On(1);switch(o.type){case"base64":f=Hr(Ta(c));break;case"binary":f=Hr(c);break;case"buffer":case"array":f=c;break}dr(f,0);var h=f.read_shift(1),d=!!(h&136),x=!1,b=!1;switch(h){case 2:break;case 3:break;case 48:x=!0,d=!0;break;case 49:x=!0,d=!0;break;case 131:break;case 139:break;case 140:b=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var m=0,w=521;h==2&&(m=f.read_shift(2)),f.l+=3,h!=2&&(m=f.read_shift(4)),m>1048576&&(m=1e6),h!=2&&(w=f.read_shift(2));var p=f.read_shift(2),v=o.codepage||1252;h!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(v=e[f[f.l]]),f.l+=1,f.l+=2),b&&(f.l+=36);for(var g=[],N={},I=Math.min(f.length,h==2?521:w-10-(x?264:0)),z=b?32:11;f.l<I&&f[f.l]!=13;)switch(N={},N.name=bn.utils.decode(v,f.slice(f.l,f.l+z)).replace(/[\u0000\r\n].*$/g,""),f.l+=z,N.type=String.fromCharCode(f.read_shift(1)),h!=2&&!b&&(N.offset=f.read_shift(4)),N.len=f.read_shift(1),h==2&&(N.offset=f.read_shift(2)),N.dec=f.read_shift(1),N.name.length&&g.push(N),h!=2&&(f.l+=b?13:14),N.type){case"B":(!x||N.len!=8)&&o.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":o.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(f[f.l]!==13&&(f.l=w-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=w;var j=0,B=0;for(u[0]=[],B=0;B!=g.length;++B)u[0][B]=g[B].name;for(;m-- >0;){if(f[f.l]===42){f.l+=p;continue}for(++f.l,u[++j]=[],B=0,B=0;B!=g.length;++B){var R=f.slice(f.l,f.l+g[B].len);f.l+=g[B].len,dr(R,0);var H=bn.utils.decode(v,R);switch(g[B].type){case"C":H.trim().length&&(u[j][B]=H.replace(/\s+$/,""));break;case"D":H.length===8?u[j][B]=new Date(+H.slice(0,4),+H.slice(4,6)-1,+H.slice(6,8)):u[j][B]=H;break;case"F":u[j][B]=parseFloat(H.trim());break;case"+":case"I":u[j][B]=b?R.read_shift(-4,"i")^2147483648:R.read_shift(4,"i");break;case"L":switch(H.trim().toUpperCase()){case"Y":case"T":u[j][B]=!0;break;case"N":case"F":u[j][B]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+H+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));u[j][B]="##MEMO##"+(b?parseInt(H.trim(),10):R.read_shift(4));break;case"N":H=H.replace(/\u0000/g,"").trim(),H&&H!="."&&(u[j][B]=+H||0);break;case"@":u[j][B]=new Date(R.read_shift(-8,"f")-621356832e5);break;case"T":u[j][B]=new Date((R.read_shift(4)-2440588)*864e5+R.read_shift(4));break;case"Y":u[j][B]=R.read_shift(4,"i")/1e4+R.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[j][B]=-R.read_shift(-8,"f");break;case"B":if(x&&g[B].len==8){u[j][B]=R.read_shift(8,"f");break}case"G":case"P":R.l+=g[B].len;break;case"0":if(g[B].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+g[B].type)}}}if(h!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return o&&o.sheetRows&&(u=u.slice(0,o.sheetRows)),o.DBF=g,u}function a(c,o){var u=o||{};u.dateNF||(u.dateNF="yyyymmdd");var f=qs(r(c,u),u);return f["!cols"]=u.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete u.DBF,f}function n(c,o){try{return zn(a(c,o),o)}catch(u){if(o&&o.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function i(c,o){var u=o||{};if(+u.codepage>=0&&si(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=er(),h=Sc(c,{header:1,raw:!0,cellDates:!0}),d=h[0],x=h.slice(1),b=c["!cols"]||[],m=0,w=0,p=0,v=1;for(m=0;m<d.length;++m){if(((b[m]||{}).DBF||{}).name){d[m]=b[m].DBF.name,++p;continue}if(d[m]!=null){if(++p,typeof d[m]=="number"&&(d[m]=d[m].toString(10)),typeof d[m]!="string")throw new Error("DBF Invalid column name "+d[m]+" |"+typeof d[m]+"|");if(d.indexOf(d[m])!==m){for(w=0;w<1024;++w)if(d.indexOf(d[m]+"_"+w)==-1){d[m]+="_"+w;break}}}}var g=et(c["!ref"]),N=[],I=[],z=[];for(m=0;m<=g.e.c-g.s.c;++m){var j="",B="",R=0,H=[];for(w=0;w<x.length;++w)x[w][m]!=null&&H.push(x[w][m]);if(H.length==0||d[m]==null){N[m]="?";continue}for(w=0;w<H.length;++w){switch(typeof H[w]){case"number":B="B";break;case"string":B="C";break;case"boolean":B="L";break;case"object":B=H[w]instanceof Date?"D":"C";break;default:B="C"}R=Math.max(R,String(H[w]).length),j=j&&j!=B?"C":B}R>250&&(R=250),B=((b[m]||{}).DBF||{}).type,B=="C"&&b[m].DBF.len>R&&(R=b[m].DBF.len),j=="B"&&B=="N"&&(j="N",z[m]=b[m].DBF.dec,R=b[m].DBF.len),I[m]=j=="C"||B=="N"?R:s[j]||0,v+=I[m],N[m]=j}var q=f.next(32);for(q.write_shift(4,318902576),q.write_shift(4,x.length),q.write_shift(2,296+32*p),q.write_shift(2,v),m=0;m<4;++m)q.write_shift(4,0);for(q.write_shift(4,0|(+t[w2]||3)<<8),m=0,w=0;m<d.length;++m)if(d[m]!=null){var re=f.next(32),se=(d[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);re.write_shift(1,se,"sbcs"),re.write_shift(1,N[m]=="?"?"C":N[m],"sbcs"),re.write_shift(4,w),re.write_shift(1,I[m]||s[N[m]]||0),re.write_shift(1,z[m]||0),re.write_shift(1,2),re.write_shift(4,0),re.write_shift(1,0),re.write_shift(4,0),re.write_shift(4,0),w+=I[m]||s[N[m]]||0}var le=f.next(264);for(le.write_shift(4,13),m=0;m<65;++m)le.write_shift(4,0);for(m=0;m<x.length;++m){var G=f.next(v);for(G.write_shift(1,0),w=0;w<d.length;++w)if(d[w]!=null)switch(N[w]){case"L":G.write_shift(1,x[m][w]==null?63:x[m][w]?84:70);break;case"B":G.write_shift(8,x[m][w]||0,"f");break;case"N":var C="0";for(typeof x[m][w]=="number"&&(C=x[m][w].toFixed(z[w]||0)),p=0;p<I[w]-C.length;++p)G.write_shift(1,32);G.write_shift(1,C,"sbcs");break;case"D":x[m][w]?(G.write_shift(4,("0000"+x[m][w].getFullYear()).slice(-4),"sbcs"),G.write_shift(2,("00"+(x[m][w].getMonth()+1)).slice(-2),"sbcs"),G.write_shift(2,("00"+x[m][w].getDate()).slice(-2),"sbcs")):G.write_shift(8,"00000000","sbcs");break;case"C":var K=String(x[m][w]!=null?x[m][w]:"").slice(0,I[w]);for(G.write_shift(1,K,"sbcs"),p=0;p<I[w]-K.length;++p)G.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:n,to_sheet:a,from_sheet:i}}(),P3=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Pt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,x){var b=e[x];return typeof b=="number"?F1(b):b},a=function(d,x,b){var m=x.charCodeAt(0)-32<<4|b.charCodeAt(0)-48;return m==59?d:F1(m)};e["|"]=254;function n(d,x){switch(x.type){case"base64":return s(Ta(d),x);case"binary":return s(d,x);case"buffer":return s(Fe&&Buffer.isBuffer(d)?d.toString("binary"):ji(d),x);case"array":return s(Xc(d),x)}throw new Error("Unrecognized type "+x.type)}function s(d,x){var b=d.split(/[\n\r]+/),m=-1,w=-1,p=0,v=0,g=[],N=[],I=null,z={},j=[],B=[],R=[],H=0,q;for(+x.codepage>=0&&si(+x.codepage);p!==b.length;++p){H=0;var re=b[p].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),se=re.replace(/;;/g,"\0").split(";").map(function(D){return D.replace(/\u0000/g,";")}),le=se[0],G;if(re.length>0)switch(le){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":se[1].charAt(0)=="P"&&N.push(re.slice(3).replace(/;;/g,";"));break;case"C":var C=!1,K=!1,O=!1,ne=!1,ye=-1,Te=-1;for(v=1;v<se.length;++v)switch(se[v].charAt(0)){case"A":break;case"X":w=parseInt(se[v].slice(1))-1,K=!0;break;case"Y":for(m=parseInt(se[v].slice(1))-1,K||(w=0),q=g.length;q<=m;++q)g[q]=[];break;case"K":G=se[v].slice(1),G.charAt(0)==='"'?G=G.slice(1,G.length-1):G==="TRUE"?G=!0:G==="FALSE"?G=!1:isNaN(ya(G))?isNaN(ii(G).getDate())||(G=Qt(G)):(G=ya(G),I!==null&&R2(I)&&(G=I2(G))),C=!0;break;case"E":ne=!0;var M=IN(se[v].slice(1),{r:m,c:w});g[m][w]=[g[m][w],M];break;case"S":O=!0,g[m][w]=[g[m][w],"S5S"];break;case"G":break;case"R":ye=parseInt(se[v].slice(1))-1;break;case"C":Te=parseInt(se[v].slice(1))-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+re)}if(C&&(g[m][w]&&g[m][w].length==2?g[m][w][0]=G:g[m][w]=G,I=null),O){if(ne)throw new Error("SYLK shared formula cannot have own formula");var P=ye>-1&&g[ye][Te];if(!P||!P[1])throw new Error("SYLK shared formula cannot find base");g[m][w][1]=BN(P[1],{r:m-ye,c:w-Te})}break;case"F":var F=0;for(v=1;v<se.length;++v)switch(se[v].charAt(0)){case"X":w=parseInt(se[v].slice(1))-1,++F;break;case"Y":for(m=parseInt(se[v].slice(1))-1,q=g.length;q<=m;++q)g[q]=[];break;case"M":H=parseInt(se[v].slice(1))/20;break;case"F":break;case"G":break;case"P":I=N[parseInt(se[v].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(R=se[v].slice(1).split(" "),q=parseInt(R[0],10);q<=parseInt(R[1],10);++q)H=parseInt(R[2],10),B[q-1]=H===0?{hidden:!0}:{wch:H},td(B[q-1]);break;case"C":w=parseInt(se[v].slice(1))-1,B[w]||(B[w]={});break;case"R":m=parseInt(se[v].slice(1))-1,j[m]||(j[m]={}),H>0?(j[m].hpt=H,j[m].hpx=Ev(H)):H===0&&(j[m].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+re)}F<1&&(I=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+re)}}return j.length>0&&(z["!rows"]=j),B.length>0&&(z["!cols"]=B),x&&x.sheetRows&&(g=g.slice(0,x.sheetRows)),[g,z]}function i(d,x){var b=n(d,x),m=b[0],w=b[1],p=qs(m,x);return Pt(w).forEach(function(v){p[v]=w[v]}),p}function c(d,x){return zn(i(d,x),x)}function o(d,x,b,m){var w="C;Y"+(b+1)+";X"+(m+1)+";K";switch(d.t){case"n":w+=d.v||0,d.f&&!d.F&&(w+=";E"+ad(d.f,{r:b,c:m}));break;case"b":w+=d.v?"TRUE":"FALSE";break;case"e":w+=d.w||d.v;break;case"d":w+='"'+(d.w||d.v)+'"';break;case"s":w+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function u(d,x){x.forEach(function(b,m){var w="F;W"+(m+1)+" "+(m+1)+" ";b.hidden?w+="0":(typeof b.width=="number"&&!b.wpx&&(b.wpx=yc(b.width)),typeof b.wpx=="number"&&!b.wch&&(b.wch=bc(b.wpx)),typeof b.wch=="number"&&(w+=Math.round(b.wch))),w.charAt(w.length-1)!=" "&&d.push(w)})}function f(d,x){x.forEach(function(b,m){var w="F;";b.hidden?w+="M0;":b.hpt?w+="M"+20*b.hpt+";":b.hpx&&(w+="M"+20*wc(b.hpx)+";"),w.length>2&&d.push(w+"R"+(m+1))})}function h(d,x){var b=["ID;PWXL;N;E"],m=[],w=et(d["!ref"]),p,v=Array.isArray(d),g=`\r
`;b.push("P;PGeneral"),b.push("F;P0;DG0G8;M255"),d["!cols"]&&u(b,d["!cols"]),d["!rows"]&&f(b,d["!rows"]),b.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var N=w.s.r;N<=w.e.r;++N)for(var I=w.s.c;I<=w.e.c;++I){var z=Ge({r:N,c:I});p=v?(d[N]||[])[I]:d[z],!(!p||p.v==null&&(!p.f||p.F))&&m.push(o(p,d,N,I))}return b.join(g)+g+m.join(g)+g+"E"+g}return{to_workbook:c,to_sheet:i,from_sheet:h}}(),U3=function(){function e(s,i){switch(i.type){case"base64":return t(Ta(s),i);case"binary":return t(s,i);case"buffer":return t(Fe&&Buffer.isBuffer(s)?s.toString("binary"):ji(s),i);case"array":return t(Xc(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){for(var c=s.split(`
`),o=-1,u=-1,f=0,h=[];f!==c.length;++f){if(c[f].trim()==="BOT"){h[++o]=[],u=0;continue}if(!(o<0)){var d=c[f].trim().split(","),x=d[0],b=d[1];++f;for(var m=c[f]||"";(m.match(/["]/g)||[]).length&1&&f<c.length-1;)m+=`
`+c[++f];switch(m=m.trim(),+x){case-1:if(m==="BOT"){h[++o]=[],u=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?h[o][u]=!0:m==="FALSE"?h[o][u]=!1:isNaN(ya(b))?isNaN(ii(b).getDate())?h[o][u]=b:h[o][u]=Qt(b):h[o][u]=ya(b),++u;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),h[o][u++]=m!==""?m:null;break}if(m==="EOD")break}}return i&&i.sheetRows&&(h=h.slice(0,i.sheetRows)),h}function r(s,i){return qs(e(s,i),i)}function a(s,i){return zn(r(s,i),i)}var n=function(){var s=function(o,u,f,h,d){o.push(u),o.push(f+","+h),o.push('"'+d.replace(/"/g,'""')+'"')},i=function(o,u,f,h){o.push(u+","+f),o.push(u==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(o){var u=[],f=et(o["!ref"]),h,d=Array.isArray(o);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,f.e.r-f.s.r+1,""),s(u,"TUPLES",0,f.e.c-f.s.c+1,""),s(u,"DATA",0,0,"");for(var x=f.s.r;x<=f.e.r;++x){i(u,-1,0,"BOT");for(var b=f.s.c;b<=f.e.c;++b){var m=Ge({r:x,c:b});if(h=d?(o[x]||[])[b]:o[m],!h){i(u,1,0,"");continue}switch(h.t){case"n":var w=h.w;!w&&h.v!=null&&(w=h.v),w==null?h.f&&!h.F?i(u,1,0,"="+h.f):i(u,1,0,""):i(u,0,w,"V");break;case"b":i(u,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":i(u,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=ln(h.z||ct[14],rr(Qt(h.v)))),i(u,0,h.w,"V");break;default:i(u,1,0,"")}}}i(u,-1,0,"EOD");var p=`\r
`,v=u.join(p);return v}}();return{to_workbook:a,to_sheet:r,from_sheet:n}}(),bv=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,d){for(var x=h.split(`
`),b=-1,m=-1,w=0,p=[];w!==x.length;++w){var v=x[w].trim().split(":");if(v[0]==="cell"){var g=At(v[1]);if(p.length<=g.r)for(b=p.length;b<=g.r;++b)p[b]||(p[b]=[]);switch(b=g.r,m=g.c,v[2]){case"t":p[b][m]=e(v[3]);break;case"v":p[b][m]=+v[3];break;case"vtf":var N=v[v.length-1];case"vtc":switch(v[3]){case"nl":p[b][m]=!!+v[4];break;default:p[b][m]=+v[4];break}v[2]=="vtf"&&(p[b][m]=[p[b][m],N])}}}return d&&d.sheetRows&&(p=p.slice(0,d.sheetRows)),p}function a(h,d){return qs(r(h,d),d)}function n(h,d){return zn(a(h,d),d)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),o="--SocialCalcSpreadsheetControlSave--";function u(h){if(!h||!h["!ref"])return"";for(var d=[],x=[],b,m="",w=wr(h["!ref"]),p=Array.isArray(h),v=w.s.r;v<=w.e.r;++v)for(var g=w.s.c;g<=w.e.c;++g)if(m=Ge({r:v,c:g}),b=p?(h[v]||[])[g]:h[m],!(!b||b.v==null||b.t==="z")){switch(x=["cell",m,"t"],b.t){case"s":case"str":x.push(t(b.v));break;case"n":b.f?(x[2]="vtf",x[3]="n",x[4]=b.v,x[5]=t(b.f)):(x[2]="v",x[3]=b.v);break;case"b":x[2]="vt"+(b.f?"f":"c"),x[3]="nl",x[4]=b.v?"1":"0",x[5]=t(b.f||(b.v?"TRUE":"FALSE"));break;case"d":var N=rr(Qt(b.v));x[2]="vtc",x[3]="nd",x[4]=""+N,x[5]=b.w||ln(b.z||ct[14],N);break;case"e":continue}d.push(x.join(":"))}return d.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function f(h){return[s,i,c,i,u(h),o].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:f}}(),z3=function(){function e(f,h,d,x,b){b.raw?h[d][x]=f:f===""||(f==="TRUE"?h[d][x]=!0:f==="FALSE"?h[d][x]=!1:isNaN(ya(f))?isNaN(ii(f).getDate())?h[d][x]=f:h[d][x]=Qt(f):h[d][x]=ya(f))}function t(f,h){var d=h||{},x=[];if(!f||f.length===0)return x;for(var b=f.split(/[\r\n]/),m=b.length-1;m>=0&&b[m].length===0;)--m;for(var w=10,p=0,v=0;v<=m;++v)p=b[v].indexOf(" "),p==-1?p=b[v].length:p++,w=Math.max(w,p);for(v=0;v<=m;++v){x[v]=[];var g=0;for(e(b[v].slice(0,w).trim(),x,v,g,d),g=1;g<=(b[v].length-w)/10+1;++g)e(b[v].slice(w+(g-1)*10,w+g*10).trim(),x,v,g,d)}return d.sheetRows&&(x=x.slice(0,d.sheetRows)),x}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(f){for(var h={},d=!1,x=0,b=0;x<f.length;++x)(b=f.charCodeAt(x))==34?d=!d:!d&&b in r&&(h[b]=(h[b]||0)+1);b=[];for(x in h)Object.prototype.hasOwnProperty.call(h,x)&&b.push([h[x],x]);if(!b.length){h=a;for(x in h)Object.prototype.hasOwnProperty.call(h,x)&&b.push([h[x],x])}return b.sort(function(m,w){return m[0]-w[0]||a[m[1]]-a[w[1]]}),r[b.pop()[1]]||44}function s(f,h){var d=h||{},x="",b=d.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(x=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(x=f.charAt(4),f=f.slice(6)):x=n(f.slice(0,1024)):d&&d.FS?x=d.FS:x=n(f.slice(0,1024));var w=0,p=0,v=0,g=0,N=0,I=x.charCodeAt(0),z=!1,j=0,B=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var R=d.dateNF!=null?aw(d.dateNF):null;function H(){var q=f.slice(g,N),re={};if(q.charAt(0)=='"'&&q.charAt(q.length-1)=='"'&&(q=q.slice(1,-1).replace(/""/g,'"')),q.length===0)re.t="z";else if(d.raw)re.t="s",re.v=q;else if(q.trim().length===0)re.t="s",re.v=q;else if(q.charCodeAt(0)==61)q.charCodeAt(1)==34&&q.charCodeAt(q.length-1)==34?(re.t="s",re.v=q.slice(2,-1).replace(/""/g,'"')):PN(q)?(re.t="n",re.f=q.slice(1)):(re.t="s",re.v=q);else if(q=="TRUE")re.t="b",re.v=!0;else if(q=="FALSE")re.t="b",re.v=!1;else if(!isNaN(v=ya(q)))re.t="n",d.cellText!==!1&&(re.w=q),re.v=v;else if(!isNaN(ii(q).getDate())||R&&q.match(R)){re.z=d.dateNF||ct[14];var se=0;R&&q.match(R)&&(q=nw(q,d.dateNF,q.match(R)||[]),se=1),d.cellDates?(re.t="d",re.v=Qt(q,se)):(re.t="n",re.v=rr(Qt(q,se))),d.cellText!==!1&&(re.w=ln(re.z,re.v instanceof Date?rr(re.v):re.v)),d.cellNF||delete re.z}else re.t="s",re.v=q;if(re.t=="z"||(d.dense?(b[w]||(b[w]=[]),b[w][p]=re):b[Ge({c:p,r:w})]=re),g=N+1,B=f.charCodeAt(g),m.e.c<p&&(m.e.c=p),m.e.r<w&&(m.e.r=w),j==I)++p;else if(p=0,++w,d.sheetRows&&d.sheetRows<=w)return!0}e:for(;N<f.length;++N)switch(j=f.charCodeAt(N)){case 34:B===34&&(z=!z);break;case I:case 10:case 13:if(!z&&H())break e;break}return N-g>0&&H(),b["!ref"]=mt(m),b}function i(f,h){return!(h&&h.PRN)||h.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,h):qs(t(f,h),h)}function c(f,h){var d="",x=h.type=="string"?[0,0,0,0]:$_(f,h);switch(h.type){case"base64":d=Ta(f);break;case"binary":d=f;break;case"buffer":h.codepage==65001?d=f.toString("utf8"):h.codepage&&typeof bn<"u"?d=bn.utils.decode(h.codepage,f):d=Fe&&Buffer.isBuffer(f)?f.toString("binary"):ji(f);break;case"array":d=Xc(f);break;case"string":d=f;break;default:throw new Error("Unrecognized type "+h.type)}return x[0]==239&&x[1]==187&&x[2]==191?d=Ul(d.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?d=Ul(d):h.type=="binary"&&typeof bn<"u"&&h.codepage&&(d=bn.utils.decode(h.codepage,bn.utils.encode(28591,d))),d.slice(0,19)=="socialcalc:version:"?bv.to_sheet(h.type=="string"?d:Ul(d),h):i(d,h)}function o(f,h){return zn(c(f,h),h)}function u(f){for(var h=[],d=et(f["!ref"]),x,b=Array.isArray(f),m=d.s.r;m<=d.e.r;++m){for(var w=[],p=d.s.c;p<=d.e.c;++p){var v=Ge({r:m,c:p});if(x=b?(f[m]||[])[p]:f[v],!x||x.v==null){w.push("          ");continue}for(var g=(x.w||(_a(x),x.w)||"").slice(0,10);g.length<10;)g+=" ";w.push(g+(p===0?" ":""))}h.push(w.join(""))}return h.join(`
`)}return{to_workbook:o,to_sheet:c,from_sheet:u}}(),dx=function(){function e(M,P,F){if(M){dr(M,M.l||0);for(var D=F.Enum||ye;M.l<M.length;){var k=M.read_shift(2),U=D[k]||D[65535],ee=M.read_shift(2),ue=M.l+ee,ie=U.f&&U.f(M,ee,F);if(M.l=ue,P(ie,U,k))return}}}function t(M,P){switch(P.type){case"base64":return r(Hr(Ta(M)),P);case"binary":return r(Hr(M),P);case"buffer":case"array":return r(M,P)}throw"Unsupported type "+P.type}function r(M,P){if(!M)return M;var F=P||{},D=F.dense?[]:{},k="Sheet1",U="",ee=0,ue={},ie=[],be=[],we={s:{r:0,c:0},e:{r:0,c:0}},W=F.sheetRows||0;if(M[2]==0&&(M[3]==8||M[3]==9)&&M.length>=16&&M[14]==5&&M[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(M[2]==2)F.Enum=ye,e(M,function(me,vt,Ze){switch(Ze){case 0:F.vers=me,me>=4096&&(F.qpro=!0);break;case 6:we=me;break;case 204:me&&(U=me);break;case 222:U=me;break;case 15:case 51:F.qpro||(me[1].v=me[1].v.slice(1));case 13:case 14:case 16:Ze==14&&(me[2]&112)==112&&(me[2]&15)>1&&(me[2]&15)<15&&(me[1].z=F.dateNF||ct[14],F.cellDates&&(me[1].t="d",me[1].v=I2(me[1].v))),F.qpro&&me[3]>ee&&(D["!ref"]=mt(we),ue[k]=D,ie.push(k),D=F.dense?[]:{},we={s:{r:0,c:0},e:{r:0,c:0}},ee=me[3],k=U||"Sheet"+(ee+1),U="");var lr=F.dense?(D[me[0].r]||[])[me[0].c]:D[Ge(me[0])];if(lr){lr.t=me[1].t,lr.v=me[1].v,me[1].z!=null&&(lr.z=me[1].z),me[1].f!=null&&(lr.f=me[1].f);break}F.dense?(D[me[0].r]||(D[me[0].r]=[]),D[me[0].r][me[0].c]=me[1]):D[Ge(me[0])]=me[1];break}},F);else if(M[2]==26||M[2]==14)F.Enum=Te,M[2]==14&&(F.qpro=!0,M.l=0),e(M,function(me,vt,Ze){switch(Ze){case 204:k=me;break;case 22:me[1].v=me[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(me[3]>ee&&(D["!ref"]=mt(we),ue[k]=D,ie.push(k),D=F.dense?[]:{},we={s:{r:0,c:0},e:{r:0,c:0}},ee=me[3],k="Sheet"+(ee+1)),W>0&&me[0].r>=W)break;F.dense?(D[me[0].r]||(D[me[0].r]=[]),D[me[0].r][me[0].c]=me[1]):D[Ge(me[0])]=me[1],we.e.c<me[0].c&&(we.e.c=me[0].c),we.e.r<me[0].r&&(we.e.r=me[0].r);break;case 27:me[14e3]&&(be[me[14e3][0]]=me[14e3][1]);break;case 1537:be[me[0]]=me[1],me[0]==ee&&(k=me[1]);break}},F);else throw new Error("Unrecognized LOTUS BOF "+M[2]);if(D["!ref"]=mt(we),ue[U||k]=D,ie.push(U||k),!be.length)return{SheetNames:ie,Sheets:ue};for(var Q={},_e=[],Ne=0;Ne<be.length;++Ne)ue[ie[Ne]]?(_e.push(be[Ne]||ie[Ne]),Q[be[Ne]]=ue[be[Ne]]||ue[ie[Ne]]):(_e.push(be[Ne]),Q[be[Ne]]={"!ref":"A1"});return{SheetNames:_e,Sheets:Q}}function a(M,P){var F=P||{};if(+F.codepage>=0&&si(+F.codepage),F.type=="string")throw new Error("Cannot write WK1 to JS string");var D=er(),k=et(M["!ref"]),U=Array.isArray(M),ee=[];xe(D,0,s(1030)),xe(D,6,o(k));for(var ue=Math.min(k.e.r,8191),ie=k.s.r;ie<=ue;++ie)for(var be=Bt(ie),we=k.s.c;we<=k.e.c;++we){ie===k.s.r&&(ee[we]=Gt(we));var W=ee[we]+be,Q=U?(M[ie]||[])[we]:M[W];if(!(!Q||Q.t=="z"))if(Q.t=="n")(Q.v|0)==Q.v&&Q.v>=-32768&&Q.v<=32767?xe(D,13,x(ie,we,Q.v)):xe(D,14,m(ie,we,Q.v));else{var _e=_a(Q);xe(D,15,h(ie,we,_e.slice(0,239)))}}return xe(D,1),D.end()}function n(M,P){var F=P||{};if(+F.codepage>=0&&si(+F.codepage),F.type=="string")throw new Error("Cannot write WK3 to JS string");var D=er();xe(D,0,i(M));for(var k=0,U=0;k<M.SheetNames.length;++k)(M.Sheets[M.SheetNames[k]]||{})["!ref"]&&xe(D,27,ne(M.SheetNames[k],U++));var ee=0;for(k=0;k<M.SheetNames.length;++k){var ue=M.Sheets[M.SheetNames[k]];if(!(!ue||!ue["!ref"])){for(var ie=et(ue["!ref"]),be=Array.isArray(ue),we=[],W=Math.min(ie.e.r,8191),Q=ie.s.r;Q<=W;++Q)for(var _e=Bt(Q),Ne=ie.s.c;Ne<=ie.e.c;++Ne){Q===ie.s.r&&(we[Ne]=Gt(Ne));var me=we[Ne]+_e,vt=be?(ue[Q]||[])[Ne]:ue[me];if(!(!vt||vt.t=="z"))if(vt.t=="n")xe(D,23,H(Q,Ne,ee,vt.v));else{var Ze=_a(vt);xe(D,22,j(Q,Ne,ee,Ze.slice(0,239)))}}++ee}}return xe(D,1),D.end()}function s(M){var P=te(2);return P.write_shift(2,M),P}function i(M){var P=te(26);P.write_shift(2,4096),P.write_shift(2,4),P.write_shift(4,0);for(var F=0,D=0,k=0,U=0;U<M.SheetNames.length;++U){var ee=M.SheetNames[U],ue=M.Sheets[ee];if(!(!ue||!ue["!ref"])){++k;var ie=wr(ue["!ref"]);F<ie.e.r&&(F=ie.e.r),D<ie.e.c&&(D=ie.e.c)}}return F>8191&&(F=8191),P.write_shift(2,F),P.write_shift(1,k),P.write_shift(1,D),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(1,1),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(4,0),P}function c(M,P,F){var D={s:{c:0,r:0},e:{c:0,r:0}};return P==8&&F.qpro?(D.s.c=M.read_shift(1),M.l++,D.s.r=M.read_shift(2),D.e.c=M.read_shift(1),M.l++,D.e.r=M.read_shift(2),D):(D.s.c=M.read_shift(2),D.s.r=M.read_shift(2),P==12&&F.qpro&&(M.l+=2),D.e.c=M.read_shift(2),D.e.r=M.read_shift(2),P==12&&F.qpro&&(M.l+=2),D.s.c==65535&&(D.s.c=D.e.c=D.s.r=D.e.r=0),D)}function o(M){var P=te(8);return P.write_shift(2,M.s.c),P.write_shift(2,M.s.r),P.write_shift(2,M.e.c),P.write_shift(2,M.e.r),P}function u(M,P,F){var D=[{c:0,r:0},{t:"n",v:0},0,0];return F.qpro&&F.vers!=20768?(D[0].c=M.read_shift(1),D[3]=M.read_shift(1),D[0].r=M.read_shift(2),M.l+=2):(D[2]=M.read_shift(1),D[0].c=M.read_shift(2),D[0].r=M.read_shift(2)),D}function f(M,P,F){var D=M.l+P,k=u(M,P,F);if(k[1].t="s",F.vers==20768){M.l++;var U=M.read_shift(1);return k[1].v=M.read_shift(U,"utf8"),k}return F.qpro&&M.l++,k[1].v=M.read_shift(D-M.l,"cstr"),k}function h(M,P,F){var D=te(7+F.length);D.write_shift(1,255),D.write_shift(2,P),D.write_shift(2,M),D.write_shift(1,39);for(var k=0;k<D.length;++k){var U=F.charCodeAt(k);D.write_shift(1,U>=128?95:U)}return D.write_shift(1,0),D}function d(M,P,F){var D=u(M,P,F);return D[1].v=M.read_shift(2,"i"),D}function x(M,P,F){var D=te(7);return D.write_shift(1,255),D.write_shift(2,P),D.write_shift(2,M),D.write_shift(2,F,"i"),D}function b(M,P,F){var D=u(M,P,F);return D[1].v=M.read_shift(8,"f"),D}function m(M,P,F){var D=te(13);return D.write_shift(1,255),D.write_shift(2,P),D.write_shift(2,M),D.write_shift(8,F,"f"),D}function w(M,P,F){var D=M.l+P,k=u(M,P,F);if(k[1].v=M.read_shift(8,"f"),F.qpro)M.l=D;else{var U=M.read_shift(2);N(M.slice(M.l,M.l+U),k),M.l+=U}return k}function p(M,P,F){var D=P&32768;return P&=-32769,P=(D?M:0)+(P>=8192?P-16384:P),(D?"":"$")+(F?Gt(P):Bt(P))}var v={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},g=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(M,P){dr(M,0);for(var F=[],D=0,k="",U="",ee="",ue="";M.l<M.length;){var ie=M[M.l++];switch(ie){case 0:F.push(M.read_shift(8,"f"));break;case 1:U=p(P[0].c,M.read_shift(2),!0),k=p(P[0].r,M.read_shift(2),!1),F.push(U+k);break;case 2:{var be=p(P[0].c,M.read_shift(2),!0),we=p(P[0].r,M.read_shift(2),!1);U=p(P[0].c,M.read_shift(2),!0),k=p(P[0].r,M.read_shift(2),!1),F.push(be+we+":"+U+k)}break;case 3:if(M.l<M.length){console.error("WK1 premature formula end");return}break;case 4:F.push("("+F.pop()+")");break;case 5:F.push(M.read_shift(2));break;case 6:{for(var W="";ie=M[M.l++];)W+=String.fromCharCode(ie);F.push('"'+W.replace(/"/g,'""')+'"')}break;case 8:F.push("-"+F.pop());break;case 23:F.push("+"+F.pop());break;case 22:F.push("NOT("+F.pop()+")");break;case 20:case 21:ue=F.pop(),ee=F.pop(),F.push(["AND","OR"][ie-20]+"("+ee+","+ue+")");break;default:if(ie<32&&g[ie])ue=F.pop(),ee=F.pop(),F.push(ee+g[ie]+ue);else if(v[ie]){if(D=v[ie][1],D==69&&(D=M[M.l++]),D>F.length){console.error("WK1 bad formula parse 0x"+ie.toString(16)+":|"+F.join("|")+"|");return}var Q=F.slice(-D);F.length-=D,F.push(v[ie][0]+"("+Q.join(",")+")")}else return ie<=7?console.error("WK1 invalid opcode "+ie.toString(16)):ie<=24?console.error("WK1 unsupported op "+ie.toString(16)):ie<=30?console.error("WK1 invalid opcode "+ie.toString(16)):ie<=115?console.error("WK1 unsupported function opcode "+ie.toString(16)):console.error("WK1 unrecognized opcode "+ie.toString(16))}}F.length==1?P[1].f=""+F[0]:console.error("WK1 bad formula parse |"+F.join("|")+"|")}function I(M){var P=[{c:0,r:0},{t:"n",v:0},0];return P[0].r=M.read_shift(2),P[3]=M[M.l++],P[0].c=M[M.l++],P}function z(M,P){var F=I(M);return F[1].t="s",F[1].v=M.read_shift(P-4,"cstr"),F}function j(M,P,F,D){var k=te(6+D.length);k.write_shift(2,M),k.write_shift(1,F),k.write_shift(1,P),k.write_shift(1,39);for(var U=0;U<D.length;++U){var ee=D.charCodeAt(U);k.write_shift(1,ee>=128?95:ee)}return k.write_shift(1,0),k}function B(M,P){var F=I(M);F[1].v=M.read_shift(2);var D=F[1].v>>1;if(F[1].v&1)switch(D&7){case 0:D=(D>>3)*5e3;break;case 1:D=(D>>3)*500;break;case 2:D=(D>>3)/20;break;case 3:D=(D>>3)/200;break;case 4:D=(D>>3)/2e3;break;case 5:D=(D>>3)/2e4;break;case 6:D=(D>>3)/16;break;case 7:D=(D>>3)/64;break}return F[1].v=D,F}function R(M,P){var F=I(M),D=M.read_shift(4),k=M.read_shift(4),U=M.read_shift(2);if(U==65535)return D===0&&k===3221225472?(F[1].t="e",F[1].v=15):D===0&&k===3489660928?(F[1].t="e",F[1].v=42):F[1].v=0,F;var ee=U&32768;return U=(U&32767)-16446,F[1].v=(1-ee*2)*(k*Math.pow(2,U+32)+D*Math.pow(2,U)),F}function H(M,P,F,D){var k=te(14);if(k.write_shift(2,M),k.write_shift(1,F),k.write_shift(1,P),D==0)return k.write_shift(4,0),k.write_shift(4,0),k.write_shift(2,65535),k;var U=0,ee=0,ue=0,ie=0;return D<0&&(U=1,D=-D),ee=Math.log2(D)|0,D/=Math.pow(2,ee-31),ie=D>>>0,ie&2147483648||(D/=2,++ee,ie=D>>>0),D-=ie,ie|=2147483648,ie>>>=0,D*=Math.pow(2,32),ue=D>>>0,k.write_shift(4,ue),k.write_shift(4,ie),ee+=16383+(U?32768:0),k.write_shift(2,ee),k}function q(M,P){var F=R(M);return M.l+=P-14,F}function re(M,P){var F=I(M),D=M.read_shift(4);return F[1].v=D>>6,F}function se(M,P){var F=I(M),D=M.read_shift(8,"f");return F[1].v=D,F}function le(M,P){var F=se(M);return M.l+=P-10,F}function G(M,P){return M[M.l+P-1]==0?M.read_shift(P,"cstr"):""}function C(M,P){var F=M[M.l++];F>P-1&&(F=P-1);for(var D="";D.length<F;)D+=String.fromCharCode(M[M.l++]);return D}function K(M,P,F){if(!(!F.qpro||P<21)){var D=M.read_shift(1);M.l+=17,M.l+=1,M.l+=2;var k=M.read_shift(P-21,"cstr");return[D,k]}}function O(M,P){for(var F={},D=M.l+P;M.l<D;){var k=M.read_shift(2);if(k==14e3){for(F[k]=[0,""],F[k][0]=M.read_shift(2);M[M.l];)F[k][1]+=String.fromCharCode(M[M.l]),M.l++;M.l++}}return F}function ne(M,P){var F=te(5+M.length);F.write_shift(2,14e3),F.write_shift(2,P);for(var D=0;D<M.length;++D){var k=M.charCodeAt(D);F[F.l++]=k>127?95:k}return F[F.l++]=0,F}var ye={0:{n:"BOF",f:mv},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:b},15:{n:"LABEL",f},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:G},222:{n:"SHEETNAMELP",f:C},65535:{n:""}},Te={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:z},23:{n:"NUMBER17",f:R},24:{n:"NUMBER18",f:B},25:{n:"FORMULA19",f:q},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:O},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:re},38:{n:"??"},39:{n:"NUMBER27",f:se},40:{n:"FORMULA28",f:le},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:G},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:K},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:t}}(),H3=/^\s|\s$|[\t\n\r]/;function wv(e,t){if(!t.bookSST)return"";var r=[gt];r[r.length]=he("sst",null,{xmlns:Qs[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var n=e[a],s="<si>";n.r?s+=n.r:(s+="<t",n.t||(n.t=""),n.t.match(H3)&&(s+=' xml:space="preserve"'),s+=">"+He(n.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function G3(e){return[e.read_shift(4),e.read_shift(4)]}function V3(e,t){return t||(t=te(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var Y3=Fw;function X3(e){var t=er();oe(t,159,V3(e));for(var r=0;r<e.length;++r)oe(t,19,Y3(e[r]));return oe(t,160),t.end()}function W3(e){for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function Nv(e){var t=0,r,a=W3(e),n=a.length+1,s,i,c,o,u;for(r=On(n),r[0]=a.length,s=1;s!=n;++s)r[s]=a[s-1];for(s=n-1;s>=0;--s)i=r[s],c=t&16384?1:0,o=t<<1&32767,u=c|o,t=u^i;return t^52811}var J3=function(){function e(n,s){switch(s.type){case"base64":return t(Ta(n),s);case"binary":return t(n,s);case"buffer":return t(Fe&&Buffer.isBuffer(n)?n.toString("binary"):ji(n),s);case"array":return t(Xc(n),s)}throw new Error("Unrecognized type "+s.type)}function t(n,s){var i=s||{},c=i.dense?[]:{},o=n.match(/\\trowd.*?\\row\b/g);if(!o.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:o.length-1}};return o.forEach(function(f,h){Array.isArray(c)&&(c[h]=[]);for(var d=/\\\w+\b/g,x=0,b,m=-1;b=d.exec(f);){switch(b[0]){case"\\cell":var w=f.slice(x,d.lastIndex-b[0].length);if(w[0]==" "&&(w=w.slice(1)),++m,w.length){var p={v:w,t:"s"};Array.isArray(c)?c[h][m]=p:c[Ge({r:h,c:m})]=p}break}x=d.lastIndex}m>u.e.c&&(u.e.c=m)}),c["!ref"]=mt(u),c}function r(n,s){return zn(e(n,s),s)}function a(n){for(var s=["{\\rtf1\\ansi"],i=et(n["!ref"]),c,o=Array.isArray(n),u=i.s.r;u<=i.e.r;++u){s.push("\\trowd\\trautofit1");for(var f=i.s.c;f<=i.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=i.s.c;f<=i.e.c;++f){var h=Ge({r:u,c:f});c=o?(n[u]||[])[f]:n[h],!(!c||c.v==null&&(!c.f||c.F))&&(s.push(" "+(c.w||(_a(c),c.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}}();function hx(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var Q3=6,ba=Q3;function yc(e){return Math.floor((e+Math.round(128/ba)/256)*ba)}function bc(e){return Math.floor((e-5)/ba*100+.5)/100}function Pu(e){return Math.round((e*ba+5)/ba*256)/256}function td(e){e.width?(e.wpx=yc(e.width),e.wch=bc(e.wpx),e.MDW=ba):e.wpx?(e.wch=bc(e.wpx),e.width=Pu(e.wch),e.MDW=ba):typeof e.wch=="number"&&(e.width=Pu(e.wch),e.wpx=yc(e.width),e.MDW=ba),e.customWidth&&delete e.customWidth}var q3=96,Sv=q3;function wc(e){return e*96/Sv}function Ev(e){return e*Sv/96}function K3(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&(t[t.length]=he("numFmt",null,{numFmtId:a,formatCode:He(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=he("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function Z3(e){var t=[];return t[t.length]=he("cellXfs",null),e.forEach(function(r){t[t.length]=he("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=he("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function Tv(e,t){var r=[gt,he("styleSheet",null,{xmlns:Qs[0],"xmlns:vt":_t.vt})],a;return e.SSF&&(a=K3(e.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=Z3(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function $3(e,t){var r=e.read_shift(2),a=Vt(e);return[r,a]}function eN(e,t,r){r||(r=te(6+4*t.length)),r.write_shift(2,e),Ct(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function tN(e,t,r){var a={};a.sz=e.read_shift(2)/20;var n=Hw(e);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var s=e.read_shift(2);switch(s===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(a.underline=i);var c=e.read_shift(1);c>0&&(a.family=c);var o=e.read_shift(1);switch(o>0&&(a.charset=o),e.l++,a.color=zw(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=Vt(e),a}function rN(e,t){t||(t=te(25+4*32)),t.write_shift(2,e.sz*20),Gw(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),vc(e.color,t);var a=0;return e.scheme=="major"&&(a=1),e.scheme=="minor"&&(a=2),t.write_shift(1,a),Ct(e.name,t),t.length>t.l?t.slice(0,t.l):t}var aN=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Lo,nN=aa;function xx(e,t){t||(t=te(4*3+8*7+16*1)),Lo||(Lo=Gf(aN));var r=Lo[e.patternType];r==null&&(r=40),t.write_shift(4,r);var a=0;if(r!=40)for(vc({auto:1},t),vc({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function sN(e,t){var r=e.l+t,a=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:n}}function _v(e,t,r){r||(r=te(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function vl(e,t){return t||(t=te(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var lN=aa;function iN(e,t){return t||(t=te(51)),t.write_shift(1,0),vl(null,t),vl(null,t),vl(null,t),vl(null,t),vl(null,t),t.length>t.l?t.slice(0,t.l):t}function cN(e,t){return t||(t=te(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),gc(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function oN(e,t,r){var a=te(2052);return a.write_shift(4,e),gc(t,a),gc(r,a),a.length>a.l?a.slice(0,a.l):a}function uN(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&++r}),r!=0&&(oe(e,615,Xr(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&oe(e,44,eN(n,t[n]))}),oe(e,616))}}function fN(e){var t=1;oe(e,611,Xr(t)),oe(e,43,rN({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),oe(e,612)}function dN(e){var t=2;oe(e,603,Xr(t)),oe(e,45,xx({patternType:"none"})),oe(e,45,xx({patternType:"gray125"})),oe(e,604)}function hN(e){var t=1;oe(e,613,Xr(t)),oe(e,46,iN()),oe(e,614)}function xN(e){var t=1;oe(e,626,Xr(t)),oe(e,47,_v({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),oe(e,627)}function mN(e,t){oe(e,617,Xr(t.length)),t.forEach(function(r){oe(e,47,_v(r,0))}),oe(e,618)}function gN(e){var t=1;oe(e,619,Xr(t)),oe(e,48,cN({xfId:0,builtinId:0,name:"Normal"})),oe(e,620)}function vN(e){var t=0;oe(e,505,Xr(t)),oe(e,506)}function pN(e){var t=0;oe(e,508,oN(t,"TableStyleMedium9","PivotStyleMedium4")),oe(e,509)}function yN(e,t){var r=er();return oe(r,278),uN(r,e.SSF),fN(r),dN(r),hN(r),xN(r),mN(r,t.cellXfs),gN(r),vN(r),pN(r),oe(r,279),r.end()}function jv(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[gt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function bN(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Vt(e)}}function wN(e){var t=te(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Ct(e.name,t),t.slice(0,t.l)}function NN(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function SN(e){var t=te(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function EN(e,t){var r=te(8+2*t.length);return r.write_shift(4,e),Ct(t,r),r.slice(0,r.l)}function TN(e){return e.l+=4,e.read_shift(4)!=0}function _N(e,t){var r=te(8);return r.write_shift(4,e),r.write_shift(4,t?1:0),r}function jN(){var e=er();return oe(e,332),oe(e,334,Xr(1)),oe(e,335,wN({name:"XLDAPR",version:12e4,flags:3496657072})),oe(e,336),oe(e,339,EN(1,"XLDAPR")),oe(e,52),oe(e,35,Xr(514)),oe(e,4096,Xr(0)),oe(e,4097,_r(1)),oe(e,36),oe(e,53),oe(e,340),oe(e,337,_N(1,!0)),oe(e,51,SN([[1,0]])),oe(e,338),oe(e,333),e.end()}function Av(){var e=[gt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function AN(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ge(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}var vs=1024;function Cv(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[he("xml",null,{"xmlns:v":hr.v,"xmlns:o":hr.o,"xmlns:x":hr.x,"xmlns:mv":hr.mv}).replace(/\/>/,">"),he("o:shapelayout",he("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),he("v:shapetype",[he("v:stroke",null,{joinstyle:"miter"}),he("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];vs<e*1e3;)vs+=1e3;return t.forEach(function(s){var i=At(s[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var o=c.type=="gradient"?he("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=he("v:fill",o,c),f={on:"t",obscured:"t"};++vs,n=n.concat(["<v:shape"+ci({id:"_x0000_s"+vs,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,he("v:shadow",null,f),he("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Lt("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),Lt("x:AutoFill","False"),Lt("x:Row",String(i.r)),Lt("x:Column",String(i.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function kv(e){var t=[gt,he("comments",null,{xmlns:Qs[0]})],r=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(n){var s=He(n.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),t.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var n=0,s=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?n=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(o){o.a&&(n=r.indexOf(He(o.a))),s.push(o.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+n+'"><text>'),s.length<=1)t.push(Lt("t",He(s[0]||"")));else{for(var i=`Comment:
    `+s[0]+`
`,c=1;c<s.length;++c)i+=`Reply:
    `+s[c]+`
`;t.push(Lt("t",He(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function CN(e,t,r){var a=[gt,he("ThreadedComments",null,{xmlns:_t.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(n){var s="";(n[1]||[]).forEach(function(i,c){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var o={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};c==0?s=o.id:o.parentId=s,i.ID=o.id,i.a&&(o.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),a.push(he("threadedComment",Lt("text",i.t||""),o))})}),a.push("</ThreadedComments>"),a.join("")}function kN(e){var t=[gt,he("personList",null,{xmlns:_t.TCMNT,"xmlns:x":Qs[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,a){t.push(he("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function MN(e){var t={};t.iauthor=e.read_shift(4);var r=Yn(e);return t.rfx=r.s,t.ref=Ge(r.s),e.l+=16,t}function DN(e,t){return t==null&&(t=te(36)),t.write_shift(4,e[1].iauthor),Ks(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var RN=Vt;function ON(e){return Ct(e.slice(0,54))}function FN(e){var t=er(),r=[];return oe(t,628),oe(t,630),e.forEach(function(a){a[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),oe(t,632,ON(n.a)))})}),oe(t,631),oe(t,633),e.forEach(function(a){a[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var s={s:At(a[0]),e:At(a[0])};oe(t,635,DN([s,n])),n.t&&n.t.length>0&&oe(t,637,Iw(n)),oe(t,636),delete n.iauthor})}),oe(t,634),oe(t,629),t.end()}function LN(e,t){t.FullPaths.forEach(function(r,a){if(a!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&Ye.utils.cfb_add(e,n,t.FileIndex[a].content)}})}var Mv=["xlsb","xlsm","xlam","biff8","xla"],IN=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,n,s,i){var c=!1,o=!1;s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1)),i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,f=i.length>0?parseInt(i,10)|0:0;return c?f+=t.c:--f,o?u+=t.r:--u,n+(c?"":"$")+Gt(f)+(o?"":"$")+Bt(u)}return function(n,s){return t=s,n.replace(e,r)}}(),rd=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,ad=function(){return function(t,r){return t.replace(rd,function(a,n,s,i,c,o){var u=qf(i)-(s?0:r.c),f=Qf(o)-(c?0:r.r),h=f==0?"":c?f+1:"["+f+"]",d=u==0?"":s?u+1:"["+u+"]";return n+"R"+h+"C"+d})}}();function BN(e,t){return e.replace(rd,function(r,a,n,s,i,c){return a+(n=="$"?n+s:Gt(qf(s)+t.c))+(i=="$"?i+c:Bt(Qf(c)+t.r))})}function PN(e){return e.length!=1}function dt(e){e.l+=1}function cn(e,t){var r=e.read_shift(t==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function Dv(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return Rv(e);r.biff==12&&(a=4)}var n=e.read_shift(a),s=e.read_shift(a),i=cn(e,2),c=cn(e,2);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:c[0],cRel:c[1],rRel:c[2]}}}function Rv(e){var t=cn(e,2),r=cn(e,2),a=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function UN(e,t,r){if(r.biff<8)return Rv(e);var a=e.read_shift(r.biff==12?4:2),n=e.read_shift(r.biff==12?4:2),s=cn(e,2),i=cn(e,2);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:n,c:i[0],cRel:i[1],rRel:i[2]}}}function Ov(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return zN(e);var a=e.read_shift(r&&r.biff==12?4:2),n=cn(e,2);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function zN(e){var t=cn(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function HN(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function GN(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return VN(e);var n=e.read_shift(a>=12?4:2),s=e.read_shift(2),i=(s&16384)>>14,c=(s&32768)>>15;if(s&=16383,c==1)for(;n>524287;)n-=1048576;if(i==1)for(;s>8191;)s=s-16384;return{r:n,c:s,cRel:i,rRel:c}}function VN(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),n==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:n,rRel:a}}function YN(e,t,r){var a=(e[e.l++]&96)>>5,n=Dv(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,n]}function XN(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var i=Dv(e,s,r);return[a,n,i]}function WN(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function JN(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[a,n]}function QN(e,t,r){var a=(e[e.l++]&96)>>5,n=UN(e,t-1,r);return[a,n]}function qN(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function mx(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function KN(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),n=[],s=0;s<=a;++s)n.push(e.read_shift(r&&r.biff==2?1:2));return n}function ZN(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function $N(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function eS(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function tS(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function Fv(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function rS(e){return e.read_shift(2),Fv(e)}function aS(e){return e.read_shift(2),Fv(e)}function nS(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=Ov(e,0,r);return[a,n]}function sS(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=GN(e,0,r);return[a,n]}function lS(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=Ov(e,0,r);return[a,n,s]}function iS(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[iE[n],Bv[n],a]}function cS(e,t,r){var a=e[e.l++],n=e.read_shift(1),s=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:oS(e);return[n,(s[0]===0?Bv:lE)[s[1]]]}function oS(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function uS(e,t,r){e.l+=r&&r.biff==2?3:4}function fS(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function dS(e){return e.l++,ki[e.read_shift(1)]}function hS(e){return e.l++,e.read_shift(2)}function xS(e){return e.l++,e.read_shift(1)!==0}function mS(e){return e.l++,Zs(e)}function gS(e,t,r){return e.l++,vv(e,t-1,r)}function vS(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=l3(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=ki[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Zs(e);break;case 2:r[1]=u3(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function pS(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),n=[],s=0;s!=a;++s)n.push((r.biff==12?Yn:h3)(e));return n}function yS(e,t,r){var a=0,n=0;r.biff==12?(a=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--n==0&&(n=256));for(var s=0,i=[];s!=a&&(i[s]=[]);++s)for(var c=0;c!=n;++c)i[s][c]=vS(e,r.biff);return i}function bS(e,t,r){var a=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,s=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,s]}function wS(e,t,r){if(r.biff==5)return NS(e);var a=e.read_shift(1)>>>5&3,n=e.read_shift(2),s=e.read_shift(4);return[a,n,s]}function NS(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function SS(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function ES(e,t,r){var a=e.read_shift(1)>>>5&3,n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function TS(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function _S(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[a,n]}var jS=aa,AS=aa,CS=aa;function Mi(e,t,r){return e.l+=2,[HN(e)]}function nd(e){return e.l+=6,[]}var kS=Mi,MS=nd,DS=nd,RS=Mi;function Lv(e){return e.l+=2,[mv(e),e.read_shift(2)&1]}var OS=Mi,FS=Lv,LS=nd,IS=Mi,BS=Mi,PS=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function US(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n=e.read_shift(2),s=e.read_shift(2),i=PS[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:a,c:n,C:s}}function zS(e){return e.l+=2,[e.read_shift(4)]}function HS(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function GS(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function VS(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function YS(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function XS(e){return e.l+=4,[0,0]}var gx={1:{n:"PtgExp",f:fS},2:{n:"PtgTbl",f:CS},3:{n:"PtgAdd",f:dt},4:{n:"PtgSub",f:dt},5:{n:"PtgMul",f:dt},6:{n:"PtgDiv",f:dt},7:{n:"PtgPower",f:dt},8:{n:"PtgConcat",f:dt},9:{n:"PtgLt",f:dt},10:{n:"PtgLe",f:dt},11:{n:"PtgEq",f:dt},12:{n:"PtgGe",f:dt},13:{n:"PtgGt",f:dt},14:{n:"PtgNe",f:dt},15:{n:"PtgIsect",f:dt},16:{n:"PtgUnion",f:dt},17:{n:"PtgRange",f:dt},18:{n:"PtgUplus",f:dt},19:{n:"PtgUminus",f:dt},20:{n:"PtgPercent",f:dt},21:{n:"PtgParen",f:dt},22:{n:"PtgMissArg",f:dt},23:{n:"PtgStr",f:gS},26:{n:"PtgSheet",f:HS},27:{n:"PtgEndSheet",f:GS},28:{n:"PtgErr",f:dS},29:{n:"PtgBool",f:xS},30:{n:"PtgInt",f:hS},31:{n:"PtgNum",f:mS},32:{n:"PtgArray",f:qN},33:{n:"PtgFunc",f:iS},34:{n:"PtgFuncVar",f:cS},35:{n:"PtgName",f:bS},36:{n:"PtgRef",f:nS},37:{n:"PtgArea",f:YN},38:{n:"PtgMemArea",f:SS},39:{n:"PtgMemErr",f:jS},40:{n:"PtgMemNoMem",f:AS},41:{n:"PtgMemFunc",f:ES},42:{n:"PtgRefErr",f:TS},43:{n:"PtgAreaErr",f:WN},44:{n:"PtgRefN",f:sS},45:{n:"PtgAreaN",f:QN},46:{n:"PtgMemAreaN",f:VS},47:{n:"PtgMemNoMemN",f:YS},57:{n:"PtgNameX",f:wS},58:{n:"PtgRef3d",f:lS},59:{n:"PtgArea3d",f:XN},60:{n:"PtgRefErr3d",f:_S},61:{n:"PtgAreaErr3d",f:JN},255:{}},WS={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},JS={1:{n:"PtgElfLel",f:Lv},2:{n:"PtgElfRw",f:IS},3:{n:"PtgElfCol",f:kS},6:{n:"PtgElfRwV",f:BS},7:{n:"PtgElfColV",f:RS},10:{n:"PtgElfRadical",f:OS},11:{n:"PtgElfRadicalS",f:LS},13:{n:"PtgElfColS",f:MS},15:{n:"PtgElfColSV",f:DS},16:{n:"PtgElfRadicalLel",f:FS},25:{n:"PtgList",f:US},29:{n:"PtgSxName",f:zS},255:{}},QS={0:{n:"PtgAttrNoop",f:XS},1:{n:"PtgAttrSemi",f:tS},2:{n:"PtgAttrIf",f:$N},4:{n:"PtgAttrChoose",f:KN},8:{n:"PtgAttrGoto",f:ZN},16:{n:"PtgAttrSum",f:uS},32:{n:"PtgAttrBaxcel",f:mx},33:{n:"PtgAttrBaxcel",f:mx},64:{n:"PtgAttrSpace",f:rS},65:{n:"PtgAttrSpaceSemi",f:aS},128:{n:"PtgAttrIfError",f:eS},255:{}};function qS(e,t,r,a){if(a.biff<8)return aa(e,t);for(var n=e.l+t,s=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=yS(e,0,a),s.push(r[i][1]);break;case"PtgMemArea":r[i][2]=pS(e,r[i][1],a),s.push(r[i][2]);break;case"PtgExp":a&&a.biff==12&&(r[i][1][1]=e.read_shift(4),s.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=n-e.l,t!==0&&s.push(aa(e,t)),s}function KS(e,t,r){for(var a=e.l+t,n,s,i=[];a!=e.l;)t=a-e.l,s=e[e.l],n=gx[s]||gx[WS[s]],(s===24||s===25)&&(n=(s===24?JS:QS)[e[e.l+1]]),!n||!n.f?aa(e,t):i.push([n.n,n.f(e,t,r)]);return i}function ZS(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],n=[],s=0;s<a.length;++s){var i=a[s];if(i)switch(i[0]){case 2:n.push('"'+i[1].replace(/"/g,'""')+'"');break;default:n.push(i[1])}else n.push("")}t.push(n.join(","))}return t.join(";")}var $S={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function eE(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Iv(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[a[0]][0]){case 357:return n=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[a[0]][0][3]?(n=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function vx(e,t,r){var a=Iv(e,t,r);return a=="#REF"?a:eE(a,r)}function zs(e,t,r,a,n){var s=n&&n.biff||8,i={s:{c:0,r:0},e:{c:0,r:0}},c=[],o,u,f,h=0,d=0,x,b="";if(!e[0]||!e[0][0])return"";for(var m=-1,w="",p=0,v=e[0].length;p<v;++p){var g=e[0][p];switch(g[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(o=c.pop(),u=c.pop(),m>=0){switch(e[0][m][1][0]){case 0:w=lt(" ",e[0][m][1][1]);break;case 1:w=lt("\r",e[0][m][1][1]);break;default:if(w="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}u=u+w,m=-1}c.push(u+$S[g[0]]+o);break;case"PtgIsect":o=c.pop(),u=c.pop(),c.push(u+" "+o);break;case"PtgUnion":o=c.pop(),u=c.pop(),c.push(u+","+o);break;case"PtgRange":o=c.pop(),u=c.pop(),c.push(u+":"+o);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Hl(g[1][1],i,n),c.push(Gl(f,s));break;case"PtgRefN":f=r?Hl(g[1][1],r,n):g[1][1],c.push(Gl(f,s));break;case"PtgRef3d":h=g[1][1],f=Hl(g[1][2],i,n),b=vx(a,h,n),c.push(b+"!"+Gl(f,s));break;case"PtgFunc":case"PtgFuncVar":var N=g[1][0],I=g[1][1];N||(N=0),N&=127;var z=N==0?[]:c.slice(-N);c.length-=N,I==="User"&&(I=z.shift()),c.push(I+"("+z.join(",")+")");break;case"PtgBool":c.push(g[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(g[1]);break;case"PtgNum":c.push(String(g[1]));break;case"PtgStr":c.push('"'+g[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(g[1]);break;case"PtgAreaN":x=tx(g[1][1],r?{s:r}:i,n),c.push(Oo(x,n));break;case"PtgArea":x=tx(g[1][1],i,n),c.push(Oo(x,n));break;case"PtgArea3d":h=g[1][1],x=g[1][2],b=vx(a,h,n),c.push(b+"!"+Oo(x,n));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=g[1][2];var j=(a.names||[])[d-1]||(a[0]||[])[d],B=j?j.Name:"SH33TJSNAME"+String(d);B&&B.slice(0,6)=="_xlfn."&&!n.xlfn&&(B=B.slice(6)),c.push(B);break;case"PtgNameX":var R=g[1][1];d=g[1][2];var H;if(n.biff<=5)R<0&&(R=-R),a[R]&&(H=a[R][d]);else{var q="";if(((a[R]||[])[0]||[])[0]==14849||(((a[R]||[])[0]||[])[0]==1025?a[R][d]&&a[R][d].itab>0&&(q=a.SheetNames[a[R][d].itab-1]+"!"):q=a.SheetNames[d-1]+"!"),a[R]&&a[R][d])q+=a[R][d].Name;else if(a[0]&&a[0][d])q+=a[0][d].Name;else{var re=(Iv(a,R,n)||"").split(";;");re[d-1]?q=re[d-1]:q+="SH33TJSERRX"}c.push(q);break}H||(H={Name:"SH33TJSERRY"}),c.push(H.Name);break;case"PtgParen":var se="(",le=")";if(m>=0){switch(w="",e[0][m][1][0]){case 2:se=lt(" ",e[0][m][1][1])+se;break;case 3:se=lt("\r",e[0][m][1][1])+se;break;case 4:le=lt(" ",e[0][m][1][1])+le;break;case 5:le=lt("\r",e[0][m][1][1])+le;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}c.push(se+c.pop()+le);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":f={c:g[1][1],r:g[1][0]};var G={c:r.c,r:r.r};if(a.sharedf[Ge(f)]){var C=a.sharedf[Ge(f)];c.push(zs(C,i,G,a,n))}else{var K=!1;for(o=0;o!=a.arrayf.length;++o)if(u=a.arrayf[o],!(f.c<u[0].s.c||f.c>u[0].e.c)&&!(f.r<u[0].s.r||f.r>u[0].e.r)){c.push(zs(u[1],i,G,a,n)),K=!0;break}K||c.push(g[1])}break;case"PtgArray":c.push("{"+ZS(g[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=p;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+g[1].idx+"[#"+g[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(g));default:throw new Error("Unrecognized Formula Token: "+String(g))}var O=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&m>=0&&O.indexOf(e[0][p][0])==-1){g=e[0][m];var ne=!0;switch(g[1][0]){case 4:ne=!1;case 0:w=lt(" ",g[1][1]);break;case 5:ne=!1;case 1:w=lt("\r",g[1][1]);break;default:if(w="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+g[1][0])}c.push((ne?w:"")+c.pop()+(ne?"":w)),m=-1}}if(c.length>1&&n.WTF)throw new Error("bad formula stack");return c[0]}function tE(e){if(e==null){var t=te(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Fn(e);return Fn(0)}function rE(e,t,r,a,n){var s=Ln(t,r,n),i=tE(e.v),c=te(6),o=33;c.write_shift(2,o),c.write_shift(4,0);for(var u=te(e.bf.length),f=0;f<e.bf.length;++f)u[f]=e.bf[f];var h=Ft([s,i,c,u]);return h}function Wc(e,t,r){var a=e.read_shift(4),n=KS(e,a,r),s=e.read_shift(4),i=s>0?qS(e,s,n,r):null;return[n,i]}var aE=Wc,Jc=Wc,nE=Wc,sE=Wc,lE={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Bv={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},iE={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function cE(e){var t="of:="+e.replace(rd,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function oE(e){return e.replace(/\./,"!")}var Vl=typeof Map<"u";function sd(e,t,r){var a=0,n=e.length;if(r){if(Vl?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=Vl?r.get(t):r[t];a<s.length;++a)if(e[s[a]].t===t)return e.Count++,s[a]}}else for(;a<n;++a)if(e[a].t===t)return e.Count++,a;return e[n]={t},e.Count++,e.Unique++,r&&(Vl?(r.has(t)||r.set(t,[]),r.get(t).push(n)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(n))),n}function Qc(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(ba=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?a=bc(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(r.width=Pu(a),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Pv(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function dn(e,t,r){var a=r.revssf[t.z!=null?t.z:"General"],n=60,s=e.length;if(a==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){O2(t.z,n),r.ssf[n]=t.z,r.revssf[t.z]=a=n;break}}for(n=0;n!=s;++n)if(e[n].numFmtId===a)return n;return e[s]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function uE(e,t,r){if(e&&e["!ref"]){var a=et(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function fE(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+mt(e[r])+'"/>';return t+"</mergeCells>"}function dE(e,t,r,a,n){var s=!1,i={},c=null;if(a.bookType!=="xlsx"&&t.vbaraw){var o=t.SheetNames[r];try{t.Workbook&&(o=t.Workbook.Sheets[r].CodeName||o)}catch{}s=!0,i.codeName=ma(He(o))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),c=(c||"")+he("outlinePr",null,u)}!s&&!c||(n[n.length]=he("sheetPr",c,i))}var hE=["objects","scenarios","selectLockedCells","selectUnlockedCells"],xE=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function mE(e){var t={sheet:1};return hE.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),xE.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Nv(e.password).toString(16).toUpperCase()),he("sheetProtection",null,t)}function gE(e){return Pv(e),he("pageMargins",null,e)}function vE(e,t){for(var r=["<cols>"],a,n=0;n!=t.length;++n)(a=t[n])&&(r[r.length]=he("col",null,Qc(n,a)));return r[r.length]="</cols>",r.join("")}function pE(e,t,r,a){var n=typeof e.ref=="string"?e.ref:mt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,i=wr(n);i.s.r==i.e.r&&(i.e.r=wr(t["!ref"]).e.r,n=mt(i));for(var c=0;c<s.length;++c){var o=s[c];if(o.Name=="_xlnm._FilterDatabase"&&o.Sheet==a){o.Ref="'"+r.SheetNames[a]+"'!"+n;break}}return c==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+n}),he("autoFilter",null,{ref:n})}function yE(e,t,r,a){var n={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),he("sheetViews",he("sheetView",null,n),{})}function bE(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var n="",s=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=ki[e.v];break;case"d":a&&a.cellDates?n=Qt(e.v,-1).toISOString():(e=ar(e),e.t="n",n=""+(e.v=rr(Qt(e.v)))),typeof e.z>"u"&&(e.z=ct[14]);break;default:n=e.v;break}var c=Lt("v",He(n)),o={r:t},u=dn(a.cellXfs,e,a);switch(u!==0&&(o.s=u),e.t){case"n":break;case"d":o.t="d";break;case"b":o.t="b";break;case"e":o.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){c=Lt("v",""+sd(a.Strings,e.v,a.revStrings)),o.t="s";break}o.t="str";break}if(e.t!=s&&(e.t=s,e.v=i),typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;c=he("f",He(e.f),f)+(e.v!=null?c:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(o.cm=1),he("c",c,o)}function wE(e,t,r,a){var n=[],s=[],i=et(e["!ref"]),c="",o,u="",f=[],h=0,d=0,x=e["!rows"],b=Array.isArray(e),m={r:u},w,p=-1;for(d=i.s.c;d<=i.e.c;++d)f[d]=Gt(d);for(h=i.s.r;h<=i.e.r;++h){for(s=[],u=Bt(h),d=i.s.c;d<=i.e.c;++d){o=f[d]+u;var v=b?(e[h]||[])[d]:e[o];v!==void 0&&(c=bE(v,o,e,t))!=null&&s.push(c)}(s.length>0||x&&x[h])&&(m={r:u},x&&x[h]&&(w=x[h],w.hidden&&(m.hidden=1),p=-1,w.hpx?p=wc(w.hpx):w.hpt&&(p=w.hpt),p>-1&&(m.ht=p,m.customHeight=1),w.level&&(m.outlineLevel=w.level)),n[n.length]=he("row",s.join(""),m))}if(x)for(;h<x.length;++h)x&&x[h]&&(m={r:h+1},w=x[h],w.hidden&&(m.hidden=1),p=-1,w.hpx?p=wc(w.hpx):w.hpt&&(p=w.hpt),p>-1&&(m.ht=p,m.customHeight=1),w.level&&(m.outlineLevel=w.level),n[n.length]=he("row","",m));return n.join("")}function Uv(e,t,r,a){var n=[gt,he("worksheet",null,{xmlns:Qs[0],"xmlns:r":_t.r})],s=r.SheetNames[e],i=0,c="",o=r.Sheets[s];o==null&&(o={});var u=o["!ref"]||"A1",f=et(u);if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),u=mt(f)}a||(a={}),o["!comments"]=[];var h=[];dE(o,r,e,t,n),n[n.length]=he("dimension",null,{ref:u}),n[n.length]=yE(o,t,e,r),t.sheetFormat&&(n[n.length]=he("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),o["!cols"]!=null&&o["!cols"].length>0&&(n[n.length]=vE(o,o["!cols"])),n[i=n.length]="<sheetData/>",o["!links"]=[],o["!ref"]!=null&&(c=wE(o,t),c.length>0&&(n[n.length]=c)),n.length>i+1&&(n[n.length]="</sheetData>",n[i]=n[i].replace("/>",">")),o["!protect"]&&(n[n.length]=mE(o["!protect"])),o["!autofilter"]!=null&&(n[n.length]=pE(o["!autofilter"],o,r,e)),o["!merges"]!=null&&o["!merges"].length>0&&(n[n.length]=fE(o["!merges"]));var d=-1,x,b=-1;return o["!links"].length>0&&(n[n.length]="<hyperlinks>",o["!links"].forEach(function(m){m[1].Target&&(x={ref:m[0]},m[1].Target.charAt(0)!="#"&&(b=Ue(a,-1,He(m[1].Target).replace(/#.*$/,""),Oe.HLINK),x["r:id"]="rId"+b),(d=m[1].Target.indexOf("#"))>-1&&(x.location=He(m[1].Target.slice(d+1))),m[1].Tooltip&&(x.tooltip=He(m[1].Tooltip)),n[n.length]=he("hyperlink",null,x))}),n[n.length]="</hyperlinks>"),delete o["!links"],o["!margins"]!=null&&(n[n.length]=gE(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(n[n.length]=Lt("ignoredErrors",he("ignoredError",null,{numberStoredAsText:1,sqref:u}))),h.length>0&&(b=Ue(a,-1,"../drawings/drawing"+(e+1)+".xml",Oe.DRAW),n[n.length]=he("drawing",null,{"r:id":"rId"+b}),o["!drawing"]=h),o["!comments"].length>0&&(b=Ue(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Oe.VML),n[n.length]=he("legacyDrawing",null,{"r:id":"rId"+b}),o["!legacy"]=b),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function NE(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=a,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=n/20),r}function SE(e,t,r){var a=te(145),n=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var s=320;n.hpx?s=wc(n.hpx)*20:n.hpt&&(s=n.hpt*20),a.write_shift(2,s),a.write_shift(1,0);var i=0;n.level&&(i|=n.level),n.hidden&&(i|=16),(n.hpx||n.hpt)&&(i|=32),a.write_shift(1,i),a.write_shift(1,0);var c=0,o=a.l;a.l+=4;for(var u={r:e,c:0},f=0;f<16;++f)if(!(t.s.c>f+1<<10||t.e.c<f<<10)){for(var h=-1,d=-1,x=f<<10;x<f+1<<10;++x){u.c=x;var b=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Ge(u)];b&&(h<0&&(h=x),d=x)}h<0||(++c,a.write_shift(4,h),a.write_shift(4,d))}var m=a.l;return a.l=o,a.write_shift(4,c),a.l=m,a.length>a.l?a.slice(0,a.l):a}function EE(e,t,r,a){var n=SE(a,r,t);(n.length>17||(t["!rows"]||[])[a])&&oe(e,0,n)}var TE=Yn,_E=Ks;function jE(){}function AE(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=Bw(e),r}function CE(e,t,r){r==null&&(r=te(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var n=1;n<3;++n)r.write_shift(1,0);return vc({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),tv(e,r),r.slice(0,r.l)}function kE(e){var t=Fr(e);return[t]}function ME(e,t,r){return r==null&&(r=te(8)),Hn(t,r)}function DE(e){var t=Gn(e);return[t]}function RE(e,t,r){return r==null&&(r=te(4)),Vn(t,r)}function OE(e){var t=Fr(e),r=e.read_shift(1);return[t,r,"b"]}function FE(e,t,r){return r==null&&(r=te(9)),Hn(t,r),r.write_shift(1,e.v?1:0),r}function LE(e){var t=Gn(e),r=e.read_shift(1);return[t,r,"b"]}function IE(e,t,r){return r==null&&(r=te(5)),Vn(t,r),r.write_shift(1,e.v?1:0),r}function BE(e){var t=Fr(e),r=e.read_shift(1);return[t,r,"e"]}function PE(e,t,r){return r==null&&(r=te(9)),Hn(t,r),r.write_shift(1,e.v),r}function UE(e){var t=Gn(e),r=e.read_shift(1);return[t,r,"e"]}function zE(e,t,r){return r==null&&(r=te(8)),Vn(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function HE(e){var t=Fr(e),r=e.read_shift(4);return[t,r,"s"]}function GE(e,t,r){return r==null&&(r=te(12)),Hn(t,r),r.write_shift(4,t.v),r}function VE(e){var t=Gn(e),r=e.read_shift(4);return[t,r,"s"]}function YE(e,t,r){return r==null&&(r=te(8)),Vn(t,r),r.write_shift(4,t.v),r}function XE(e){var t=Fr(e),r=Zs(e);return[t,r,"n"]}function WE(e,t,r){return r==null&&(r=te(16)),Hn(t,r),Fn(e.v,r),r}function JE(e){var t=Gn(e),r=Zs(e);return[t,r,"n"]}function QE(e,t,r){return r==null&&(r=te(12)),Vn(t,r),Fn(e.v,r),r}function qE(e){var t=Fr(e),r=rv(e);return[t,r,"n"]}function KE(e,t,r){return r==null&&(r=te(12)),Hn(t,r),av(e.v,r),r}function ZE(e){var t=Gn(e),r=rv(e);return[t,r,"n"]}function $E(e,t,r){return r==null&&(r=te(8)),Vn(t,r),av(e.v,r),r}function eT(e){var t=Fr(e),r=Kf(e);return[t,r,"is"]}function tT(e){var t=Fr(e),r=Vt(e);return[t,r,"str"]}function rT(e,t,r){return r==null&&(r=te(12+4*e.v.length)),Hn(t,r),Ct(e.v,r),r.length>r.l?r.slice(0,r.l):r}function aT(e){var t=Gn(e),r=Vt(e);return[t,r,"str"]}function nT(e,t,r){return r==null&&(r=te(8+4*e.v.length)),Vn(t,r),Ct(e.v,r),r.length>r.l?r.slice(0,r.l):r}function sT(e,t,r){var a=e.l+t,n=Fr(e);n.r=r["!row"];var s=e.read_shift(1),i=[n,s,"b"];if(r.cellFormula){e.l+=2;var c=Jc(e,a-e.l,r);i[3]=zs(c,null,n,r.supbooks,r)}else e.l=a;return i}function lT(e,t,r){var a=e.l+t,n=Fr(e);n.r=r["!row"];var s=e.read_shift(1),i=[n,s,"e"];if(r.cellFormula){e.l+=2;var c=Jc(e,a-e.l,r);i[3]=zs(c,null,n,r.supbooks,r)}else e.l=a;return i}function iT(e,t,r){var a=e.l+t,n=Fr(e);n.r=r["!row"];var s=Zs(e),i=[n,s,"n"];if(r.cellFormula){e.l+=2;var c=Jc(e,a-e.l,r);i[3]=zs(c,null,n,r.supbooks,r)}else e.l=a;return i}function cT(e,t,r){var a=e.l+t,n=Fr(e);n.r=r["!row"];var s=Vt(e),i=[n,s,"str"];if(r.cellFormula){e.l+=2;var c=Jc(e,a-e.l,r);i[3]=zs(c,null,n,r.supbooks,r)}else e.l=a;return i}var oT=Yn,uT=Ks;function fT(e,t){return t==null&&(t=te(4)),t.write_shift(4,e),t}function dT(e,t){var r=e.l+t,a=Yn(e),n=Zf(e),s=Vt(e),i=Vt(e),c=Vt(e);e.l=r;var o={rfx:a,relId:n,loc:s,display:c};return i&&(o.Tooltip=i),o}function hT(e,t){var r=te(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Ks({s:At(e[0]),e:At(e[0])},r),$f("rId"+t,r);var a=e[1].Target.indexOf("#"),n=a==-1?"":e[1].Target.slice(a+1);return Ct(n||"",r),Ct(e[1].Tooltip||"",r),Ct("",r),r.slice(0,r.l)}function xT(){}function mT(e,t,r){var a=e.l+t,n=nv(e),s=e.read_shift(1),i=[n];if(i[2]=s,r.cellFormula){var c=aE(e,a-e.l,r);i[1]=c}else e.l=a;return i}function gT(e,t,r){var a=e.l+t,n=Yn(e),s=[n];if(r.cellFormula){var i=sE(e,a-e.l,r);s[1]=i,e.l=a}else e.l=a;return s}function vT(e,t,r){r==null&&(r=te(18));var a=Qc(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var n=0;return t.hidden&&(n|=1),typeof a.width=="number"&&(n|=2),t.level&&(n|=t.level<<8),r.write_shift(2,n),r}var zv=["left","right","top","bottom","header","footer"];function pT(e){var t={};return zv.forEach(function(r){t[r]=Zs(e)}),t}function yT(e,t){return t==null&&(t=te(6*8)),Pv(e),zv.forEach(function(r){Fn(e[r],t)}),t}function bT(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function wT(e,t,r){r==null&&(r=te(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function NT(e){var t=te(24);return t.write_shift(4,4),t.write_shift(4,1),Ks(e,t),t}function ST(e,t){return t==null&&(t=te(16*4+2)),t.write_shift(2,e.password?Nv(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function ET(){}function TT(){}function _T(e,t,r,a,n,s,i){if(t.v===void 0)return!1;var c="";switch(t.t){case"b":c=t.v?"1":"0";break;case"d":t=ar(t),t.z=t.z||ct[14],t.v=rr(Qt(t.v)),t.t="n";break;case"n":case"e":c=""+t.v;break;default:c=t.v;break}var o={r,c:a};switch(o.s=dn(n.cellXfs,t,n),t.l&&s["!links"].push([Ge(o),t.l]),t.c&&s["!comments"].push([Ge(o),t.c]),t.t){case"s":case"str":return n.bookSST?(c=sd(n.Strings,t.v,n.revStrings),o.t="s",o.v=c,i?oe(e,18,YE(t,o)):oe(e,7,GE(t,o))):(o.t="str",i?oe(e,17,nT(t,o)):oe(e,6,rT(t,o))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?oe(e,13,$E(t,o)):oe(e,2,KE(t,o)):i?oe(e,16,QE(t,o)):oe(e,5,WE(t,o)),!0;case"b":return o.t="b",i?oe(e,15,IE(t,o)):oe(e,4,FE(t,o)),!0;case"e":return o.t="e",i?oe(e,14,zE(t,o)):oe(e,3,PE(t,o)),!0}return i?oe(e,12,RE(t,o)):oe(e,1,ME(t,o)),!0}function jT(e,t,r,a){var n=et(t["!ref"]||"A1"),s,i="",c=[];oe(e,145);var o=Array.isArray(t),u=n.e.r;t["!rows"]&&(u=Math.max(n.e.r,t["!rows"].length-1));for(var f=n.s.r;f<=u;++f){i=Bt(f),EE(e,t,n,f);var h=!1;if(f<=n.e.r)for(var d=n.s.c;d<=n.e.c;++d){f===n.s.r&&(c[d]=Gt(d)),s=c[d]+i;var x=o?(t[f]||[])[d]:t[s];if(!x){h=!1;continue}h=_T(e,x,f,d,a,t,h)}}oe(e,146)}function AT(e,t){!t||!t["!merges"]||(oe(e,177,fT(t["!merges"].length)),t["!merges"].forEach(function(r){oe(e,176,uT(r))}),oe(e,178))}function CT(e,t){!t||!t["!cols"]||(oe(e,390),t["!cols"].forEach(function(r,a){r&&oe(e,60,vT(a,r))}),oe(e,391))}function kT(e,t){!t||!t["!ref"]||(oe(e,648),oe(e,649,NT(et(t["!ref"]))),oe(e,650))}function MT(e,t,r){t["!links"].forEach(function(a){if(a[1].Target){var n=Ue(r,-1,a[1].Target.replace(/#.*$/,""),Oe.HLINK);oe(e,494,hT(a,n))}}),delete t["!links"]}function DT(e,t,r,a){if(t["!comments"].length>0){var n=Ue(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Oe.VML);oe(e,551,$f("rId"+n)),t["!legacy"]=n}}function RT(e,t,r,a){if(t["!autofilter"]){var n=t["!autofilter"],s=typeof n.ref=="string"?n.ref:mt(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,c=wr(s);c.s.r==c.e.r&&(c.e.r=wr(t["!ref"]).e.r,s=mt(c));for(var o=0;o<i.length;++o){var u=i[o];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==a){u.Ref="'"+r.SheetNames[a]+"'!"+s;break}}o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+s}),oe(e,161,Ks(et(s))),oe(e,162)}}function OT(e,t,r){oe(e,133),oe(e,137,wT(t,r)),oe(e,138),oe(e,134)}function FT(e,t){t["!protect"]&&oe(e,535,ST(t["!protect"]))}function LT(e,t,r,a){var n=er(),s=r.SheetNames[e],i=r.Sheets[s]||{},c=s;try{r&&r.Workbook&&(c=r.Workbook.Sheets[e].CodeName||c)}catch{}var o=et(i["!ref"]||"A1");if(o.e.c>16383||o.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");o.e.c=Math.min(o.e.c,16383),o.e.r=Math.min(o.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],oe(n,129),(r.vbaraw||i["!outline"])&&oe(n,147,CE(c,i["!outline"])),oe(n,148,_E(o)),OT(n,i,r.Workbook),CT(n,i),jT(n,i,e,t),FT(n,i),RT(n,i,r,e),AT(n,i),MT(n,i,a),i["!margins"]&&oe(n,476,yT(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&kT(n,i),DT(n,i,e,a),oe(n,130),n.end()}function IT(e,t){e.l+=10;var r=Vt(e);return{name:r}}var BT=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function PT(e){return!e.Workbook||!e.Workbook.WBProps?"false":gw(e.Workbook.WBProps.date1904)?"true":"false"}var UT="][*?/\\".split("");function Hv(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return UT.forEach(function(a){if(e.indexOf(a)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}function zT(e,t,r){e.forEach(function(a,n){Hv(a);for(var s=0;s<n;++s)if(a==e[s])throw new Error("Duplicate Sheet Name: "+a);if(r){var i=t&&t[n]&&t[n].CodeName||a;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function HT(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];zT(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)uE(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function Gv(e){var t=[gt];t[t.length]=he("workbook",null,{xmlns:Qs[0],"xmlns:r":_t.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(BT.forEach(function(c){e.Workbook.WBProps[c[0]]!=null&&e.Workbook.WBProps[c[0]]!=c[1]&&(a[c[0]]=e.Workbook.WBProps[c[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=he("workbookPr",null,a);var n=e.Workbook&&e.Workbook.Sheets||[],s=0;if(n&&n[0]&&n[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!n[s]||!n[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var i={name:He(e.SheetNames[s].slice(0,31))};if(i.sheetId=""+(s+1),i["r:id"]="rId"+(s+1),n[s])switch(n[s].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=he("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(c){var o={name:c.Name};c.Comment&&(o.comment=c.Comment),c.Sheet!=null&&(o.localSheetId=""+c.Sheet),c.Hidden&&(o.hidden="1"),c.Ref&&(t[t.length]=he("definedName",He(c.Ref),o))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function GT(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Bu(e),r.name=Vt(e),r}function VT(e,t){return t||(t=te(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),$f(e.strRelID,t),Ct(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function YT(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?Vt(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function XT(e,t){t||(t=te(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),tv(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function WT(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),s=Pw(e),i=nE(e,0,r),c=Zf(e);e.l=a;var o={Name:s,Ptg:i};return n<268435455&&(o.Sheet=n),c&&(o.Comment=c),o}function JT(e,t){oe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,n={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};oe(e,156,VT(n))}oe(e,144)}function QT(e,t){t||(t=te(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Ct("SheetJS",t),Ct(uc.version,t),Ct(uc.version,t),Ct("7262",t),t.length>t.l?t.slice(0,t.l):t}function qT(e,t){t||(t=te(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function KT(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,a=0,n=-1,s=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&n==-1?n=a:r[a].Hidden==1&&s==-1&&(s=a);s>n||(oe(e,135),oe(e,158,qT(n)),oe(e,136))}}function ZT(e,t){var r=er();return oe(r,131),oe(r,128,QT()),oe(r,153,XT(e.Workbook&&e.Workbook.WBProps||null)),KT(r,e),JT(r,e),oe(r,132),r.end()}function $T(e,t,r){return(t.slice(-4)===".bin"?ZT:Gv)(e)}function e_(e,t,r,a,n){return(t.slice(-4)===".bin"?LT:Uv)(e,r,a,n)}function t_(e,t,r){return(t.slice(-4)===".bin"?yN:Tv)(e,r)}function r_(e,t,r){return(t.slice(-4)===".bin"?X3:wv)(e,r)}function a_(e,t,r){return(t.slice(-4)===".bin"?FN:kv)(e)}function n_(e){return(e.slice(-4)===".bin"?jN:Av)()}function s_(e,t){var r=[];return e.Props&&r.push(t3(e.Props,t)),e.Custprops&&r.push(r3(e.Props,e.Custprops)),r.join("")}function l_(){return""}function i_(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,n){var s=[];s.push(he("NumberFormat",null,{"ss:Format":He(ct[a.numFmtId])}));var i={"ss:ID":"s"+(21+n)};r.push(he("Style",s.join(""),i))}),he("Styles",r.join(""))}function Vv(e){return he("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+ad(e.Ref,{r:0,c:0})})}function c_(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var n=t[a];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(Vv(n)))}return he("Names",r.join(""))}function o_(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,s=[],i=0;i<n.length;++i){var c=n[i];c.Sheet==r&&(c.Name.match(/^_xlfn\./)||s.push(Vv(c)))}return s.join("")}function u_(e,t,r,a){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(he("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(he("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(he("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)n.push(he("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(a.Workbook.Sheets[s]&&!a.Workbook.Sheets[s].Hidden);++s);s==r&&n.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(Lt("ProtectContents","True")),e["!protect"].objects&&n.push(Lt("ProtectObjects","True")),e["!protect"].scenarios&&n.push(Lt("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?n.push(Lt("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&n.push(Lt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&n.push("<"+i[1]+"/>")})),n.length==0?"":he("WorksheetOptions",n.join(""),{xmlns:hr.x})}function f_(e){return e.map(function(t){var r=mw(t.t||""),a=he("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return he("Comment",a,{"ss:Author":t.a})}).join("")}function d_(e,t,r,a,n,s,i){if(!e||e.v==null&&e.f==null)return"";var c={};if(e.f&&(c["ss:Formula"]="="+He(ad(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var o=At(e.F.slice(t.length+1));c["ss:ArrayRange"]="RC:R"+(o.r==i.r?"":"["+(o.r-i.r)+"]")+"C"+(o.c==i.c?"":"["+(o.c-i.c)+"]")}if(e.l&&e.l.Target&&(c["ss:HRef"]=He(e.l.Target),e.l.Tooltip&&(c["x:HRefScreenTip"]=He(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],f=0;f!=u.length;++f)u[f].s.c!=i.c||u[f].s.r!=i.r||(u[f].e.c>u[f].s.c&&(c["ss:MergeAcross"]=u[f].e.c-u[f].s.c),u[f].e.r>u[f].s.r&&(c["ss:MergeDown"]=u[f].e.r-u[f].s.r));var h="",d="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":h="Number",d=String(e.v);break;case"b":h="Boolean",d=e.v?"1":"0";break;case"e":h="Error",d=ki[e.v];break;case"d":h="DateTime",d=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||ct[14]);break;case"s":h="String",d=xw(e.v||"");break}var x=dn(a.cellXfs,e,a);c["ss:StyleID"]="s"+(21+x),c["ss:Index"]=i.c+1;var b=e.v!=null?d:"",m=e.t=="z"?"":'<Data ss:Type="'+h+'">'+b+"</Data>";return(e.c||[]).length>0&&(m+=f_(e.c)),he("Cell",m,c)}function h_(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Ev(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function x_(e,t,r,a){if(!e["!ref"])return"";var n=et(e["!ref"]),s=e["!merges"]||[],i=0,c=[];e["!cols"]&&e["!cols"].forEach(function(w,p){td(w);var v=!!w.width,g=Qc(p,w),N={"ss:Index":p+1};v&&(N["ss:Width"]=yc(g.width)),w.hidden&&(N["ss:Hidden"]="1"),c.push(he("Column",null,N))});for(var o=Array.isArray(e),u=n.s.r;u<=n.e.r;++u){for(var f=[h_(u,(e["!rows"]||[])[u])],h=n.s.c;h<=n.e.c;++h){var d=!1;for(i=0;i!=s.length;++i)if(!(s[i].s.c>h)&&!(s[i].s.r>u)&&!(s[i].e.c<h)&&!(s[i].e.r<u)){(s[i].s.c!=h||s[i].s.r!=u)&&(d=!0);break}if(!d){var x={r:u,c:h},b=Ge(x),m=o?(e[u]||[])[h]:e[b];f.push(d_(m,b,e,t,r,a,x))}}f.push("</Row>"),f.length>2&&c.push(f.join(""))}return c.join("")}function m_(e,t,r){var a=[],n=r.SheetNames[e],s=r.Sheets[n],i=s?o_(s,t,e,r):"";return i.length>0&&a.push("<Names>"+i+"</Names>"),i=s?x_(s,t,e,r):"",i.length>0&&a.push("<Table>"+i+"</Table>"),a.push(u_(s,t,e,r)),a.join("")}function g_(e,t){t||(t={}),e.SSF||(e.SSF=ar(ct)),e.SSF&&(Vc(),Gc(e.SSF),t.revssf=Yc(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],dn(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(s_(e,t)),r.push(l_()),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(he("Worksheet",m_(a,t,e),{"ss:Name":He(e.SheetNames[a])}));return r[2]=i_(e,t),r[3]=c_(e),gt+he("Workbook",r.join(""),{xmlns:hr.ss,"xmlns:o":hr.o,"xmlns:x":hr.x,"xmlns:ss":hr.ss,"xmlns:dt":hr.dt,"xmlns:html":hr.html})}var Io={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function v_(e,t){var r=[],a=[],n=[],s=0,i,c=V1(ax,"n"),o=V1(nx,"n");if(e.Props)for(i=Pt(e.Props),s=0;s<i.length;++s)(Object.prototype.hasOwnProperty.call(c,i[s])?r:Object.prototype.hasOwnProperty.call(o,i[s])?a:n).push([i[s],e.Props[i[s]]]);if(e.Custprops)for(i=Pt(e.Custprops),s=0;s<i.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},i[s])||(Object.prototype.hasOwnProperty.call(c,i[s])?r:Object.prototype.hasOwnProperty.call(o,i[s])?a:n).push([i[s],e.Custprops[i[s]]]);var u=[];for(s=0;s<n.length;++s)xv.indexOf(n[s][0])>-1||fv.indexOf(n[s][0])>-1||n[s][1]!=null&&u.push(n[s]);a.length&&Ye.utils.cfb_add(t,"/SummaryInformation",ox(a,Io.SI,o,nx)),(r.length||u.length)&&Ye.utils.cfb_add(t,"/DocumentSummaryInformation",ox(r,Io.DSI,c,ax,u.length?u:null,Io.UDI))}function p_(e,t){var r=t||{},a=Ye.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ye.utils.cfb_add(a,n,Yv(e,r)),r.biff==8&&(e.Props||e.Custprops)&&v_(e,a),r.biff==8&&e.vbaraw&&LN(a,Ye.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var y_={0:{f:NE},1:{f:kE},2:{f:qE},3:{f:BE},4:{f:OE},5:{f:XE},6:{f:tT},7:{f:HE},8:{f:cT},9:{f:iT},10:{f:sT},11:{f:lT},12:{f:DE},13:{f:ZE},14:{f:UE},15:{f:LE},16:{f:JE},17:{f:aT},18:{f:VE},19:{f:Kf},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:WT},40:{},42:{},43:{f:tN},44:{f:$3},45:{f:nN},46:{f:lN},47:{f:sN},48:{},49:{f:Dw},50:{},51:{f:NN},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:R3},62:{f:eT},63:{f:AN},64:{f:ET},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:aa,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:bT},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:AE},148:{f:TE,p:16},151:{f:xT},152:{},153:{f:YT},154:{},155:{},156:{f:GT},157:{},158:{},159:{T:1,f:G3},160:{T:-1},161:{T:1,f:Yn},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:oT},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:bN},336:{T:-1},337:{f:TN,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Bu},357:{},358:{},359:{},360:{T:1},361:{},362:{f:j3},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:mT},427:{f:gT},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:pT},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:jE},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:dT},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Bu},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:RN},633:{T:1},634:{T:-1},635:{T:1,f:MN},636:{T:-1},637:{f:Lw},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:IT},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:TT},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function xe(e,t,r,a){var n=t;if(!isNaN(n)){var s=a||(r||[]).length||0,i=e.next(4);i.write_shift(2,n),i.write_shift(2,s),s>0&&Jf(r)&&e.push(r)}}function b_(e,t,r,a){var n=a||(r||[]).length||0;if(n<=8224)return xe(e,t,r,n);var s=t;if(!isNaN(s)){for(var i=r.parts||[],c=0,o=0,u=0;u+(i[c]||8224)<=8224;)u+=i[c]||8224,c++;var f=e.next(4);for(f.write_shift(2,s),f.write_shift(2,u),e.push(r.slice(o,o+u)),o+=u;o<n;){for(f=e.next(4),f.write_shift(2,60),u=0;u+(i[c]||8224)<=8224;)u+=i[c]||8224,c++;f.write_shift(2,u),e.push(r.slice(o,o+u)),o+=u}}}function Di(e,t,r){return e||(e=te(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function w_(e,t,r,a){var n=te(9);return Di(n,e,t),gv(r,a||"b",n),n}function N_(e,t,r){var a=te(8+2*r.length);return Di(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function S_(e,t,r,a){if(t.v!=null)switch(t.t){case"d":case"n":var n=t.t=="d"?rr(Qt(t.v)):t.v;n==(n|0)&&n>=0&&n<65536?xe(e,2,I3(r,a,n)):xe(e,3,L3(r,a,n));return;case"b":case"e":xe(e,5,w_(r,a,t.v,t.t));return;case"s":case"str":xe(e,4,N_(r,a,(t.v||"").slice(0,255)));return}xe(e,1,Di(null,r,a))}function E_(e,t,r,a){var n=Array.isArray(t),s=et(t["!ref"]||"A1"),i,c="",o=[];if(s.e.c>255||s.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),i=mt(s)}for(var u=s.s.r;u<=s.e.r;++u){c=Bt(u);for(var f=s.s.c;f<=s.e.c;++f){u===s.s.r&&(o[f]=Gt(f)),i=o[f]+c;var h=n?(t[u]||[])[f]:t[i];h&&S_(e,h,u,f)}}}function T_(e,t){for(var r=t||{},a=er(),n=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(n=s);if(n==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return xe(a,r.biff==4?1033:r.biff==3?521:9,ed(e,16,r)),E_(a,e.Sheets[e.SheetNames[n]],n,r),xe(a,10),a.end()}function __(e,t,r){xe(e,49,y3({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function j_(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&xe(e,1054,N3(n,t[n],r))})}function A_(e,t){var r=te(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),xe(e,2151,r),r=te(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),yv(et(t["!ref"]||"A1"),r),r.write_shift(4,4),xe(e,2152,r)}function C_(e,t){for(var r=0;r<16;++r)xe(e,224,fx({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){xe(e,224,fx(a,0,t))})}function k_(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];xe(e,440,k3(a)),a[1].Tooltip&&xe(e,2048,M3(a))}delete t["!links"]}function M_(e,t){if(t){var r=0;t.forEach(function(a,n){++r<=256&&a&&xe(e,125,O3(Qc(n,a),n))})}}function D_(e,t,r,a,n){var s=16+dn(n.cellXfs,t,n);if(t.v==null&&!t.bf){xe(e,513,Ln(r,a,s));return}if(t.bf)xe(e,6,rE(t,r,a,n,s));else switch(t.t){case"d":case"n":var i=t.t=="d"?rr(Qt(t.v)):t.v;xe(e,515,_3(r,a,i,s));break;case"b":case"e":xe(e,517,T3(r,a,t.v,s,n,t.t));break;case"s":case"str":if(n.bookSST){var c=sd(n.Strings,t.v,n.revStrings);xe(e,253,b3(r,a,c,s))}else xe(e,516,w3(r,a,(t.v||"").slice(0,255),s,n));break;default:xe(e,513,Ln(r,a,s))}}function R_(e,t,r){var a=er(),n=r.SheetNames[e],s=r.Sheets[n]||{},i=(r||{}).Workbook||{},c=(i.Sheets||[])[e]||{},o=Array.isArray(s),u=t.biff==8,f,h="",d=[],x=et(s["!ref"]||"A1"),b=u?65536:16384;if(x.e.c>255||x.e.r>=b){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");x.e.c=Math.min(x.e.c,255),x.e.r=Math.min(x.e.c,b-1)}xe(a,2057,ed(r,16,t)),xe(a,13,_r(1)),xe(a,12,_r(100)),xe(a,15,Xt(!0)),xe(a,17,Xt(!1)),xe(a,16,Fn(.001)),xe(a,95,Xt(!0)),xe(a,42,Xt(!1)),xe(a,43,Xt(!1)),xe(a,130,_r(1)),xe(a,128,E3([0,0])),xe(a,131,Xt(!1)),xe(a,132,Xt(!1)),u&&M_(a,s["!cols"]),xe(a,512,S3(x,t)),u&&(s["!links"]=[]);for(var m=x.s.r;m<=x.e.r;++m){h=Bt(m);for(var w=x.s.c;w<=x.e.c;++w){m===x.s.r&&(d[w]=Gt(w)),f=d[w]+h;var p=o?(s[m]||[])[w]:s[f];p&&(D_(a,p,m,w,t),u&&p.l&&s["!links"].push([f,p.l]))}}var v=c.CodeName||c.name||n;return u&&xe(a,574,p3((i.Views||[])[0])),u&&(s["!merges"]||[]).length&&xe(a,229,C3(s["!merges"])),u&&k_(a,s),xe(a,442,pv(v)),u&&A_(a,s),xe(a,10),a.end()}function O_(e,t,r){var a=er(),n=(e||{}).Workbook||{},s=n.Sheets||[],i=n.WBProps||{},c=r.biff==8,o=r.biff==5;if(xe(a,2057,ed(e,5,r)),r.bookType=="xla"&&xe(a,135),xe(a,225,c?_r(1200):null),xe(a,193,s3(2)),o&&xe(a,191),o&&xe(a,192),xe(a,226),xe(a,92,x3("SheetJS",r)),xe(a,66,_r(c?1200:1252)),c&&xe(a,353,_r(0)),c&&xe(a,448),xe(a,317,F3(e.SheetNames.length)),c&&e.vbaraw&&xe(a,211),c&&e.vbaraw){var u=i.CodeName||"ThisWorkbook";xe(a,442,pv(u))}xe(a,156,_r(17)),xe(a,25,Xt(!1)),xe(a,18,Xt(!1)),xe(a,19,_r(0)),c&&xe(a,431,Xt(!1)),c&&xe(a,444,_r(0)),xe(a,61,v3()),xe(a,64,Xt(!1)),xe(a,141,_r(0)),xe(a,34,Xt(PT(e)=="true")),xe(a,14,Xt(!0)),c&&xe(a,439,Xt(!1)),xe(a,218,_r(0)),__(a,e,r),j_(a,e.SSF,r),C_(a,r),c&&xe(a,352,Xt(!1));var f=a.end(),h=er();c&&xe(h,140,D3()),c&&r.Strings&&b_(h,252,g3(r.Strings)),xe(h,10);var d=h.end(),x=er(),b=0,m=0;for(m=0;m<e.SheetNames.length;++m)b+=(c?12:11)+(c?2:1)*e.SheetNames[m].length;var w=f.length+b+d.length;for(m=0;m<e.SheetNames.length;++m){var p=s[m]||{};xe(x,133,m3({pos:w,hs:p.Hidden||0,dt:0,name:e.SheetNames[m]},r)),w+=t[m].length}var v=x.end();if(b!=v.length)throw new Error("BS8 "+b+" != "+v.length);var g=[];return f.length&&g.push(f),v.length&&g.push(v),d.length&&g.push(d),Ft(g)}function F_(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=ar(ct)),e&&e.SSF&&(Vc(),Gc(e.SSF),r.revssf=Yc(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,ld(r),r.cellXfs=[],dn(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)a[a.length]=R_(n,r,e);return a.unshift(O_(e,a,r)),Ft(a)}function Yv(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(!(!a||!a["!ref"])){var n=wr(a["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return F_(e,t);case 4:case 3:case 2:return T_(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function L_(e,t,r,a){for(var n=e["!merges"]||[],s=[],i=t.s.c;i<=t.e.c;++i){for(var c=0,o=0,u=0;u<n.length;++u)if(!(n[u].s.r>r||n[u].s.c>i)&&!(n[u].e.r<r||n[u].e.c<i)){if(n[u].s.r<r||n[u].s.c<i){c=-1;break}c=n[u].e.r-n[u].s.r+1,o=n[u].e.c-n[u].s.c+1;break}if(!(c<0)){var f=Ge({r,c:i}),h=a.dense?(e[r]||[])[i]:e[f],d=h&&h.v!=null&&(h.h||hw(h.w||(_a(h),h.w)||""))||"",x={};c>1&&(x.rowspan=c),o>1&&(x.colspan=o),a.editable?d='<span contenteditable="true">'+d+"</span>":h&&(x["data-t"]=h&&h.t||"z",h.v!=null&&(x["data-v"]=h.v),h.z!=null&&(x["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+h.l.Target+'">'+d+"</a>")),x.id=(a.id||"sjs")+"-"+f,s.push(he("td",d,x))}}var b="<tr>";return b+s.join("")+"</tr>"}var I_='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',B_="</body></html>";function P_(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Xv(e,t){var r=t||{},a=r.header!=null?r.header:I_,n=r.footer!=null?r.footer:B_,s=[a],i=wr(e["!ref"]);r.dense=Array.isArray(e),s.push(P_(e,i,r));for(var c=i.s.r;c<=i.e.r;++c)s.push(L_(e,i,c,r));return s.push("</table>"+n),s.join("")}function Wv(e,t,r){var a=r||{},n=0,s=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var i=typeof a.origin=="string"?At(a.origin):a.origin;n=i.r,s=i.c}var c=t.getElementsByTagName("tr"),o=Math.min(a.sheetRows||1e7,c.length),u={s:{r:0,c:0},e:{r:n,c:s}};if(e["!ref"]){var f=wr(e["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),n==-1&&(u.e.r=n=f.e.r+1)}var h=[],d=0,x=e["!rows"]||(e["!rows"]=[]),b=0,m=0,w=0,p=0,v=0,g=0;for(e["!cols"]||(e["!cols"]=[]);b<c.length&&m<o;++b){var N=c[b];if(px(N)){if(a.display)continue;x[m]={hidden:!0}}var I=N.children;for(w=p=0;w<I.length;++w){var z=I[w];if(!(a.display&&px(z))){var j=z.hasAttribute("data-v")?z.getAttribute("data-v"):z.hasAttribute("v")?z.getAttribute("v"):vw(z.innerHTML),B=z.getAttribute("data-z")||z.getAttribute("z");for(d=0;d<h.length;++d){var R=h[d];R.s.c==p+s&&R.s.r<m+n&&m+n<=R.e.r&&(p=R.e.c+1-s,d=-1)}g=+z.getAttribute("colspan")||1,((v=+z.getAttribute("rowspan")||1)>1||g>1)&&h.push({s:{r:m+n,c:p+s},e:{r:m+n+(v||1)-1,c:p+s+(g||1)-1}});var H={t:"s",v:j},q=z.getAttribute("data-t")||z.getAttribute("t")||"";j!=null&&(j.length==0?H.t=q||"z":a.raw||j.trim().length==0||q=="s"||(j==="TRUE"?H={t:"b",v:!0}:j==="FALSE"?H={t:"b",v:!1}:isNaN(ya(j))?isNaN(ii(j).getDate())||(H={t:"d",v:Qt(j)},a.cellDates||(H={t:"n",v:rr(H.v)}),H.z=a.dateNF||ct[14]):H={t:"n",v:ya(j)})),H.z===void 0&&B!=null&&(H.z=B);var re="",se=z.getElementsByTagName("A");if(se&&se.length)for(var le=0;le<se.length&&!(se[le].hasAttribute("href")&&(re=se[le].getAttribute("href"),re.charAt(0)!="#"));++le);re&&re.charAt(0)!="#"&&(H.l={Target:re}),a.dense?(e[m+n]||(e[m+n]=[]),e[m+n][p+s]=H):e[Ge({c:p+s,r:m+n})]=H,u.e.c<p+s&&(u.e.c=p+s),p+=g}}++m}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),u.e.r=Math.max(u.e.r,m-1+n),e["!ref"]=mt(u),m>=o&&(e["!fullref"]=mt((u.e.r=c.length-b+m-1+n,u))),e}function Jv(e,t){var r=t||{},a=r.dense?[]:{};return Wv(a,e,t)}function U_(e,t){return zn(Jv(e,t),t)}function px(e){var t="",r=z_(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function z_(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var H_=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+ci({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return gt+t}}(),yx=function(){var e=function(s){return He(s).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(s,i,c){var o=[];o.push('      <table:table table:name="'+He(i.SheetNames[c])+`" table:style-name="ta1">
`);var u=0,f=0,h=wr(s["!ref"]||"A1"),d=s["!merges"]||[],x=0,b=Array.isArray(s);if(s["!cols"])for(f=0;f<=h.e.c;++f)o.push("        <table:table-column"+(s["!cols"][f]?' table:style-name="co'+s["!cols"][f].ods+'"':"")+`></table:table-column>
`);var m="",w=s["!rows"]||[];for(u=0;u<h.s.r;++u)m=w[u]?' table:style-name="ro'+w[u].ods+'"':"",o.push("        <table:table-row"+m+`></table:table-row>
`);for(;u<=h.e.r;++u){for(m=w[u]?' table:style-name="ro'+w[u].ods+'"':"",o.push("        <table:table-row"+m+`>
`),f=0;f<h.s.c;++f)o.push(t);for(;f<=h.e.c;++f){var p=!1,v={},g="";for(x=0;x!=d.length;++x)if(!(d[x].s.c>f)&&!(d[x].s.r>u)&&!(d[x].e.c<f)&&!(d[x].e.r<u)){(d[x].s.c!=f||d[x].s.r!=u)&&(p=!0),v["table:number-columns-spanned"]=d[x].e.c-d[x].s.c+1,v["table:number-rows-spanned"]=d[x].e.r-d[x].s.r+1;break}if(p){o.push(r);continue}var N=Ge({r:u,c:f}),I=b?(s[u]||[])[f]:s[N];if(I&&I.f&&(v["table:formula"]=He(cE(I.f)),I.F&&I.F.slice(0,N.length)==N)){var z=wr(I.F);v["table:number-matrix-columns-spanned"]=z.e.c-z.s.c+1,v["table:number-matrix-rows-spanned"]=z.e.r-z.s.r+1}if(!I){o.push(t);continue}switch(I.t){case"b":g=I.v?"TRUE":"FALSE",v["office:value-type"]="boolean",v["office:boolean-value"]=I.v?"true":"false";break;case"n":g=I.w||String(I.v||0),v["office:value-type"]="float",v["office:value"]=I.v||0;break;case"s":case"str":g=I.v==null?"":I.v,v["office:value-type"]="string";break;case"d":g=I.w||Qt(I.v).toISOString(),v["office:value-type"]="date",v["office:date-value"]=Qt(I.v).toISOString(),v["table:style-name"]="ce1";break;default:o.push(t);continue}var j=e(g);if(I.l&&I.l.Target){var B=I.l.Target;B=B.charAt(0)=="#"?"#"+oE(B.slice(1)):B,B.charAt(0)!="#"&&!B.match(/^\w+:/)&&(B="../"+B),j=he("text:a",j,{"xlink:href":B.replace(/&/g,"&amp;")})}o.push("          "+he("table:table-cell",he("text:p",j,{}),v)+`
`)}o.push(`        </table:table-row>
`)}return o.push(`      </table:table>
`),o.join("")},n=function(s,i){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var c=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var f=0;f<u["!cols"].length;++f)if(u["!cols"][f]){var h=u["!cols"][f];if(h.width==null&&h.wpx==null&&h.wch==null)continue;td(h),h.ods=c;var d=u["!cols"][f].wpx+"px";s.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+d+`"/>
`),s.push(`  </style:style>
`),++c}}});var o=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var f=0;f<u["!rows"].length;++f)if(u["!rows"][f]){u["!rows"][f].ods=o;var h=u["!rows"][f].hpx+"px";s.push('  <style:style style:name="ro'+o+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++o}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(i,c){var o=[gt],u=ci({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=ci({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(o.push("<office:document"+u+f+`>
`),o.push(ov().replace(/office:document-meta/g,"office:meta"))):o.push("<office:document-content"+u+`>
`),n(o,i),o.push(`  <office:body>
`),o.push(`    <office:spreadsheet>
`);for(var h=0;h!=i.SheetNames.length;++h)o.push(a(i.Sheets[i.SheetNames[h]],i,h));return o.push(`    </office:spreadsheet>
`),o.push(`  </office:body>
`),c.bookType=="fods"?o.push("</office:document>"):o.push("</office:document-content>"),o.join("")}}();function Qv(e,t){if(t.bookType=="fods")return yx(e,t);var r=Vf(),a="",n=[],s=[];return a="mimetype",je(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",je(r,a,yx(e,t)),n.push([a,"text/xml"]),s.push([a,"ContentFile"]),a="styles.xml",je(r,a,H_(e,t)),n.push([a,"text/xml"]),s.push([a,"StylesFile"]),a="meta.xml",je(r,a,gt+ov()),n.push([a,"text/xml"]),s.push([a,"MetadataFile"]),a="manifest.rdf",je(r,a,e3(s)),n.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",je(r,a,Zw(n)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Nc(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function G_(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Hr(ma(e))}function V_(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}function on(e){var t=e.reduce(function(n,s){return n+s.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(n){r.set(n,a),a+=n.length}),r}function Y_(e,t,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var s=0;n>=1;++s,n/=256)e[t+s]=n&255;e[t+15]|=r>=0?0:128}function oi(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function Be(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Cs(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function yt(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],n=oi(e,r),s=n&7;n=Math.floor(n/8);var i=0,c;if(n==0)break;switch(s){case 0:{for(var o=r[0];e[r[0]++]>=128;);c=e.slice(o,r[0])}break;case 5:i=4,c=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,c=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=oi(e,r),c=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(n," at offset ").concat(a))}var u={data:c,type:s};t[n]==null?t[n]=[u]:t[n].push(u)}return t}function Mt(e){var t=[];return e.forEach(function(r,a){r.forEach(function(n){n.data&&(t.push(Be(a*8+n.type)),n.type==2&&t.push(Be(n.data.length)),t.push(n.data))})}),on(t)}function Pr(e){for(var t,r=[],a=[0];a[0]<e.length;){var n=oi(e,a),s=yt(e.slice(a[0],a[0]+n));a[0]+=n;var i={id:Cs(s[1][0].data),messages:[]};s[2].forEach(function(c){var o=yt(c.data),u=Cs(o[3][0].data);i.messages.push({meta:o,data:e.slice(a[0],a[0]+u)}),a[0]+=u}),(t=s[3])!=null&&t[0]&&(i.merge=Cs(s[3][0].data)>>>0>0),r.push(i)}return r}function Zn(e){var t=[];return e.forEach(function(r){var a=[];a[1]=[{data:Be(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:Be(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(i){n.push(i.data),i.meta[3]=[{type:0,data:Be(i.data.length)}],a[2].push({data:Mt(i.meta),type:2})});var s=Mt(a);t.push(Be(s.length)),t.push(s),n.forEach(function(i){return t.push(i)})}),on(t)}function X_(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=oi(t,r),n=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var c=i-59;i=t[r[0]],c>1&&(i|=t[r[0]+1]<<8),c>2&&(i|=t[r[0]+2]<<16),c>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=c}n.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var o=0,u=0;if(s==1?(u=(t[r[0]]>>2&7)+4,o=(t[r[0]++]&224)<<3,o|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,s==2?(o=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(o=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[on(n)],o==0)throw new Error("Invalid offset 0");if(o>n[0].length)throw new Error("Invalid offset beyond length");if(u>=o)for(n.push(n[0].slice(-o)),u-=o;u>=n[n.length-1].length;)n.push(n[n.length-1]),u-=n[n.length-1].length;n.push(n[0].slice(-o,-o+u))}}var f=on(n);if(f.length!=a)throw new Error("Unexpected length: ".concat(f.length," != ").concat(a));return f}function Ur(e){for(var t=[],r=0;r<e.length;){var a=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(X_(a,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return on(t)}function $n(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),n=new Uint8Array(4);t.push(n);var s=Be(a),i=s.length;t.push(s),a<=60?(i++,t.push(new Uint8Array([a-1<<2]))):a<=256?(i+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(i+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(i+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(i+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),i+=a,n[0]=0,n[1]=i&255,n[2]=i>>8&255,n[3]=i>>16&255,r+=a}return on(t)}function Bo(e,t){var r=new Uint8Array(32),a=Nc(r),n=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,Y_(r,n,e.v),s|=1,n+=16;break;case"b":r[1]=6,a.setFloat64(n,e.v?1:0,!0),s|=2,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(n,t.indexOf(e.v),!0),s|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,s,!0),r.slice(0,n)}function Po(e,t){var r=new Uint8Array(32),a=Nc(r),n=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(n,e.v,!0),s|=32,n+=8;break;case"b":r[2]=6,a.setFloat64(n,e.v?1:0,!0),s|=32,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(n,t.indexOf(e.v),!0),s|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,s,!0),r.slice(0,n)}function Fa(e){var t=yt(e);return oi(t[1][0].data)}function W_(e,t,r){var a,n,s,i;if(!((a=e[6])!=null&&a[0])||!((n=e[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var c=((i=(s=e[8])==null?void 0:s[0])==null?void 0:i.data)&&Cs(e[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var o=0,u=Nc(e[7][0].data),f=0,h=[],d=Nc(e[4][0].data),x=0,b=[],m=0;m<t.length;++m){if(t[m]==null){u.setUint16(m*2,65535,!0),d.setUint16(m*2,65535);continue}u.setUint16(m*2,f,!0),d.setUint16(m*2,x,!0);var w,p;switch(typeof t[m]){case"string":w=Bo({t:"s",v:t[m]},r),p=Po({t:"s",v:t[m]},r);break;case"number":w=Bo({t:"n",v:t[m]},r),p=Po({t:"n",v:t[m]},r);break;case"boolean":w=Bo({t:"b",v:t[m]},r),p=Po({t:"b",v:t[m]},r);break;default:throw new Error("Unsupported value "+t[m])}h.push(w),f+=w.length,b.push(p),x+=p.length,++o}for(e[2][0].data=Be(o);m<e[7][0].data.length/2;++m)u.setUint16(m*2,65535,!0),d.setUint16(m*2,65535,!0);return e[6][0].data=on(h),e[3][0].data=on(b),o}function J_(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=wr(r["!ref"]);a.s.r=a.s.c=0;var n=!1;a.e.c>9&&(n=!0,a.e.c=9),a.e.r>49&&(n=!0,a.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(mt(a)));var s=Sc(r,{range:a,header:1}),i=["~Sh33tJ5~"];s.forEach(function(P){return P.forEach(function(F){typeof F=="string"&&i.push(F)})});var c={},o=[],u=Ye.read(t.numbers,{type:"base64"});u.FileIndex.map(function(P,F){return[P,u.FullPaths[F]]}).forEach(function(P){var F=P[0],D=P[1];if(F.type==2&&F.name.match(/\.iwa/)){var k=F.content,U=Ur(k),ee=Pr(U);ee.forEach(function(ue){o.push(ue.id),c[ue.id]={deps:[],location:D,type:Cs(ue.messages[0].meta[1][0].data)}})}}),o.sort(function(P,F){return P-F});var f=o.filter(function(P){return P>1}).map(function(P){return[P,Be(P)]});u.FileIndex.map(function(P,F){return[P,u.FullPaths[F]]}).forEach(function(P){var F=P[0];if(P[1],!!F.name.match(/\.iwa/)){var D=Pr(Ur(F.content));D.forEach(function(k){k.messages.forEach(function(U){f.forEach(function(ee){k.messages.some(function(ue){return Cs(ue.meta[1][0].data)!=11006&&V_(ue.data,ee[1])})&&c[ee[0]].deps.push(k.id)})})})}});for(var h=Ye.find(u,c[1].location),d=Pr(Ur(h.content)),x,b=0;b<d.length;++b){var m=d[b];m.id==1&&(x=m)}var w=Fa(yt(x.messages[0].data)[1][0].data);for(h=Ye.find(u,c[w].location),d=Pr(Ur(h.content)),b=0;b<d.length;++b)m=d[b],m.id==w&&(x=m);for(w=Fa(yt(x.messages[0].data)[2][0].data),h=Ye.find(u,c[w].location),d=Pr(Ur(h.content)),b=0;b<d.length;++b)m=d[b],m.id==w&&(x=m);for(w=Fa(yt(x.messages[0].data)[2][0].data),h=Ye.find(u,c[w].location),d=Pr(Ur(h.content)),b=0;b<d.length;++b)m=d[b],m.id==w&&(x=m);var p=yt(x.messages[0].data);{p[6][0].data=Be(a.e.r+1),p[7][0].data=Be(a.e.c+1);var v=Fa(p[46][0].data),g=Ye.find(u,c[v].location),N=Pr(Ur(g.content));{for(var I=0;I<N.length&&N[I].id!=v;++I);if(N[I].id!=v)throw"Bad ColumnRowUIDMapArchive";var z=yt(N[I].messages[0].data);z[1]=[],z[2]=[],z[3]=[];for(var j=0;j<=a.e.c;++j){var B=[];B[1]=B[2]=[{type:0,data:Be(j+420690)}],z[1].push({type:2,data:Mt(B)}),z[2].push({type:0,data:Be(j)}),z[3].push({type:0,data:Be(j)})}z[4]=[],z[5]=[],z[6]=[];for(var R=0;R<=a.e.r;++R)B=[],B[1]=B[2]=[{type:0,data:Be(R+726270)}],z[4].push({type:2,data:Mt(B)}),z[5].push({type:0,data:Be(R)}),z[6].push({type:0,data:Be(R)});N[I].messages[0].data=Mt(z)}g.content=$n(Zn(N)),g.size=g.content.length,delete p[46];var H=yt(p[4][0].data);{H[7][0].data=Be(a.e.r+1);var q=yt(H[1][0].data),re=Fa(q[2][0].data);g=Ye.find(u,c[re].location),N=Pr(Ur(g.content));{if(N[0].id!=re)throw"Bad HeaderStorageBucket";var se=yt(N[0].messages[0].data);for(R=0;R<s.length;++R){var le=yt(se[2][0].data);le[1][0].data=Be(R),le[4][0].data=Be(s[R].length),se[2][R]={type:se[2][0].type,data:Mt(le)}}N[0].messages[0].data=Mt(se)}g.content=$n(Zn(N)),g.size=g.content.length;var G=Fa(H[2][0].data);g=Ye.find(u,c[G].location),N=Pr(Ur(g.content));{if(N[0].id!=G)throw"Bad HeaderStorageBucket";for(se=yt(N[0].messages[0].data),j=0;j<=a.e.c;++j)le=yt(se[2][0].data),le[1][0].data=Be(j),le[4][0].data=Be(a.e.r+1),se[2][j]={type:se[2][0].type,data:Mt(le)};N[0].messages[0].data=Mt(se)}g.content=$n(Zn(N)),g.size=g.content.length;var C=Fa(H[4][0].data);(function(){for(var P=Ye.find(u,c[C].location),F=Pr(Ur(P.content)),D,k=0;k<F.length;++k){var U=F[k];U.id==C&&(D=U)}var ee=yt(D.messages[0].data);{ee[3]=[];var ue=[];i.forEach(function(we,W){ue[1]=[{type:0,data:Be(W)}],ue[2]=[{type:0,data:Be(1)}],ue[3]=[{type:2,data:G_(we)}],ee[3].push({type:2,data:Mt(ue)})})}D.messages[0].data=Mt(ee);var ie=Zn(F),be=$n(ie);P.content=be,P.size=P.content.length})();var K=yt(H[3][0].data);{var O=K[1][0];delete K[2];var ne=yt(O.data);{var ye=Fa(ne[2][0].data);(function(){for(var P=Ye.find(u,c[ye].location),F=Pr(Ur(P.content)),D,k=0;k<F.length;++k){var U=F[k];U.id==ye&&(D=U)}var ee=yt(D.messages[0].data);{delete ee[6],delete K[7];var ue=new Uint8Array(ee[5][0].data);ee[5]=[];for(var ie=0,be=0;be<=a.e.r;++be){var we=yt(ue);ie+=W_(we,s[be],i),we[1][0].data=Be(be),ee[5].push({data:Mt(we),type:2})}ee[1]=[{type:0,data:Be(a.e.c+1)}],ee[2]=[{type:0,data:Be(a.e.r+1)}],ee[3]=[{type:0,data:Be(ie)}],ee[4]=[{type:0,data:Be(a.e.r+1)}]}D.messages[0].data=Mt(ee);var W=Zn(F),Q=$n(W);P.content=Q,P.size=P.content.length})()}O.data=Mt(ne)}H[3][0].data=Mt(K)}p[4][0].data=Mt(H)}x.messages[0].data=Mt(p);var Te=Zn(d),M=$n(Te);return h.content=M,h.size=h.content.length,u}function Q_(e){return function(r){for(var a=0;a!=e.length;++a){var n=e[a];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function ld(e){Q_([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function q_(e,t){return t.bookType=="ods"?Qv(e,t):t.bookType=="numbers"?J_(e,t):t.bookType=="xlsb"?K_(e,t):Z_(e,t)}function K_(e,t){vs=1024,e&&!e.SSF&&(e.SSF=ar(ct)),e&&e.SSF&&(Vc(),Gc(e.SSF),t.revssf=Yc(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Vl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",a=Mv.indexOf(t.bookType)>-1,n=lv();ld(t=t||{});var s=Vf(),i="",c=0;if(t.cellXfs=[],dn(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",je(s,i,uv(e.Props,t)),n.coreprops.push(i),Ue(t.rels,2,i,Oe.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var o=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&o.push(e.SheetNames[u]);e.Props.SheetNames=o}for(e.Props.Worksheets=e.Props.SheetNames.length,je(s,i,dv(e.Props)),n.extprops.push(i),Ue(t.rels,3,i,Oe.EXT_PROPS),e.Custprops!==e.Props&&Pt(e.Custprops||{}).length>0&&(i="docProps/custom.xml",je(s,i,hv(e.Custprops)),n.custprops.push(i),Ue(t.rels,4,i,Oe.CUST_PROPS)),c=1;c<=e.SheetNames.length;++c){var f={"!id":{}},h=e.Sheets[e.SheetNames[c-1]],d=(h||{})["!type"]||"sheet";switch(d){case"chart":default:i="xl/worksheets/sheet"+c+"."+r,je(s,i,e_(c-1,i,t,e,f)),n.sheets.push(i),Ue(t.wbrels,-1,"worksheets/sheet"+c+"."+r,Oe.WS[0])}if(h){var x=h["!comments"],b=!1,m="";x&&x.length>0&&(m="xl/comments"+c+"."+r,je(s,m,a_(x,m)),n.comments.push(m),Ue(f,-1,"../comments"+c+"."+r,Oe.CMNT),b=!0),h["!legacy"]&&b&&je(s,"xl/drawings/vmlDrawing"+c+".vml",Cv(c,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&je(s,cv(i),js(f))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,je(s,i,r_(t.Strings,i,t)),n.strs.push(i),Ue(t.wbrels,-1,"sharedStrings."+r,Oe.SST)),i="xl/workbook."+r,je(s,i,$T(e,i)),n.workbooks.push(i),Ue(t.rels,1,i,Oe.WB),i="xl/theme/theme1.xml",je(s,i,jv(e.Themes,t)),n.themes.push(i),Ue(t.wbrels,-1,"theme/theme1.xml",Oe.THEME),i="xl/styles."+r,je(s,i,t_(e,i,t)),n.styles.push(i),Ue(t.wbrels,-1,"styles."+r,Oe.STY),e.vbaraw&&a&&(i="xl/vbaProject.bin",je(s,i,e.vbaraw),n.vba.push(i),Ue(t.wbrels,-1,"vbaProject.bin",Oe.VBA)),i="xl/metadata."+r,je(s,i,n_(i)),n.metadata.push(i),Ue(t.wbrels,-1,"metadata."+r,Oe.XLMETA),je(s,"[Content_Types].xml",iv(n,t)),je(s,"_rels/.rels",js(t.rels)),je(s,"xl/_rels/workbook."+r+".rels",js(t.wbrels)),delete t.revssf,delete t.ssf,s}function Z_(e,t){vs=1024,e&&!e.SSF&&(e.SSF=ar(ct)),e&&e.SSF&&(Vc(),Gc(e.SSF),t.revssf=Yc(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Vl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=Mv.indexOf(t.bookType)>-1,n=lv();ld(t=t||{});var s=Vf(),i="",c=0;if(t.cellXfs=[],dn(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",je(s,i,uv(e.Props,t)),n.coreprops.push(i),Ue(t.rels,2,i,Oe.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var o=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&o.push(e.SheetNames[u]);e.Props.SheetNames=o}e.Props.Worksheets=e.Props.SheetNames.length,je(s,i,dv(e.Props)),n.extprops.push(i),Ue(t.rels,3,i,Oe.EXT_PROPS),e.Custprops!==e.Props&&Pt(e.Custprops||{}).length>0&&(i="docProps/custom.xml",je(s,i,hv(e.Custprops)),n.custprops.push(i),Ue(t.rels,4,i,Oe.CUST_PROPS));var f=["SheetJ5"];for(t.tcid=0,c=1;c<=e.SheetNames.length;++c){var h={"!id":{}},d=e.Sheets[e.SheetNames[c-1]],x=(d||{})["!type"]||"sheet";switch(x){case"chart":default:i="xl/worksheets/sheet"+c+"."+r,je(s,i,Uv(c-1,t,e,h)),n.sheets.push(i),Ue(t.wbrels,-1,"worksheets/sheet"+c+"."+r,Oe.WS[0])}if(d){var b=d["!comments"],m=!1,w="";if(b&&b.length>0){var p=!1;b.forEach(function(v){v[1].forEach(function(g){g.T==!0&&(p=!0)})}),p&&(w="xl/threadedComments/threadedComment"+c+"."+r,je(s,w,CN(b,f,t)),n.threadedcomments.push(w),Ue(h,-1,"../threadedComments/threadedComment"+c+"."+r,Oe.TCMNT)),w="xl/comments"+c+"."+r,je(s,w,kv(b)),n.comments.push(w),Ue(h,-1,"../comments"+c+"."+r,Oe.CMNT),m=!0}d["!legacy"]&&m&&je(s,"xl/drawings/vmlDrawing"+c+".vml",Cv(c,d["!comments"])),delete d["!comments"],delete d["!legacy"]}h["!id"].rId1&&je(s,cv(i),js(h))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,je(s,i,wv(t.Strings,t)),n.strs.push(i),Ue(t.wbrels,-1,"sharedStrings."+r,Oe.SST)),i="xl/workbook."+r,je(s,i,Gv(e)),n.workbooks.push(i),Ue(t.rels,1,i,Oe.WB),i="xl/theme/theme1.xml",je(s,i,jv(e.Themes,t)),n.themes.push(i),Ue(t.wbrels,-1,"theme/theme1.xml",Oe.THEME),i="xl/styles."+r,je(s,i,Tv(e,t)),n.styles.push(i),Ue(t.wbrels,-1,"styles."+r,Oe.STY),e.vbaraw&&a&&(i="xl/vbaProject.bin",je(s,i,e.vbaraw),n.vba.push(i),Ue(t.wbrels,-1,"vbaProject.bin",Oe.VBA)),i="xl/metadata."+r,je(s,i,Av()),n.metadata.push(i),Ue(t.wbrels,-1,"metadata."+r,Oe.XLMETA),f.length>1&&(i="xl/persons/person.xml",je(s,i,kN(f)),n.people.push(i),Ue(t.wbrels,-1,"persons/person.xml",Oe.PEOPLE)),je(s,"[Content_Types].xml",iv(n,t)),je(s,"_rels/.rels",js(t.rels)),je(s,"xl/_rels/workbook."+r+".rels",js(t.wbrels)),delete t.revssf,delete t.ssf,s}function $_(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Ta(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function qv(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Ai(t.file,Ye.write(e,{type:Fe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ye.write(e,t)}function ej(e,t){var r=ar(t||{}),a=q_(e,r);return tj(a,r)}function tj(e,t){var r={},a=Fe?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var n=e.FullPaths?Ye.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof n=="string"){if(t.type=="binary"||t.type=="base64")return n;n=new Uint8Array(Hc(n))}return t.password&&typeof encrypt_agile<"u"?qv(encrypt_agile(n,t.password),t):t.type==="file"?Ai(t.file,n):t.type=="string"?Ul(n):n}function rj(e,t){var r=t||{},a=p_(e,r);return qv(a,r)}function Kr(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return li(ma(a));case"binary":return ma(a);case"string":return e;case"file":return Ai(t.file,a,"utf8");case"buffer":return Fe?Aa(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):Kr(a,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function aj(e,t){switch(t.type){case"base64":return li(e);case"binary":return e;case"string":return e;case"file":return Ai(t.file,e,"binary");case"buffer":return Fe?Aa(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function p0(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return t.type=="base64"?li(r):t.type=="string"?Ul(r):r;case"file":return Ai(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Kv(e,t){kb(),HT(e);var r=ar(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=Kv(e,r);return r.type="array",Hc(a)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=e.SheetNames.indexOf(r.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Kr(g_(e,r),r);case"slk":case"sylk":return Kr(P3.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"htm":case"html":return Kr(Xv(e.Sheets[e.SheetNames[n]],r),r);case"txt":return aj(Zv(e.Sheets[e.SheetNames[n]],r),r);case"csv":return Kr(id(e.Sheets[e.SheetNames[n]],r),r,"\uFEFF");case"dif":return Kr(U3.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"dbf":return p0(B3.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"prn":return Kr(z3.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"rtf":return Kr(J3.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"eth":return Kr(bv.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"fods":return Kr(Qv(e,r),r);case"wk1":return p0(dx.sheet_to_wk1(e.Sheets[e.SheetNames[n]],r),r);case"wk3":return p0(dx.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),p0(Yv(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),rj(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return ej(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function nj(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function sj(e,t,r){var a=r||{};return a.type="file",a.file=t,nj(a),Kv(e,a)}function lj(e,t,r,a,n,s,i,c){var o=Bt(r),u=c.defval,f=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),h=!0,d=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!i||e[r])for(var x=t.s.c;x<=t.e.c;++x){var b=i?e[r][x]:e[a[x]+o];if(b===void 0||b.t===void 0){if(u===void 0)continue;s[x]!=null&&(d[s[x]]=u);continue}var m=b.v;switch(b.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+b.t)}if(s[x]!=null){if(m==null)if(b.t=="e"&&m===null)d[s[x]]=null;else if(u!==void 0)d[s[x]]=u;else if(f&&m===null)d[s[x]]=null;else continue;else d[s[x]]=f&&(b.t!=="n"||b.t==="n"&&c.rawNumbers!==!1)?m:_a(b,m,c);m!=null&&(h=!1)}}return{row:d,isempty:h}}function Sc(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,n=1,s=[],i=0,c="",o={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},f=u.range!=null?u.range:e["!ref"];switch(u.header===1?a=1:u.header==="A"?a=2:Array.isArray(u.header)?a=3:u.header==null&&(a=0),typeof f){case"string":o=et(f);break;case"number":o=et(e["!ref"]),o.s.r=f;break;default:o=f}a>0&&(n=0);var h=Bt(o.s.r),d=[],x=[],b=0,m=0,w=Array.isArray(e),p=o.s.r,v=0,g={};w&&!e[p]&&(e[p]=[]);var N=u.skipHidden&&e["!cols"]||[],I=u.skipHidden&&e["!rows"]||[];for(v=o.s.c;v<=o.e.c;++v)if(!(N[v]||{}).hidden)switch(d[v]=Gt(v),r=w?e[p][v]:e[d[v]+h],a){case 1:s[v]=v-o.s.c;break;case 2:s[v]=d[v];break;case 3:s[v]=u.header[v-o.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),c=i=_a(r,null,u),m=g[i]||0,!m)g[i]=1;else{do c=i+"_"+m++;while(g[c]);g[i]=m,g[c]=1}s[v]=c}for(p=o.s.r+n;p<=o.e.r;++p)if(!(I[p]||{}).hidden){var z=lj(e,o,p,d,a,s,w,u);(z.isempty===!1||(a===1?u.blankrows!==!1:u.blankrows))&&(x[b++]=z.row)}return x.length=b,x}var bx=/"/g;function ij(e,t,r,a,n,s,i,c){for(var o=!0,u=[],f="",h=Bt(r),d=t.s.c;d<=t.e.c;++d)if(a[d]){var x=c.dense?(e[r]||[])[d]:e[a[d]+h];if(x==null)f="";else if(x.v!=null){o=!1,f=""+(c.rawNumbers&&x.t=="n"?x.v:_a(x,null,c));for(var b=0,m=0;b!==f.length;++b)if((m=f.charCodeAt(b))===n||m===s||m===34||c.forceQuotes){f='"'+f.replace(bx,'""')+'"';break}f=="ID"&&(f='"ID"')}else x.f!=null&&!x.F?(o=!1,f="="+x.f,f.indexOf(",")>=0&&(f='"'+f.replace(bx,'""')+'"')):f="";u.push(f)}return c.blankrows===!1&&o?null:u.join(i)}function id(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var n=et(e["!ref"]),s=a.FS!==void 0?a.FS:",",i=s.charCodeAt(0),c=a.RS!==void 0?a.RS:`
`,o=c.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),f="",h=[];a.dense=Array.isArray(e);for(var d=a.skipHidden&&e["!cols"]||[],x=a.skipHidden&&e["!rows"]||[],b=n.s.c;b<=n.e.c;++b)(d[b]||{}).hidden||(h[b]=Gt(b));for(var m=0,w=n.s.r;w<=n.e.r;++w)(x[w]||{}).hidden||(f=ij(e,n,w,h,i,o,s,a),f!=null&&(a.strip&&(f=f.replace(u,"")),(f||a.blankrows!==!1)&&r.push((m++?c:"")+f)));return delete a.dense,r.join("")}function Zv(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=id(e,t);return r}function cj(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var n=et(e["!ref"]),s="",i=[],c,o=[],u=Array.isArray(e);for(c=n.s.c;c<=n.e.c;++c)i[c]=Gt(c);for(var f=n.s.r;f<=n.e.r;++f)for(s=Bt(f),c=n.s.c;c<=n.e.c;++c)if(t=i[c]+s,r=u?(e[f]||[])[c]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}o[o.length]=t+"="+a}return o}function $v(e,t,r){var a=r||{},n=+!a.skipHeader,s=e||{},i=0,c=0;if(s&&a.origin!=null)if(typeof a.origin=="number")i=a.origin;else{var o=typeof a.origin=="string"?At(a.origin):a.origin;i=o.r,c=o.c}var u,f={s:{c:0,r:0},e:{c,r:i+t.length-1+n}};if(s["!ref"]){var h=et(s["!ref"]);f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),i==-1&&(i=h.e.r+1,f.e.r=i+t.length-1+n)}else i==-1&&(i=0,f.e.r=t.length-1+n);var d=a.header||[],x=0;t.forEach(function(m,w){Pt(m).forEach(function(p){(x=d.indexOf(p))==-1&&(d[x=d.length]=p);var v=m[p],g="z",N="",I=Ge({c:c+x,r:i+w+n});u=ui(s,I),v&&typeof v=="object"&&!(v instanceof Date)?s[I]=v:(typeof v=="number"?g="n":typeof v=="boolean"?g="b":typeof v=="string"?g="s":v instanceof Date?(g="d",a.cellDates||(g="n",v=rr(v)),N=a.dateNF||ct[14]):v===null&&a.nullError&&(g="e",v=0),u?(u.t=g,u.v=v,delete u.w,delete u.R,N&&(u.z=N)):s[I]=u={t:g,v},N&&(u.z=N))})}),f.e.c=Math.max(f.e.c,c+d.length-1);var b=Bt(i);if(n)for(x=0;x<d.length;++x)s[Gt(x+c)+b]={t:"s",v:d[x]};return s["!ref"]=mt(f),s}function oj(e,t){return $v(null,e,t)}function ui(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=At(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?ui(e,Ge(t)):ui(e,Ge({r:t,c:r||0}))}function uj(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function fj(){return{SheetNames:[],Sheets:{}}}function dj(e,t,r,a){var n=1;if(!r)for(;n<=65535&&e.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);n=s&&+s[2]||0;var i=s&&s[1]||r;for(++n;n<=65535&&e.SheetNames.indexOf(r=i+n)!=-1;++n);}if(Hv(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function hj(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=uj(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function xj(e,t){return e.z=t,e}function ep(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function mj(e,t,r){return ep(e,"#"+t,r)}function gj(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function vj(e,t,r,a){for(var n=typeof t!="string"?t:et(t),s=typeof t=="string"?t:mt(t),i=n.s.r;i<=n.e.r;++i)for(var c=n.s.c;c<=n.e.c;++c){var o=ui(e,i,c);o.t="n",o.F=s,delete o.v,i==n.s.r&&c==n.s.c&&(o.f=r,a&&(o.D=!0))}return e}var Uo={encode_col:Gt,encode_row:Bt,encode_cell:Ge,encode_range:mt,decode_col:qf,decode_row:Qf,split_cell:Mw,decode_cell:At,decode_range:wr,format_cell:_a,sheet_add_aoa:ev,sheet_add_json:$v,sheet_add_dom:Wv,aoa_to_sheet:qs,json_to_sheet:oj,table_to_sheet:Jv,table_to_book:U_,sheet_to_csv:id,sheet_to_txt:Zv,sheet_to_json:Sc,sheet_to_html:Xv,sheet_to_formulae:cj,sheet_to_row_object_array:Sc,sheet_get_cell:ui,book_new:fj,book_append_sheet:dj,book_set_sheet_visibility:hj,cell_set_number_format:xj,cell_set_hyperlink:ep,cell_set_internal_link:mj,cell_add_comment:gj,sheet_set_array_formula:vj,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const pj={details:{label:"Details",id:"details"},metadata:{label:"AI Metadata",id:"metadata"},processing:{label:"Processing",id:"processing"}},yj=({image:e,isOpen:t,onClose:r,onPrevious:a,onNext:n,hasPrevious:s=!1,hasNext:i=!1})=>{var x,b;const[c,o]=L.useState("details");if(L.useEffect(()=>{const m=w=>{w.key==="Escape"&&t&&r()};return t&&(document.addEventListener("keydown",m),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",m),document.body.style.overflow="unset"}},[t,r]),L.useEffect(()=>{t&&e&&o("details")},[t,e]),!t||!e)return null;const u=m=>{switch(m){case"approved":return"bg-green-100 text-green-800 border-green-300";case"rejected":return"bg-red-100 text-red-800 border-red-300";case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-300";default:return"bg-gray-100 text-gray-800 border-gray-300"}},f=m=>new Date(m).toLocaleString(),h=e.processingSettings||{};let d={};if(typeof e.metadata=="string")try{d=JSON.parse(e.metadata),console.log("🔍 Parsed metadata from string:",d)}catch(m){console.error("❌ Failed to parse metadata string:",m),d={}}else e.metadata&&(d=e.metadata,console.log("🔍 Metadata is already an object:",d));return l.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:r,"aria-hidden":"true"}),l.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:l.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl max-w-6xl w-full max-h-[90vh] overflow-hidden",children:[l.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Image Details"}),l.jsx("div",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${u(e.qcStatus)}`,children:e.qcStatus||"pending"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[(s||i)&&l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx("button",{onClick:a,disabled:!s,className:`p-2 rounded-md transition-colors ${s?"text-gray-600 hover:text-gray-900 hover:bg-gray-100":"text-gray-300 cursor-not-allowed"}`,"aria-label":"Previous image",children:l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),l.jsx("button",{onClick:n,disabled:!i,className:`p-2 rounded-md transition-colors ${i?"text-gray-600 hover:text-gray-900 hover:bg-gray-100":"text-gray-300 cursor-not-allowed"}`,"aria-label":"Next image",children:l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),l.jsx("button",{onClick:r,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-md transition-colors","aria-label":"Close modal",children:l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),l.jsxs("div",{className:"flex flex-col lg:flex-row max-h-[calc(90vh-80px)]",children:[l.jsx("div",{className:"flex-1 flex items-center justify-center bg-gray-50 p-4",children:l.jsx("div",{className:"max-w-full max-h-full",children:l.jsx("img",{src:`local-file://${e.finalImagePath}`,alt:"Generated image",className:"w-full h-auto max-h-96 object-contain rounded",onError:m=>{m.currentTarget.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik01MCA1MEgxNTBWNzVINzVWMTI1SDUwVjUwWiIgZmlsbD0iI0QxRDVEM0EiLz4KPHN2ZyB4PSI3NSIgeT0iODAiIHdpZHRoPSI1MCIgaGVpZ2h0PSI0NSIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNMTkgM0g1QzMuOSAzIDMgMy45IDMgNVYxOUMzIDIwLjEgMy45IDIxIDUgMjFIMTlDMjAuMSAyMSAyMSAyMC4xIDIxIDE5VjVDMjEgMy45IDIwLjEgMyAxOSAzWk0xOSAxOUg1VjVIMTlWMTlaIiBmaWxsPSIjOUI5QkEwIi8+CjxwYXRoIGQ9Ik0xNCAxM0gxMFYxN0gxNFYxM1oiIGZpbGw9IiM5QjlCQTAiLz4KPC9zdmc+Cjwvc3ZnPgo="}})})}),l.jsxs("div",{className:"w-full lg:w-96 border-l border-gray-200 flex flex-col",children:[l.jsx("div",{className:"flex border-b border-gray-200",children:Object.values(pj).map(m=>l.jsx("button",{onClick:()=>o(m.id),className:`flex-1 px-4 py-3 text-sm font-medium border-b-2 transition-colors ${c===m.id?"border-blue-500 text-blue-600 bg-blue-50":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:m.label},m.id))}),l.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[c==="details"&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Image ID"}),l.jsx("p",{className:"text-sm text-gray-900 font-mono",children:e.id})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Job Execution"}),l.jsx("p",{className:"text-sm text-gray-900 font-mono",children:e.executionId})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Generation Prompt"}),l.jsx("p",{className:"text-sm text-gray-900 bg-gray-50 p-3 rounded-md border",children:e.generationPrompt})]}),e.seed&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Seed"}),l.jsx("p",{className:"text-sm text-gray-900 font-mono",children:e.seed})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"QC Status"}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${u(e.qcStatus)}`,children:e.qcStatus||"pending"}),e.qcReason&&l.jsxs("span",{className:"text-sm text-gray-600",children:["- ",e.qcReason]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Created"}),l.jsx("p",{className:"text-sm text-gray-900",children:f(e.createdAt)})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"File Path"}),l.jsx("p",{className:"text-sm text-gray-900 font-mono break-all",children:e.finalImagePath})]})]}),c==="metadata"&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"AI-Generated Metadata"}),l.jsxs("button",{onClick:async()=>{try{console.log("🔄 Refreshing metadata for image:",e.id);const m=await window.electronAPI.generatedImages.getGeneratedImage(e.id);m.success&&(console.log("✅ Metadata refreshed:",m.image.metadata),console.log("🔄 To see updated metadata, close and reopen the image modal"))}catch(m){console.error("❌ Failed to refresh metadata:",m)}},className:"inline-flex items-center px-3 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[l.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh Metadata"]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"AI-Generated Title"}),l.jsx("p",{className:"text-sm text-gray-900 bg-gray-50 p-3 rounded-md border",children:((x=d.title)==null?void 0:x.en)||d.title||"No title generated"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"AI-Generated Description"}),l.jsx("p",{className:"text-sm text-gray-900 bg-gray-50 p-3 rounded-md border",children:((b=d.description)==null?void 0:b.en)||d.description||"No description generated"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"AI-Generated Tags"}),l.jsx("div",{className:"bg-gray-50 p-3 rounded-md border",children:(()=>{var w;let m=[];return(w=d.uploadTags)!=null&&w.en?m=d.uploadTags.en.split(",").map(p=>p.trim()).filter(p=>p):Array.isArray(d.tags)?m=d.tags:typeof d.tags=="string"&&d.tags.trim()&&(m=d.tags.split(",").map(p=>p.trim()).filter(p=>p)),m.length>0?l.jsx("div",{className:"flex flex-wrap gap-2",children:m.map((p,v)=>l.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:p},v))}):l.jsx("p",{className:"text-sm text-gray-500",children:"No tags generated"})})()})]})]}),c==="processing"&&l.jsx("div",{className:"space-y-4",children:l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Image Enhancement"}),l.jsx("p",{className:"text-sm text-gray-900",children:h.imageEnhancement?"Yes":"No"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sharpening"}),l.jsx("p",{className:"text-sm text-gray-900",children:h.imageEnhancement?h.sharpening||0:l.jsx("span",{className:"text-gray-500 italic",children:"Not applied (Image Enhancement OFF)"})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Saturation"}),l.jsx("p",{className:"text-sm text-gray-900",children:h.imageEnhancement?h.saturation||1.4:l.jsx("span",{className:"text-gray-500 italic",children:"Not applied (Image Enhancement OFF)"})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Image Convert"}),l.jsx("p",{className:"text-sm text-gray-900",children:h.imageConvert?"Yes":"No"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Convert Format"}),l.jsx("p",{className:"text-sm text-gray-900",children:h.imageConvert?h.convertToJpg?"JPG":"PNG":l.jsx("span",{className:"text-gray-500 italic",children:"Not applied (Image Convert OFF)"})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"JPG Quality"}),l.jsx("p",{className:"text-sm text-gray-900",children:h.imageConvert&&h.convertToJpg?h.jpgQuality||100:l.jsx("span",{className:"text-gray-500 italic",children:"Not applied (Convert Format is not JPG)"})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PNG Quality"}),l.jsx("p",{className:"text-sm text-gray-900",children:h.imageConvert&&!h.convertToJpg?h.pngQuality||100:l.jsx("span",{className:"text-gray-500 italic",children:"Not applied (Convert Format is not PNG)"})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Remove Background"}),l.jsx("p",{className:"text-sm text-gray-900",children:h.removeBg?"Yes":"No"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Remove.bg Size"}),l.jsx("p",{className:"text-sm text-gray-900",children:h.removeBg?h.removeBgSize||"auto":l.jsx("span",{className:"text-gray-500 italic",children:"Not applied (Remove Background OFF)"})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trim Transparent"}),l.jsx("p",{className:"text-sm text-gray-900",children:h.trimTransparentBackground?"Yes":"No"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"JPG Background Colour"}),l.jsx("p",{className:"text-sm text-gray-900",children:h.imageConvert&&h.convertToJpg&&h.removeBg?h.jpgBackground||"white":l.jsx("span",{className:"text-gray-500 italic",children:"Not applied (Remove Background, Image Convert are set to OFF and Convert Format is not JPG)"})})]})]})})]})]})]})]})})]})},bj=[{wch:5},{wch:15},{wch:15},{wch:25},{wch:40},{wch:12},{wch:30},{wch:50},{wch:12},{wch:20},{wch:30},{wch:50},{wch:40},{wch:15},{wch:15},{wch:15},{wch:12},{wch:12},{wch:12},{wch:12},{wch:15},{wch:15},{wch:15},{wch:15}],wj=({images:e,onImageAction:t,onBulkAction:r,isLoading:a,jobStatus:n="idle"})=>{if(!e||!Array.isArray(e))return l.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:l.jsx("div",{className:"text-center text-gray-500",children:a?"Loading images...":"No images available"})});const[s,i]=L.useState(new Set),[c,o]=L.useState("all"),[u,f]=L.useState(""),[h,d]=L.useState("grid"),[x,b]=L.useState("newest"),[m,w]=L.useState(null),[p,v]=L.useState(!1),[g,N]=L.useState(null);Vr.useEffect(()=>{i(new Set)},[c]);const I=Array.from(new Set((e||[]).map(C=>C.executionId))),z=Vr.useMemo(()=>!e||!Array.isArray(e)?[]:[...e.filter(O=>{var ne,ye;if(c!=="all"&&O.executionId!==c)return!1;if(u){const Te=u.toLowerCase(),M=O.generationPrompt.toLowerCase().includes(Te),P=(ye=(ne=O.metadata)==null?void 0:ne.prompt)==null?void 0:ye.toLowerCase().includes(Te);if(!M&&!P)return!1}return!0})].sort((O,ne)=>{switch(x){case"newest":return new Date(ne.createdAt).getTime()-new Date(O.createdAt).getTime();case"oldest":return new Date(O.createdAt).getTime()-new Date(ne.createdAt).getTime();case"name":return O.generationPrompt.localeCompare(ne.generationPrompt);default:return 0}}),[e,c,u,x]),j=C=>{const K=new Set(s);K.has(C)?K.delete(C):K.add(C),i(K)},B=()=>{s.size===z.length?i(new Set):i(new Set(z.map(C=>C.id)))},R=C=>{s.size!==0&&(s.forEach(K=>{t(C,K)}),i(new Set))},H=(C,K)=>{t("update-qc-status",C,K)},q=(C,K)=>{const O=C.processingSettings||{},ne=C.metadata||{};return{Row:K+1,"Image ID":C.id,"Job Execution ID":C.executionId,"File Name":C.finalImagePath?C.finalImagePath.split("/").pop():"N/A","File Path":C.finalImagePath||"N/A","QC Status":C.qcStatus||"pending","QC Reason":C.qcReason||"","Generation Prompt":C.generationPrompt||"",Seed:C.seed||"N/A","Created At":C.createdAt?new Date(C.createdAt).toLocaleString():"N/A","AI Title":ne.title||"","AI Description":ne.description||"","AI Tags":Array.isArray(ne.tags)?ne.tags.join(", "):ne.tags||"","Image Enhancement":O.imageEnhancement?"Yes":"No","Sharpening Level":O.sharpening||0,"Saturation Level":O.saturation||1,"Image Convert":O.imageConvert?"Yes":"No","Convert to JPG":O.convertToJpg?"Yes":"No","JPG Quality":O.jpgQuality||"N/A","PNG Quality":O.pngQuality||"N/A","Remove Background":O.removeBg?"Yes":"No","Remove BG Size":O.removeBgSize||"N/A","Trim Transparent":O.trimTransparentBackground?"Yes":"No","JPG Background":O.jpgBackground||"N/A"}},re=async()=>{try{v(!0),N(null);const C=s.size===0?z:Array.from(s).map(P=>e.find(F=>F.id===P)).filter(P=>P!==void 0);if(C.length===0){N("No images to export");return}const K=C.map(q),O=Uo.book_new(),ne=Uo.json_to_sheet(K),ye=bj;ne["!cols"]=ye,Uo.book_append_sheet(O,ne,"Generated Images");const M=`generated-images-export-${new Date().toISOString().replace(/[:.]/g,"-").split("T")[0]}.xlsx`;sj(O,M),console.log(`Excel export completed: ${C.length} images exported to ${M}`)}catch(C){const K=C instanceof Error?C.message:"Unknown error";console.error("Excel export failed:",C),N(`Export failed: ${K}`)}finally{v(!1)}},se=C=>new Date(C).toLocaleDateString()+" "+new Date(C).toLocaleTimeString(),le=C=>{if(!m)return;const K=z.findIndex(ne=>ne.id===m);if(K===-1)return;let O;C==="next"?O=K+1<z.length?K+1:K:O=K-1>=0?K-1:K,w(z[O].id)},G=()=>{if(!m)return{hasPrevious:!1,hasNext:!1};const C=z.findIndex(K=>K.id===m);return{hasPrevious:C>0,hasNext:C<z.length-1}};return l.jsxs("div",{className:"flex flex-col h-full min-h-0",children:[l.jsx("div",{className:"flex items-center justify-between mb-4 flex-shrink-0",children:l.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Generated Images"})}),l.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg mb-4 flex-shrink-0",children:[l.jsxs("div",{className:"text-sm font-medium text-gray-700",children:[e.length," Total Images"]}),l.jsx("div",{className:"flex items-center space-x-4",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),l.jsxs("span",{className:"text-sm text-gray-700",children:[e.length," Success Images"]})]})})]}),l.jsxs("div",{className:"flex flex-wrap items-center gap-4 p-4 bg-gray-50 rounded-lg mb-4 flex-shrink-0",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Job:"}),l.jsxs("select",{"aria-label":"Job",value:c,onChange:C=>o(C.target.value),className:"text-sm border border-gray-300 rounded-md px-3 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:"all",children:"All Jobs"}),I.length>0?I.map(C=>l.jsxs("option",{value:C,children:["Job ",String(C).slice(0,8),"..."]},C)):l.jsx("option",{value:"all",disabled:!0,children:"No jobs available"})]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Search:"}),l.jsx("input",{type:"text",placeholder:"Search images...",value:u,onChange:C=>f(C.target.value),className:"text-sm border border-gray-300 rounded-md px-3 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Sort:"}),l.jsxs("select",{value:x,onChange:C=>b(C.target.value),className:"text-sm border border-gray-300 rounded-md px-3 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:"newest",children:"Newest First"}),l.jsx("option",{value:"oldest",children:"Oldest First"}),l.jsx("option",{value:"name",children:"By Name"})]})]}),l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx("button",{onClick:()=>d("grid"),className:`p-1 rounded ${h==="grid"?"bg-blue-100 text-blue-600":"text-gray-400 hover:text-gray-600"}`,title:"Grid view","aria-label":"Grid view",children:l.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{d:"M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),l.jsx("button",{onClick:()=>d("list"),className:`p-1 rounded ${h==="list"?"bg-blue-100 text-blue-600":"text-gray-400 hover:text-gray-600"}`,title:"List view","aria-label":"List view",children:l.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z",clipRule:"evenodd"})})})]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("input",{type:"checkbox","aria-label":"Select all images",checked:s.size===z.length&&z.length>0,onChange:B,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),l.jsxs("span",{className:"text-sm text-gray-700",children:["Select All (",s.size,"/",z.length,")"]})]}),s.size>0&&l.jsx("div",{className:"flex items-center space-x-2",children:l.jsx("button",{onClick:()=>R("delete"),className:"px-3 py-1 text-sm bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:"Delete Selected"})}),l.jsx("button",{onClick:()=>{o("all"),f(""),b("newest"),i(new Set)},className:"px-3 py-1 text-sm text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-md transition-colors",children:"Clear"}),l.jsx("button",{onClick:re,disabled:p||z.length===0,className:`px-3 py-1 text-sm rounded-md transition-colors flex items-center space-x-1 ${p||z.length===0?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"}`,title:s.size>0?`Export ${s.size} selected images to Excel`:`Export ${z.length} images to Excel`,"aria-label":s.size>0?`Export ${s.size} selected images to Excel`:`Export ${z.length} images to Excel`,children:p?l.jsxs(l.Fragment,{children:[l.jsxs("svg",{className:"animate-spin -ml-1 mr-1 h-3 w-3 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),l.jsx("span",{children:"Exporting..."})]}):l.jsxs(l.Fragment,{children:[l.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),l.jsx("span",{children:"Export Excel"})]})})]})]}),g&&l.jsx("div",{className:"mx-6 mb-4 p-3 bg-red-50 border border-red-200 rounded-md",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("svg",{className:"w-4 h-4 text-red-600 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),l.jsx("span",{className:"text-sm text-red-800",children:g}),l.jsx("button",{onClick:()=>N(null),className:"ml-auto text-red-600 hover:text-red-800","aria-label":"Dismiss error",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),l.jsx("div",{className:"flex-1 overflow-y-auto min-h-0",children:z.length===0?l.jsx("div",{className:"text-center py-8 text-gray-500",children:"No images found matching the current filters."}):l.jsx(l.Fragment,{children:l.jsx("div",{className:h==="grid"?"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-4":"space-y-2",children:z.map(C=>{var K,O;return l.jsxs("div",{className:`relative bg-white border rounded-lg overflow-hidden transition-colors ${s.has(C.id)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,children:[l.jsx("div",{className:"absolute top-2 left-2 z-10",children:l.jsx("input",{type:"checkbox",checked:s.has(C.id),onChange:()=>j(C.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500","aria-label":`Select ${C.generationPrompt}`})}),l.jsxs("div",{className:"relative aspect-square",children:[C.finalImagePath?l.jsx("img",{src:`local-file://${C.finalImagePath}`,alt:C.generationPrompt,className:"w-full h-full object-cover cursor-pointer",onClick:()=>w(C.id),onError:ne=>{ne.currentTarget.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik01MCA1MEgxNTBWNzVINzVWMTI1SDUwVjUwWiIgZmlsbD0iI0QxRDVEM0EiLz4KPHN2ZyB4PSI3NSIgeT0iODAiIHdpZHRoPSI1MCIgaGVpZ2h0PSI0NSIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiB4bWxucz0iI0QxRDVEM0EiLz4KPHN2ZyB4PSI3NSIgeT0iODAiIHdpZHRoPSI1MCIgaGVpZ2h0PSI0NSIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiB4bWxucz0iaHR0Oi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxwYXRoIGQ9Ik0xOSAzSDVDMy45IDMgMyAzLjkgMyA1VjE5QzMgMjAuMSAzLjkgMjEgNSAyMUgxOUMyMC4xIDIxIDIxIDIwLjEgMjEgMTlWNUMxMSAzLjkgMjAuMSAzIDE5IDNaTTE5IDE5SDVWNUgxOVYxOVoiIGZpbGw9IiM5QjlCQTAiLz4KPHBhdGggZD0iTTE0IDEzSDEwVjE3SDE0VjEzWiIgZmlsbD0iI0QxRDVEM0EiLz4KPC9zdmc+Cjwvc3ZnPgo="}}):l.jsx("div",{className:"w-full h-full bg-gray-100 flex items-center justify-center",children:l.jsx("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),l.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 hover:bg-opacity-50 transition-all duration-200 flex items-center justify-center opacity-0 hover:opacity-100",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("button",{onClick:ne=>{ne.stopPropagation(),w(C.id)},className:"p-2 bg-blue-600 text-white rounded-full hover:bg-blue-700",title:"View full size","aria-label":"View full size",children:l.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),l.jsx("button",{onClick:ne=>{ne.stopPropagation(),H(C.id,"approved")},className:"p-2 bg-green-600 text-white rounded-full hover:bg-green-700",title:"Approve","aria-label":"Approve",children:l.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),l.jsx("button",{onClick:ne=>{ne.stopPropagation(),H(C.id,"rejected")},className:"p-2 bg-red-600 text-white rounded-full hover:bg-red-700",title:"Reject","aria-label":"Reject",children:l.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),l.jsx("button",{onClick:ne=>{ne.stopPropagation(),t("delete",C.id)},className:"p-2 bg-gray-600 text-white rounded-full hover:bg-gray-700",title:"Delete","aria-label":"Delete",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]}),l.jsxs("div",{className:"p-3 space-y-2",children:[(K=C.metadata)!=null&&K.title?l.jsxs("div",{children:[l.jsx("h4",{className:"text-sm font-medium text-gray-900 truncate",title:C.metadata.title,children:C.metadata.title}),l.jsx("div",{className:"text-xs text-gray-500 truncate mt-1",title:C.generationPrompt,children:C.generationPrompt})]}):l.jsx("div",{className:"text-xs text-gray-600 truncate",title:C.generationPrompt,children:C.generationPrompt}),C.processingSettings&&l.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[C.processingSettings.imageEnhancement&&l.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",title:"Image Enhancement Applied",children:"✨ Enhanced"}),C.processingSettings.removeBg&&l.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-purple-100 text-purple-800",title:"Background Removed",children:"🖼️ No BG"}),C.processingSettings.convertToJpg&&l.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800",title:"Converted to JPG",children:"📄 JPG"}),C.processingSettings.sharpening&&C.processingSettings.sharpening>0&&l.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-yellow-100 text-yellow-800",title:`Sharpening: ${C.processingSettings.sharpening}`,children:"🔍 Sharp"})]}),((O=C.metadata)==null?void 0:O.tags)&&Array.isArray(C.metadata.tags)&&C.metadata.tags.length>0&&l.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[C.metadata.tags.slice(0,3).map((ne,ye)=>l.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-700",title:ne,children:ne.length>8?`${ne.slice(0,8)}...`:ne},ye)),C.metadata.tags.length>3&&l.jsxs("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-500",children:["+",C.metadata.tags.length-3]})]}),l.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 mt-2",children:[l.jsx("div",{className:"flex items-center space-x-2",children:C.seed&&l.jsxs("span",{className:"font-mono",title:`Seed: ${C.seed}`,children:["🎲 ",C.seed]})}),l.jsx("div",{title:se(C.createdAt),children:new Date(C.createdAt).toLocaleDateString()})]})]})]},C.id)})})})}),l.jsx(yj,{image:m&&e.find(C=>C.id===m)||null,isOpen:!!m,onClose:()=>w(null),onNext:()=>le("next"),onPrevious:()=>le("previous"),...G()})]})},Nj=({onForceStop:e,isLoading:t})=>{const[r,a]=L.useState(!1);Vr.useEffect(()=>{if(!r)return;const s=i=>{i.key==="Escape"&&a(!1)};return document.addEventListener("keydown",s),()=>document.removeEventListener("keydown",s)},[r]);const n=()=>{a(!1),e()};return l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:()=>a(!0),disabled:t,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors bg-red-600 hover:bg-red-700 focus:ring-red-500 text-white disabled:opacity-50 disabled:cursor-not-allowed",title:"Force stop all processes",children:t?l.jsxs(l.Fragment,{children:[l.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Stopping..."]}):l.jsxs(l.Fragment,{children:[l.jsx("svg",{className:"-ml-1 mr-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),"Force Stop"]})}),r&&l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-75",onClick:()=>a(!1),children:l.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",onClick:s=>s.stopPropagation(),children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("svg",{className:"h-6 w-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),l.jsx("div",{className:"ml-3",children:l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Force Stop All Processes"})})]}),l.jsx("button",{onClick:()=>a(!1),className:"text-gray-400 hover:text-gray-600",children:l.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),l.jsx("div",{className:"p-6",children:l.jsxs("div",{className:"flex items-start",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("svg",{className:"h-6 w-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Emergency Stop"}),l.jsxs("div",{className:"mt-2 text-sm text-gray-500",children:[l.jsx("p",{children:"This will immediately terminate all running processes, including:"}),l.jsxs("ul",{className:"mt-2 list-disc list-inside space-y-1",children:[l.jsx("li",{children:"Image generation processes"}),l.jsx("li",{children:"Quality check operations"}),l.jsx("li",{children:"Background tasks"}),l.jsx("li",{children:"Any other running jobs"})]}),l.jsx("p",{className:"mt-2 font-medium text-red-600",children:"This action cannot be undone and may result in data loss."})]})]})]})}),l.jsxs("div",{className:"flex items-center justify-end space-x-3 px-6 py-4 bg-gray-50 rounded-b-lg",children:[l.jsx("button",{onClick:()=>a(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Cancel"}),l.jsx("button",{onClick:n,disabled:t,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 border border-transparent rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed",children:t?l.jsxs("div",{className:"flex items-center",children:[l.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Stopping..."]}):"Force Stop All"})]})]})})]})},cd=({isOpen:e,onClose:t,onExport:r,title:a,description:n})=>{const[s,i]=L.useState(!1),[c,o]=L.useState(null),u=L.useCallback(async()=>{i(!0),o(null);try{o({success:!0,message:"Starting export...",isProgress:!0});const d=await r();await new Promise(x=>setTimeout(x,500)),o(d),d.success&&setTimeout(()=>{h()},5e3)}catch(d){o({success:!1,error:d instanceof Error?d.message:"Unknown error occurred"})}finally{i(!1)}},[r,t]),f=L.useCallback(async()=>{try{await window.electronAPI.openExportsFolder()}catch(d){console.error("Failed to open exports folder:",d)}},[]),h=L.useCallback(()=>{i(!1),o(null),t()},[t]);return e?l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:a}),l.jsx("button",{onClick:h,className:"text-gray-400 hover:text-gray-600 transition-colors",disabled:s,children:l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),n&&l.jsx("p",{className:"text-gray-600 mb-4",children:n}),!c&&!s&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("p",{className:"text-gray-700",children:"Ready to export. Click Export to continue."}),l.jsxs("div",{className:"flex space-x-3",children:[l.jsx("button",{onClick:u,className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Export"}),l.jsx("button",{onClick:h,className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancel"})]})]}),s&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),l.jsx("span",{className:"text-gray-700",children:"Exporting..."})]}),l.jsx("p",{className:"text-sm text-gray-500",children:"Creating Excel file with job details and settings..."}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:l.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-500 ease-out",style:{width:"100%"}})}),(c==null?void 0:c.isProgress)&&l.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:l.jsx("p",{className:"text-sm text-blue-800",children:c.message})})]}),c&&l.jsx("div",{className:"space-y-4",children:c.success?l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 mb-4",children:l.jsx("svg",{className:"h-6 w-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),l.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Export Successful!"}),c.message&&l.jsx("p",{className:"text-gray-600 mb-2",children:c.message}),c.filename&&l.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["File: ",c.filename]}),l.jsxs("div",{className:"flex space-x-3",children:[l.jsx("button",{onClick:f,className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Open Exports Folder"}),l.jsx("button",{onClick:h,className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition-colors",children:"Close"})]})]}):l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4",children:l.jsx("svg",{className:"h-6 w-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),l.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Export Failed"}),l.jsx("p",{className:"text-red-600 mb-4",children:c.error}),l.jsxs("div",{className:"flex space-x-3",children:[l.jsx("button",{onClick:u,className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Try Again"}),l.jsx("button",{onClick:h,className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition-colors",children:"Close"})]})]})})]})}):null};const Sj=({onOpenFailedImagesReview:e,onOpenSettings:t,onOpenJobs:r})=>{const[a,n]=Vr.useState(!1),[s,i]=Vr.useState({top:0,left:0}),c=Vr.useRef(null),o=320;return l.jsxs("div",{className:"relative",children:[l.jsx("button",{"aria-label":"Open menu",title:"Menu",ref:c,onClick:()=>{var f;const u=(f=c.current)==null?void 0:f.getBoundingClientRect();if(u){const h=u.bottom+8,d=u.right-o,x=window.innerWidth-o-8,b=Math.max(8,Math.min(d,x));i({top:h,left:b})}n(h=>!h)},className:"p-2 rounded-md hover:bg-gray-100 text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),a&&l.jsx("div",{className:"fixed min-w-[20rem] bg-white border border-gray-200 rounded-lg shadow-xl z-50 overflow-hidden",style:{top:`${s.top}px`,left:`${s.left}px`,width:`${o}px`},children:l.jsxs("div",{className:"py-1",children:[l.jsx("div",{className:"px-4 py-2 text-xs font-semibold text-gray-500 uppercase tracking-wide text-center",children:"Navigate"}),l.jsxs("button",{onClick:()=>{n(!1),e&&e()},className:"w-full py-2 text-sm text-gray-700 hover:bg-gray-50 grid place-items-center grid-flow-col auto-cols-max gap-2",children:[l.jsxs("svg",{className:"w-4 h-4 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),l.jsx("span",{children:"Failed Images Review"})]}),l.jsxs("button",{onClick:()=>{n(!1),t&&t()},className:"w-full py-2 text-sm text-gray-700 hover:bg-gray-50 grid place-items-center grid-flow-col auto-cols-max gap-2",children:[l.jsx("svg",{className:"w-4 h-4 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})}),l.jsx("span",{children:"Settings"})]}),l.jsxs("button",{onClick:()=>{n(!1),r&&r()},className:"w-full py-2 text-sm text-gray-700 hover:bg-gray-50 grid place-items-center grid-flow-col auto-cols-max gap-2",children:[l.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-6h13M9 7h13M5 7h.01M5 17h.01M5 12h.01"})}),l.jsx("span",{children:"Job Management"})]})]})}),a&&l.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>n(!1)})]})},Ej=({onBack:e,onOpenFailedImagesReview:t,onOpenSettings:r,onOpenJobs:a,onOpenSingleJobView:n})=>{const[s,i]=L.useState({state:"idle",progress:0,currentStep:0,totalSteps:0}),[c,o]=L.useState([]),[u,f]=L.useState([]),[h,d]=L.useState([]),[x,b]=L.useState({totalJobs:0,completedJobs:0,failedJobs:0,averageExecutionTime:0,totalImagesGenerated:0,successRate:0}),[m,w]=L.useState(null),[p,v]=L.useState(!1),[g,N]=L.useState(!1),[I,z]=L.useState(null),[j,B]=L.useState(null),[R,H]=L.useState("overview");L.useEffect(()=>{const k=async()=>{try{const ee=await window.electronAPI.jobManagement.getJobStatus();i(ee)}catch(ee){console.error("Failed to get job status:",ee)}},U=setInterval(k,500);return k(),()=>clearInterval(U)},[]);const q=async()=>{try{const k=await window.electronAPI.jobManagement.getConfiguration();k!=null&&k.success&&B(k.settings)}catch(k){console.error("Failed to load job configuration:",k)}};L.useEffect(()=>{se(),le(),G(),C(),q()},[]);const re=Vr.useRef(null);L.useEffect(()=>{s.state==="completed"&&(re.current=Date.now()),s.state==="running"&&(re.current=null),C()},[s.state]),L.useEffect(()=>{const k=setInterval(()=>{const U=re.current!==null&&Date.now()-re.current<6e4;s.state==="running"||U?C():d([])},2e3);return()=>clearInterval(k)},[s.state]),L.useEffect(()=>{s.state==="completed"&&(console.log("🔄 Job completed, refreshing data..."),se(),le(),setTimeout(()=>{console.log("🔄 Delayed refresh of generated images to ensure metadata is complete..."),G()},500))},[s.state]);const se=async()=>{try{v(!0),w(null);const k=await window.electronAPI.jobManagement.getJobHistory();console.log("Job history loaded:",k),k&&Array.isArray(k)?o(k):(console.warn("getJobHistory returned non-array:",k),o([]))}catch(k){console.error("Failed to load job history:",k),w("Failed to load job history"),o([])}finally{v(!1)}},le=async()=>{try{const k=await window.electronAPI.jobManagement.getJobStatistics();console.log("Statistics loaded:",k),b(k)}catch(k){console.error("Failed to load statistics:",k)}},G=async()=>{try{const k=await window.electronAPI.jobManagement.getAllGeneratedImages();if(console.log("Generated images loaded:",k),k&&Array.isArray(k)){const U=k.filter(ee=>ee.qcStatus==="approved");f(U),console.log("🔍 Showing approved images:",U.length,"out of",k.length,"total")}else console.warn("getAllGeneratedImages returned non-array:",k),f([])}catch(k){console.error("Failed to load generated images:",k),f([])}},C=async()=>{var k,U,ee,ue;try{const ie=re.current!==null&&Date.now()-re.current<6e4;if(!(s.state==="running"||ie)){d([]);return}let be="standard";try{const W=await((U=(k=window.electronAPI).getSettings)==null?void 0:U.call(k));(ue=(ee=W==null?void 0:W.settings)==null?void 0:ee.advanced)!=null&&ue.debugMode&&(be="debug")}catch{}const we=await window.electronAPI.jobManagement.getJobLogs(be);console.log("Logs loaded:",we),we&&Array.isArray(we)?d(we):console.warn("getJobLogs returned non-array:",we)}catch(ie){console.error("Failed to load logs:",ie),d([])}},K=async()=>{try{console.log("🚀 handleStartJob called - starting job execution..."),v(!0),w(null),console.log("📋 Getting current configuration...");const k=await window.electronAPI.jobManagement.getConfiguration();if(console.log("✅ Configuration response loaded:",k),!k.success||!k.settings)throw new Error("Failed to load configuration or invalid response structure");const U=k.settings;console.log("✅ Configuration extracted:",U),console.log("🎯 Starting the job with config...");const ee=await window.electronAPI.jobManagement.jobStart(U);console.log("✅ Job start result:",ee),console.log("🔄 Reloading data..."),await Promise.all([se(),le()]),console.log("✅ Data reloaded successfully")}catch(k){console.error("❌ Failed to start job:",k),w("Failed to start job")}finally{console.log("🏁 handleStartJob completed, setting loading to false"),v(!1)}},O=async()=>{try{v(!0),w(null),await window.electronAPI.jobManagement.jobStop(),await Promise.all([se(),le()])}catch(k){w("Failed to stop job"),console.error("Failed to stop job:",k)}finally{v(!1)}},ne=async()=>{try{v(!0),w(null),await window.electronAPI.jobManagement.jobForceStop(),await Promise.all([se(),le()])}catch(k){w("Failed to force stop job"),console.error("Failed to force stop job:",k)}finally{v(!1)}},ye=async(k,U)=>{try{switch(w(null),k){case"view":n&&n(U);break;case"export":z(U),N(!0);break;case"delete":await window.electronAPI.jobManagement.deleteJobExecution(U),await se(),await le();break;case"rerun":console.log("🚨 DEBUG RERUN: DashboardPanel rerun case triggered for jobId:",U),console.log("🚨 DEBUG RERUN: Timestamp:",new Date().toISOString()),console.log("🚨 DEBUG RERUN: Stack trace:",new Error().stack);try{console.log("🚨 DEBUG RERUN: About to call rerunJobExecution...");const ee=await window.electronAPI.jobManagement.rerunJobExecution(U);console.log("🚨 DEBUG RERUN: rerunJobExecution result:",ee),ee&&ee.success?(console.log("🚨 DEBUG RERUN: Rerun successful, waiting for job registration..."),setTimeout(async()=>{console.log("🔄 Refreshing UI after rerun..."),await se(),await le()},1e3)):(console.error("🚨 DEBUG RERUN: Rerun failed:",ee),w(`Failed to rerun job: ${(ee==null?void 0:ee.error)||"Unknown error"}`))}catch(ee){console.error("🚨 DEBUG RERUN: Exception during rerun:",ee),w(`Failed to rerun job: ${ee.message}`)}break}}catch(ee){w(`Failed to ${k} job`),console.error(`Failed to ${k} job:`,ee)}},Te=async(k,U,ee)=>{try{switch(w(null),k){case"delete":await window.electronAPI.jobManagement.deleteGeneratedImage(U),await G();break;case"view":break;case"update-qc-status":ee&&(await window.electronAPI.jobManagement.updateQCStatus(U,ee),await G());break}}catch(ue){w(`Failed to ${k} image`),console.error(`Failed to ${k} image:`,ue)}},M=async(k,U)=>{try{if(w(null),U.length===0)return;switch(k){case"delete":await window.electronAPI.jobManagement.bulkDeleteImages(U);break}await G()}catch(ee){w(`Failed to bulk ${k} images`),console.error(`Failed to bulk ${k} images:`,ee)}},P=k=>{var ie,be,we;if(!k)return[];const U=[{name:"Initialization",icon:"⚙️",description:"Setup & Parameters",required:!0,completed:!0,weight:20}],ee=[];return ee.push("AI Generation"),(ie=k.ai)!=null&&ie.runMetadataGen&&ee.push("Metadata"),(be=k.ai)!=null&&be.runQualityCheck&&ee.push("QC"),(we=k.processing)!=null&&we.removeBg&&ee.push("Background Removal"),k.processing&&(k.processing.imageEnhancement||k.processing.imageConvert||k.processing.sharpening>0||k.processing.saturation!==1||k.processing.convertToJpg||k.processing.trimTransparentBackground)&&ee.push("Processing"),ee.length>0&&U.push({name:"Image Generation",icon:"🎨",description:ee.join(" + "),required:!0,completed:!1,current:!0,weight:80}),U},F=k=>{var U;return((U=k==null?void 0:k.parameters)==null?void 0:U.count)>1},D=(k,U)=>{var _e;if(!k)return{overallGenerationProgress:0,current:0,currentGeneration:1,totalGenerations:1,generatedImages:0,totalImages:4};const ee=((_e=k.parameters)==null?void 0:_e.count)||1,ue=(U==null?void 0:U.progress)||0,ie=(U==null?void 0:U.currentStep)||1;let be=0;ie===1?be=Math.min(ue*100,20):ie===2&&(be=20+Math.min((ue-.2)*100,80));let we=0,W=1;ee>1?(we=Math.round(be/ee),W=1):(we=0,W=1);const Q=Math.floor(be/100*4);return{overallGenerationProgress:Math.round(we),current:Math.round(be),currentGeneration:W,totalGenerations:ee,generatedImages:Q,totalImages:4}};return l.jsxs("div",{className:"dashboard-panel min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white border-b border-gray-200 h-14 flex items-center px-6",children:l.jsxs("div",{className:"flex items-center justify-between w-full",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[e&&l.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700 transition-colors","aria-label":"Close dashboard",title:"Close",children:l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),l.jsx(Sj,{onOpenFailedImagesReview:t,onOpenSettings:r,onOpenJobs:a}),l.jsx(Tb,{jobStatus:s.state,onStartJob:K,onStopJob:O,onRefresh:()=>{se(),le(),G()},isLoading:p}),l.jsx(Nj,{onForceStop:ne,isLoading:p})]}),l.jsxs("div",{className:"flex items-center space-x-6",children:[l.jsxs("div",{className:"text-sm whitespace-nowrap",children:[l.jsx("span",{className:"text-gray-600",children:"Total Jobs:"}),l.jsx("span",{className:"ml-1 font-semibold text-blue-600",children:x.totalJobs})]}),l.jsxs("div",{className:"text-sm whitespace-nowrap",children:[l.jsx("span",{className:"text-gray-600",children:"Success Rate:"}),l.jsxs("span",{className:"ml-1 font-semibold text-green-600",children:[x.successRate,"%"]})]}),l.jsxs("div",{className:"text-sm whitespace-nowrap",children:[l.jsx("span",{className:"text-gray-600",children:"Images Generated:"}),l.jsx("span",{className:"ml-1 font-semibold text-purple-600",children:x.totalImagesGenerated})]}),l.jsxs("div",{className:"text-sm whitespace-nowrap",children:[l.jsx("span",{className:"text-gray-600",children:"Avg Duration:"}),l.jsxs("span",{className:"ml-1 font-semibold text-orange-600",children:[x.averageExecutionTime,"s"]})]})]})]})}),l.jsxs("div",{className:"tab-navigation",children:[l.jsx("button",{className:`tab-button ${R==="overview"?"active":""}`,onClick:()=>H("overview"),children:"Overview"}),l.jsx("button",{className:`tab-button ${R==="image-gallery"?"active":""}`,onClick:()=>H("image-gallery"),children:"Image Gallery"})]}),l.jsxs("div",{className:"tab-content-container",children:[R==="overview"&&l.jsxs("div",{className:"unified-panel-container",children:[l.jsxs("div",{className:"dashboard-panel job-progress",children:[l.jsx("div",{className:"panel-header",children:l.jsxs("div",{className:"section-header-with-icon",children:[l.jsx("svg",{className:"section-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M14.828 14.828a4 4 0 01-5.656 0M9 10h1m4 0h1m-6 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Job Progress"]})}),l.jsxs("div",{className:"panel-content",children:[F(j)&&l.jsxs("div",{className:"mb-6",children:[l.jsxs("h4",{className:"text-sm font-medium mb-3 text-gray-700",children:["Overall Progress (",j.parameters.count," generations)"]}),l.jsx("div",{className:"progress-container",children:l.jsx("div",{className:"progress-fill",style:{width:`${D(j,s).overallGenerationProgress}%`}})}),l.jsxs("p",{className:"text-sm text-gray-600",children:["Generation ",D(j,s).currentGeneration," of ",j.parameters.count," (",D(j,s).overallGenerationProgress,"% complete)"]})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("h4",{className:"text-sm font-medium mb-3 text-gray-700",children:F(j)?"Current Generation Progress":"Single Generation Progress"}),l.jsx("div",{className:"progress-container",children:l.jsx("div",{className:"progress-fill",style:{width:`${D(j,s).current}%`}})}),l.jsxs("p",{className:"text-sm text-gray-600",children:["Images ",D(j,s).generatedImages," of 4 (",D(j,s).current,"% complete)"]})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-sm font-medium mb-3 text-gray-700",children:"Progress Steps"}),l.jsx("div",{className:"progress-steps",children:P(j).map((k,U)=>{const ee=D(j,s).current;let ue="pending";return k.name==="Initialization"?ee<=20?ue="active":ue="completed":k.name==="Image Generation"&&(ee>20?ue="active":ue="pending"),l.jsxs(Vr.Fragment,{children:[l.jsxs("div",{className:"progress-step",children:[l.jsx("div",{className:`step-icon ${ue}`,children:ue==="completed"?l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}):ue==="active"?l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})}):l.jsxs("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}),l.jsxs("div",{className:"step-info",children:[l.jsx("div",{className:"step-name",children:k.name}),l.jsx("div",{className:"step-subtitle",children:k.description})]})]}),U<P(j).length-1&&l.jsx("div",{className:"progress-connector"})]},k.name)})})]})]})]}),l.jsxs("div",{className:"dashboard-panel",children:[l.jsx("div",{className:"panel-header",children:l.jsxs("div",{className:"section-header-with-icon",children:[l.jsx("svg",{className:"section-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Job History"]})}),l.jsxs("div",{className:"panel-content",style:{padding:0},children:[l.jsx("div",{style:{padding:"20px 24px",borderBottom:"1px solid #e5e7eb",background:"white"},children:l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Status:"}),l.jsxs("select",{className:"control-select",children:[l.jsx("option",{children:"All Statuses"}),l.jsx("option",{children:"Completed"}),l.jsx("option",{children:"Failed"}),l.jsx("option",{children:"Running"}),l.jsx("option",{children:"Pending"})]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Sort:"}),l.jsxs("select",{className:"control-select",children:[l.jsx("option",{children:"Newest First"}),l.jsx("option",{children:"Oldest First"}),l.jsx("option",{children:"By Name"})]})]})]})}),l.jsx("div",{className:"job-history-content",children:l.jsx(jb,{jobs:c,onJobAction:ye,onDeleteJob:k=>ye("delete",k),isLoading:p})})]})]}),l.jsxs("div",{className:"dashboard-panel",children:[l.jsx("div",{className:"panel-header",children:l.jsxs("div",{className:"section-header-with-icon",children:[l.jsx("svg",{className:"section-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Logs Panel"]})}),l.jsx("div",{className:"panel-content",children:l.jsx(_b,{logs:h,jobStatus:s.state,onRefresh:C})})]})]}),R==="image-gallery"&&l.jsxs("div",{className:"flex flex-col h-full min-h-0",children:[l.jsxs("div",{className:"px-6 pt-4 pb-0 flex-shrink-0",children:[l.jsx("div",{className:"flex items-center justify-between mb-4",children:l.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Generated Images"})}),l.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg mb-4",children:[l.jsxs("div",{className:"text-sm font-medium text-gray-700",children:[u.length," Total Images"]}),l.jsx("div",{className:"flex items-center space-x-4",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),l.jsxs("span",{className:"text-sm text-gray-700",children:[u.filter(k=>k.qcStatus==="approved").length," Success Images"]})]})})]}),l.jsxs("div",{className:"flex flex-wrap items-center gap-4 p-4 bg-gray-50 rounded-lg mb-4 flex-shrink-0",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Job:"}),l.jsx("select",{className:"text-sm border border-gray-300 rounded-md px-3 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500",children:l.jsx("option",{value:"all",children:"All Jobs"})})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Search:"}),l.jsx("input",{type:"text",placeholder:"Search images...",className:"text-sm border border-gray-300 rounded-md px-3 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Sort:"}),l.jsxs("select",{className:"text-sm border border-gray-300 rounded-md px-3 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:"newest",children:"Newest First"}),l.jsx("option",{value:"oldest",children:"Oldest First"}),l.jsx("option",{value:"name",children:"By Name"})]})]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),l.jsxs("span",{className:"text-sm text-gray-700",children:["Select All (0/",u.length,")"]})]}),l.jsx("button",{className:"px-3 py-1 text-sm text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-md transition-colors",children:"Clear"}),l.jsxs("button",{className:"px-3 py-1 text-sm rounded-md transition-colors flex items-center space-x-1 bg-green-600 text-white hover:bg-green-700",children:[l.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),l.jsx("span",{children:"Export Excel"})]})]})]})]}),l.jsx("div",{className:"flex-1 overflow-y-auto min-h-0 px-6 pb-6",style:{maxHeight:"400px",overflowY:"scroll"},children:l.jsx(wj,{images:u,onImageAction:Te,onBulkAction:M,isLoading:p,jobStatus:s.state})})]})]}),m&&l.jsx("div",{className:"fixed top-4 right-4 bg-red-50 border border-red-200 rounded-lg p-4 max-w-md",children:l.jsxs("div",{className:"flex",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:l.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),l.jsx("div",{className:"ml-3",children:l.jsx("p",{className:"text-sm text-red-800",children:m})}),l.jsx("div",{className:"ml-auto pl-3",children:l.jsx("button",{onClick:()=>w(null),className:"text-red-400 hover:text-red-600",children:l.jsx("svg",{className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:l.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})})]})}),s.state==="running"&&l.jsx("div",{className:"fixed bottom-4 left-4 bg-blue-50 border border-blue-200 rounded-lg p-4 max-w-md",children:l.jsxs("div",{className:"flex",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:l.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),l.jsx("div",{className:"ml-3",children:l.jsx("p",{className:"text-sm text-blue-800",children:"Only one job can run at a time. Please wait for the current job to complete."})})]})}),l.jsx(cd,{isOpen:g,onClose:()=>{N(!1),z(null)},onExport:async()=>I?await window.electronAPI.jobManagement.exportJobToExcel(I):{success:!1,error:"No job ID specified"},title:"Export Job",description:"Export this job to Excel format with all details and settings."})]})},Tj=({image:e,isSelected:t,onSelect:r,onAction:a})=>{const n=i=>new Date(i).toLocaleDateString(),s=()=>{if(!e.qcStatus)return null;const c={qc_failed:{text:"QC Failed",className:"bg-red-500 text-white",icon:"⚠️"},retry_pending:{text:"Pending Retry",className:"bg-amber-500 text-white",icon:"⏳"},processing:{text:"Processing Retry",className:"bg-blue-500 text-white",icon:"🔄"},approved:{text:"Approved",className:"bg-green-500 text-white",icon:"✅"},failed_retry:{text:"Failed Retry",className:"bg-orange-500 text-white",icon:"❌"}}[e.qcStatus];return c?l.jsxs("div",{className:`absolute top-2 left-2 ${c.className} text-xs px-2 py-1 rounded-full font-medium`,children:[c.icon," ",c.text]}):null};return l.jsxs("div",{"data-testid":`failed-image-card-${e.id}`,className:"relative bg-white border rounded-lg overflow-hidden transition-colors border-gray-200 hover:border-gray-300 hover:bg-gray-50",children:[l.jsx("div",{className:"absolute top-2 right-2 z-10",children:l.jsx("input",{"data-testid":`select-${e.id}`,type:"checkbox",checked:t,onChange:r,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500",onClick:i=>i.stopPropagation()})}),l.jsxs("div",{className:"relative aspect-square",children:[e.finalImagePath?l.jsx("img",{src:`local-file://${e.finalImagePath}`,alt:`Failed image ${e.id}`,className:"w-full h-32 object-cover rounded",onError:i=>{i.currentTarget.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDEyOCAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxMjgiIGhlaWdodD0iMTI4IiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik02NCAzMkM3Ny4yNTQ4IDMyIDg4IDQyLjc0NTIgODggNTZDODggNjkuMjU0OCA3Ny4yNTQ4IDgwIDY0IDgwQzUwLjc0NTIgODAgNDAgNjkuMjU0OCA0MCA1NkM0MCA0Mi43NDUyIDUwLjc0NTIgMzIgNjQgMzJaIiBmaWxsPSIjOUI5QkEwIi8+CjxwYXRoIGQ9Ik0yNCA4OEgxMDRDMTEwLjYyNyA4OCAxMTYgOTMuMzcyNiAxMTYgMTAwVjExMkMxMTYgMTE4LjYyNyAxMTAuNjI3IDEyNCAxMDQgMTI0SDI0QzE3LjM3MjYgMTI0IDEyIDExOC42MjcgMTIgMTEyVjEwMEMxMiA5My4zNzI2IDE3LjM3MjYgODggMjQgODhaIiBmaWxsPSIjOUI5QkEwIi8+Cjwvc3ZnPgo="}}):l.jsx("div",{className:"w-full h-full bg-gray-100 flex items-center justify-center",children:l.jsx("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),s()]}),l.jsxs("div",{className:"p-3",children:[l.jsx("div",{className:"text-xs text-gray-600 truncate mb-2",title:e.generationPrompt,children:e.generationPrompt}),e.qcReason&&l.jsxs("div",{className:"text-xs text-red-600 mb-2 p-2 bg-red-50 rounded border border-red-200",children:[l.jsx("strong",{children:"Failure:"})," ",e.qcReason]}),l.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-3",children:[l.jsx("div",{className:"flex items-center space-x-2",children:e.seed&&l.jsxs("span",{className:"font-mono",title:`Seed: ${e.seed}`,children:["🎲 ",e.seed]})}),l.jsx("div",{title:n(e.createdAt),children:n(e.createdAt)})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsx("button",{onClick:()=>a("approve",e.id),className:"px-2 py-1 text-xs bg-green-600 text-white rounded hover:bg-green-700 transition-colors",title:"Approve image (move to success)",children:"✓ Approve"}),l.jsx("button",{onClick:()=>a("retry",e.id),className:"px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",title:"Add to retry selection bucket",children:"🔄 Add To Retry"}),l.jsx("button",{onClick:()=>a("view",e.id),className:"px-2 py-1 text-xs bg-gray-600 text-white rounded hover:bg-gray-700 transition-colors",title:"View full image details",children:"👁 View"}),l.jsx("button",{onClick:()=>a("delete",e.id),className:"px-2 py-1 text-xs bg-red-600 text-white rounded hover:bg-red-700 transition-colors",title:"Delete image permanently",children:"🗑 Delete"})]})]})]})},_j=({image:e,isOpen:t,onClose:r,onAction:a})=>{if(!t)return null;const n=o=>new Date(o).toLocaleString(),s=o=>{a(o,e.id),r()},i=o=>{o.target===o.currentTarget&&r()},c=o=>{o.key==="Escape"&&r()};return Vr.useEffect(()=>{if(t){const o=document.querySelector('[aria-label="Close modal"]');o&&o.focus()}},[t]),l.jsx("div",{"data-testid":"failed-image-review-modal",className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 overflow-hidden",onKeyDown:c,onClick:i,children:l.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[l.jsxs("div",{"data-testid":"modal-header",className:"flex items-center justify-between p-6 border-b border-gray-200",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Failed Image Review"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Review and manage failed image"})]}),l.jsx("button",{type:"button",onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close modal",children:l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),l.jsxs("div",{"data-testid":"modal-content",className:"flex flex-col lg:flex-row h-full overflow-hidden",children:[l.jsx("div",{className:"lg:w-2/3 p-6 bg-gray-50",children:l.jsxs("div",{"data-testid":"image-container",className:"relative",children:[e.finalImagePath?l.jsx("img",{src:`local-file://${e.finalImagePath}`,alt:"Failed image",className:"w-full h-auto max-h-96 object-contain rounded",onError:o=>{o.currentTarget.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik01MCA1MEgxNTBWNzVINzVWMTI1SDUwVjUwWiIgZmlsbD0iI0QxRDVEM0EiLz4KPHN2ZyB4PSI3NSIgeT0iODAiIHdpZHRoPSI1MCIgaGVpZ2h0PSI0NSIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNMTkgM0g1QzMuOSAzIDMgMy45IDMgNVYxOUMzIDIwLjEgMy45IDIxIDUgMjFIMTlDMjAuMSAyMSAyMSAyMC4xIDIxIDE5VjVDMjEgMy45IDIwLjEgMyAxOSAzWk0xOSAxOUg1VjVIMTlWMTlaIiBmaWxsPSIjOUI5QkEwIi8+CjxwYXRoIGQ9Ik0xNCAxM0gxMFYxN0gxNFYxM1oiIGZpbGw9IiM5QjlCQTAiLz4KPC9zdmc+Cjwvc3ZnPgo="}}):l.jsxs("div",{className:"w-full h-64 bg-gray-100 flex items-center justify-center rounded-lg",children:[l.jsx("svg",{className:"w-16 h-16 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),l.jsx("span",{className:"sr-only",children:"No Image Available"})]}),l.jsx("div",{className:"absolute top-4 left-4 bg-red-500 text-white px-3 py-1 rounded-full text-sm font-medium",children:"⚠️ Failed"})]})}),l.jsxs("div",{className:"lg:w-1/3 p-6 overflow-y-auto",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Failure Analysis"}),e.qcReason?l.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex items-start",children:[l.jsx("svg",{className:"w-5 h-5 text-red-400 mt-0.5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.34 16.5c-.77.833.192 2.5 1.732 2.5z"})}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-sm font-medium text-red-800",children:"Failure Reason"}),l.jsx("p",{className:"text-sm text-red-700 mt-1",children:e.qcReason})]})]})}):l.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex items-start",children:[l.jsx("svg",{className:"w-5 h-5 text-yellow-400 mt-0.5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-sm font-medium text-yellow-800",children:"No Specific Reason"}),l.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:"Image failed quality check but no specific reason provided."})]})]})})]}),l.jsxs("div",{className:"mb-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Generation Details"}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Prompt"}),l.jsx("p",{className:"text-sm text-gray-900 bg-gray-50 p-2 rounded border mt-1",children:e.generationPrompt})]}),e.seed&&l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Seed"}),l.jsx("p",{className:"text-sm text-gray-900 font-mono bg-gray-50 p-2 rounded border mt-1",children:e.seed})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Created"}),l.jsx("p",{className:"text-sm text-gray-900 bg-gray-50 p-2 rounded border mt-1",children:n(e.createdAt)})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Job ID"}),l.jsx("p",{className:"text-sm text-gray-900 bg-gray-50 p-2 rounded border mt-1",children:e.executionId})]})]})]}),e.metadata&&l.jsxs("div",{className:"mb-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"AI Generated Metadata"}),l.jsxs("div",{className:"space-y-3",children:[e.metadata.title&&l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Title"}),l.jsx("p",{className:"text-sm text-gray-900 bg-gray-50 p-2 rounded border mt-1",children:e.metadata.title})]}),e.metadata.description&&l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Description"}),l.jsx("p",{className:"text-sm text-gray-900 bg-gray-50 p-2 rounded border mt-1",children:e.metadata.description})]}),e.metadata.tags&&e.metadata.tags.length>0&&l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Tags"}),l.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:e.metadata.tags.map((o,u)=>l.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:o},u))})]})]})]}),e.processingSettings&&l.jsxs("div",{className:"mb-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Processing Settings"}),l.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[l.jsxs("div",{className:"bg-gray-50 p-2 rounded border",children:[l.jsx("span",{className:"font-medium",children:"Enhancement:"})," ",e.processingSettings.imageEnhancement?"Yes":"No"]}),l.jsxs("div",{className:"bg-gray-50 p-2 rounded border",children:[l.jsx("span",{className:"font-medium",children:"Sharpening:"})," ",e.processingSettings.sharpening||0]}),l.jsxs("div",{className:"bg-gray-50 p-2 rounded border",children:[l.jsx("span",{className:"font-medium",children:"Saturation:"})," ",e.processingSettings.saturation||1]}),l.jsxs("div",{className:"bg-gray-50 p-2 rounded border",children:[l.jsx("span",{className:"font-medium",children:"Remove BG:"})," ",e.processingSettings.removeBg?"Yes":"No"]})]})]}),l.jsxs("div",{"data-testid":"modal-footer",className:"flex justify-between items-center gap-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Actions"}),l.jsxs("div",{className:"flex flex-col gap-2",children:[l.jsx("button",{onClick:()=>s("approve"),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium",title:"Approve image (move to success)",children:"✓ Approve Image"}),l.jsx("button",{onClick:()=>s("retry"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",title:"Add image to retry pool",children:"🔄 Add to Retry Pool"}),l.jsx("button",{onClick:()=>s("delete"),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium",title:"Delete image permanently",children:"🗑 Delete Image"})]})]})]})]})]})})},jj=({isOpen:e,onClose:t,onRetry:r,selectedCount:a})=>{const[n,s]=L.useState(!0),[i,c]=L.useState(!1),[o,u]=L.useState({imageEnhancement:!1,sharpening:5,saturation:1,imageConvert:!0,convertToJpg:!0,jpgQuality:85,pngQuality:9,removeBg:!1,removeBgSize:"auto",trimTransparentBackground:!1,jpgBackground:"#FFFFFF"});if(!e)return null;const f=()=>{console.log("🔍 ProcessingSettingsModal: handleRetry called"),console.log("🔍 ProcessingSettingsModal: useOriginalSettings:",n),console.log("🔍 ProcessingSettingsModal: includeMetadata:",i),console.log("🔍 ProcessingSettingsModal: batchSettings keys:",Object.keys(o)),n?(console.log("🔍 ProcessingSettingsModal: Retrying with original settings"),r(!0,void 0,i)):(console.log("🔍 ProcessingSettingsModal: Retrying with modified settings keys:",Object.keys(o)),r(!1,o,i))},h=(N,I)=>{u(z=>({...z,[N]:I}))},d=o.imageEnhancement,x=o.imageEnhancement,b=o.imageConvert,m=o.imageConvert,w=o.imageConvert&&o.convertToJpg,p=o.imageConvert&&!o.convertToJpg,v=o.removeBg,g=o.removeBg&&o.imageConvert&&o.convertToJpg;return l.jsx("div",{"data-testid":"processing-settings-modal",className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[l.jsxs("div",{"data-testid":"modal-header",className:"flex items-center justify-between p-6 border-b border-gray-200",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Retry Processing Settings"}),l.jsxs("p",{className:"text-sm text-gray-600",children:["Configure how to process ",a," selected images for retry"]})]}),l.jsx("button",{type:"button",onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close modal",children:l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),l.jsxs("div",{"data-testid":"modal-content",className:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]",children:[l.jsx("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:l.jsxs("div",{className:"flex items-start",children:[l.jsx("svg",{className:"w-5 h-5 text-blue-400 mt-0.5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-sm font-medium text-blue-800",children:"Batch Processing"}),l.jsxs("p",{className:"text-sm text-blue-700 mt-1",children:["All ",a," selected images will be processed together with the same settings. This ensures consistent results across the entire batch."]})]})]})}),l.jsxs("div",{className:"mb-8",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Batch Processing Method"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[l.jsx("input",{type:"radio",name:"processingMethod",value:"original","aria-label":"Retry with Original Settings",checked:n,onChange:()=>s(!0),className:"text-blue-600 focus:ring-blue-500"}),l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Retry with Original Settings"}),l.jsx("div",{className:"text-xs text-gray-500",children:"Process all images with their original job settings (QC, metadata, processing)"})]})]}),l.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[l.jsx("input",{type:"radio",name:"processingMethod",value:"modified","aria-label":"Retry with Modified Settings",checked:!n,onChange:()=>s(!1),className:"text-blue-600 focus:ring-blue-500"}),l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Retry with Modified Settings"}),l.jsx("div",{className:"text-xs text-gray-500",children:"Process all images with new settings (QC, metadata, processing) - no image regeneration"})]})]})]})]}),l.jsxs("div",{className:"mb-8",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Metadata Options"}),l.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:l.jsxs("div",{className:"flex items-start",children:[l.jsx("svg",{className:"w-5 h-5 text-blue-400 mt-0.5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h4",{className:"text-sm font-medium text-blue-800",children:"Metadata Regeneration"}),l.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Choose whether to regenerate metadata for the selected images during retry processing."}),l.jsxs("div",{className:"mt-3",children:[l.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[l.jsx("input",{type:"checkbox","aria-label":"Also regenerate metadata",checked:i,onChange:N=>c(N.target.checked),className:"text-blue-600 focus:ring-blue-500"}),l.jsx("span",{className:"text-sm text-blue-800 font-medium",children:"Also regenerate metadata (titles, descriptions, tags)"})]}),l.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"This will regenerate AI-generated metadata for all selected images using the current AI model settings."})]})]})]})})]}),!n&&l.jsxs("div",{className:"space-y-8",children:[l.jsx("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:l.jsxs("div",{className:"flex items-start",children:[l.jsx("svg",{className:"w-5 h-5 text-yellow-400 mt-0.5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.34 16.5c-.77.833.192 2.5 1.732 2.5z"})}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-sm font-medium text-yellow-800",children:"Important Note"}),l.jsxs("p",{className:"text-sm text-yellow-700 mt-1",children:["These settings will be applied to all ",a," images in the batch. Images will NOT be regenerated - only QC, metadata, and processing will be updated."]}),l.jsxs("p",{className:"text-sm text-yellow-600 mt-2",children:[l.jsx("strong",{children:"Current defaults:"})," Image conversion enabled, converting to JPG at 85% quality"]})]})]})}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Batch Processing Configuration"}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("h4",{className:"text-md font-medium text-gray-800",children:"Image Enhancement"}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Image Enhancement"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Enable image enhancement effects (sharpening, saturation)"})]}),l.jsx(or,{checked:o.imageEnhancement,onChange:N=>h("imageEnhancement",N)})]}),d&&l.jsxs("div",{children:[l.jsx("label",{htmlFor:"sharpening",className:"block text-sm font-medium text-gray-700 mb-2",children:"Sharpening Level (0-10)"}),l.jsx("input",{id:"sharpening",type:"number",value:o.sharpening,onChange:N=>h("sharpening",parseInt(N.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"0",max:"10"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Sharpening intensity for image enhancement"})]}),x&&l.jsxs("div",{children:[l.jsx("label",{htmlFor:"saturation",className:"block text-sm font-medium text-gray-700 mb-2",children:"Saturation Level (0.0-2.0)"}),l.jsx("input",{id:"saturation",type:"number",value:o.saturation,onChange:N=>h("saturation",parseFloat(N.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"0.0",max:"2.0",step:"0.1"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Saturation adjustment for image enhancement"})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("h4",{className:"text-md font-medium text-gray-800",children:"Image Conversion"}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Image Convert"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Enable image conversion and processing"})]}),l.jsx(or,{checked:o.imageConvert,onChange:N=>h("imageConvert",N)})]}),b&&l.jsxs("div",{children:[l.jsx("label",{htmlFor:"convert-format",className:"block text-sm font-medium text-gray-700 mb-2",children:"Convert Format"}),l.jsxs("select",{id:"convert-format",value:o.convertToJpg?"jpg":"png",onChange:N=>{const I=N.target.value==="jpg";h("convertToJpg",I)},className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"png",children:"PNG"}),l.jsx("option",{value:"jpg",children:"JPG"})]}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Convert images to this format"})]}),m&&l.jsxs("div",{className:"space-y-4",children:[w&&l.jsxs("div",{children:[l.jsx("label",{htmlFor:"jpg-quality",className:"block text-sm font-medium text-gray-700 mb-2",children:"JPG Quality (1-100)"}),l.jsx("input",{id:"jpg-quality",type:"number",value:o.jpgQuality,onChange:N=>h("jpgQuality",parseInt(N.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"1",max:"100"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Quality setting for JPG conversion"})]}),p&&l.jsxs("div",{children:[l.jsx("label",{htmlFor:"png-quality",className:"block text-sm font-medium text-gray-700 mb-2",children:"PNG Quality (0-9)"}),l.jsx("input",{id:"png-quality",type:"number",value:o.pngQuality,onChange:N=>h("pngQuality",parseInt(N.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"0",max:"9"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Compression level for PNG conversion (0=uncompressed, 9=maximum compression)"})]})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("h4",{className:"text-md font-medium text-gray-800",children:"Background Processing"}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Remove Background"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Remove background using Remove.bg API"})]}),l.jsx(or,{checked:o.removeBg,onChange:N=>h("removeBg",N)})]}),o.removeBg&&l.jsxs("div",{children:[l.jsx("label",{htmlFor:"remove-bg-size",className:"block text-sm font-medium text-gray-700 mb-2",children:"Remove BG Size"}),l.jsxs("select",{id:"remove-bg-size",value:o.removeBgSize,onChange:N=>h("removeBgSize",N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"auto",children:"Auto"}),l.jsx("option",{value:"preview",children:"Preview"}),l.jsx("option",{value:"full",children:"Full"})]}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Size setting for background removal"})]}),v&&l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Trim Transparent Background"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Remove transparent areas from images (PNG only)"})]}),l.jsx(or,{checked:o.trimTransparentBackground,onChange:N=>h("trimTransparentBackground",N)})]}),g&&l.jsxs("div",{children:[l.jsx("label",{htmlFor:"jpg-background",className:"block text-sm font-medium text-gray-700 mb-2",children:"JPG Background Color"}),l.jsxs("select",{id:"jpg-background",value:o.jpgBackground,onChange:N=>h("jpgBackground",N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"#FFFFFF",children:"White"}),l.jsx("option",{value:"#000000",children:"Black"}),l.jsx("option",{value:"#F0F0F0",children:"Light Gray"}),l.jsx("option",{value:"#808080",children:"Gray"})]}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Background color for JPG images (required when removing background)"})]})]})]})]}),l.jsxs("div",{"data-testid":"modal-footer",className:"flex justify-end space-x-3 p-6 border-t border-gray-200",children:[l.jsx("button",{onClick:t,className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-md transition-colors",children:"Cancel"}),l.jsxs("button",{onClick:f,className:"px-6 py-2 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors font-medium",children:[n?"Retry with Original Settings":"Retry with Modified Settings"," (",a," images)"]})]})]})})},Aj=({onBack:e})=>{console.log("🔍 FailedImagesReviewPanel: Component mounting...");const[t,r]=L.useState([]),[a,n]=L.useState([]),[s,i]=L.useState([]),[c,o]=L.useState([]),[u,f]=L.useState(new Set),[h,d]=L.useState(null),[x,b]=L.useState(!1),[m,w]=L.useState("qc_failed"),[p,v]=L.useState({imageEnhancement:!1,sharpening:0,saturation:1,imageConvert:!1,convertToJpg:!0,jpgQuality:90,pngQuality:9,removeBg:!1,removeBgSize:"auto",trimTransparentBackground:!1,jpgBackground:"#FFFFFF"}),[g,N]=L.useState(!1),[I,z]=L.useState(null),[j,B]=L.useState("all"),[R,H]=L.useState(""),[q,re]=L.useState("newest"),[se,le]=L.useState({isProcessing:!1,queueLength:0,pendingJobs:0,processingJobs:0,completedJobs:0,failedJobs:0});L.useEffect(()=>{console.log("🔍 FailedImagesReviewPanel: useEffect running..."),C(),G();const U=(W,Q)=>{console.log("🔧 Retry progress event received:",Q),C(),G()},ee=(W,Q)=>{console.log("🔧 Retry completed event received:",Q),C(),G()},ue=(W,Q)=>{console.log("🔧 Retry error event received:",Q),z(`Retry error: ${Q.error}`),C(),G()},ie=(W,Q)=>{console.log("🔧 Retry queue updated event received:",Q),G()},be=(W,Q)=>{console.log("🔧 Retry status updated event received:",Q),C(),G()};window.electronAPI.onRetryProgress(U),window.electronAPI.onRetryCompleted(ee),window.electronAPI.onRetryError(ue),window.electronAPI.onRetryQueueUpdated(ie),window.electronAPI.onRetryStatusUpdated(be);const we=setInterval(()=>{G(),se.isProcessing&&C()},5e3);return()=>{clearInterval(we),window.electronAPI.removeRetryProgress(U),window.electronAPI.removeRetryCompleted(ee),window.electronAPI.removeRetryError(ue),window.electronAPI.removeRetryQueueUpdated(ie),window.electronAPI.removeRetryStatusUpdated(be)}},[]);const G=async()=>{try{const U=await window.electronAPI.getRetryQueueStatus();U.success&&U.queueStatus&&le(U.queueStatus)}catch(U){console.error("Failed to load retry queue status:",U)}},C=async()=>{console.log("🔍 loadAllImageStatuses: Starting...");try{N(!0),z(null);const[U,ee,ue,ie]=await Promise.all([window.electronAPI.generatedImages.getImagesByQCStatus("qc_failed"),window.electronAPI.generatedImages.getImagesByQCStatus("retry_pending"),window.electronAPI.generatedImages.getImagesByQCStatus("processing"),window.electronAPI.generatedImages.getImagesByQCStatus("retry_failed")]),be=we=>we&&typeof we=="object"&&we.success!==void 0?we.images||[]:Array.isArray(we)?we:[];r(be(U)),n(be(ee)),i(be(ue)),o(be(ie))}catch(U){console.error("🔍 loadAllImageStatuses: Error occurred:",U),z("Failed to load images")}finally{N(!1),console.log("🔍 loadAllImageStatuses: Loading complete")}},K=()=>{switch(m){case"qc_failed":return t;case"retry_pending":return a;case"processing":return s;case"retry_failed":return c;case"approved":return[...t,...a,...s,...c];default:return t}},O=U=>{const ee=new Set(u);ee.has(U)?ee.delete(U):ee.add(U),f(ee)},ne=()=>{const U=K();u.size===U.length?f(new Set):f(new Set(U.map(ee=>ee.id)))},ye=async(U,ee,ue)=>{try{switch(z(null),U){case"approve":await window.electronAPI.generatedImages.updateQCStatus(ee,"approved"),await C();break;case"retry":const ie=new Set(u);ie.add(ee),f(ie),console.log("🔍 Image added to retry selection:",ee,"Total selected:",ie.size);break;case"delete":await window.electronAPI.generatedImages.deleteGeneratedImage(ee),await C();break;case"view":const we=[...t,...a,...s,...c].find(W=>W.id===ee);we&&d(we);break}}catch(ie){z(`Failed to ${U} image`),console.error(`Failed to ${U} image:`,ie)}},Te=async(U,ee)=>{if(u.size!==0)try{switch(z(null),U){case"approve":for(const ue of u)await window.electronAPI.generatedImages.updateQCStatus(ue,"approved");break;case"retry":b(!0);return;case"delete":for(const ue of u)await window.electronAPI.generatedImages.deleteGeneratedImage(ue);break}await C(),f(new Set)}catch(ue){z(`Failed to bulk ${U} images`),console.error(`Failed to bulk ${U} images:`,ue)}},M=async(U,ee,ue)=>{if(console.log("🔍 FailedImagesReviewPanel: handleRetryWithSettings called"),console.log("🔍 FailedImagesReviewPanel: useOriginalSettings:",U),console.log("🔍 FailedImagesReviewPanel: modifiedSettings keys:",ee?Object.keys(ee):"undefined"),console.log("🔍 FailedImagesReviewPanel: includeMetadata:",ue),console.log("🔍 FailedImagesReviewPanel: selectedImages count:",u.size),u.size!==0)try{z(null);const ie=Array.from(u);console.log("🔍 FailedImagesReviewPanel: Calling retryFailedImagesBatch with imageIds:",ie);const be=await window.electronAPI.retryFailedImagesBatch(ie,U,U?null:ee||p,ue);console.log("🔍 FailedImagesReviewPanel: retryFailedImagesBatch result:",be),be.success?(console.log("🔍 FailedImagesReviewPanel: Retry successful, refreshing data..."),await C(),await G(),f(new Set),b(!1),console.log("🔍 FailedImagesReviewPanel: Retry processing complete")):(console.error("🔍 FailedImagesReviewPanel: Retry failed:",be.error),z(be.error||"Failed to process retry operations"))}catch(ie){console.error("🔍 FailedImagesReviewPanel: Exception occurred:",ie),z("Failed to process retry operations"),console.error("Failed to process retry operations:",ie)}},P=Vr.useMemo(()=>[...K().filter(ie=>{var be,we;if(j!=="all"&&ie.executionId!==j)return!1;if(R){const W=R.toLowerCase(),Q=ie.generationPrompt.toLowerCase().includes(W),_e=(we=(be=ie.metadata)==null?void 0:be.prompt)==null?void 0:we.toLowerCase().includes(W);if(!Q&&!_e)return!1}return!0})].sort((ie,be)=>{switch(q){case"newest":return new Date(be.createdAt).getTime()-new Date(ie.createdAt).getTime();case"oldest":return new Date(ie.createdAt).getTime()-new Date(be.createdAt).getTime();case"name":return ie.generationPrompt.localeCompare(be.generationPrompt);default:return 0}}),[m,t,a,s,c,j,R,q]),F=Array.from(new Set([...t.map(U=>U.executionId),...a.map(U=>U.executionId),...s.map(U=>U.executionId),...c.map(U=>U.executionId)])),D=U=>{switch(U){case"qc_failed":return t.length;case"retry_pending":return a.length;case"processing":return s.length;case"retry_failed":return c.length;case"approved":return t.length+a.length+s.length+c.length;default:return 0}},k=U=>{switch(U){case"qc_failed":return"text-red-600 bg-red-50 border-red-200";case"retry_pending":return"text-amber-600 bg-amber-50 border-amber-200";case"processing":return"text-blue-600 bg-blue-50 border-blue-200";case"retry_failed":return"text-orange-600 bg-orange-50 border-orange-200";case"approved":return"text-gray-600 bg-gray-50 border-gray-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}};return g?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Loading images..."})]})}):l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700 transition-colors","aria-label":"Back to dashboard",children:l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Failed Images Review"}),l.jsx("p",{className:"text-gray-600",children:"Review and manage images that failed quality assurance checks"})]})]}),l.jsx("div",{className:"flex items-center space-x-4",children:l.jsxs("div",{className:"text-right",children:[l.jsx("div",{className:"text-2xl font-bold text-red-600",children:D("qc_failed")}),l.jsx("div",{className:"text-sm text-gray-500",children:"Failed Images"})]})})]})}),(se.isProcessing||se.queueLength>0)&&l.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:l.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("h3",{className:"text-lg font-semibold text-blue-900",children:"🔄 Retry Queue Status"}),l.jsx("div",{className:"text-sm text-blue-700",children:se.isProcessing?"Currently Processing":"Queued Jobs"})]}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-2xl font-bold text-blue-600",children:se.processingJobs}),l.jsx("div",{className:"text-sm text-blue-700",children:"Processing"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-2xl font-bold text-amber-600",children:se.pendingJobs}),l.jsx("div",{className:"text-sm text-amber-700",children:"Queued"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-2xl font-bold text-green-600",children:se.completedJobs}),l.jsx("div",{className:"text-sm text-green-700",children:"Completed"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-2xl font-bold text-red-600",children:se.failedJobs}),l.jsx("div",{className:"text-sm text-red-700",children:"Failed"})]})]}),se.currentJob&&l.jsxs("div",{className:"bg-white border border-blue-200 rounded-lg p-3",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsxs("span",{className:"text-sm font-medium text-blue-900",children:["Current Job: #",se.currentJob.id]}),l.jsxs("span",{className:"text-xs text-blue-600",children:[se.currentJob.settings," settings + ",se.currentJob.metadata?"metadata":"no metadata"]})]}),l.jsx("div",{className:"space-y-2",children:s.map((U,ee)=>l.jsxs("div",{className:"flex items-center justify-between text-sm",children:[l.jsxs("span",{className:"text-blue-800",children:["🖼️ Image ",U.id,": Processing..."]}),l.jsx("div",{className:"w-24 bg-blue-200 rounded-full h-2",children:l.jsx("div",{className:"bg-blue-600 h-2 rounded-full animate-pulse",style:{width:"75%"}})})]},U.id))})]})]})}),l.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-2",children:l.jsx("div",{className:"flex space-x-1",children:["qc_failed","retry_pending","processing","retry_failed","approved"].map(U=>l.jsxs("button",{onClick:()=>w(U),className:`px-4 py-2 text-sm font-medium rounded-lg border transition-colors ${m===U?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-600 border-gray-300 hover:bg-gray-50"}`,children:[U==="qc_failed"&&"Failed",U==="retry_pending"&&"Retry Pending",U==="processing"&&"Processing",U==="retry_failed"&&"Retry Failed",U==="approved"&&"All",l.jsx("span",{className:`ml-2 px-2 py-0.5 text-xs rounded-full border ${k(U)}`,children:D(U)})]},U))})}),l.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:l.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Job:"}),l.jsxs("select",{value:j,onChange:U=>B(U.target.value),className:"text-sm border border-gray-300 rounded-md px-3 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:"all",children:"All Jobs"}),F.length>0?F.map(U=>l.jsxs("option",{value:U,children:["Job ",String(U).slice(0,8),"..."]},U)):l.jsx("option",{value:"all",disabled:!0,children:"No jobs available"})]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Search:"}),l.jsx("input",{type:"text",placeholder:"Search images...",value:R,onChange:U=>H(U.target.value),className:"text-sm border border-gray-300 rounded-md px-3 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Sort:"}),l.jsxs("select",{value:q,onChange:U=>re(U.target.value),className:"text-sm border border-gray-300 rounded-md px-3 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:"newest",children:"Newest First"}),l.jsx("option",{value:"oldest",children:"Oldest First"}),l.jsx("option",{value:"name",children:"By Name"})]})]})]}),l.jsx("button",{onClick:()=>{B("all"),H(""),re("newest"),f(new Set)},className:"px-3 py-1 text-sm text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-md transition-colors",children:"Clear"})]})}),l.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-3",children:l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("input",{type:"checkbox",checked:u.size===P.length&&P.length>0,onChange:ne,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),l.jsxs("span",{className:"text-sm text-gray-700",children:["Select All (",u.size,"/",P.length,")"]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("button",{onClick:()=>Te("approve"),disabled:u.size===0,className:`px-3 py-1 text-sm rounded-md transition-colors ${u.size===0?"bg-green-200 text-green-400 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"}`,title:u.size===0?"Select images to enable":"Approve selected images",children:"Approve Selected"}),l.jsxs("button",{onClick:()=>Te("retry"),disabled:u.size===0||se.isProcessing,className:`px-3 py-1 text-sm rounded-md transition-colors ${u.size===0||se.isProcessing?"bg-blue-200 text-blue-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,title:u.size===0?"Select images to enable":se.isProcessing?"Retry is currently processing. Please wait for completion.":"Retry selected images (batch)",children:["Retry Selected",se.isProcessing&&l.jsx("span",{className:"ml-1",children:"⏳"})]}),l.jsx("button",{onClick:()=>Te("delete"),disabled:u.size===0,className:`px-3 py-1 text-sm rounded-md transition-colors ${u.size===0?"bg-red-200 text-red-400 cursor-not-allowed":"bg-red-600 text-white hover:bg-red-700"}`,title:u.size===0?"Select images to enable":"Delete selected images",children:"Delete Selected"})]})]})})}),l.jsx("div",{className:"flex-1 p-6",children:P.length===0?l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"text-gray-400 mb-4",children:l.jsx("svg",{className:"mx-auto h-12 w-12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),l.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:["No ",m==="qc_failed"?"Failed":m==="retry_pending"?"Retry Pending":m==="processing"?"Processing":m==="retry_failed"?"Retry Failed":"Images"]}),l.jsx("p",{className:"text-gray-500",children:m==="qc_failed"?"All images have passed quality checks or are pending review.":m==="retry_pending"?"No images are currently queued for retry.":m==="processing"?"No images are currently being processed.":m==="retry_failed"?"No images have failed retry attempts.":"No images match the current criteria."})]}):l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-4",children:P.map(U=>l.jsx(Tj,{image:U,isSelected:u.has(U.id),onSelect:()=>O(U.id),onAction:ye},U.id))})}),(se.completedJobs>0||se.failedJobs>0)&&l.jsx("div",{className:"bg-white border-t border-gray-200 px-6 py-4",children:l.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"📊 Retry History"}),l.jsxs("div",{className:"space-y-2 text-sm text-gray-700",children:[se.completedJobs>0&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-green-600",children:"✅"}),l.jsxs("span",{children:["Completed: ",se.completedJobs," retry jobs"]})]}),se.failedJobs>0&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-red-600",children:"❌"}),l.jsxs("span",{children:["Failed: ",se.failedJobs," retry jobs"]})]})]})]})}),I&&l.jsx("div",{className:"fixed top-4 right-4 bg-red-50 border border-red-200 rounded-lg p-4 max-w-md",children:l.jsxs("div",{className:"flex",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:l.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),l.jsx("div",{className:"ml-3",children:l.jsx("p",{className:"text-sm text-red-800",children:I})}),l.jsx("div",{className:"ml-auto pl-3",children:l.jsx("button",{onClick:()=>z(null),className:"text-red-400 hover:text-red-600",children:l.jsx("svg",{className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:l.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})})]})}),h&&l.jsx(_j,{image:h,isOpen:!!h,onClose:()=>d(null),onAction:ye}),x&&l.jsx(jj,{isOpen:x,onClose:()=>b(!1),onRetry:M,selectedCount:u.size})]})};const Cj=({onOpenSingleJob:e,onBack:t})=>{const[r,a]=L.useState([]),[n,s]=L.useState(new Set),[i,c]=L.useState({status:"all",dateRange:"all",label:"",minImages:0,maxImages:null}),[o,u]=L.useState(""),[f,h]=L.useState("startedAt"),[d,x]=L.useState("desc"),[b,m]=L.useState(1),[w,p]=L.useState(25),[v,g]=L.useState(0),[N,I]=L.useState(!0),[z,j]=L.useState(null),[B,R]=L.useState(!1),[H,q]=L.useState(!1),[re,se]=L.useState("single"),[le,G]=L.useState(null),C=L.useRef(),K=L.useMemo(()=>{if(!r.length)return[];let W=[...r];if(o.trim()){const Q=o.toLowerCase();W=W.filter(_e=>{var Ne;return((Ne=_e.label)==null?void 0:Ne.toLowerCase().includes(Q))||_e.id.toString().includes(Q)||_e.status.toLowerCase().includes(Q)})}if(i.status!=="all"&&(W=W.filter(Q=>Q.status===i.status)),i.dateRange!=="all"){let Q=new Date;switch(i.dateRange){case"today":Q.setHours(0,0,0,0),W=W.filter(_e=>new Date(_e.startedAt||0)>=Q);break;case"week":Q.setDate(Q.getDate()-7),W=W.filter(_e=>new Date(_e.startedAt||0)>=Q);break;case"month":Q.setMonth(Q.getMonth()-1),W=W.filter(_e=>new Date(_e.startedAt||0)>=Q);break}}if(i.label.trim()){const Q=i.label.toLowerCase();W=W.filter(_e=>{var Ne;return(Ne=_e.label)==null?void 0:Ne.toLowerCase().includes(Q)})}return i.minImages>0&&(W=W.filter(Q=>(Q.totalImages||0)>=i.minImages)),i.maxImages!==null&&(W=W.filter(Q=>(Q.totalImages||0)<=i.maxImages)),W},[r,o,i]),O=L.useMemo(()=>K.length?[...K].sort((Q,_e)=>{let Ne=Q[f],me=_e[f];if((f==="startedAt"||f==="completedAt")&&(Ne=new Date(Ne||0).getTime(),me=new Date(me||0).getTime()),typeof Ne=="number"&&typeof me=="number")return d==="asc"?Ne-me:me-Ne;if(typeof Ne=="string"&&typeof me=="string"){const vt=Ne.localeCompare(me);return d==="asc"?vt:-vt}return Ne==null&&me==null?0:Ne==null?d==="asc"?-1:1:me==null?d==="asc"?1:-1:0}):[],[K,f,d]),ne=L.useMemo(()=>{const W=(b-1)*w,Q=W+w;return O.slice(W,Q)},[O,b,w]),ye=L.useMemo(()=>Math.ceil(O.length/w),[O.length,w]),Te=L.useMemo(()=>{const W=r.filter(Ze=>Ze.status==="completed").length,Q=r.filter(Ze=>Ze.status==="failed").length,_e=r.filter(Ze=>Ze.status==="processing").length,Ne=r.filter(Ze=>Ze.status==="pending").length,me=r.reduce((Ze,lr)=>Ze+(lr.totalImages||0),0),vt=r.length>0?me/r.length:0;return{totalJobs:r.length,completedJobs:W,failedJobs:Q,processingJobs:_e,pendingJobs:Ne,totalImages:me,averageImagesPerJob:vt}},[r]);L.useRef(0);const M=L.useCallback(W=>{u(W),m(1),C.current&&clearTimeout(C.current),C.current=setTimeout(()=>{},300)},[]),P=L.useCallback(async()=>{var W;try{I(!0),j(null);const Q=await window.electronAPI.jobManagement.getJobExecutionsWithFilters(i,b,w);if(Q.success)a(Q.jobs||[]),g(Q.totalCount||((W=Q.jobs)==null?void 0:W.length)||0);else throw new Error(Q.error||"Failed to load jobs")}catch(Q){j(Q instanceof Error?Q.message:"Failed to load jobs"),console.error("Error loading jobs:",Q),a([]),g(0)}finally{I(!1)}},[i,b,w]);L.useEffect(()=>{P()},[P]),L.useEffect(()=>{m(1)},[i]);const F=L.useCallback(W=>{c(W)},[]);L.useCallback((W,Q)=>{h(W),x(Q)},[]);const D=L.useCallback(W=>{m(W)},[]),k=L.useCallback(W=>{p(W),m(1)},[]),U=L.useCallback((W,Q)=>{s(_e=>{const Ne=new Set(_e);return Q?Ne.add(W):Ne.delete(W),Ne})},[]),ee=L.useCallback(W=>{s(W?new Set(ne.map(Q=>Q.id)):new Set)},[ne]),ue=L.useCallback(async(W,Q)=>{try{const _e=await window.electronAPI.jobManagement.renameJobExecution(W,Q);if(_e.success)a(Ne=>Ne.map(me=>me.id===W?{...me,label:Q}:me));else throw new Error(_e.error||"Failed to rename job")}catch(_e){console.error("Error renaming job:",_e)}},[]),ie=L.useCallback(async()=>{if(n.size!==0)try{R(!0);const W=Array.from(n),Q=await window.electronAPI.jobManagement.bulkRerunJobExecutions(W);Q.success?(console.log("Bulk rerun started:",Q.message),await P(),s(new Set)):(console.error("Bulk rerun failed:",Q.error),alert(`Bulk rerun failed: ${Q.error}`))}catch(W){console.error("Error rerunning jobs:",W),alert(`Error rerunning jobs: ${W.message}`)}finally{R(!1)}},[n,P]);L.useCallback(async()=>{if(n.size!==0)try{R(!0);const W=Array.from(n),Q=await window.electronAPI.jobManagement.bulkExportJobExecutions(W);Q!=null&&Q.success||console.error("Bulk export failed:",Q==null?void 0:Q.error),s(new Set)}catch(W){console.error("Error exporting jobs:",W)}finally{R(!1)}},[n]);const be=L.useCallback(async()=>{if(n.size!==0)try{R(!0);const W=Array.from(n);for(const Q of W)await window.electronAPI.jobManagement.deleteJobExecution(Q);await P(),s(new Set)}catch(W){console.error("Error deleting jobs:",W)}finally{R(!1)}},[n,P]),we=L.useCallback(W=>{e(W)},[e]);return L.useEffect(()=>{const W=Q=>{Q.ctrlKey&&Q.key==="a"&&(Q.preventDefault(),ee(!0)),Q.key==="Delete"&&n.size>0&&(Q.preventDefault(),be()),Q.key==="Escape"&&s(new Set)};return document.addEventListener("keydown",W),()=>document.removeEventListener("keydown",W)},[n.size,ee,be]),L.useEffect(()=>()=>{C.current&&clearTimeout(C.current)},[]),z?l.jsx("div",{className:"min-h-screen bg-[--background] text-[--foreground] flex flex-col overflow-hidden",children:l.jsx("div",{className:"flex-1 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-red-600 mb-4",children:"⚠️ Error"}),l.jsx("p",{className:"text-gray-600",children:z}),l.jsx("button",{onClick:P,className:"mt-4 bg-[--primary] text-white px-4 py-2 rounded hover:opacity-90",children:"Retry"})]})})}):l.jsxs("div",{className:"min-h-screen bg-[--background] text-[--foreground] flex flex-col overflow-hidden",children:[l.jsx("header",{className:"job-management-header",children:l.jsxs("div",{className:"header-content",children:[l.jsxs("div",{className:"header-left",children:[l.jsx("button",{onClick:t,className:"back-button","aria-label":"Go back to dashboard",children:l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),l.jsx("h1",{className:"header-title",children:"Job Management"})]}),l.jsx("div",{className:"header-actions",children:l.jsx("button",{onClick:P,className:"refresh-button",disabled:N,"aria-label":"Refresh jobs",children:l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})})]})}),l.jsxs("div",{className:"grid grid-cols-5 gap-4 p-6 shrink-0",children:[l.jsxs("div",{className:"stats-card",children:[l.jsx("div",{className:"text-sm text-[--muted-foreground]",children:"Total Jobs"}),l.jsx("div",{className:"text-2xl font-semibold mt-1",children:Te.totalJobs}),l.jsx("div",{className:"text-xs text-[--primary] mt-1",children:"↑ 12% from last week"})]}),l.jsxs("div",{className:"stats-card",children:[l.jsx("div",{className:"text-sm text-[--muted-foreground]",children:"Completed"}),l.jsx("div",{className:"text-2xl font-semibold mt-1 text-[--status-completed]",children:Te.completedJobs}),l.jsx("div",{className:"text-xs text-[--muted-foreground] mt-1",children:"Success rate 98%"})]}),l.jsxs("div",{className:"stats-card",children:[l.jsx("div",{className:"text-sm text-[--muted-foreground]",children:"In Progress"}),l.jsx("div",{className:"text-2xl font-semibold mt-1 text-[--status-in-progress]",children:Te.processingJobs}),l.jsx("div",{className:"text-xs text-[--muted-foreground] mt-1",children:"Currently processing"})]}),l.jsxs("div",{className:"stats-card",children:[l.jsx("div",{className:"text-sm text-[--muted-foreground]",children:"Failed"}),l.jsx("div",{className:"text-2xl font-semibold mt-1 text-[--status-failed]",children:Te.failedJobs}),l.jsx("div",{className:"text-xs text-[--muted-foreground] mt-1",children:"Last 24h"})]}),l.jsxs("div",{className:"stats-card",children:[l.jsx("div",{className:"text-sm text-[--muted-foreground]",children:"Pending"}),l.jsx("div",{className:"text-2xl font-semibold mt-1 text-[--status-pending]",children:Te.pendingJobs}),l.jsx("div",{className:"text-xs text-[--muted-foreground] mt-1",children:"In queue"})]})]}),l.jsxs("div",{className:"px-6 py-4 space-y-4 border-b border-[--border] shrink-0",children:[l.jsxs("div",{className:"flex gap-4",children:[l.jsxs("div",{className:"relative w-48",children:[l.jsxs("select",{value:i.status,onChange:W=>F({...i,status:W.target.value}),className:"w-full appearance-none bg-[--background] border border-[--border] rounded-lg px-4 py-2 pr-8 focus:outline-none focus:ring-2 focus:ring-[--ring]",children:[l.jsx("option",{value:"all",children:"All Status"}),l.jsx("option",{value:"completed",children:"Completed"}),l.jsx("option",{value:"processing",children:"In Progress"}),l.jsx("option",{value:"failed",children:"Failed"}),l.jsx("option",{value:"pending",children:"Pending"})]}),l.jsx("svg",{className:"absolute right-2 top-1/2 -translate-y-1/2 w-5 h-5 pointer-events-none text-[--muted-foreground]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),l.jsxs("div",{className:"relative flex items-center gap-2",children:[l.jsxs("div",{className:"flex items-center gap-2 bg-[--background] border border-[--border] rounded-lg p-2",children:[l.jsx("input",{type:"date",className:"bg-transparent px-2 focus:outline-none",placeholder:"From",onChange:W=>F({...i,dateRange:W.target.value})}),l.jsx("div",{className:"h-4 w-px bg-[--border]"}),l.jsx("input",{type:"date",className:"bg-transparent px-2 focus:outline-none",placeholder:"To",onChange:W=>F({...i,dateRange:W.target.value})})]}),l.jsxs("div",{className:"flex gap-1",children:[l.jsx("button",{onClick:()=>F({...i,dateRange:"today"}),className:"px-2 py-1 text-xs bg-[--secondary] hover:bg-opacity-80 rounded",children:"Today"}),l.jsx("button",{onClick:()=>F({...i,dateRange:"week"}),className:"px-2 py-1 text-xs bg-[--secondary] hover:bg-opacity-80 rounded",children:"Week"}),l.jsx("button",{onClick:()=>F({...i,dateRange:"month"}),className:"px-2 py-1 text-xs bg-[--secondary] hover:bg-opacity-80 rounded",children:"Month"})]})]}),l.jsxs("div",{className:"relative flex-1",children:[l.jsx("input",{type:"text",value:o,onChange:W=>M(W.target.value),placeholder:"Search jobs...",className:"w-full bg-[--background] border border-[--border] rounded-lg px-4 py-2 pl-10 pr-10 focus:outline-none focus:ring-2 focus:ring-[--ring]"}),l.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-[--muted-foreground]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),o&&l.jsx("button",{onClick:()=>M(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-[--muted-foreground] hover:text-[--foreground]",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[l.jsx("span",{className:"text-[--muted-foreground]",children:"3 active filters"}),l.jsx("button",{onClick:()=>{c({status:"all",dateRange:"all",label:"",minImages:0,maxImages:null}),u("")},className:"text-[--primary] hover:underline text-sm",children:"Clear all"})]}),l.jsx("div",{className:"h-4 border-r border-[--border]"}),l.jsx("div",{className:"flex items-center gap-2",children:l.jsxs("button",{className:"flex items-center gap-1 text-sm text-[--primary] hover:underline",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"})}),"Save as preset"]})})]})})]}),l.jsx("div",{className:"job-table-container",children:l.jsx("div",{className:"job-table-scroll",children:l.jsxs("table",{className:"job-table w-full",children:[l.jsx("thead",{className:"sticky top-0 bg-[--background] z-10",children:l.jsxs("tr",{children:[l.jsx("th",{className:"w-12",children:l.jsx("div",{className:"checkbox-wrapper",role:"checkbox","aria-checked":ne.length>0&&ne.every(W=>n.has(W.id)),tabIndex:0,onClick:()=>ee(!ne.every(W=>n.has(W.id))),children:ne.length>0&&ne.every(W=>n.has(W.id))&&l.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})}),l.jsxs("th",{className:"w-32",children:["Job ID",l.jsx("span",{className:"sort-indicator",children:"▼"})]}),l.jsx("th",{className:"w-64",children:"Name/Label"}),l.jsx("th",{className:"w-32",children:"Status"}),l.jsxs("th",{className:"w-40",children:["Date",l.jsx("span",{className:"sort-indicator",children:"▼"})]}),l.jsx("th",{className:"w-24",children:"Duration"}),l.jsx("th",{className:"w-24",children:"Images"}),l.jsx("th",{className:"w-40",children:"Actions"})]})}),l.jsx("tbody",{children:ne.map(W=>l.jsxs("tr",{className:`job-row ${n.has(W.id)?"selected":""}`,children:[l.jsx("td",{children:l.jsx("div",{className:"checkbox-wrapper","aria-checked":n.has(W.id),onClick:Q=>{Q.stopPropagation(),U(W.id,!n.has(W.id))},role:"checkbox",tabIndex:0,onKeyDown:Q=>{(Q.key==="Enter"||Q.key===" ")&&(Q.preventDefault(),Q.stopPropagation(),U(W.id,!n.has(W.id)))},children:n.has(W.id)&&l.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})}),l.jsx("td",{children:l.jsxs("span",{className:"job-id",children:["#",W.id]})}),l.jsx("td",{children:l.jsx("span",{className:"job-label",contentEditable:!0,suppressContentEditableWarning:!0,onBlur:Q=>ue(W.id,Q.currentTarget.textContent||""),onKeyDown:Q=>{Q.key==="Enter"?Q.currentTarget.blur():Q.key==="Escape"&&(Q.currentTarget.textContent=W.label||`Job ${W.id}`,Q.currentTarget.blur())},children:W.label||`Job ${W.id}`})}),l.jsx("td",{children:l.jsxs("span",{className:`status-badge status-${W.status}`,children:[W.status==="completed"&&"✓ Completed",W.status==="processing"&&"⟳ In Progress",W.status==="failed"&&"✗ Failed",W.status==="pending"&&"⏳ Pending",!["completed","processing","failed","pending"].includes(W.status)&&W.status]})}),l.jsx("td",{children:l.jsx("span",{className:"timestamp",children:W.startedAt?new Date(W.startedAt).toLocaleDateString():"Unknown"})}),l.jsx("td",{children:W.startedAt&&W.completedAt?`${Math.round((new Date(W.completedAt).getTime()-new Date(W.startedAt).getTime())/(1e3*60))}m`:"N/A"}),l.jsx("td",{children:l.jsxs("span",{className:"flex items-center gap-1",children:[W.totalImages||0,l.jsx("svg",{className:"w-4 h-4 text-[--muted-foreground]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})]})}),l.jsx("td",{children:l.jsxs("div",{className:"quick-actions flex items-center gap-2",children:[l.jsx("button",{onClick:()=>we(W.id),className:"p-1 hover:bg-[--secondary] rounded transition-colors",title:"View Job Details",children:l.jsxs("svg",{className:"w-4 h-4 text-[--action-view]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),l.jsx("button",{onClick:async Q=>{Q.preventDefault(),Q.stopPropagation(),console.log("🚨 DEBUG RERUN: JobManagementPanel rerun button clicked for job:",W.id),console.log("🚨 DEBUG RERUN: Timestamp:",new Date().toISOString()),console.log("🚨 DEBUG RERUN: Event type:",Q.type),console.log("🚨 DEBUG RERUN: Event target:",Q.target),console.log("🚨 DEBUG RERUN: Event currentTarget:",Q.currentTarget);try{await window.electronAPI.jobManagement.rerunJobExecution(W.id),console.log("🔄 Waiting for job registration to complete..."),setTimeout(async()=>{console.log("🔄 Refreshing Job Management UI after rerun..."),await P()},1e3)}catch(_e){console.error("Failed to rerun job:",_e)}},className:"p-1 hover:bg-[--secondary] rounded transition-colors",title:"Rerun Job",children:l.jsx("svg",{className:"w-4 h-4 text-[--action-rerun]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),l.jsx("button",{onClick:()=>{se("single"),G(W.id),q(!0)},className:"p-1 hover:bg-[--secondary] rounded transition-colors",title:"Export Job",children:l.jsx("svg",{className:"w-4 h-4 text-[--action-export]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),l.jsx("button",{onClick:()=>window.electronAPI.jobManagement.deleteJobExecution(W.id),className:"p-1 hover:bg-[--secondary] rounded transition-colors",title:"Delete Job",children:l.jsx("svg",{className:"w-4 h-4 text-[--action-delete]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},W.id))})]})})}),n.size>0&&l.jsx("div",{className:"border-t border-[--border] p-4 shrink-0",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("span",{className:"text-sm text-[--muted-foreground]",children:["Selected: ",n.size," (",Math.round(n.size/ne.length*100),"%)"]}),l.jsx("button",{onClick:()=>s(new Set),className:"text-[--primary] hover:underline text-sm",children:"Clear"})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("button",{onClick:ie,disabled:B,className:"bg-[--action-rerun] text-white px-4 py-2 rounded-lg hover:opacity-90 disabled:opacity-50 flex items-center gap-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.828 14.828a4 4 0 01-5.656 0M9 10h1m4 0h1m-6 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Rerun Selected"]}),l.jsxs("button",{onClick:()=>{se("bulk"),G(null),q(!0)},disabled:B,className:"bg-[--action-export] text-white px-4 py-2 rounded-lg hover:opacity-90 disabled:opacity-50 flex items-center gap-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export Selected"]}),l.jsxs("button",{onClick:be,disabled:B,className:"bg-[--action-delete] text-white px-4 py-2 rounded-lg hover:opacity-90 disabled:opacity-50 flex items-center gap-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete Selected"]})]})]})}),l.jsx("div",{className:"border-t border-[--border] p-4 shrink-0",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("button",{onClick:()=>D(b-1),disabled:b===1,className:"p-2 hover:bg-[--secondary] rounded-lg transition-colors disabled:opacity-50",children:l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),l.jsxs("span",{className:"text-sm text-[--muted-foreground]",children:["Page ",b," of ",ye]}),l.jsx("button",{onClick:()=>D(b+1),disabled:b===ye,className:"p-2 hover:bg-[--secondary] rounded-lg transition-colors disabled:opacity-50",children:l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("select",{value:w,onChange:W=>k(Number(W.target.value)),className:"bg-[--background] border border-[--border] rounded-lg px-3 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-[--ring]",children:[l.jsx("option",{value:25,children:"25 per page"}),l.jsx("option",{value:50,children:"50 per page"}),l.jsx("option",{value:100,children:"100 per page"})]}),l.jsxs("span",{className:"text-sm text-[--muted-foreground]",children:["Total: ",v," jobs"]})]})]})}),N&&l.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-75 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[--primary] mx-auto"}),l.jsx("p",{className:"mt-4 text-[--muted-foreground]",children:"Loading jobs..."})]})}),l.jsx(cd,{isOpen:H,onClose:()=>{q(!1),se("single"),G(null)},onExport:async()=>{if(re==="single"&&le)return await window.electronAPI.exportJobToExcel(le);if(re==="bulk"){const W=Array.from(n);return await window.electronAPI.jobManagement.bulkExportJobExecutions(W)}return{success:!1,error:"Invalid export type"}},title:re==="single"?"Export Job":`Export ${n.size} Jobs`,description:re==="single"?"Export this job to Excel format with all details and settings.":`Export ${n.size} selected jobs to Excel format.`})]})};const kj=({jobId:e,onBack:t,onExport:r,onRerun:a,onDelete:n})=>{var tl,rl,al,nl,Fi,Li,sl,ll,il,Ii,Bi,mn,Pi,Ui,zi,Hi,Gi,Vi,Yi,Xi,Xn,Wi,Ji,Qi,y,T,S,E,_,A,Y,ae,V,X,J,fe,ge,pe,de,ve,Ee,Qe,qe,pt,ka,Ma,Da,Jr,Wn,Sr,od,ud,fd,dd,hd,xd,md,gd,vd,pd,yd,bd,wd,Nd,Sd,Ed,Td,_d,jd,Ad,Cd,kd,Md,Dd,Rd,Od,Fd,Ld,Id,Bd,Pd,Ud,zd,Hd,Gd,Vd,Yd,Xd,Wd,Jd,Qd,qd,Kd,Zd,$d,eh,th,rh,ah,nh,sh,lh;const[s,i]=L.useState("overview"),[c,o]=L.useState(null),[u,f]=L.useState([]),[h,d]=L.useState([]),[x,b]=L.useState(!0),[m,w]=L.useState(null),[p,v]=L.useState(!1),[g,N]=L.useState("grid"),[I,z]=L.useState("all"),[j,B]=L.useState(!1),[R,H]=L.useState(""),[q,re]=L.useState(!1),[se,le]=L.useState(null),G=L.useRef(null),[C,K]=L.useState(!1),[O,ne]=L.useState(null),[ye,Te]=L.useState(!1),[M,P]=L.useState(null),[F,D]=L.useState(!1),[k,U]=L.useState(null),[ee,ue]=L.useState(!1);L.useEffect(()=>{ie()},[e]);const ie=async()=>{var Z,ke,Ut,Br;console.log("🔄 SingleJobView: loadJobData called"),b(!0),w(null);try{const St=await window.electronAPI.jobManagement.getJobExecution(e);if(St.success){o(St.execution);const We=St.execution.label;!We||We.trim()===""?H("No label"):H(We)}else w(St.error||"Failed to load job details");if((Z=St.execution)!=null&&Z.id){console.log("🔄 SingleJobView: Loading images for execution ID:",St.execution.id);const We=await window.electronAPI.generatedImages.getGeneratedImagesByExecution(St.execution.id);console.log("🔄 SingleJobView: Images result:",We),We.success?(console.log("🔄 SingleJobView: Setting images:",We.images),console.log("🔄 SingleJobView: Images QC statuses:",(ke=We.images)==null?void 0:ke.map(cl=>({id:cl.id,qcStatus:cl.qcStatus}))),f(We.images||[])):(console.warn("Failed to load images:",We.error),f([]))}else console.warn("Job execution has no numeric ID, cannot load images"),f([]);try{const We=await window.electronAPI.jobManagement.getJobLogs("standard");We&&Array.isArray(We)?d(We):d([])}catch{d([])}if(console.log("🔍 DEBUG: jobResult structure:",St),console.log("🔍 DEBUG: jobResult.execution:",St.execution),console.log("🔍 DEBUG: jobResult.execution?.configurationId:",(Ut=St.execution)==null?void 0:Ut.configurationId),(Br=St.execution)!=null&&Br.configurationId)try{console.log("🔍 DEBUG: About to call getJobConfigurationById with:",St.execution.configurationId);const We=await window.electronAPI.getJobConfigurationById(St.execution.configurationId);console.log("🔍 DEBUG: getJobConfigurationById result:",We),We.success&&We.configuration?(console.log("🔍 DEBUG: Setting job configuration:",We.configuration),U(We.configuration)):console.warn("🔍 DEBUG: getJobConfigurationById failed:",We)}catch(We){console.warn("Failed to load job configuration:",We)}else console.warn("🔍 DEBUG: No configurationId found in jobResult.execution")}catch(St){console.error("Error loading job data:",St),w("Failed to load job data")}finally{b(!1)}},be=L.useCallback(Z=>{i(Z),Z==="logs"&&window.electronAPI.jobManagement.getJobLogs("standard").then(ke=>d(Array.isArray(ke)?ke:[])).catch(()=>d([]))},[]),we=L.useCallback(()=>{t()},[t]),W=L.useCallback(async()=>{ue(!0)},[]),Q=L.useCallback(()=>{console.log("🚨 DEBUG RERUN: SingleJobView rerun button clicked for jobId:",e),console.log("🚨 DEBUG RERUN: Timestamp:",new Date().toISOString()),console.log("🚨 DEBUG RERUN: Stack trace:",new Error().stack),a(e)},[a,e]),_e=L.useCallback(()=>{v(!0)},[]),Ne=L.useCallback(()=>{n(e),v(!1)},[n,e]),me=L.useCallback(()=>{v(!1)},[]),vt=L.useCallback(()=>{B(!0),le(null),setTimeout(()=>{if(G.current){G.current.focus();const Z=document.createRange();Z.selectNodeContents(G.current);const ke=window.getSelection();ke&&(ke.removeAllRanges(),ke.addRange(Z))}},10)},[]),Ze=L.useCallback(async()=>{if(!(!c||!R.trim())){re(!0),le(null);try{const Z=R.trim()==="No label"?"":R.trim(),ke=await window.electronAPI.jobManagement.renameJobExecution(c.id,Z);ke.success?(o(Ut=>Ut?{...Ut,label:Z}:null),B(!1),console.log("Job label updated successfully")):le(ke.error||"Failed to save label")}catch(Z){console.error("Error saving job label:",Z),le("Failed to save label")}finally{re(!1)}}},[c,R]),lr=L.useCallback(()=>{B(!1);const Z=c==null?void 0:c.label;!Z||Z.trim()===""?H("No label"):H(Z),le(null)},[c]),Ca=L.useCallback(Z=>{Z.key==="Enter"?(Z.preventDefault(),Ze()):Z.key==="Escape"&&(Z.preventDefault(),lr())},[Ze,lr]),Ri=L.useCallback(()=>{const Z=(c==null?void 0:c.label)||"",ke=Z&&Z.trim()!==""?Z:"No label";R!==ke&&Ze()},[R,c,Ze]),$s=L.useCallback(async()=>{var Z;console.log("Edit button clicked, job:",c),console.log("Job configurationId:",c==null?void 0:c.configurationId),console.log("Already loaded jobConfiguration:",k),K(!0),P(null),D(!1);try{if(k!=null&&k.settings)console.log("Using already-loaded job configuration:",k.settings),ne(k.settings);else if(c!=null&&c.configurationId){console.log("Job configuration not loaded yet, fetching from backend for ID:",c.configurationId),D(!0);const ke=await window.electronAPI.getJobConfigurationById(c.configurationId);console.log("Configuration load result:",ke),ke.success&&((Z=ke.configuration)!=null&&Z.settings)?(ne(ke.configuration.settings),console.log("Loaded job configuration from backend:",ke.configuration.settings)):(console.warn("Job configuration not found, showing error in modal"),P("Job configuration not found. This job may be corrupted."))}else console.log("Job has no configurationId - this is a dashboard-created job"),P("This job was created from the dashboard and has no saved configuration. You can view the job details and generated images, but cannot edit settings. This is normal behavior for dashboard-created jobs.")}catch(ke){console.error("Error loading job settings:",ke),P("Failed to load job settings")}finally{D(!1)}},[c==null?void 0:c.configurationId,k]),Nr=L.useCallback(async()=>{if(!(!O||!(c!=null&&c.configurationId))){Te(!0),P(null);try{const Z=await window.electronAPI.updateJobConfiguration(c.configurationId,O);Z.success?(K(!1),console.log("Job settings updated successfully")):P(Z.error||"Failed to save job settings")}catch(Z){console.error("Error saving job settings:",Z),P("Failed to save job settings")}finally{Te(!1)}}},[O,c==null?void 0:c.configurationId]),hn=L.useCallback(()=>{K(!1),ne(null),P(null)},[]),ot=L.useCallback((Z,ke,Ut)=>{O&&ne(Br=>Br&&{...Br,[Z]:{...Br[Z],[ke]:Ut}})},[O]),Lr=L.useCallback((Z,ke)=>Ut=>{ot(Z,ke,Ut)},[ot]),Ir=Z=>{switch(Z){case"completed":return"status-complete";case"failed":return"status-failed";case"running":return"status-processing";case"pending":return"status-pending";default:return"status-pending"}},el=L.useMemo(()=>I==="all"?u:u.filter(Z=>Z.qcStatus===I),[u,I]),xn=Z=>Z instanceof Date?Z.toLocaleString():new Date(Z).toLocaleString(),Oi=(Z,ke)=>{if(!ke)return"In Progress";const Ut=Z instanceof Date?Z:new Date(Z),St=(ke instanceof Date?ke:new Date(ke)).getTime()-Ut.getTime(),We=Math.floor(St/36e5),cl=Math.floor(St%36e5/6e4);return We>0?`${We}h ${cl}m`:`${cl}m`};return x?l.jsx("div",{className:"single-job-view",role:"main","aria-label":"Loading job details",children:l.jsxs("div",{className:"loading-container",children:[l.jsx("div",{className:"loading-spinner"}),l.jsx("p",{children:"Loading job details..."})]})}):m?l.jsx("div",{className:"single-job-view",role:"main","aria-label":"Job error",children:l.jsxs("div",{className:"error-container",children:[l.jsx("div",{className:"error-icon",children:"⚠️"}),l.jsx("h3",{children:"Error Loading Job"}),l.jsx("p",{children:m}),l.jsx("button",{onClick:we,className:"btn-primary",children:"Go Back"})]})}):c?l.jsxs("div",{className:"single-job-view",children:[l.jsxs("header",{className:"job-header",children:[l.jsx("div",{className:"header-content",children:l.jsxs("div",{className:"header-left",children:[l.jsx("button",{onClick:we,className:"back-button","aria-label":"Go back to job list",children:l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),l.jsxs("h1",{className:"job-title-main",children:["Job #",c.id]})]})}),l.jsxs("div",{className:"job-title-section",children:[l.jsx("div",{className:"job-title-editable",onClick:j?void 0:vt,title:j?"Press Enter to save, Escape to cancel":"Click to edit job label",children:j?l.jsx("input",{type:"text",value:R,onChange:Z=>H(Z.target.value),onKeyDown:Ca,onBlur:Ri,ref:G,className:"label-input",autoFocus:!0}):l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"job-title-text",children:c!=null&&c.label&&c.label.trim()!==""?c.label:"No label"}),l.jsxs("svg",{className:"edit-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[l.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),l.jsx("path",{d:"m18.5 2.5 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})]})}),j&&l.jsxs("div",{className:"label-edit-controls",children:[l.jsx("button",{onClick:Ze,disabled:q,className:"label-save-btn",title:"Save label",children:q?"Saving...":"Save"}),l.jsx("button",{onClick:lr,disabled:q,className:"label-cancel-btn",title:"Cancel editing",children:"Cancel"})]}),se&&l.jsxs("div",{className:"label-error",children:[l.jsx("span",{className:"error-icon",children:"⚠️"}),se]})]})]}),l.jsxs("div",{className:"tab-navigation",children:[l.jsx("button",{className:`tab-button ${s==="overview"?"active":""}`,onClick:()=>be("overview"),"data-tab":"overview",children:"Overview"}),l.jsx("button",{className:`tab-button ${s==="images"?"active":""}`,onClick:()=>be("images"),"data-tab":"images",children:"Images"}),(c==null?void 0:c.status)==="running"&&l.jsx("button",{className:`tab-button ${s==="logs"?"active":""}`,onClick:()=>be("logs"),"data-tab":"logs",children:"Logs"})]}),l.jsxs("main",{className:"tab-content-container",children:[l.jsx("div",{id:"overview",className:`tab-content ${s==="overview"?"active":""}`,children:l.jsxs("div",{className:"overview-content",children:[l.jsxs("div",{className:"info-grid",children:[l.jsxs("div",{className:"info-card",children:[l.jsx("div",{className:"info-label",children:"Job ID"}),l.jsxs("div",{className:"info-value",children:["JOB-",c.id]})]}),l.jsxs("div",{className:"info-card",children:[l.jsx("div",{className:"info-label",children:"Status"}),l.jsx("div",{className:"info-value",children:l.jsx("span",{className:`status-badge ${Ir(c.status)}`,children:c.status==="completed"?"✓ Completed":c.status==="processing"?"⟳ Processing":c.status==="failed"?"⚠ Failed":"⏳ Pending"})})]}),l.jsxs("div",{className:"info-card",children:[l.jsx("div",{className:"info-label",children:"Start Time"}),l.jsx("div",{className:"info-value",children:c.startedAt?xn(c.startedAt):"Not started"})]}),l.jsxs("div",{className:"info-card",children:[l.jsx("div",{className:"info-label",children:"Duration"}),l.jsx("div",{className:"info-value",children:c.startedAt&&c.completedAt?Oi(c.startedAt,c.completedAt):"In Progress"})]}),l.jsxs("div",{className:"info-card",children:[l.jsx("div",{className:"info-label",children:"Success Rate"}),l.jsx("div",{className:"info-value",children:c.totalImages?`${Math.round((c.successfulImages||0)/c.totalImages*100)}% (${c.successfulImages||0}/${c.totalImages})`:"N/A"})]})]}),l.jsx("h2",{className:"section-title",children:"Generated Images Summary"}),l.jsxs("div",{className:"stats-grid",children:[l.jsxs("div",{className:"stats-card",children:[l.jsx("div",{className:"stats-label",children:"Total Images"}),l.jsx("div",{className:"stats-value",children:c.totalImages||0})]}),l.jsxs("div",{className:"stats-card",children:[l.jsx("div",{className:"stats-label",children:"Successful"}),l.jsx("div",{className:"stats-value success",children:c.successfulImages||0})]}),l.jsxs("div",{className:"stats-card",children:[l.jsx("div",{className:"stats-label",children:"Failed"}),l.jsx("div",{className:"stats-value failed",children:c.failedImages||0})]})]}),l.jsxs("div",{className:"settings-section",children:[l.jsxs("div",{className:"settings-header",children:[l.jsx("h2",{className:"section-title",children:"Settings"}),l.jsxs("div",{className:"settings-actions",children:[l.jsx("button",{className:"refresh-button",onClick:ie,title:"Refresh job data",disabled:x,children:x?"Refreshing...":"🔄 Refresh"}),l.jsx("button",{className:"edit-button",onClick:$s,title:"Edit job settings",children:"Edit"})]})]}),l.jsx("div",{className:"settings-content",children:k?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"setting-group",children:[l.jsx("h3",{children:"Model Configuration"}),l.jsxs("div",{className:"setting-details",children:[l.jsxs("div",{children:["• Model: ",(rl=(tl=k.settings)==null?void 0:tl.parameters)!=null&&rl.mjVersion?`Midjourney v${k.settings.parameters.mjVersion}`:"Not specified"]}),l.jsxs("div",{children:["• Process Mode: ",((nl=(al=k.settings)==null?void 0:al.parameters)==null?void 0:nl.processMode)||"Not specified"]}),l.jsxs("div",{children:["• OpenAI Model: ",((Li=(Fi=k.settings)==null?void 0:Fi.parameters)==null?void 0:Li.openaiModel)||"Not specified"]})]})]}),l.jsxs("div",{className:"setting-group",children:[l.jsx("h3",{children:"Image Settings"}),l.jsxs("div",{className:"setting-details",children:[l.jsxs("div",{children:["• Aspect Ratio: ",Array.isArray((ll=(sl=k.settings)==null?void 0:sl.parameters)==null?void 0:ll.aspectRatios)?k.settings.parameters.aspectRatios.join(", "):((Ii=(il=k.settings)==null?void 0:il.parameters)==null?void 0:Ii.aspectRatios)||"Not specified"]}),l.jsxs("div",{children:["• Image Count: ",((mn=(Bi=k.settings)==null?void 0:Bi.parameters)==null?void 0:mn.count)||"Not specified"]}),l.jsxs("div",{children:["• Convert to JPG: ",(Ui=(Pi=k.settings)==null?void 0:Pi.processing)!=null&&Ui.convertToJpg?"Yes":"No"]})]})]}),l.jsxs("div",{className:"setting-group",children:[l.jsx("h3",{children:"Processing Options"}),l.jsxs("div",{className:"setting-details",children:[l.jsxs("div",{children:["• Remove Background: ",(Hi=(zi=k.settings)==null?void 0:zi.processing)!=null&&Hi.removeBg?"Yes":"No"]}),l.jsxs("div",{children:["• Remove.bg Size: ",(Vi=(Gi=k.settings)==null?void 0:Gi.processing)!=null&&Vi.removeBg?((Xi=(Yi=k.settings)==null?void 0:Yi.processing)==null?void 0:Xi.removeBgSize)||"auto":"Not applied (Remove Background OFF)"]}),l.jsxs("div",{children:["• Image Enhancement: ",(Wi=(Xn=k.settings)==null?void 0:Xn.processing)!=null&&Wi.imageEnhancement?"Yes":"No"]}),l.jsxs("div",{children:["• Sharpening: ",(Qi=(Ji=k.settings)==null?void 0:Ji.processing)!=null&&Qi.imageEnhancement?((T=(y=k.settings)==null?void 0:y.processing)==null?void 0:T.sharpening)||0:"Not applied (Image Enhancement OFF)"]}),l.jsxs("div",{children:["• Saturation: ",(E=(S=k.settings)==null?void 0:S.processing)!=null&&E.imageEnhancement?((A=(_=k.settings)==null?void 0:_.processing)==null?void 0:A.saturation)||1.4:"Not applied (Image Enhancement OFF)"]}),l.jsxs("div",{children:["• Image Convert: ",(ae=(Y=k.settings)==null?void 0:Y.processing)!=null&&ae.imageConvert?"Yes":"No"]}),l.jsxs("div",{children:["• Convert Format: ",(X=(V=k.settings)==null?void 0:V.processing)!=null&&X.imageConvert?(fe=(J=k.settings)==null?void 0:J.processing)!=null&&fe.convertToJpg?"JPG":"PNG":"Not applied (Image Convert OFF)"]}),l.jsxs("div",{children:["• JPG Quality: ",(pe=(ge=k.settings)==null?void 0:ge.processing)!=null&&pe.imageConvert&&((ve=(de=k.settings)==null?void 0:de.processing)!=null&&ve.convertToJpg)?((Qe=(Ee=k.settings)==null?void 0:Ee.processing)==null?void 0:Qe.jpgQuality)||100:"Not applied (Convert Format is not JPG)"]}),l.jsxs("div",{children:["• PNG Quality: ",(pt=(qe=k.settings)==null?void 0:qe.processing)!=null&&pt.imageConvert&&!((Ma=(ka=k.settings)==null?void 0:ka.processing)!=null&&Ma.convertToJpg)?((Jr=(Da=k.settings)==null?void 0:Da.processing)==null?void 0:Jr.pngQuality)||100:"Not applied (Convert Format is not PNG)"]}),l.jsxs("div",{children:["• Trim Transparent: ",(Sr=(Wn=k.settings)==null?void 0:Wn.processing)!=null&&Sr.trimTransparentBackground?"Yes":"No"]}),l.jsxs("div",{children:["• JPG Background Colour: ",(ud=(od=k.settings)==null?void 0:od.processing)!=null&&ud.imageConvert&&((dd=(fd=k.settings)==null?void 0:fd.processing)!=null&&dd.convertToJpg)&&((xd=(hd=k.settings)==null?void 0:hd.processing)!=null&&xd.removeBg)?((gd=(md=k.settings)==null?void 0:md.processing)==null?void 0:gd.jpgBackground)||"white":"Not applied (Remove Background, Image Convert are set to OFF and Convert Format is not JPG)"]}),l.jsxs("div",{children:["• Quality Check: ",(pd=(vd=k.settings)==null?void 0:vd.ai)!=null&&pd.runQualityCheck?"Yes":"No"]}),l.jsxs("div",{children:["• Metadata Generation: ",(bd=(yd=k.settings)==null?void 0:yd.ai)!=null&&bd.runMetadataGen?"Yes":"No"]})]})]})]}):l.jsxs("div",{className:"no-configuration",children:[l.jsx("p",{children:"No configuration available for this job."}),l.jsx("p",{children:"This job was run with default settings."})]})})]})]})}),l.jsx("div",{id:"images",className:`tab-content ${s==="images"?"active":""}`,children:l.jsxs("div",{className:"images-content",children:[l.jsxs("div",{className:"images-controls",children:[l.jsx("div",{className:"filter-controls",children:l.jsxs("select",{value:I,onChange:Z=>z(Z.target.value),className:"filter-select",children:[l.jsx("option",{value:"all",children:"All Images"}),l.jsx("option",{value:"completed",children:"Completed"}),l.jsx("option",{value:"failed",children:"Failed"})]})}),l.jsxs("div",{className:"view-controls",children:[l.jsx("button",{className:`view-toggle ${g==="grid"?"active":""}`,onClick:()=>N("grid"),title:"Grid View",children:l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),l.jsx("button",{className:`view-toggle ${g==="list"?"active":""}`,onClick:()=>N("list"),title:"List View",children:l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})})})]})]}),g==="grid"&&l.jsx("div",{className:"image-grid",children:el.length===0?l.jsx("div",{className:"no-images",children:l.jsx("p",{children:"No images found with current filter."})}):el.map(Z=>l.jsxs("div",{className:"image-card",children:[l.jsx("div",{className:"image-preview",children:Z.finalImagePath?l.jsx("img",{src:`local-file://${Z.finalImagePath}`,alt:`Generated image ${Z.id}`,className:"w-full h-32 object-cover rounded",onError:ke=>{console.error("Failed to load image:",Z.finalImagePath),ke.currentTarget.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDEyOCAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxMjgiIGhlaWdodD0iMTI4IiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik02NCAzMkM3Ny4yNTQ4IDMyIDg4IDQyLjc0NTIgODggNTZDODggNjkuMjU0OCA3Ny4yNTQ4IDgwIDY0IDgwQzUwLjc0NTIgODAgNDAgNjkuMjU0OCA0MCA1NkM0MCA0Mi43NDUyIDUwLjc0NTIgMzIgNjQgMzJaIiBmaWxsPSIjOUI5QkEwIi8+CjxwYXRoIGQ9Ik0yNCA4OEgxMDRDMTEwLjYyNyA4OCAxMTYgOTMuMzcyNiAxMTYgMTAwVjExMkMxMTYgMTE4LjYyNyAxMTAuNjI3IDEyNCAxMDQgMTI0SDI0QzE3LjM3MjYgMTI0IDEyIDExOC42MjcgMTIgMTEyVjEwMEMxMiA5My4zNzI2IDE3LjM3MjYgODggMjQgODhaIiBmaWxsPSIjOUI5QkEwIi8+Cjwvc3ZnPgo="}}):l.jsx("div",{className:"w-full h-32 bg-gray-100 rounded flex items-center justify-center",children:l.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})}),l.jsxs("div",{className:"image-info",children:[l.jsxs("span",{className:"image-id",children:["Image ",Z.id]}),l.jsx("span",{className:`image-status ${Ir(Z.qcStatus)}`,children:Z.qcStatus==="approved"?"✓ Approved":Z.qcStatus==="failed"?"⚠️ Failed":"⏳ Pending"})]})]},Z.id))}),g==="list"&&l.jsxs("table",{className:"image-list",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{children:"Preview"}),l.jsx("th",{children:"ID"}),l.jsx("th",{children:"Status"}),l.jsx("th",{children:"Generated At"})]})}),l.jsx("tbody",{children:el.map(Z=>l.jsxs("tr",{children:[l.jsx("td",{children:l.jsx("div",{className:"thumbnail",children:Z.finalImagePath?l.jsx("img",{src:`local-file://${Z.finalImagePath}`,alt:`Generated image ${Z.id}`,className:"w-12 h-12 object-cover rounded",onError:ke=>{ke.currentTarget.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDgiIGhlaWdodD0iNDgiIHZpZXdCb3g9IjAgMCA0OCA0OCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjQ4IiBoZWlnaHQ9IjQ4IiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik0yNCAxMkMzMC42MjcgMTIgMzYgMTcuMzcyNiAzNiAyNEMzNiAzMC42Mjc4IDMwLjYyNyAzNiAyNCAzNkMxNy4zNzIyIDM2IDEyIDMwLjYyNzggMTIgMjRDMTIgMTcuMzcyNiAxNy4zNzIyIDEyIDI0IDEyWiIgZmlsbD0iIzlCOUJBMCIvPgo8cGF0aCBkPSJNOSAzNkgzOUM0Mi4zMTM3IDM2IDQ1IDMzLjMxMzcgNDUgMzBWMjRDNDUgMjAuNjg2MyA0Mi4zMTM3IDE4IDM5IDE4SDlDNi42ODYyOSAxOCA0IDIwLjY4NjMgNCAyNFYzMEM0IDMzLjMxMzcgNi42ODYyOSAzNiA5IDM2WiIgZmlsbD0iIzlCOUJBMCIvPgo8L3N2Zz4K"}}):l.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded flex items-center justify-center",children:l.jsx("svg",{className:"w-6 h-6 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})})}),l.jsxs("td",{children:["Image ",Z.id]}),l.jsx("td",{children:l.jsx("span",{className:`image-status ${Ir(Z.qcStatus)}`,children:Z.qcStatus==="approved"?"✓ Complete":Z.qcStatus==="failed"?"⚠️ Failed":"⏳ Pending"})}),l.jsx("td",{children:xn(c.startedAt||"")})]},Z.id))})]})]})}),(c==null?void 0:c.status)==="running"&&l.jsx("div",{id:"logs",className:`tab-content ${s==="logs"?"active":""}`,children:l.jsx("div",{className:"logs-content",children:l.jsx("div",{className:"logs-timeline",children:h.length===0?l.jsx("div",{className:"no-logs",children:"No logs yet…"}):h.map((Z,ke)=>{var Ut,Br;return l.jsxs("div",{className:"log-entry",children:[l.jsx("div",{className:"log-dot"}),l.jsxs("div",{className:"log-content",children:[l.jsxs("div",{className:"log-header",children:[l.jsx("div",{className:"log-title",children:((Br=(Ut=Z.level)==null?void 0:Ut.toUpperCase)==null?void 0:Br.call(Ut))||"INFO"}),l.jsx("div",{className:"log-time",children:Z.timestamp?xn(Z.timestamp):c!=null&&c.startedAt?xn(c.startedAt):"Unknown time"})]}),l.jsx("div",{className:"log-message",children:typeof Z=="string"?Z:Z.message})]})]},ke)})})})})]}),l.jsx("footer",{className:"job-footer",children:l.jsxs("div",{className:"footer-actions",children:[l.jsxs("button",{onClick:Q,className:"btn-rerun",children:[l.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Rerun Job"]}),l.jsxs("button",{onClick:W,className:"btn-export",children:[l.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export Job"]}),l.jsxs("button",{onClick:_e,className:"btn-delete",children:[l.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete Job"]})]})}),p&&l.jsx("div",{className:"modal-overlay",children:l.jsxs("div",{className:"delete-modal",children:[l.jsx("div",{className:"modal-header",children:l.jsx("h3",{children:"Confirm Deletion"})}),l.jsx("div",{className:"modal-body",children:l.jsx("p",{children:"Are you sure you want to delete this job? This action cannot be undone."})}),l.jsxs("div",{className:"modal-actions",children:[l.jsx("button",{onClick:me,className:"btn-cancel",children:"Cancel"}),l.jsx("button",{onClick:Ne,className:"btn-confirm-delete",children:"Delete Permanently"})]})]})}),C&&l.jsx("div",{className:"modal-overlay",children:l.jsxs("div",{className:"settings-modal",children:[l.jsxs("div",{className:"settings-header",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Edit Job Settings"}),l.jsx("button",{onClick:hn,className:"close-button",title:"Close",children:l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),F?l.jsxs("div",{className:"loading-state",children:[l.jsx("div",{className:"spinner"}),l.jsx("p",{children:"Loading current settings..."})]}):O?l.jsxs("div",{className:"settings-content",children:[l.jsxs("div",{className:"setting-group",children:[l.jsx("h4",{className:"setting-group-title",children:"API Keys"}),l.jsxs("div",{className:"setting-row",children:[l.jsx("label",{children:"OpenAI API Key"}),l.jsx("input",{type:"password",value:((wd=O.apiKeys)==null?void 0:wd.openai)||"",onChange:Z=>ot("apiKeys","openai",Z.target.value),placeholder:"Enter OpenAI API key"})]}),l.jsxs("div",{className:"setting-row",children:[l.jsx("label",{children:"PiAPI Key"}),l.jsx("input",{type:"password",value:((Nd=O.apiKeys)==null?void 0:Nd.piapi)||"",onChange:Z=>ot("apiKeys","piapi",Z.target.value),placeholder:"Enter PiAPI key"})]}),l.jsxs("div",{className:"setting-row",children:[l.jsx("label",{children:"Remove.bg API Key"}),l.jsx("input",{type:"password",value:((Sd=O.apiKeys)==null?void 0:Sd.removeBg)||"",onChange:Z=>ot("apiKeys","removeBg",Z.target.value),placeholder:"Enter Remove.bg API key"})]})]}),l.jsxs("div",{className:"setting-group",children:[l.jsx("h4",{className:"setting-group-title",children:"File Paths"}),l.jsxs("div",{className:"setting-row",children:[l.jsx("label",{children:"Output Directory"}),l.jsx("input",{type:"text",value:((Ed=O.filePaths)==null?void 0:Ed.outputDirectory)||"",onChange:Z=>ot("filePaths","outputDirectory",Z.target.value),placeholder:"Output directory path"})]}),l.jsxs("div",{className:"setting-row",children:[l.jsx("label",{children:"Temp Directory"}),l.jsx("input",{type:"text",value:((Td=O.filePaths)==null?void 0:Td.tempDirectory)||"",onChange:Z=>ot("filePaths","tempDirectory",Z.target.value),placeholder:"Temporary directory path"})]})]}),l.jsxs("div",{className:"setting-group",children:[l.jsx("h4",{className:"setting-group-title",children:"Parameters"}),l.jsxs("div",{className:"setting-row",children:[l.jsx("label",{children:"Process Mode"}),l.jsxs("select",{value:((_d=O.parameters)==null?void 0:_d.processMode)||"relax",onChange:Z=>ot("parameters","processMode",Z.target.value),children:[l.jsx("option",{value:"relax",children:"Relax"}),l.jsx("option",{value:"fast",children:"Fast"}),l.jsx("option",{value:"turbo",children:"Turbo"})]})]}),l.jsxs("div",{className:"setting-row",children:[l.jsx("label",{children:"Aspect Ratios"}),l.jsx("input",{type:"text",value:((jd=O.parameters)==null?void 0:jd.aspectRatios)||["1:1","16:9","9:16"],onChange:Z=>ot("parameters","aspectRatios",Z.target.value),placeholder:"Comma-separated aspect ratios"})]}),l.jsxs("div",{className:"setting-row",children:[l.jsx("label",{children:"MJ Version"}),l.jsxs("select",{value:((Ad=O.parameters)==null?void 0:Ad.mjVersion)||"6.1",onChange:Z=>ot("parameters","mjVersion",Z.target.value),children:[l.jsx("option",{value:"6.1",children:"6.1"}),l.jsx("option",{value:"6.0",children:"6.0"}),l.jsx("option",{value:"5.2",children:"5.2"})]})]})]}),l.jsxs("div",{className:"setting-group",children:[l.jsx("h4",{className:"setting-group-title",children:"Image Processing"}),l.jsxs("div",{className:"setting-row toggle-row",children:[l.jsxs("div",{children:[l.jsx("label",{children:"Remove Background"}),l.jsx("p",{className:"setting-description",children:"Remove background from generated images"})]}),l.jsx("button",{type:"button",role:"switch","aria-checked":((Cd=O.processing)==null?void 0:Cd.removeBg)||!1,onClick:()=>{var Z;return Lr("processing","removeBg")(!((Z=O.processing)!=null&&Z.removeBg))},className:`toggle-button ${(kd=O.processing)!=null&&kd.removeBg?"toggle-on":"toggle-off"}`,children:l.jsx("span",{className:"toggle-slider"})})]}),((Md=O.processing)==null?void 0:Md.removeBg)&&l.jsxs("div",{className:"setting-row",children:[l.jsx("label",{children:"Remove.bg Size"}),l.jsxs("select",{value:((Dd=O.processing)==null?void 0:Dd.removeBgSize)||"auto",onChange:Z=>ot("processing","removeBgSize",Z.target.value),children:[l.jsx("option",{value:"auto",children:"Auto"}),l.jsx("option",{value:"preview",children:"Preview"}),l.jsx("option",{value:"full",children:"Full"}),l.jsx("option",{value:"50MP",children:"50MP"})]})]}),l.jsxs("div",{className:"setting-row toggle-row",children:[l.jsxs("div",{children:[l.jsx("label",{children:"Image Convert"}),l.jsx("p",{className:"setting-description",children:"Enable image conversion and processing"})]}),l.jsx("button",{type:"button",role:"switch","aria-checked":((Rd=O.processing)==null?void 0:Rd.imageConvert)||!1,onClick:()=>{var Z;return Lr("processing","imageConvert")(!((Z=O.processing)!=null&&Z.imageConvert))},className:`toggle-button ${(Od=O.processing)!=null&&Od.imageConvert?"toggle-on":"toggle-off"}`,children:l.jsx("span",{className:"toggle-slider"})})]}),((Fd=O.processing)==null?void 0:Fd.imageConvert)&&l.jsxs("div",{className:"setting-row",children:[l.jsx("label",{children:"Convert Format"}),l.jsxs("select",{value:(Ld=O.processing)!=null&&Ld.convertToJpg?"jpg":"png",onChange:Z=>ot("processing","convertToJpg",Z.target.value==="jpg"),children:[l.jsx("option",{value:"png",children:"PNG"}),l.jsx("option",{value:"jpg",children:"JPG"})]})]}),((Id=O.processing)==null?void 0:Id.imageConvert)&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"setting-row",children:[l.jsx("label",{children:"JPG Quality (1-100)"}),l.jsx("input",{type:"number",value:((Bd=O.processing)==null?void 0:Bd.jpgQuality)||100,onChange:Z=>ot("processing","jpgQuality",parseInt(Z.target.value)),min:"1",max:"100"})]}),l.jsxs("div",{className:"setting-row",children:[l.jsx("label",{children:"PNG Quality (1-100)"}),l.jsx("input",{type:"number",value:((Pd=O.processing)==null?void 0:Pd.pngQuality)||100,onChange:Z=>ot("processing","pngQuality",parseInt(Z.target.value)),min:"1",max:"100"})]})]}),((Ud=O.processing)==null?void 0:Ud.removeBg)&&((zd=O.processing)==null?void 0:zd.imageConvert)&&((Hd=O.processing)==null?void 0:Hd.convertToJpg)&&l.jsxs("div",{className:"setting-row",children:[l.jsx("label",{children:"JPG Background Color"}),l.jsxs("select",{value:((Gd=O.processing)==null?void 0:Gd.jpgBackground)||"white",onChange:Z=>ot("processing","jpgBackground",Z.target.value),children:[l.jsx("option",{value:"white",children:"White"}),l.jsx("option",{value:"black",children:"Black"}),l.jsx("option",{value:"transparent",children:"Transparent"})]})]}),((Vd=O.processing)==null?void 0:Vd.removeBg)&&l.jsxs("div",{className:"setting-row toggle-row",children:[l.jsxs("div",{children:[l.jsx("label",{children:"Trim Transparent Background"}),l.jsx("p",{className:"setting-description",children:"Remove transparent areas from images (PNG only)"})]}),l.jsx("button",{type:"button",role:"switch","aria-checked":((Yd=O.processing)==null?void 0:Yd.trimTransparentBackground)||!1,onClick:()=>{var Z;return Lr("processing","trimTransparentBackground")(!((Z=O.processing)!=null&&Z.trimTransparentBackground))},className:`toggle-button ${(Xd=O.processing)!=null&&Xd.trimTransparentBackground?"toggle-on":"toggle-off"}`,children:l.jsx("span",{className:"toggle-slider"})})]}),l.jsxs("div",{className:"setting-row toggle-row",children:[l.jsxs("div",{children:[l.jsx("label",{children:"Image Enhancement"}),l.jsx("p",{className:"setting-description",children:"Apply sharpening and saturation effects"})]}),l.jsx("button",{type:"button",role:"switch","aria-checked":((Wd=O.processing)==null?void 0:Wd.imageEnhancement)||!1,onClick:()=>{var Z;return Lr("processing","imageEnhancement")(!((Z=O.processing)!=null&&Z.imageEnhancement))},className:`toggle-button ${(Jd=O.processing)!=null&&Jd.imageEnhancement?"toggle-on":"toggle-off"}`,children:l.jsx("span",{className:"toggle-slider"})})]}),((Qd=O.processing)==null?void 0:Qd.imageEnhancement)&&l.jsxs("div",{className:"setting-row",children:[l.jsx("label",{children:"Sharpening Intensity (0-10)"}),l.jsx("input",{type:"range",min:"0",max:"10",step:"0.5",value:((qd=O.processing)==null?void 0:qd.sharpening)||5,onChange:Z=>ot("processing","sharpening",parseFloat(Z.target.value)),className:"range-slider"}),l.jsxs("div",{className:"range-labels",children:[l.jsx("span",{children:"0 (None)"}),l.jsx("span",{children:((Kd=O.processing)==null?void 0:Kd.sharpening)||5}),l.jsx("span",{children:"10 (Maximum)"})]})]}),((Zd=O.processing)==null?void 0:Zd.imageEnhancement)&&l.jsxs("div",{className:"setting-row",children:[l.jsx("label",{children:"Saturation Level (0-2)"}),l.jsx("input",{type:"range",min:"0",max:"2",step:"0.1",value:(($d=O.processing)==null?void 0:$d.saturation)||1.4,onChange:Z=>ot("processing","saturation",parseFloat(Z.target.value)),className:"range-slider"}),l.jsxs("div",{className:"range-labels",children:[l.jsx("span",{children:"0 (Grayscale)"}),l.jsx("span",{children:((eh=O.processing)==null?void 0:eh.saturation)||1.4}),l.jsx("span",{children:"2 (Vibrant)"})]})]})]}),l.jsxs("div",{className:"setting-group",children:[l.jsx("h4",{className:"setting-group-title",children:"AI Features"}),l.jsxs("div",{className:"setting-row toggle-row",children:[l.jsxs("div",{children:[l.jsx("label",{children:"AI Quality Check"}),l.jsx("p",{className:"setting-description",children:"Use AI to check image quality"})]}),l.jsx("button",{type:"button",role:"switch","aria-checked":((th=O.ai)==null?void 0:th.runQualityCheck)||!1,onClick:()=>{var Z;return Lr("ai","runQualityCheck")(!((Z=O.ai)!=null&&Z.runQualityCheck))},className:`toggle-button ${(rh=O.ai)!=null&&rh.runQualityCheck?"toggle-on":"toggle-off"}`,children:l.jsx("span",{className:"toggle-slider"})})]}),l.jsxs("div",{className:"setting-row toggle-row",children:[l.jsxs("div",{children:[l.jsx("label",{children:"AI Metadata Generation"}),l.jsx("p",{className:"setting-description",children:"Generate metadata using AI"})]}),l.jsx("button",{type:"button",role:"switch","aria-checked":((ah=O.ai)==null?void 0:ah.runMetadataGen)||!1,onClick:()=>{var Z;return Lr("ai","runMetadataGen")(!((Z=O.ai)!=null&&Z.runMetadataGen))},className:`toggle-button ${(nh=O.ai)!=null&&nh.runMetadataGen?"toggle-on":"toggle-off"}`,children:l.jsx("span",{className:"toggle-slider"})})]})]}),l.jsxs("div",{className:"setting-group",children:[l.jsx("h4",{className:"setting-group-title",children:"Advanced Settings"}),l.jsxs("div",{className:"setting-row toggle-row",children:[l.jsxs("div",{children:[l.jsx("label",{children:"Debug Mode"}),l.jsx("p",{className:"setting-description",children:"Enable detailed logging and debugging"})]}),l.jsx("button",{type:"button",role:"switch","aria-checked":((sh=O.advanced)==null?void 0:sh.debugMode)||!1,onClick:()=>{var Z;return Lr("advanced","debugMode")(!((Z=O.advanced)!=null&&Z.debugMode))},className:`toggle-button ${(lh=O.advanced)!=null&&lh.debugMode?"toggle-on":"toggle-off"}`,children:l.jsx("span",{className:"toggle-slider"})})]})]})]}):l.jsx("div",{className:"settings-content",children:l.jsxs("div",{className:"error-state",children:[l.jsx("p",{children:"Unable to load job settings. This job may be corrupted or missing configuration."}),l.jsx("p",{children:"Please check the error message below for more details."})]})}),M&&l.jsxs("div",{className:"settings-error",children:[l.jsx("span",{className:"error-icon",children:"⚠️"}),M]}),l.jsxs("div",{className:"settings-actions",children:[l.jsx("button",{onClick:hn,className:"btn-cancel",children:"Cancel"}),l.jsx("button",{onClick:Nr,disabled:ye||F||!O,className:"btn-save",children:ye?"Saving...":"Save Settings"})]})]})}),l.jsx(cd,{isOpen:ee,onClose:()=>ue(!1),onExport:async()=>await window.electronAPI.exportJobToExcel(e),title:"Export Job",description:"Export this job to Excel format with all details and settings."})]}):l.jsx("div",{className:"single-job-view",role:"main","aria-label":"Job not found",children:l.jsxs("div",{className:"error-container",children:[l.jsx("h3",{children:"Job Not Found"}),l.jsx("p",{children:"The requested job could not be found."}),l.jsx("button",{onClick:we,className:"btn-primary",children:"Go Back"})]})})};function Mj(){const[e,t]=L.useState("Testing..."),[r,a]=L.useState("Loading..."),[n,s]=L.useState("main"),[i,c]=L.useState(null);return L.useEffect(()=>{const o=async()=>{try{const f=await window.electronAPI.ping();t(f==="pong"?"✅ IPC Working":"❌ IPC Failed")}catch(f){console.error("IPC Error:",f),t("❌ IPC Error: "+f.message)}},u=async()=>{try{const f=await window.electronAPI.getAppVersion();a(f)}catch(f){console.error("Version Error:",f),a("Error: "+f.message)}};o(),u()},[]),l.jsx("div",{className:"min-h-screen bg-gray-100",children:n==="settings"?l.jsx(Eb,{onBack:()=>s("main")}):n==="dashboard"?l.jsx(Ej,{onBack:()=>s("main"),onOpenFailedImagesReview:()=>s("failed-review"),onOpenSettings:()=>s("settings"),onOpenJobs:()=>s("job-management"),onOpenSingleJobView:o=>{c(o),s("single-job")}}):n==="failed-review"?l.jsx(Aj,{onBack:()=>s("dashboard")}):n==="job-management"?l.jsx(Cj,{onOpenSingleJob:o=>{c(o.toString()),s("single-job")},onBack:()=>s("dashboard")}):n==="single-job"?l.jsx(kj,{jobId:i||"",onBack:()=>s("job-management"),onExport:o=>{console.log(`Export job ${o}`)},onRerun:o=>{console.log(`🚨 APP: Rerun job ${o} - calling backend rerun function`),window.electronAPI.jobManagement.rerunJobExecution(o)},onDelete:o=>{console.log(`Delete job ${o}`)}}):l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg max-w-md w-full",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-6 text-center",children:"Gen Image Factory"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[l.jsx("h2",{className:"text-lg font-semibold text-blue-800 mb-2",children:"Electron + React + TypeScript + Tailwind CSS"}),l.jsx("p",{className:"text-blue-600",children:"Basic Electron shell successfully set up with modern frontend tooling."})]}),l.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[l.jsx("h3",{className:"font-semibold text-green-800 mb-1",children:"IPC Communication"}),l.jsx("p",{className:"text-green-600",children:e})]}),l.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg",children:[l.jsx("h3",{className:"font-semibold text-purple-800 mb-1",children:"App Version"}),l.jsx("p",{className:"text-purple-600",children:r})]}),l.jsxs("div",{className:"p-4 bg-yellow-50 rounded-lg",children:[l.jsx("h3",{className:"font-semibold text-yellow-800 mb-1",children:"Development Status"}),l.jsx("p",{className:"text-yellow-600",children:"✅ Story 1.1 Foundation Setup Complete"}),l.jsx("p",{className:"text-yellow-600",children:"🚧 Story 1.8 Job Management - Core Infrastructure Complete"})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("button",{onClick:()=>s("settings"),className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition-colors",children:"Open Settings"}),l.jsx("button",{onClick:()=>s("dashboard"),className:"w-full bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 transition-colors",children:"Open Dashboard"})]})]})]})})})}const Dj=document.getElementById("root"),Rj=K4.createRoot(Dj);Rj.render(l.jsx(Mj,{}));
