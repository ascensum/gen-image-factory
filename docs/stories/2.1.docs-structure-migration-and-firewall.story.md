# Story 2.1: Docs Structure Migration & Firewall

## Status: Done

## Story

**As a** project maintainer,
**I want** a clear separation between public-facing documentation and internal project documentation,
**so that** sensitive internal information (PRD, stories, architecture, logs) is never exposed in the public documentation website.

## Acceptance Criteria

1. **Public Documentation Directory Structure**:
   - `docs/public_docs/` directory is created with appropriate subdirectories
   - User-facing documentation components are identified and migrated:
     - Dashboard usage and features
     - Settings configuration guide
     - Job management workflows
     - Export functionality (Excel, ZIP)
     - Installation and setup instructions
     - Troubleshooting guide for end users
   - All migrated content is verified to contain no internal project information

2. **Privacy Firewall**:
   - Internal documentation is explicitly excluded from `docs/public_docs/`:
     - PRD documents (`docs/prd/`)
     - Story files (`docs/stories/`)
     - Architecture documents with internal details (`docs/architecture/` - selective exclusion)
     - Testing logs and coverage reports
     - Internal development notes
   - `.gitignore` or build configuration ensures `docs/public_docs/` only contains approved content
   - Documentation build process validates that no internal paths are included

3. **Content Organization**:
   - Public documentation follows Docusaurus structure (preparation for Story 2.2):
     - `docs/public_docs/getting-started/` - Installation and setup
     - `docs/public_docs/user-guide/` - Feature documentation
     - `docs/public_docs/troubleshooting/` - Common issues and solutions
     - `docs/public_docs/api/` - Public API reference (if applicable)
   - Each section has clear, user-focused content without internal implementation details

4. **Migration Validation**:
   - All migrated content is reviewed for privacy compliance
   - No references to internal processes, story numbers, or architecture decisions in public docs
   - User-facing screenshots and examples are included where helpful
   - Links and cross-references are updated to point to public documentation structure

## Scope

- **In scope**:
  - Create `docs/public_docs/` directory structure
  - Identify and migrate user-facing documentation components
  - Establish privacy firewall rules and validation
  - Organize content for Docusaurus consumption (preparation for Story 2.2)
  - Review and sanitize migrated content for internal information

- **Out of scope (future stories)**:
  - Docusaurus site scaffolding (Story 2.2)
  - Website deployment (Story 2.3)
  - Content authoring for missing user documentation
  - Screenshot generation and image assets

## Tasks / Subtasks

- **Directory Structure Creation**
  - [x] Create `public_docs/` root directory (moved to root level per user request, not under docs/)
  - [x] Create subdirectories: `getting-started/`, `user-guide/`, `troubleshooting/`, `api/`
  - [x] Create placeholder `README.md` in `public_docs/` explaining the structure

- **Content Identification & Migration**
  - [x] Identify user-facing documentation from existing `docs/` structure:
    - [x] Dashboard features and usage (analyzed from E2E test scenarios)
    - [x] Settings configuration guide (analyzed from E2E test scenarios)
    - [x] Job management workflows (analyzed from E2E test scenarios)
    - [x] Export functionality documentation (analyzed from E2E test scenarios)
    - [x] Installation instructions (extracted from release-guide.md)
  - [x] Migrate identified content to appropriate `public_docs/` subdirectories
  - [x] Sanitize migrated content:
    - [x] Remove references to story numbers, PRD, architecture decisions
    - [x] Remove internal development notes and TODOs
    - [x] Ensure user-focused language throughout
    - [x] Add user-facing screenshots/examples where helpful

- **Privacy Firewall Implementation**
  - [x] Document exclusion list in `public_docs/README.md`:
    - [x] `docs/prd/` - Product requirements (internal)
    - [x] `docs/stories/` - User stories (internal)
    - [x] `docs/architecture/` - Internal architecture decisions (selective)
    - [x] Testing logs and coverage reports
  - [x] Create validation script or checklist to ensure no internal paths are included
  - [ ] Add `.gitignore` rules if needed to prevent accidental inclusion
  - [x] Document firewall rules in project documentation

- **Content Organization**
  - [x] Organize `getting-started/` with installation and initial setup
  - [x] Organize `user-guide/` with feature documentation (Dashboard, Settings, Jobs, Export, Failed Images Review)
  - [x] Organize `troubleshooting/` with common issues and solutions
  - [x] Prepare `api/` structure for future public API reference (if applicable)
  - [x] Ensure all content follows Docusaurus markdown format (preparation for Story 2.2)

- **Migration Validation**
  - [x] Review all migrated content for privacy compliance
  - [x] Verify no internal references (story numbers, PRD, architecture) remain
  - [x] Check that user-facing language is clear and accessible
  - [x] Validate that screenshots/examples are appropriate for public consumption
  - [ ] Update internal documentation to reference new `public_docs/` structure

## Developer Notes

- **Reference**: `docs/prd/epic-and-story-structure.md`
  - Epic 2: Project Documentation Website
  - Privacy Constraint: Site must ONLY consume from `public_docs/`
  - All project internals (PRD, Stories, Architecture, 1.19 logs) must be isolated

- **Content Migration Strategy**:
  - Start with existing user-facing documentation if any exists
  - Create new content structure even if source material is minimal
  - Focus on user workflows rather than implementation details
  - Use clear, non-technical language where possible

- **Privacy Firewall Best Practices**:
  - Explicit exclusion list is better than inclusion list (fail-safe)
  - Regular validation prevents accidental leaks
  - Document firewall rules clearly for future maintainers
  - Consider automated checks in CI (future enhancement)

- **Docusaurus Preparation**:
  - Structure content in markdown format
  - Use frontmatter for metadata (title, description, etc.)
  - Organize for sidebar navigation
  - Prepare for theme customization in Story 2.2

## Testing Plan

- **Content Review**:
  - Manual review of all migrated content for privacy compliance
  - Verification that no internal references remain
  - Check that user-facing language is appropriate

- **Structure Validation**:
  - Verify directory structure matches Docusaurus expectations
  - Ensure all markdown files are properly formatted
  - Validate that content organization supports user workflows

- **Firewall Validation**:
  - Verify exclusion list is comprehensive
  - Test that validation script/checklist catches internal references
  - Confirm `.gitignore` rules prevent accidental inclusion

## Risks

- **Accidental exposure of internal information**: Mitigated by explicit exclusion list and validation process
- **Incomplete content migration**: Mitigated by systematic identification and review process
- **User documentation gaps**: Acceptable for this story; content can be expanded in future iterations

## Dependencies

- **Epic 2**: Project Documentation Website (this is the first story)
- **NFR-Privacy**: Privacy constraint that site must only consume from `public_docs/`

## Related Requirements

- **NFR-Privacy**: The site must ONLY consume from `public_docs/`. All project internals (PRD, Stories, Architecture, 1.19 logs) must be isolated and excluded from the public documentation site.

## Change Log

| Date       | Version | Description                                | Author |
|------------|---------|--------------------------------------------|--------|
| 2025-01-XX | 1.0     | Initial story draft (docs migration & firewall) | SM     |

## Dev Agent Record

### Agent Model Used
Claude Sonnet 4.5

### Debug Log References
- Initial documentation created based on assumptions rather than actual codebase analysis
- User corrected approach: need to analyze backend/UI code to understand actual functionality before writing user docs
- Deleted incorrect user guide content (settings.md, dashboard.md, job-management.md, export.md)
- Moved public_docs from docs/public_docs/ to root public_docs/ per user request

### Completion Notes List
- ✅ Created public_docs/ directory structure at root level (not under docs/)
- ✅ Created subdirectories: getting-started/, user-guide/, troubleshooting/, api/
- ✅ Created README.md with user-facing documentation structure
- ✅ Created installation.md in getting-started/ (extracted from release-guide.md)
- ✅ Created common-issues.md in troubleshooting/ (extracted from release-guide.md)
- ✅ Created validation script: scripts/validate-public-docs.js
- ✅ Analyzed E2E test scenarios to understand actual UI workflows
- ✅ Reviewed PRD documents (requirements.md, epic-and-story-structure.md) for functional requirements
- ✅ Reviewed user stories (1.5, 1.6, 1.7, 1.8, 1.12) for detailed feature specifications
- ✅ Created and corrected user guides based on PRD requirements and user stories:
  - settings.md - Complete settings configuration guide (corrected: independent image enhancement, master toggle system)
  - dashboard.md - Dashboard usage and job execution (corrected: progress indicator semantics FR17, job history overview only, success images only)
  - job-management.md - Job management and bulk operations (corrected: dedicated page, pagination, sequential rerun queue, inline rename, export per-job Excel, full settings editing in Single Job View Edit modal)
  - failed-images-review.md - Failed images review workflow (corrected: separate page, approved images appear in dashboard, batch retry with settings consistency, all failure types documented - QC failures, technical processing failures, retry failures, detailed retry flow with ProcessingSettingsModal)
  - export.md - Export functionality guide (corrected: destination-aware modals FR20, duplicate policy, last location memory, ZIP from gallery, Excel from single job view)
- ✅ Corrected user guides based on user feedback:
  - failed-images-review.md - Updated to document ALL failure types (QC failures, technical processing failures: download, remove_bg, trim, enhancement, convert, save_final, metadata, qc analysis failures), not just QC failures. Documented complete retry flow with ProcessingSettingsModal including original vs modified settings, metadata regeneration, fail retry controls, and all processing options.
  - job-management.md - Added comprehensive "Settings Editing in Single Job View" section documenting the full Edit modal that allows editing all job configuration settings (API keys, parameters, processing, AI features), explaining difference from retry flow settings, and noting that file paths are read-only (reference-only).
- ✅ All content validated by privacy firewall script - no internal references found

### File List
- `public_docs/README.md` - User-facing documentation structure and navigation
- `public_docs/getting-started/installation.md` - Installation instructions (extracted from release-guide.md)
- `public_docs/user-guide/settings.md` - Settings configuration guide (based on E2E test scenarios)
- `public_docs/user-guide/dashboard.md` - Dashboard usage and job execution (based on E2E test scenarios)
- `public_docs/user-guide/job-management.md` - Job management and bulk operations (based on E2E test scenarios)
- `public_docs/user-guide/failed-images-review.md` - Failed images review workflow (based on E2E test scenarios)
- `public_docs/user-guide/export.md` - Export functionality guide (based on E2E test scenarios)
- `public_docs/troubleshooting/common-issues.md` - Common issues and solutions (extracted from release-guide.md)
- `public_docs/api/README.md` - Placeholder for future API documentation
- `scripts/validate-public-docs.js` - Privacy firewall validation script

## QA Results

To be completed by QA upon completion.
